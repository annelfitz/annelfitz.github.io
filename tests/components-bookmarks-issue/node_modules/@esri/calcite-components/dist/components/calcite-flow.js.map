{"file":"calcite-flow.js","mappings":"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","names":[],"sources":["src/components/flow/resources.ts","src/components/flow/flow.scss?tag=calcite-flow&encapsulation=shadow","src/components/flow/flow.tsx"],"sourcesContent":["export const CSS = {\n  frame: \"frame\",\n  frameAdvancing: \"frame--advancing\",\n  frameRetreating: \"frame--retreating\",\n};\n",":host {\n  @extend %component-host;\n  @apply relative\n    flex\n    w-full\n    flex-auto\n    items-stretch\n    overflow-hidden\n    bg-transparent;\n\n  .frame {\n    @apply relative\n      m-0\n      flex\n      w-full\n      flex-auto\n      flex-col\n      items-stretch\n      p-0;\n  }\n\n  ::slotted(calcite-flow-item),\n  ::slotted(calcite-panel) {\n    @apply h-full;\n  }\n\n  ::slotted(.calcite-match-height:last-child) {\n    @apply flex\n    flex-auto\n    overflow-hidden;\n  }\n\n  .frame--advancing {\n    animation: calcite-frame-advance var(--calcite-animation-timing);\n  }\n\n  .frame--retreating {\n    animation: calcite-frame-retreat var(--calcite-animation-timing);\n  }\n\n  @keyframes calcite-frame-advance {\n    0% {\n      @apply bg-opacity-50;\n      transform: translate3d(50px, 0, 0);\n    }\n    100% {\n      @apply bg-opacity-100;\n      transform: translate3d(0, 0, 0);\n    }\n  }\n\n  @keyframes calcite-frame-retreat {\n    0% {\n      @apply bg-opacity-50;\n      transform: translate3d(-50px, 0, 0);\n    }\n    100% {\n      @apply bg-opacity-100;\n      transform: translate3d(0, 0, 0);\n    }\n  }\n}\n\n@include base-component();\n","import { Component, Element, h, Listen, Method, Prop, State, VNode } from \"@stencil/core\";\nimport { createObserver } from \"../../utils/observers\";\nimport { FlowDirection, FlowItemLikeElement } from \"./interfaces\";\nimport { CSS } from \"./resources\";\nimport {\n  componentFocusable,\n  LoadableComponent,\n  setComponentLoaded,\n  setUpLoadableComponent,\n} from \"../../utils/loadable\";\n\n/**\n * @slot - A slot for adding `calcite-flow-item` elements to the component.\n */\n@Component({\n  tag: \"calcite-flow\",\n  styleUrl: \"flow.scss\",\n  shadow: true,\n})\nexport class Flow implements LoadableComponent {\n  // --------------------------------------------------------------------------\n  //\n  //  Public Methods\n  //\n  // --------------------------------------------------------------------------\n\n  /**\n   * Removes the currently active `calcite-flow-item`.\n   */\n  @Method()\n  async back(): Promise<HTMLCalciteFlowItemElement | FlowItemLikeElement> {\n    const { items } = this;\n\n    const lastItem = items[items.length - 1];\n\n    if (!lastItem) {\n      return;\n    }\n\n    const beforeBack = lastItem.beforeBack\n      ? lastItem.beforeBack\n      : (): Promise<void> => Promise.resolve();\n\n    try {\n      await beforeBack.call(lastItem);\n    } catch (_error) {\n      // back prevented\n      return;\n    }\n\n    lastItem.remove();\n\n    return lastItem;\n  }\n\n  /**\n   * Sets focus on the component.\n   */\n  @Method()\n  async setFocus(): Promise<void> {\n    await componentFocusable(this);\n\n    const { items } = this;\n    const activeItem = items[items.length - 1];\n\n    return activeItem?.setFocus();\n  }\n\n  // --------------------------------------------------------------------------\n  //\n  //  Public Properties\n  //\n  // --------------------------------------------------------------------------\n\n  /**\n   * This property enables the component to consider other custom elements implementing flow-item's interface.\n   *\n   * @internal\n   */\n  @Prop() customItemSelectors: string;\n\n  // --------------------------------------------------------------------------\n  //\n  //  Private Properties\n  //\n  // --------------------------------------------------------------------------\n\n  @Element() el: HTMLCalciteFlowElement;\n\n  @State() flowDirection: FlowDirection = null;\n\n  @State() itemCount = 0;\n\n  @State() items: FlowItemLikeElement[] = [];\n\n  itemMutationObserver = createObserver(\"mutation\", () => this.updateFlowProps());\n\n  // --------------------------------------------------------------------------\n  //\n  //  Lifecycle\n  //\n  // --------------------------------------------------------------------------\n\n  connectedCallback(): void {\n    this.itemMutationObserver?.observe(this.el, { childList: true, subtree: true });\n    this.updateFlowProps();\n  }\n\n  async componentWillLoad(): Promise<void> {\n    setUpLoadableComponent(this);\n  }\n\n  componentDidLoad(): void {\n    setComponentLoaded(this);\n  }\n\n  disconnectedCallback(): void {\n    this.itemMutationObserver?.disconnect();\n  }\n\n  // --------------------------------------------------------------------------\n  //\n  //  Private Methods\n  //\n  // --------------------------------------------------------------------------\n\n  @Listen(\"calciteFlowItemBack\")\n  async handleItemBackClick(event: CustomEvent): Promise<void> {\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    await this.back();\n    return this.setFocus();\n  }\n\n  getFlowDirection = (oldFlowItemCount: number, newFlowItemCount: number): FlowDirection | null => {\n    const allowRetreatingDirection = oldFlowItemCount > 1;\n    const allowAdvancingDirection = oldFlowItemCount && newFlowItemCount > 1;\n\n    if (!allowAdvancingDirection && !allowRetreatingDirection) {\n      return null;\n    }\n\n    return newFlowItemCount < oldFlowItemCount ? \"retreating\" : \"advancing\";\n  };\n\n  updateFlowProps = (): void => {\n    const { customItemSelectors, el, items } = this;\n\n    const newItems = Array.from<FlowItemLikeElement>(\n      el.querySelectorAll(\n        `calcite-flow-item${customItemSelectors ? `,${customItemSelectors}` : \"\"}`,\n      ),\n    ).filter((flowItem) => flowItem.closest(\"calcite-flow\") === el);\n\n    const oldItemCount = items.length;\n    const newItemCount = newItems.length;\n    const activeItem = newItems[newItemCount - 1];\n    const previousItem = newItems[newItemCount - 2];\n\n    if (newItemCount && activeItem) {\n      newItems.forEach((itemNode) => {\n        itemNode.showBackButton = itemNode === activeItem && newItemCount > 1;\n        itemNode.hidden = itemNode !== activeItem;\n      });\n    }\n\n    if (previousItem) {\n      previousItem.menuOpen = false;\n    }\n\n    this.items = newItems;\n\n    if (oldItemCount !== newItemCount) {\n      const flowDirection = this.getFlowDirection(oldItemCount, newItemCount);\n      this.itemCount = newItemCount;\n      this.flowDirection = flowDirection;\n    }\n  };\n\n  // --------------------------------------------------------------------------\n  //\n  //  Render Methods\n  //\n  // --------------------------------------------------------------------------\n\n  render(): VNode {\n    const { flowDirection } = this;\n\n    const frameDirectionClasses = {\n      [CSS.frame]: true,\n      [CSS.frameAdvancing]: flowDirection === \"advancing\",\n      [CSS.frameRetreating]: flowDirection === \"retreating\",\n    };\n\n    return (\n      <div class={frameDirectionClasses}>\n        <slot />\n      </div>\n    );\n  }\n}\n"],"version":3}