{"version":3,"file":"utils.spec.js","sourceRoot":"","sources":["../../../../src/components/icon/utils.spec.ts"],"names":[],"mappings":"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","sourcesContent":["import { fetchIcon, FetchIconProps, iconCache, normalizeIconName, requestCache, scaleToPx } from \"./utils\";\n\ndescribe(\"utils\", () => {\n  describe(\"scaleToPx\", () => {\n    it(\"maps scale values to sizes\", () => {\n      expect(scaleToPx[\"s\"]).toBe(16);\n      expect(scaleToPx[\"m\"]).toBe(24);\n      expect(scaleToPx[\"l\"]).toBe(32);\n    });\n  });\n\n  describe(\"fetchIcon\", () => {\n    beforeAll(() => {\n      // we mock fetch since we are not testing the icon data itself\n      (global.fetch as jest.Mock) = jest.fn(async () =>\n        Promise.resolve({\n          json: () =>\n            Promise.resolve({\n              /* intentionally empty */\n            }),\n        }),\n      );\n    });\n\n    afterAll(() => {\n      (global.fetch as jest.Mock).mockReset();\n    });\n\n    it(\"avoids fetching if icon data is available\", async () => {\n      expect(Object.keys(requestCache)).toHaveLength(0);\n      expect(Object.keys(iconCache)).toHaveLength(0);\n\n      const smallBanana: FetchIconProps = {\n        icon: \"banana\",\n        scale: \"s\",\n      };\n      const mediumBanana: FetchIconProps = {\n        icon: \"banana\",\n        scale: \"m\",\n      };\n      const circle: FetchIconProps = {\n        icon: \"circleF\",\n        scale: \"s\",\n      };\n      const circleKebab: FetchIconProps = {\n        icon: \"circle-f\",\n        scale: \"m\",\n      };\n      const circleCamel: FetchIconProps = {\n        icon: \"circleF\",\n        scale: \"m\",\n      };\n\n      await fetchIcon(smallBanana);\n      expect(Object.keys(requestCache)).toHaveLength(1);\n      expect(Object.keys(iconCache)).toHaveLength(1);\n\n      await fetchIcon(mediumBanana);\n      expect(Object.keys(requestCache)).toHaveLength(2);\n      expect(Object.keys(iconCache)).toHaveLength(2);\n\n      await fetchIcon(circle);\n      expect(Object.keys(requestCache)).toHaveLength(3);\n      expect(Object.keys(iconCache)).toHaveLength(3);\n\n      await fetchIcon(circleKebab);\n      expect(Object.keys(requestCache)).toHaveLength(4);\n      expect(Object.keys(iconCache)).toHaveLength(4);\n\n      await fetchIcon(smallBanana);\n      await fetchIcon(mediumBanana);\n      await fetchIcon(circleCamel);\n      expect(Object.keys(requestCache)).toHaveLength(4);\n      expect(Object.keys(iconCache)).toHaveLength(4);\n    });\n\n    it(\"normalizes icon name (used internally by fetchIcon)\", () => {\n      expect(normalizeIconName(\"1-8x\")).toBe(\"i18X\");\n      expect(normalizeIconName(\"1-8X\")).toBe(\"i18X\");\n      expect(normalizeIconName(\"18X\")).toBe(\"i18X\");\n\n      expect(normalizeIconName(\"1x\")).toBe(\"i1X\");\n      expect(normalizeIconName(\"1X\")).toBe(\"i1X\");\n\n      expect(normalizeIconName(\"2d-explore\")).toBe(\"i2DExplore\");\n      expect(normalizeIconName(\"2DExplore\")).toBe(\"i2DExplore\");\n\n      expect(normalizeIconName(\"360-view\")).toBe(\"i360View\");\n      expect(normalizeIconName(\"360View\")).toBe(\"i360View\");\n\n      expect(normalizeIconName(\"a-z\")).toBe(\"aZ\");\n      expect(normalizeIconName(\"aZ\")).toBe(\"aZ\");\n\n      expect(normalizeIconName(\"attachment\")).toBe(\"attachment\");\n\n      expect(normalizeIconName(\"classify-pixels\")).toBe(\"classifyPixels\");\n      expect(normalizeIconName(\"classifyPixels\")).toBe(\"classifyPixels\");\n\n      expect(normalizeIconName(\"display-selection-lock\")).toBe(\"displaySelectionLock\");\n      expect(normalizeIconName(\"displaySelectionLock\")).toBe(\"displaySelectionLock\");\n\n      expect(normalizeIconName(\"number-circle-6\")).toBe(\"numberCircle6\");\n      expect(normalizeIconName(\"numberCircle6\")).toBe(\"numberCircle6\");\n\n      expect(normalizeIconName(\"x-axis-guide\")).toBe(\"xAxisGuide\");\n      expect(normalizeIconName(\"xAxisGuide\")).toBe(\"xAxisGuide\");\n    });\n  });\n});\n"]}