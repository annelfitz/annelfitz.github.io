{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/interactive/visualElements/DrapedVisualElementResources.js", "../../@arcgis/core/views/3d/interactive/visualElements/VisualElementResources.js", "../../@arcgis/core/views/3d/interactive/visualElements/EngineVisualElement.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import r from\"../../../../core/Accessor.js\";import{IdentifiableMixin as s}from\"../../../../core/Identifiable.js\";import{property as t}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import\"../../../../core/RandomLCG.js\";import{subclass as o}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{DrapeSourceType as i,DrapedRenderGroup as c}from\"../../layers/interfaces.js\";import{DirtyOperation as u}from\"../../webgl-engine/lib/ModelDirtyTypes.js\";import{UpdatePolicy as n}from\"../../webgl-engine/lib/UpdatePolicy.js\";class d{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=c.Outline}destroy(){this._destroyResources()}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){this._renderGroup=e;const r=this._resources?.layerView;r&&(r.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),r=new a({view:this._resourceFactory.view,renderGroup:this._renderGroup}),s=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new a({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:e,geometriesAdded:!1},s&&(this._resources.drapeSourceRenderer=s.registerGeometryDrapeSource(r)),this._syncGeometriesToRenderer()}_destroyResources(){if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.basemapTerrain?.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){if(null==this._resources?.drapeSourceRenderer)return;if(!this._resources.geometriesAdded)return;this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,u.UPDATE),this._resources.geometriesAdded=!1}_ensureRenderGeometriesAdded(){if(null==this._resources?.drapeSourceRenderer)return;if(this._resources.geometriesAdded)return;this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,u.UPDATE),this._resources.geometriesAdded=!0}}let a=class extends(s(r)){constructor(e){super(e),this.drapeSourceType=i.Features,this.updatePolicy=n.SYNC,this.renderGroup=c.Outline}};e([t({constructOnly:!0})],a.prototype,\"view\",void 0),e([t({readOnly:!0})],a.prototype,\"drapeSourceType\",void 0),e([t()],a.prototype,\"renderGroup\",void 0),a=e([o(\"esri.views.3d.interactive.visualElements.DrapedVisualElementResources\")],a);export{d as DrapedVisualElementResources};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{watch as e,initial as s}from\"../../../../core/reactiveUtils.js\";import{ContentObjectType as r}from\"../../webgl-engine/lib/ContentObjectType.js\";import{Object3D as t}from\"../../webgl-engine/lib/Object3D.js\";import{UpdatePolicy as o}from\"../../webgl-engine/lib/UpdatePolicy.js\";import{WebGLLayer as i}from\"../../webgl-engine/lib/WebGLLayer.js\";class c{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view._stage;if(null==this._resources||!e)return;const s=this._resources.object;this._resources.external.forEach((s=>{s.type!==r.Mesh&&s.type!==r.Line&&s.type!==r.Point||e.remove(s)})),s.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,s,this._resources.layer),this._resources.external.forEach((s=>{s.type!==r.Mesh&&s.type!==r.Line&&s.type!==r.Point||e.add(s)}))}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const c=this._resourceFactory,a=c.view,h=a._stage;if(!h)return;const u=new i(h,{pickable:!1,updatePolicy:o.SYNC}),l=new t({castShadow:!1}),n=c.createResources(l,u);n.forEach((e=>{h.add(e),e.type===r.Texture&&e.load(h.renderView.renderingContext)})),h.add(l),u.add(l);const _=c.cameraChanged,y=_?e((()=>a.state.camera),(e=>_(e)),s):null;this._resources={layer:u,object:l,external:n,cameraHandle:y},this._syncVisible()}_destroyResources(){if(null==this._resources)return;const e=this._resourceFactory.view._stage;e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach((s=>{e.remove(s),s.type===r.Texture&&s.unload()}))),this._resources.object.dispose(),this._resources.cameraHandle?.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}export{c as VisualElementResources};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{DrapedVisualElementResources as e}from\"./DrapedVisualElementResources.js\";import{VisualElement as s}from\"./VisualElement.js\";import{VisualElementResources as r}from\"./VisualElementResources.js\";class t extends s{constructor(s){super(s),this._isDraped=!1,this.object3dResources=new r(this.createObject3DResourceFactory(s.view)),this.drapedResources=new e(this.createDrapedResourceFactory(s.view)),this.isDraped=s.isDraped??!1}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}}export{t as EngineVisualElement};\n"],
  "mappings": "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",
  "names": ["d", "e", "a", "s", "e", "s", "c", "a", "y", "t", "s", "d", "e"]
}
