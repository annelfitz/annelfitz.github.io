{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/layers/graphics/elevationAlignPointsInFeatures.js", "../../@arcgis/core/views/3d/layers/graphics/queryForSymbologySnapping.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport\"../../../../geometry.js\";import{throwIfAborted as e}from\"../../../../core/promiseUtils.js\";import{create as o}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{projectPointToVectorAsync as t}from\"../../../../geometry/projection/projectPointToVector.js\";import{makeDehydratedPoint as r}from\"../../../../layers/graphics/dehydratedPoint.js\";import{getGeometryEffectiveElevationInfo as i}from\"../../../../support/elevationInfoUtils.js\";import{evaluateElevationInfoAtPoint as n,SampleElevationInfo as s}from\"./elevationAlignmentUtils.js\";import{ElevationContext as a}from\"./ElevationContext.js\";import{extractExpressionInfo as p,createContext as f}from\"./featureExpressionInfoUtils.js\";import c from\"../../../../geometry/SpatialReference.js\";async function m(m,l,d,j,u){const{elevationProvider:v,renderCoordsHelper:g}=m,{elevationInfo:y}=l,{pointsInFeatures:I,spatialReference:x}=j,h=c.fromJSON(x),w=p(y,!0),R=await f(w,h,u);e(u);const S=[],b=new Set,z=new Set,E=new a,P=r(0,0,0,c.WGS84),U=new s,C=o();P.spatialReference=h;const F=m.elevationProvider.spatialReference??m.spatialReference;for(const{objectId:e,points:o}of I){const r=d(e);if(null==r){for(const e of o)S.push(e.z??0);b.add(e);continue}r.isDraped&&z.add(e);const s=r.graphic.geometry;E.setFromElevationInfo(i(s,y)),E.updateFeatureExpressionInfoContext(R,r.graphic,l);for(const{x:e,y:i,z:a}of o)P.x=e,P.y=i,P.z=a??0,await t(P,C,F,0,{signal:u}),n(C,v,E,g,U),S.push(U.z)}return{elevations:S,drapedObjectIds:z,failedObjectIds:b}}export{m as elevationAlignPointsInFeatures};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{throwIfAborted as n}from\"../../../../core/promiseUtils.js\";import{loadArcade as e}from\"../../../../support/arcadeOnDemand.js\";async function r(r,a,s){if(null==r||0===a.candidates.length)return t;const i=r.graphics3DGraphicsByObjectID??r.graphics3DGraphics,c=[],o=[],{renderer:d}=r,p=null!=d&&\"arcadeRequired\"in d&&d.arcadeRequired?e():null,l=async(n,{graphic:e,graphics3DSymbol:t})=>{const a=await p,i=await r.getRenderingInfoAsync(e,d,a,{signal:s});return null==i?[]:t.queryForSnapping(n,g,i,s)},{candidates:u,spatialReference:g}=a;for(let n=0;n<u.length;++n){const e=u[n],{objectId:r}=e,t=\"number\"==typeof r?i?.get(r):void 0;if(null==t)continue;const{graphics3DSymbol:a}=t;a.symbologySnappingSupported&&(c.push(l(e,t)),o.push(n))}if(0===c.length)return t;const h=await Promise.all(c);n(s);const f=[],m=[];for(let n=0;n<h.length;++n){const e=h[n],r=o[n];for(const n of e)f.push(n),m.push(r)}return{candidates:f,sourceCandidateIndices:m}}const t={candidates:[],sourceCandidateIndices:[]};export{r as queryForSymbologySnapping};\n"],
  "mappings": "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",
  "names": ["m", "l", "d", "R", "e", "o", "r", "s", "i", "a", "r", "a", "s", "i", "c", "o", "d", "l", "n", "e", "t", "f", "m"]
}
