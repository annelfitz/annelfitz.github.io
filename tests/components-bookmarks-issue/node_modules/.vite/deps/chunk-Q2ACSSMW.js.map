{
  "version": 3,
  "sources": ["../../@arcgis/core/geometry/projection/localLinearScaleFactors.js", "../../@arcgis/core/views/3d/layers/i3s/LayerElevationProvider.js", "../../@arcgis/core/views/3d/webgl-engine/collections/Component/ObjectParameters.js", "../../@arcgis/core/views/3d/webgl-engine/collections/Component/Transform.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{l as r}from\"../../chunks/vec32.js\";import{classifySpatialReference as t,sourceClassificationCache as s,destClassificationCache as o,ProjectionID as i,invPlateCarreeScale as n}from\"./projectors.js\";import{earth as e}from\"../support/Ellipsoid.js\";import{equals as u}from\"../support/spatialReferenceUtils.js\";function f(f,p,E,c){if(null==p||null==c)return!1;const l=t(p,s),C=t(c,o);if(l===C&&l!==i.UNKNOWN||u(p,c))return E[0]=1,E[1]=1,E[2]=1,!0;if(l===i.SPHERICAL_ECEF){const t=r(f),s=t/Math.sqrt(f[0]*f[0]+f[1]*f[1]),o=t/e.radius;if(C===i.WEB_MERCATOR)return E[0]=s*o,E[1]=s*o,E[2]=1,!0;if(C===i.WGS84||C===i.CGCS2000){const r=n;return E[0]=r*s*o,E[1]=r*o,E[2]=1,!0}}else if(l===i.PLATE_CARREE){if(C===i.WGS84||C===i.CGCS2000)return E[0]=n,E[1]=n,E[2]=1,!0;if(C===i.WEB_MERCATOR){const r=f[1]/e.radius;return E[0]=1,E[1]=1/Math.cos(r),E[2]=1,!0}}return!1}export{f as localLinearScaleFactors};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import r from\"../../../../core/Evented.js\";import o from\"../../../../core/Logger.js\";import{property as n}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import{subclass as i}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{fromQuat as s}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as a}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{s as l,e as c}from\"../../../../chunks/vec32.js\";import{create as p}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{projectBoundingSphere as m}from\"../../../../geometry/projection/projectBoundingSphere.js\";import{empty as u,expand as h}from\"../../../../geometry/support/aaBoundingRect.js\";import{f as d}from\"../../../../chunks/sphere.js\";import{ElevationRange as f}from\"../../support/ElevationRange.js\";import{ElevationUpdateEvent as v}from\"../../support/ElevationUpdateEvent.js\";import{newIntersector as g}from\"../../webgl-engine/lib/Intersector.js\";import{StoreResults as E}from\"../../webgl-engine/lib/IntersectorInterfaces.js\";let x=class extends(r.EventedMixin(t)){constructor(e){super(e),this._tmpEvent=new v,this._renderCoordsHelper=e.view.renderCoordsHelper,this._renderSR=this._renderCoordsHelper.spatialReference,this._layerElevationSource=e.layerElevationSource}initialize(){this._intersector=g(this.view.state.viewingMode),this._intersector.options.store=E.MIN,this._intersector.options.normalRequired=!1,this._tmpEvent.context=this.intersectionHandler.isGround?\"ground\":\"scene\"}get spatialReference(){return this.view?.elevationProvider?.spatialReference}getElevation(e,t,r,n){const i=this._renderCoordsHelper,s=l(R,e,t,r);if(!i.toRenderCoords(s,n,s))return o.getLogger(this).error(\"could not project point to compute elevation\"),null;const{layerElevationSource:a,_intersector:c,intersectionHandler:p}=this,m=a.fullExtent,u=null!=m&&Number.isFinite(m.xmin)&&Number.isFinite(m.xmax)&&Number.isFinite(m.ymin)&&Number.isFinite(m.ymax)&&Number.isFinite(m.zmin)&&Number.isFinite(m.zmax)?new f(m.zmin,m.zmax):a.elevationRange;if(null==u)return null;const h=a.elevationOffset,d=u.elevationRangeMin+h,v=u.elevationRangeMax+h,g=i.setAltitude(y,v,s),E=i.setAltitude(b,d,s);return c.reset(g,E,null),p.intersect(c,null,g,E,null,!0),c.results.min.getIntersectionPoint(s)?i.getAltitude(s):null}getSphereElevationBounds(e,t){return m(e,t,j,this._renderSR),this._layerElevationSource.getElevationRange(j)}getRootElevationBounds(){const e=this.layerElevationSource.fullExtent;return e?.hasZ?new f(e.zmin,e.zmax):null}objectsChanged(e){this.spatialReference&&(this._computeLayerExtent(e,this._tmpEvent.extent),this._tmpEvent.spatialReference=this.spatialReference,this.emit(\"elevation-change\",this._tmpEvent))}objectChanged(e){this.spatialReference&&(this._computeObjectExtent(e,this._tmpEvent.extent),this._tmpEvent.spatialReference=this.spatialReference,this.emit(\"elevation-change\",this._tmpEvent))}_computeObjectExtent(e,t){u(t),this._expandExtent(e,t)}_computeLayerExtent(e,t){u(t);for(const r of e)this._expandExtent(r,t)}_expandExtent(e,t){const r=this.spatialReference;if(null==r)return;if(null==e)return;s(_,e.quaternion),_[12]=e.center[0],_[13]=e.center[1],_[14]=e.center[2];const o=e.halfSize;for(let n=0;n<8;++n)R[0]=1&n?o[0]:-o[0],R[1]=2&n?o[1]:-o[1],R[2]=4&n?o[2]:-o[2],c(R,R,_),this._renderCoordsHelper.fromRenderCoords(R,R,r),h(t,R,t)}};e([n({constructOnly:!0})],x.prototype,\"layerElevationSource\",void 0),e([n({constructOnly:!0})],x.prototype,\"intersectionHandler\",void 0),e([n({constructOnly:!0})],x.prototype,\"view\",void 0),e([n()],x.prototype,\"spatialReference\",null),x=e([i(\"esri.views.3d.layers.i3s.LayerElevationProvider\")],x);const _=a(),j=d(0,0,0,0),R=p(),y=p(),b=p();export{x as LayerElevationProvider};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nclass t{constructor(t,s,o,r){this.toMapSpace=t,this.transform=s,this.obb=o,this.geometry=r}}export{t as ObjectParameters};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nclass i{constructor(i,o){this.position=i,this.rotationScale=o,this.origin=void 0}}export{i as Transform};\n"],
  "mappings": "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",
  "names": ["f", "t", "s", "o", "e", "t", "n", "i", "s", "o", "a", "m", "y", "_", "t", "s", "o", "i", "o"]
}
