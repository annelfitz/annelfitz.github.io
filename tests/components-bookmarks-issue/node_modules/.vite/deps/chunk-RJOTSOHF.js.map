{
  "version": 3,
  "sources": ["../../@esri/calcite-components/dist/esm/src/components/action-bar/utils.ts", "../../@esri/calcite-components/dist/esm/src/components/functional/ExpandToggle.tsx"],
  "sourcesContent": ["import { forceUpdate } from \"@stencil/core\";\nimport { SLOTS as ACTION_GROUP_SLOTS } from \"../action-group/resources\";\nimport { SLOTS as ACTION_MENU_SLOTS } from \"../action-menu/resources\";\nimport { Layout } from \"../interfaces\";\n\nexport const overflowActionsDebounceInMs = 150;\nconst groupBufferPx = 2;\n\nconst getAverage = (arr: number[]) => arr.reduce((p, c) => p + c, 0) / arr.length;\n\nexport const geActionDimensions = (\n  actions: HTMLCalciteActionElement[],\n): { actionWidth: number; actionHeight: number } => {\n  const actionsNotSlotted = actions.filter((action) => action.slot !== ACTION_GROUP_SLOTS.menuActions);\n  const actionLen = actionsNotSlotted?.length;\n  return {\n    actionWidth: actionLen ? getAverage(actionsNotSlotted.map((action) => action.clientWidth || 0)) : 0,\n    actionHeight: actionLen ? getAverage(actionsNotSlotted.map((action) => action.clientHeight || 0)) : 0,\n  };\n};\n\nconst getMaxActionCount = ({\n  width,\n  actionWidth,\n  layout,\n  height,\n  actionHeight,\n  groupCount,\n}: {\n  layout: Extract<\"horizontal\" | \"vertical\", Layout>;\n  height: number;\n  actionWidth: number;\n  width: number;\n  actionHeight: number;\n  groupCount: number;\n}): number => {\n  const maxContainerPx = layout === \"horizontal\" ? width : height;\n  const avgItemPx = layout === \"horizontal\" ? actionWidth : actionHeight;\n  return Math.floor((maxContainerPx - groupCount * groupBufferPx) / avgItemPx);\n};\n\nexport const getOverflowCount = ({\n  layout,\n  actionCount,\n  actionWidth,\n  width,\n  actionHeight,\n  height,\n  groupCount,\n}: {\n  layout: Extract<\"horizontal\" | \"vertical\", Layout>;\n  actionCount: number;\n  actionWidth: number;\n  width: number;\n  actionHeight: number;\n  height: number;\n  groupCount: number;\n}): number => {\n  return Math.max(actionCount - getMaxActionCount({ width, actionWidth, layout, height, actionHeight, groupCount }), 0);\n};\n\nexport const queryActions = (el: HTMLElement): HTMLCalciteActionElement[] => {\n  return Array.from(el.querySelectorAll(\"calcite-action\")).filter((action) =>\n    action.closest(\"calcite-action-menu\") ? action.slot === ACTION_MENU_SLOTS.trigger : true,\n  );\n};\n\nexport const overflowActions = ({\n  actionGroups,\n  expanded,\n  overflowCount,\n}: {\n  actionGroups: HTMLCalciteActionGroupElement[];\n  expanded: boolean;\n  overflowCount: number;\n}): void => {\n  let needToSlotCount = overflowCount;\n  actionGroups.reverse().forEach((group) => {\n    let slottedWithinGroupCount = 0;\n\n    const groupActions = queryActions(group).reverse();\n\n    groupActions.forEach((groupAction) => {\n      if (groupAction.slot === ACTION_GROUP_SLOTS.menuActions) {\n        groupAction.removeAttribute(\"slot\");\n        groupAction.textEnabled = expanded;\n      }\n    });\n\n    if (needToSlotCount > 0) {\n      groupActions.some((groupAction) => {\n        const unslottedActions = groupActions.filter((action) => !action.slot);\n\n        if (unslottedActions.length > 1 && groupActions.length > 2 && !groupAction.closest(\"calcite-action-menu\")) {\n          groupAction.textEnabled = true;\n          groupAction.setAttribute(\"slot\", ACTION_GROUP_SLOTS.menuActions);\n          slottedWithinGroupCount++;\n\n          if (slottedWithinGroupCount > 1) {\n            needToSlotCount--;\n          }\n        }\n\n        return needToSlotCount < 1;\n      });\n    }\n\n    forceUpdate(group);\n  });\n};\n", "import { FunctionalComponent, h } from \"@stencil/core\";\nimport { getElementDir } from \"../../utils/dom\";\nimport { queryActions } from \"../action-bar/utils\";\nimport { SLOTS as ACTION_GROUP_SLOTS } from \"../action-group/resources\";\nimport { Position, Scale } from \"../interfaces\";\n\ninterface ExpandToggleProps {\n  expanded: boolean;\n  expandText: string;\n  collapseText: string;\n  el: HTMLElement;\n  position: Position;\n  tooltip?: HTMLCalciteTooltipElement;\n  toggle: () => void;\n  ref?: (el: HTMLElement) => void;\n  scale?: Scale;\n}\n\nconst ICONS = {\n  chevronsLeft: \"chevrons-left\",\n  chevronsRight: \"chevrons-right\",\n};\n\nfunction getCalcitePosition(position: Position, el: HTMLElement): Position {\n  return position || el.closest(\"calcite-shell-panel\")?.position || \"start\";\n}\n\nexport function toggleChildActionText({\n  el,\n  expanded,\n}: {\n  el: HTMLElement;\n  expanded: boolean;\n}): void {\n  queryActions(el)\n    .filter((el) => el.slot !== ACTION_GROUP_SLOTS.menuActions)\n    .forEach((action) => (action.textEnabled = expanded));\n  el.querySelectorAll(\"calcite-action-group, calcite-action-menu\").forEach(\n    (el: HTMLCalciteActionMenuElement | HTMLCalciteActionGroupElement) => (el.expanded = expanded),\n  );\n}\n\nconst setTooltipReference = ({\n  tooltip,\n  referenceElement,\n  expanded,\n  ref,\n}: {\n  tooltip: HTMLCalciteTooltipElement;\n  referenceElement: HTMLCalciteActionElement;\n  expanded: boolean;\n  ref?: (el: HTMLElement) => void;\n}): HTMLCalciteActionElement => {\n  if (tooltip) {\n    tooltip.referenceElement = !expanded && referenceElement ? referenceElement : null;\n  }\n\n  if (ref) {\n    ref(referenceElement);\n  }\n\n  return referenceElement;\n};\n\nexport const ExpandToggle: FunctionalComponent<ExpandToggleProps> = ({\n  expanded,\n  expandText,\n  collapseText,\n  toggle,\n  el,\n  position,\n  tooltip,\n  ref,\n  scale,\n}) => {\n  const rtl = getElementDir(el) === \"rtl\";\n\n  const text = expanded ? collapseText : expandText;\n  const icons = [ICONS.chevronsLeft, ICONS.chevronsRight];\n\n  if (rtl) {\n    icons.reverse();\n  }\n\n  const end = getCalcitePosition(position, el) === \"end\";\n  const expandIcon = end ? icons[1] : icons[0];\n  const collapseIcon = end ? icons[0] : icons[1];\n\n  const actionNode = (\n    <calcite-action\n      icon={expanded ? expandIcon : collapseIcon}\n      onClick={toggle}\n      scale={scale}\n      text={text}\n      textEnabled={expanded}\n      title={!expanded && !tooltip ? text : null}\n      // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)\n      ref={(referenceElement): HTMLCalciteActionElement =>\n        setTooltipReference({ tooltip, referenceElement, expanded, ref })\n      }\n    />\n  );\n\n  return actionNode;\n};\n"],
  "mappings": "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",
  "names": ["ACTION_GROUP_SLOTS", "ACTION_MENU_SLOTS", "el"]
}
