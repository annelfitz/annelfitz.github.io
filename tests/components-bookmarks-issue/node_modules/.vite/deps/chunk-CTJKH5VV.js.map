{
  "version": 3,
  "sources": ["../../@arcgis/core/views/interactive/snapping/SnappingOperation.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import s from\"../../../core/Accessor.js\";import{abortMaybe as o,removeMaybe as n}from\"../../../core/maybe.js\";import{debounce as i}from\"../../../core/promiseUtils.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as e}from\"../../../core/accessorSupport/decorators/subclass.js\";import{TaskPriority as a,ImmediateTask as l}from\"../../support/Scheduler.js\";let p=class extends s{constructor(t){super(t),this.constrainResult=t=>t,this._snapPoints=null,this._frameTask=null,this._abortController=null,this._stagedPoint=null,this._snap=i((async(t,s,o,n)=>{const i=this._frameTask;if(null==i)return;const r=await i.schedule((()=>s.snap({...t,context:o,signal:n})),n);r.valid&&await i.schedule((()=>{this.stagedPoint=r.apply(),t!==this._snapPoints&&null!=this._snapPoints&&(this.stagedPoint=s.update({...this._snapPoints,context:o}))}),n)}))}get stagedPoint(){return this._stagedPoint}set stagedPoint(t){this._stagedPoint=this.constrainResult(t)}initialize(){const t=\"3d\"===this.view.type?this.view?.resourceController?.scheduler:null;this._frameTask=null!=t?t.registerTask(a.SNAPPING):l}destroy(){this._abortController=o(this._abortController),this._frameTask=n(this._frameTask)}update(t,s,o){this._snapPoints=t;const{point:n,scenePoint:i}=t,r=s.update({point:n,scenePoint:i,context:o});return this.stagedPoint=r,r}async snap(t,s,o){const{point:n,scenePoint:i}=t;return this.stagedPoint=s.update({point:n,scenePoint:i,context:o}),this._snapPoints=t,null==this._abortController&&(this._abortController=new AbortController),this._snap(t,s,o,this._abortController.signal)}async snapAgainNearPreviousMapPoint(t,s){null!=this._snapPoints&&await this.snap(this._snapPoints,t,s)}abort(){this._abortController=o(this._abortController),this._snapPoints=null}};t([r({constructOnly:!0})],p.prototype,\"view\",void 0),t([r()],p.prototype,\"stagedPoint\",null),t([r()],p.prototype,\"constrainResult\",void 0),t([r()],p.prototype,\"_stagedPoint\",void 0),p=t([e(\"esri.views.interactive.snapping.SnappingOperation\")],p);export{p as SnappingOperation};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;AAIqiB,IAAI,IAAE,cAAc,EAAC;AAAA,EAAC,YAAY,GAAE;AAAC,UAAM,CAAC,GAAE,KAAK,kBAAgB,CAAAA,OAAGA,IAAE,KAAK,cAAY,MAAK,KAAK,aAAW,MAAK,KAAK,mBAAiB,MAAK,KAAK,eAAa,MAAK,KAAK,QAAM,EAAG,OAAMA,IAAE,GAAE,GAAE,MAAI;AAAC,YAAM,IAAE,KAAK;AAAW,UAAG,QAAM;AAAE;AAAO,YAAM,IAAE,MAAM,EAAE,SAAU,MAAI,EAAE,KAAK,EAAC,GAAGA,IAAE,SAAQ,GAAE,QAAO,EAAC,CAAC,GAAG,CAAC;AAAE,QAAE,SAAO,MAAM,EAAE,SAAU,MAAI;AAAC,aAAK,cAAY,EAAE,MAAM,GAAEA,OAAI,KAAK,eAAa,QAAM,KAAK,gBAAc,KAAK,cAAY,EAAE,OAAO,EAAC,GAAG,KAAK,aAAY,SAAQ,EAAC,CAAC;AAAA,MAAE,GAAG,CAAC;AAAA,IAAC,CAAE;AAAA,EAAC;AAAA,EAAC,IAAI,cAAa;AAAC,WAAO,KAAK;AAAA,EAAY;AAAA,EAAC,IAAI,YAAY,GAAE;AAAC,SAAK,eAAa,KAAK,gBAAgB,CAAC;AAAA,EAAC;AAAA,EAAC,aAAY;AAJznC;AAI0nC,UAAM,IAAE,SAAO,KAAK,KAAK,QAAK,gBAAK,SAAL,mBAAW,uBAAX,mBAA+B,YAAU;AAAK,SAAK,aAAW,QAAM,IAAE,EAAE,aAAa,EAAE,QAAQ,IAAE;AAAA,EAAC;AAAA,EAAC,UAAS;AAAC,SAAK,mBAAiBC,GAAE,KAAK,gBAAgB,GAAE,KAAK,aAAW,EAAE,KAAK,UAAU;AAAA,EAAC;AAAA,EAAC,OAAO,GAAE,GAAE,GAAE;AAAC,SAAK,cAAY;AAAE,UAAK,EAAC,OAAM,GAAE,YAAW,EAAC,IAAE,GAAE,IAAE,EAAE,OAAO,EAAC,OAAM,GAAE,YAAW,GAAE,SAAQ,EAAC,CAAC;AAAE,WAAO,KAAK,cAAY,GAAE;AAAA,EAAC;AAAA,EAAC,MAAM,KAAK,GAAE,GAAE,GAAE;AAAC,UAAK,EAAC,OAAM,GAAE,YAAW,EAAC,IAAE;AAAE,WAAO,KAAK,cAAY,EAAE,OAAO,EAAC,OAAM,GAAE,YAAW,GAAE,SAAQ,EAAC,CAAC,GAAE,KAAK,cAAY,GAAE,QAAM,KAAK,qBAAmB,KAAK,mBAAiB,IAAI,oBAAiB,KAAK,MAAM,GAAE,GAAE,GAAE,KAAK,iBAAiB,MAAM;AAAA,EAAC;AAAA,EAAC,MAAM,8BAA8B,GAAE,GAAE;AAAC,YAAM,KAAK,eAAa,MAAM,KAAK,KAAK,KAAK,aAAY,GAAE,CAAC;AAAA,EAAC;AAAA,EAAC,QAAO;AAAC,SAAK,mBAAiBA,GAAE,KAAK,gBAAgB,GAAE,KAAK,cAAY;AAAA,EAAI;AAAC;AAAE,EAAE,CAAC,EAAE,EAAC,eAAc,KAAE,CAAC,CAAC,GAAE,EAAE,WAAU,QAAO,MAAM,GAAE,EAAE,CAAC,EAAE,CAAC,GAAE,EAAE,WAAU,eAAc,IAAI,GAAE,EAAE,CAAC,EAAE,CAAC,GAAE,EAAE,WAAU,mBAAkB,MAAM,GAAE,EAAE,CAAC,EAAE,CAAC,GAAE,EAAE,WAAU,gBAAe,MAAM,GAAE,IAAE,EAAE,CAAC,EAAE,mDAAmD,CAAC,GAAE,CAAC;",
  "names": ["t", "e"]
}
