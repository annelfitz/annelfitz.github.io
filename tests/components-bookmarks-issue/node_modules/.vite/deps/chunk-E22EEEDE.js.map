{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/interactive/visualElements/PointVisualElement.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{clamp as e}from\"../../../../core/mathUtils.js\";import{s as t}from\"../../../../chunks/vec32.js\";import{create as i}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{a as r,c as s}from\"../../../../chunks/vec42.js\";import{fromValues as o}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{projectVectorToVector as n}from\"../../../../geometry/projection/projectVectorToVector.js\";import{expandWithBuffer as l}from\"../../../../geometry/support/aaBoundingBox.js\";import{sv3d as a}from\"../../../../geometry/support/vectorStacks.js\";import{Object3DVisualElement as u}from\"./Object3DVisualElement.js\";import{evaluateElevationAlignmentAtPoint as h}from\"../../layers/graphics/elevationAlignmentUtils.js\";import{ElevationContext as m}from\"../../layers/graphics/ElevationContext.js\";import{requiresHalfTexelOffset as p,createTexture as _,defaultSymbolSizeRatio as c}from\"../../support/engineContent/sdfPrimitives.js\";import{createPointGeometry as g}from\"../../webgl-engine/lib/GeometryUtil.js\";import{VertexAttribute as d}from\"../../webgl-engine/lib/VertexAttribute.js\";import{HUDMaterial as f}from\"../../webgl-engine/materials/HUDMaterial.js\";class x extends u{constructor(e){super(e),this._material=null,this._texture=null,this._geometry=null,this._size=3,this._color=o(1,0,1,1),this._pixelSnappingEnabled=!0,this._primitive=\"square\",this._outlineSize=1,this._outlineColor=o(1,1,1,1),this._elevationInfo=null,this.applyProperties(e)}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get size(){return this._size}set size(e){if(e!==this._size){const t=this._preferredTextureSize;this._size=e,t<this._preferredTextureSize?this.recreate():this._updateSizeAttribute()}}get color(){return this._color}set color(e){r(e,this._color)||(s(this._color,e),this._updateMaterial())}get pixelSnappingEnabled(){return this._pixelSnappingEnabled}set pixelSnappingEnabled(e){this._pixelSnappingEnabled!==e&&(this._pixelSnappingEnabled=e,this._updateMaterial())}get primitive(){return this._primitive}set primitive(e){this._primitive!==e&&(this._primitive=e,this.recreate())}get outlineSize(){return this._outlineSize}set outlineSize(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(e){r(e,this._outlineColor)||(s(this._outlineColor,e),this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}_updateMaterial(){this._material&&this._material.setParameters(this._materialParameters)}_updateSizeAttribute(){const e=this.object;if(null==e)return;const t=e.geometries[0];if(null==t)return;const i=t.getMutableAttribute(d.SIZE).data,r=this._geometrySize;i[0]=r,i[1]=r,e.geometryVertexAttributeUpdated(e.geometries[0],d.SIZE)}get _materialParameters(){return{color:this._color,textureIsSignedDistanceField:!0,sampleSignedDistanceFieldTexelCenter:p(this._primitive),distanceFieldBoundingBox:v,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:this._texture?.id,polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled,isDecoration:this.isDecoration}}get _geometrySize(){return this._size/S}createExternalResources(){this._texture=_(this._primitive,this._preferredTextureSize),this._material=new f(this._materialParameters);const e=this.view._stage;this._texture.load(e.renderView.renderingContext),e.add(this._texture)}destroyExternalResources(){if(this._texture){this.view._stage.remove(this._texture),this._texture.dispose(),this._texture=null}this._material=null}createGeometries(e){const t=this._createRenderGeometry();null!=t&&e.addGeometry(t)}forEachExternalMaterial(e){this._material&&e(this._material)}get _preferredTextureSize(){return e(2*this._geometrySize,16,128)}calculateMapBounds(e){const t=this.object?.geometries[0];if(!t)return!1;const i=t.attributes.get(d.POSITION).data;return n(i,this.view.renderCoordsHelper.spatialReference,y,this.view.spatialReference),l(e,y),!0}_createRenderGeometry(){const{geometry:e,_material:i}=this;if(null==e||null==i)return null;const{renderCoordsHelper:r,elevationProvider:s}=this.view,o=h(e,s,m.fromElevationInfo(this.elevationInfo),r),l=t(a.get(),e.x,e.y,o),u=a.get();n(l,e.spatialReference,u,r.spatialReference);const p=this._geometrySize;return g(i,null,u,null,[p,p],[0,0,0,1])}}const S=c,v=[S/2,S/2,1-S/2,1-S/2],y=i();export{x as PointVisualElement};\n"],
  "mappings": "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",
  "names": ["a", "e", "r", "n", "o", "c", "u"]
}
