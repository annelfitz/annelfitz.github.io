import {
  L
} from "./chunk-3RT7534N.js";
import {
  N,
  b,
  d as d2,
  g,
  h,
  i,
  l,
  p,
  q,
  r as r2,
  t as t2
} from "./chunk-R5A6POKY.js";
import {
  n as n3,
  t
} from "./chunk-S3ISUHOZ.js";
import "./chunk-4ZRUV2JM.js";
import {
  e as e4
} from "./chunk-D5LHX57G.js";
import {
  n as n4
} from "./chunk-HLKM6YBE.js";
import "./chunk-CDYT7KXF.js";
import {
  e as e3
} from "./chunk-EAAEPSBY.js";
import "./chunk-X2GCSX3A.js";
import {
  s
} from "./chunk-QX66UTIR.js";
import "./chunk-OCF7OAES.js";
import "./chunk-JZBR4X6W.js";
import "./chunk-OIJCMME5.js";
import "./chunk-4KLYOMH2.js";
import "./chunk-CXNX736Z.js";
import {
  D,
  e2,
  r
} from "./chunk-RGCWZ2KZ.js";
import {
  n as n2
} from "./chunk-5VMSFOCB.js";
import "./chunk-LGQXPGTM.js";
import "./chunk-2SDMYJDE.js";
import "./chunk-TPLOIZC7.js";
import "./chunk-C62RZQQX.js";
import "./chunk-6Z6C6JVV.js";
import "./chunk-QLL2YG25.js";
import "./chunk-Z2PDA67N.js";
import "./chunk-NIDZ6R4E.js";
import "./chunk-IOB3DJMR.js";
import "./chunk-BPRXWDBO.js";
import "./chunk-7MT4ACA4.js";
import "./chunk-RUN6MNXL.js";
import "./chunk-SAYWXQVM.js";
import "./chunk-SBL4URUW.js";
import {
  P,
  d
} from "./chunk-Z4Y53NDM.js";
import {
  V
} from "./chunk-PVUNFEWX.js";
import {
  o as o2
} from "./chunk-TXBMNSNF.js";
import "./chunk-BVQWKK2V.js";
import "./chunk-D25BO7X7.js";
import {
  S,
  o,
  y2 as y
} from "./chunk-NDIXNREV.js";
import {
  a3 as a
} from "./chunk-I2RC5KWA.js";
import "./chunk-SSFWZSUM.js";
import {
  e
} from "./chunk-2F6FFF5T.js";
import "./chunk-C26KUZ46.js";
import "./chunk-JGDJR5EV.js";
import "./chunk-QHK5ZYFW.js";
import "./chunk-L65HKN25.js";
import {
  n2 as n
} from "./chunk-7RBRCL6S.js";
import "./chunk-J2EGIWT6.js";
import "./chunk-MDRC3XUT.js";
import "./chunk-NCF6OYL5.js";
import "./chunk-Z4ZPL3B3.js";

// node_modules/@arcgis/core/widgets/BasemapLayerList/BasemapLayerListViewModel.js
var n5 = { view: "view", basemap: "basemap", baseLayers: "base-layers", referenceLayers: "reference-layers", baseLayersListMode: "reference-layers-list-mode", referenceLayersListMode: "base-layers-list-mode", baseLayerViews: "base-layer-views", referenceLayerViews: "reference-layer-views", children: "children" };
var m = V.ofType(L);
var h2 = class extends o2.EventedAccessor {
  constructor(e6) {
    super(e6), this.baseItems = new m(), this.baseListItemCreatedFunction = null, this.checkPublishStatusEnabled = false, this.referenceListItemCreatedFunction = null, this.referenceItems = new m(), this.view = null, this._compileBaseList = this._compileBaseList.bind(this), this._compileReferenceList = this._compileReferenceList.bind(this);
  }
  initialize() {
    this.addHandles([d(() => {
      var _a, _b, _c, _d;
      return [(_b = (_a = this.view) == null ? void 0 : _a.map) == null ? void 0 : _b.basemap, true === ((_c = this.view) == null ? void 0 : _c.ready), (_d = this.view) == null ? void 0 : _d.basemapView];
    }, () => this._watchBasemapLayers(), P), d(() => [this.baseListItemCreatedFunction, this.checkPublishStatusEnabled], () => this._baseListItemCreatedFunctionChanged()), d(() => [this.referenceListItemCreatedFunction, this.checkPublishStatusEnabled], () => this._referenceListItemCreatedFunctionChanged())], n5.view);
  }
  destroy() {
    this.view = null, this.baseItems.removeAll(), this.referenceItems.removeAll();
  }
  get basemapTitle() {
    var _a, _b, _c;
    return ((_c = (_b = (_a = this.view) == null ? void 0 : _a.map) == null ? void 0 : _b.basemap) == null ? void 0 : _c.title) ?? null;
  }
  set basemapTitle(e6) {
    this._override("basemapTitle", e6);
  }
  get state() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.ready) ? "ready" : this.view ? "loading" : "disabled";
  }
  get totalBaseItems() {
    return this.baseItems.flatten((e6) => e6.children).length;
  }
  get totalReferenceItems() {
    return this.referenceItems.flatten((e6) => e6.children).length;
  }
  triggerAction(e6, t4) {
    e6 && !e6.disabled && this.emit("trigger-action", { action: e6, item: t4 });
  }
  moveListItem({ targetItem: e6, fromParentItem: t4, toParentItem: s3, from: i3, to: a2, newIndex: r3 }) {
    var _a, _b;
    const l3 = e6 == null ? void 0 : e6.layer;
    if (!l3 || "subtype-sublayer" === l3.type)
      return;
    const o3 = (_b = (_a = this.view) == null ? void 0 : _a.map) == null ? void 0 : _b.basemap, n6 = o3 == null ? void 0 : o3.baseLayers, m2 = o3 == null ? void 0 : o3.referenceLayers, h3 = t4 ? h(t4) : "base" === i3 ? n6 : m2, d4 = s3 ? h(s3) : "base" === a2 ? n6 : m2;
    if (!h3 || !d4)
      return;
    const { baseItems: p2, referenceItems: y2 } = this, L2 = "base" === i3 ? p2 : y2, b2 = "base" === a2 ? p2 : y2, f = (t4 == null ? void 0 : t4.children) || L2, u = (s3 == null ? void 0 : s3.children) || b2, I = d4.length - r3;
    e6.parent = s3 || null, f.remove(e6), h3.remove(l3), u.includes(e6) || u.add(e6, I), d4.includes(l3) || d4.add(l3, I), this._compileLists();
  }
  _createItemChangeHandles({ items: e6, key: t4, callback: s3 }) {
    this.removeHandles(t4), s3(), e6 && this.addHandles(e6.on("change", () => s3()), t4);
  }
  _createListItem({ layer: e6, type: t4 }) {
    const { view: s3, baseListItemCreatedFunction: i3, referenceListItemCreatedFunction: a2, checkPublishStatusEnabled: r3 } = this;
    return new L({ layer: e6, checkPublishStatusEnabled: r3, listItemCreatedFunction: "base" === t4 ? i3 : a2, view: s3 });
  }
  _watchLayersListMode({ layers: e6, key: t4, callback: s3 }) {
    this.removeHandles(t4), e6 && e6.forEach((e7) => {
      this.addHandles(d(() => e7.listMode, () => s3()), t4);
    });
  }
  _compileListItems({ layers: e6, items: t4, key: s3, type: i3, callback: a2 }) {
    this._watchLayersListMode({ layers: e6, key: s3, callback: a2 }), this._createNewItems({ type: i3, items: t4, layers: e6 }), this._removeItems({ items: t4, layers: e6 }), this._sortItems(t4, e6);
  }
  _compileReferenceList() {
    var _a, _b, _c;
    const { referenceItems: e6 } = this, t4 = (_c = (_b = (_a = this.view) == null ? void 0 : _a.map) == null ? void 0 : _b.basemap) == null ? void 0 : _c.referenceLayers;
    this._compileListItems({ type: "reference", layers: t4, items: e6, key: n5.referenceLayersListMode, callback: this._compileReferenceList });
  }
  _compileBaseList() {
    var _a, _b, _c;
    const { baseItems: e6 } = this, t4 = (_c = (_b = (_a = this.view) == null ? void 0 : _a.map) == null ? void 0 : _b.basemap) == null ? void 0 : _c.baseLayers;
    this._compileListItems({ type: "base", layers: t4, items: e6, key: n5.baseLayersListMode, callback: this._compileBaseList });
  }
  _compileLists() {
    this._compileReferenceList(), this._compileBaseList();
  }
  _createNewItems({ items: e6, layers: t4, type: s3 }) {
    t4 == null ? void 0 : t4.forEach((t5) => {
      e6.some((e7) => e7.layer === t5) || e6.add(this._createListItem({ type: s3, layer: t5 }));
    });
  }
  _removeItems({ items: e6, layers: t4 }) {
    e6 && e6.forEach((s3) => {
      if (!s3)
        return;
      const i3 = t4 == null ? void 0 : t4.some((e7) => s3.layer === e7);
      i3 || (this.removeHandles(`${n5.children}-${s3.uid}`), e6.remove(s3));
    });
  }
  _sortItems(e6, t4) {
    e6 && t4 && e6.sort((e7, s3) => {
      const i3 = t4.indexOf(e7.layer), a2 = t4.indexOf(s3.layer);
      return i3 > a2 ? -1 : i3 < a2 ? 1 : 0;
    });
  }
  _removeAllBaseItems() {
    const { baseItems: e6 } = this;
    e6.forEach((e7) => {
      this.removeHandles(`${n5.children}-${e7.uid}`);
    }), e6.removeAll();
  }
  _removeAllReferenceItems() {
    const { referenceItems: e6 } = this;
    e6.forEach((e7) => {
      this.removeHandles(`${n5.children}-${e7.uid}`);
    }), e6.removeAll();
  }
  _baseListItemCreatedFunctionChanged() {
    this._removeAllBaseItems(), this._compileLists();
  }
  _referenceListItemCreatedFunctionChanged() {
    this._removeAllReferenceItems(), this._compileLists();
  }
  _watchBasemapLayers() {
    const { view: e6 } = this;
    if (this.removeHandles([n5.baseLayers, n5.referenceLayers, n5.basemap, n5.baseLayerViews, n5.referenceLayerViews]), !(e6 == null ? void 0 : e6.ready))
      return this._removeAllBaseItems(), void this._removeAllReferenceItems();
    this._compileLists(), this.addHandles([d(() => {
      var _a, _b, _c;
      return (_c = (_b = (_a = this.view) == null ? void 0 : _a.map) == null ? void 0 : _b.basemap) == null ? void 0 : _c.baseLayers;
    }, (e7) => this._createItemChangeHandles({ items: e7, key: n5.baseLayers, callback: this._compileBaseList }), P), d(() => {
      var _a, _b, _c;
      return (_c = (_b = (_a = this.view) == null ? void 0 : _a.map) == null ? void 0 : _b.basemap) == null ? void 0 : _c.referenceLayers;
    }, (e7) => this._createItemChangeHandles({ items: e7, key: n5.referenceLayers, callback: this._compileReferenceList }), P), d(() => {
      var _a, _b;
      return (_b = (_a = this.view) == null ? void 0 : _a.basemapView) == null ? void 0 : _b.baseLayerViews;
    }, (e7) => this._createItemChangeHandles({ items: e7, key: n5.baseLayerViews, callback: this._compileBaseList }), P), d(() => {
      var _a, _b;
      return (_b = (_a = this.view) == null ? void 0 : _a.basemapView) == null ? void 0 : _b.referenceLayerViews;
    }, (e7) => this._createItemChangeHandles({ items: e7, key: n5.referenceLayerViews, callback: this._compileReferenceList }), P)], n5.basemap);
  }
};
e([y({ type: m, readOnly: true })], h2.prototype, "baseItems", void 0), e([y()], h2.prototype, "basemapTitle", null), e([y()], h2.prototype, "baseListItemCreatedFunction", void 0), e([y()], h2.prototype, "checkPublishStatusEnabled", void 0), e([y()], h2.prototype, "referenceListItemCreatedFunction", void 0), e([y({ type: m, readOnly: true })], h2.prototype, "referenceItems", void 0), e([y({ readOnly: true })], h2.prototype, "state", null), e([y()], h2.prototype, "totalBaseItems", null), e([y()], h2.prototype, "totalReferenceItems", null), e([y()], h2.prototype, "view", void 0), h2 = e([a("esri.widgets.BasemapLayerList.BasemapLayerListViewModel")], h2);
var d3 = h2;

// node_modules/@arcgis/core/widgets/BasemapLayerList/BasemapLayerListVisibleElements.js
var s2 = class extends S {
  constructor() {
    super(...arguments), this.baseLayers = true, this.closeButton = false, this.collapseButton = false, this.editTitleButton = false, this.errors = false, this.filter = false, this.flow = true, this.heading = true, this.referenceLayers = true, this.statusIndicators = true, this.temporaryLayerIndicators = false;
  }
};
e([y({ type: Boolean, nonNullable: true })], s2.prototype, "baseLayers", void 0), e([y({ type: Boolean, nonNullable: true })], s2.prototype, "closeButton", void 0), e([y({ type: Boolean, nonNullable: true })], s2.prototype, "collapseButton", void 0), e([y({ type: Boolean, nonNullable: true })], s2.prototype, "editTitleButton", void 0), e([y({ type: Boolean, nonNullable: true })], s2.prototype, "errors", void 0), e([y({ type: Boolean, nonNullable: true })], s2.prototype, "filter", void 0), e([y({ type: Boolean, nonNullable: true })], s2.prototype, "flow", void 0), e([y({ type: Boolean, nonNullable: true })], s2.prototype, "heading", void 0), e([y({ type: Boolean, nonNullable: true })], s2.prototype, "referenceLayers", void 0), e([y({ type: Boolean, nonNullable: true })], s2.prototype, "statusIndicators", void 0), e([y({ type: Boolean, nonNullable: true })], s2.prototype, "temporaryLayerIndicators", void 0), s2 = e([a("esri.widgets.BasemapLayerList.BasemapLayerListVisibleElements")], s2);
var l2 = s2;

// node_modules/@arcgis/core/widgets/BasemapLayerList/css.js
var t3 = "esri-basemap-layer-list";
var i2 = `${t3}__item`;
var e5 = { base: t3, filterNoResults: `${t3}__filter-no-results`, item: i2, itemActive: `${i2}--active`, itemContent: `${i2}-content`, itemContentBottom: `${i2}-content-bottom`, itemMessage: `${i2}-message`, itemInvisibleAtScale: `${i2}--invisible-at-scale`, itemActionIcon: `${i2}-action-icon`, itemActionImage: `${i2}-action-image`, itemTemporaryIcon: `${i2}-temporary-icon`, statusIndicator: `${t3}__status-indicator`, publishing: `${t3}__publishing`, updating: `${t3}__updating`, editing: `${t3}__editing`, connectionStatus: `${t3}__connection-status`, connectionStatusConnected: `${t3}__connection-status--connected`, visibleToggle: `${t3}__visible-toggle`, visibleIcon: `${t3}__visible-icon`, section: `${t3}__section` };

// node_modules/@arcgis/core/widgets/BasemapLayerList.js
var k = V.ofType(L);
var S2 = ".*\\S+.*";
var j = class extends s(D) {
  constructor(e6, t4) {
    super(e6, t4), this._activeItem = null, this._tooltipReferenceMap = /* @__PURE__ */ new Map(), this._editTitleInput = null, this._focusRootFlowItem = false, this._focusPanelFlowItem = false, this._focusEditingFlowItem = false, this._lastDragDetail = null, this._selectedDragItemLayerUid = null, this._rootGroupUid = `basemap-${this.uid}`, this.collapsed = false, this.dragEnabled = false, this.editingTitle = false, this.filterPlaceholder = "", this.baseFilterText = "", this.referenceFilterText = "", this.listItemCanGiveFunction = null, this.listItemCanReceiveFunction = null, this.headingLevel = 2, this.messages = null, this.messagesCommon = null, this.minFilterItems = i, this.selectedItems = new k(), this.selectionMode = "none", this.viewModel = new d3(), this.visibilityAppearance = "default", this.visibleElements = new l2(), this._canMove = ({ dragEl: e7, fromEl: t5, toEl: i3 }, s3) => {
      var _a, _b, _c;
      const n6 = "pull" === s3 ? this.listItemCanGiveFunction : this.listItemCanReceiveFunction, o3 = N(e7);
      if (!(o3 == null ? void 0 : o3.sortable))
        return false;
      const l3 = N(t5), r3 = g(t5), a2 = N(i3), c = g(i3), d4 = !!r3 && !!c && r3 === c, m2 = { selected: o3, from: l3, to: a2 }, p2 = t5.group, u = i3.group;
      return p2 && u && "function" == typeof n6 ? n6.call(null, m2) : d4 && "sublayer" !== ((_a = o3 == null ? void 0 : o3.layer) == null ? void 0 : _a.type) && "map-image" !== ((_b = l3 == null ? void 0 : l3.layer) == null ? void 0 : _b.type) && "map-image" !== ((_c = a2 == null ? void 0 : a2.layer) == null ? void 0 : _c.type);
    }, this._clearActiveItem = () => {
      this._activeItem = null;
    }, this._setActiveItem = (e7) => {
      if ("default" !== this.visibilityAppearance)
        return;
      const t5 = Array.from(e7.composedPath()).find((e8) => {
        var _a;
        return (_a = e8.classList) == null ? void 0 : _a.contains(e5.item);
      });
      this._activeItem = N(t5);
    }, this._onCalciteListOrderChange = (e7) => {
      const { _lastDragDetail: t5 } = this, { toEl: i3, fromEl: s3, dragEl: n6, newIndex: o3 } = e7;
      if (!s3 || !i3 || (t5 == null ? void 0 : t5.newIndex) === o3 && (t5 == null ? void 0 : t5.dragEl) === n6 && (t5 == null ? void 0 : t5.toEl) === i3 && (t5 == null ? void 0 : t5.fromEl) === s3)
        return;
      this._lastDragDetail = e7;
      const l3 = s3, r3 = i3;
      if (l3 !== r3)
        this._moveLayerFromChildList({ toEl: r3, fromEl: l3, dragEl: n6, newIndex: o3 });
      else {
        const e8 = Array.from(s3.children).filter((e9) => e9 == null ? void 0 : e9.matches("calcite-list-item")).map((e9) => e9.value);
        this._sortLayers(l3, e8);
      }
    };
  }
  normalizeCtorArgs(e6) {
    return null != (e6 == null ? void 0 : e6.editingEnabled) && null != e6.visibleElements ? { ...e6, visibleElements: new l2({ ...e6.visibleElements, editTitleButton: e6.editingEnabled }) } : e6;
  }
  loadDependencies() {
    return r({ action: () => import("./calcite-action-P2CTRNG2.js"), "action-group": () => import("./calcite-action-group-COKFT2E7.js"), "action-menu": () => import("./calcite-action-menu-43IE6S65.js"), block: () => import("./calcite-block-GV6ZWM4U.js"), label: () => import("./calcite-label-W4VTHQAF.js"), input: () => import("./calcite-input-CHG5BNQ7.js"), button: () => import("./calcite-button-V4T5NPWY.js"), flow: () => import("./calcite-flow-S3IMKQD6.js"), "flow-item": () => import("./calcite-flow-item-BUZXXDGT.js"), icon: () => import("./calcite-icon-25XWA6H7.js"), list: () => import("./calcite-list-CC3BA3BY.js"), "list-item": () => import("./calcite-list-item-K4SMX7ZK.js"), notice: () => import("./calcite-notice-Q2MN4Y4I.js"), tooltip: () => import("./calcite-tooltip-TDDUGVK4.js") });
  }
  destroy() {
    this._tooltipReferenceMap.clear();
  }
  get _baseFilterEnabled() {
    return this.viewModel.totalBaseItems >= this.minFilterItems && this.visibleElements.filter;
  }
  get _referenceFilterEnabled() {
    return this.viewModel.totalReferenceItems >= this.minFilterItems && this.visibleElements.filter;
  }
  get basemapTitle() {
    return this.viewModel.basemapTitle;
  }
  set basemapTitle(e6) {
    this.viewModel.basemapTitle = e6;
  }
  get baseListItemCreatedFunction() {
    return this.viewModel.baseListItemCreatedFunction;
  }
  set baseListItemCreatedFunction(e6) {
    this.viewModel.baseListItemCreatedFunction = e6;
  }
  get editingEnabled() {
    return o(n.getLogger(this), "editingEnabled", { replacement: "selectionMode, dragEnabled, visibleElements.editTitleButton", version: "4.29", warnOnce: true }), "none" !== this.selectionMode && this.dragEnabled && this.visibleElements.editTitleButton;
  }
  set editingEnabled(e6) {
    o(n.getLogger(this), "editingEnabled", { replacement: "selectionMode, dragEnabled, visibleElements.editTitleButton", version: "4.29", warnOnce: true }), this.dragEnabled = e6, this.visibleElements.editTitleButton = e6, this.selectionMode = e6 ? this.multipleSelectionEnabled ? "multiple" : "single" : "none";
  }
  get icon() {
    return "layers";
  }
  set icon(e6) {
    this._overrideIfSome("icon", e6);
  }
  get label() {
    var _a;
    return ((_a = this.messages) == null ? void 0 : _a.widgetLabel) ?? "";
  }
  set label(e6) {
    this._overrideIfSome("label", e6);
  }
  get multipleSelectionEnabled() {
    return o(n.getLogger(this), "multipleSelectionEnabled", { replacement: "selectionMode", version: "4.29", warnOnce: true }), "multiple" === this.selectionMode;
  }
  set multipleSelectionEnabled(e6) {
    o(n.getLogger(this), "multipleSelectionEnabled", { replacement: "selectionMode", version: "4.29", warnOnce: true }), this.selectionMode = e6 ? "multiple" : this.editingEnabled ? "single" : "none";
  }
  get referenceListItemCreatedFunction() {
    return this.viewModel.referenceListItemCreatedFunction;
  }
  set referenceListItemCreatedFunction(e6) {
    this.viewModel.referenceListItemCreatedFunction = e6;
  }
  get baseItems() {
    return this.viewModel.baseItems;
  }
  get referenceItems() {
    return this.viewModel.referenceItems;
  }
  get view() {
    return this.viewModel.view;
  }
  set view(e6) {
    this.viewModel.view = e6;
  }
  triggerAction(e6, t4) {
    return this.viewModel.triggerAction(e6, t4);
  }
  render() {
    const { state: e6 } = this.viewModel, t4 = { [e3.hidden]: "loading" === e6, [e3.disabled]: "disabled" === e6 };
    return n2("div", { class: this.classes(e5.base, e3.widget, e3.panel, t4) }, this._renderItems());
  }
  _renderItemTooltip(e6) {
    return e6 ? n2("calcite-tooltip", { key: `tooltip-${e6.layer.uid}`, referenceElement: this._tooltipReferenceMap.get(e6.layer.uid) }, this.messages.layerIncompatibleTooltip) : null;
  }
  _renderItemTooltipNodes(e6) {
    var _a;
    return e6.incompatible ? this._renderItemTooltip(e6) : (_a = e6.children) == null ? void 0 : _a.filter((e7) => !e7.hidden).toArray().map((e7) => this._renderItemTooltipNodes(e7));
  }
  _renderItemTooltips(e6) {
    return e6 == null ? void 0 : e6.toArray().map((e7) => this._renderItemTooltipNodes(e7));
  }
  _renderPanelFlowItems(e6) {
    return e6 ? e6.flatten((e7) => e7.children).filter((e7) => !e7.hidden).toArray().filter(({ panel: e7 }) => (e7 == null ? void 0 : e7.open) && !e7.disabled && e7.flowEnabled).map(({ title: e7, panel: t4 }) => {
      const i3 = () => this._handlePanelFlowItemBack(t4);
      return n2("calcite-flow-item", { afterCreate: this._focusPanelFlowItemNode, afterUpdate: this._focusPanelFlowItemNode, bind: this, description: e7, heading: t4.title, headingLevel: this.headingLevel, key: `flow-panel-${t4.uid}`, onCalciteFlowItemBack: (e8) => {
        e8.preventDefault(), i3();
      } }, t4.render(), n2("calcite-button", { appearance: "transparent", onclick: i3, slot: "footer-actions", width: "full" }, this.messagesCommon.back));
    }) : [];
  }
  _handlePanelFlowItemBack(e6) {
    e6.open = false, this._focusRootFlowItem = true;
  }
  _focusEditingFlowItemNode(e6) {
    this._focusEditingFlowItem && (this._focusEditingFlowItem = false, requestAnimationFrame(() => e6 == null ? void 0 : e6.setFocus()));
  }
  _focusRootFlowItemNode(e6) {
    this._focusRootFlowItem && (this._focusRootFlowItem = false, requestAnimationFrame(() => e6 == null ? void 0 : e6.setFocus()));
  }
  _focusPanelFlowItemNode(e6) {
    this._focusPanelFlowItem && (this._focusPanelFlowItem = false, requestAnimationFrame(() => e6 == null ? void 0 : e6.setFocus()));
  }
  _renderItemMessage(e6) {
    return e6.error ? n2("div", { class: e5.itemMessage, key: "esri-layer-list__error", slot: "content-bottom" }, n2("calcite-notice", { icon: "exclamation-mark-triangle", kind: "warning", open: true, scale: "s", width: "full" }, n2("div", { slot: "message" }, this.messages.layerError))) : e6.incompatible ? n2("div", { class: e5.itemMessage, key: "esri-layer-list__incompatible", slot: "content-bottom" }, n2("calcite-notice", { afterCreate: (t4) => this._setTooltipReference(t4, e6), afterRemoved: () => this._removeTooltipReference(e6), icon: "exclamation-mark-triangle", kind: "warning", open: true, scale: "s", tabIndex: 0, width: "full" }, n2("div", { slot: "message" }, this.messages.layerIncompatible))) : null;
  }
  _renderItem(e6, t4, i3, s3, n6) {
    const { _activeItem: o3, _selectedDragItemLayerUid: l3, selectionMode: r3, selectedItems: a2, messages: c } = this, d4 = e6.title || c.untitledLayer, m2 = e6.visibleAtCurrentScale ? d4 : `${d4} (${c.layerInvisibleAtScale})`, u = this._filterActions(e6.actionsSections), h3 = this._countActions(u);
    return n2("calcite-list-item", { afterCreate: (t5) => this._focusSelectedDragEl(t5, e6), afterUpdate: (t5) => this._focusSelectedDragEl(t5, e6), class: this.classes(e5.item, { [e5.itemActive]: o3 === e6 }), "data-item": e6, dragDisabled: !e6.sortable || i3, dragSelected: e6.layer.uid === l3, id: e6.layer.uid, key: `list-item-${e6.layer.uid}`, label: d4, metadata: { parentTitles: n6, title: d4 }, open: e6.open, selected: "none" !== r3 && a2.includes(e6), title: m2, value: e6.layer.uid, onCalciteListItemDragHandleChange: (t5) => this._handleCalciteListItemDragHandleChange(t5, e6), onCalciteListItemSelect: (t5) => this._handleCalciteListItemSelect(t5, e6, s3), onCalciteListItemToggle: (t5) => this._handleCalciteListItemToggle(t5, e6) }, n2("div", { class: this.classes({ [e5.itemContent]: true, [e5.itemInvisibleAtScale]: !e6.visibleAtCurrentScale }), slot: "content" }, d4), this._renderItemStatus(e6, s3), this._renderItemToggle(e6, s3), this._renderItemTemporaryIcon(e6), this._renderChildList(e6, t4, n6), this._renderItemMessage(e6), this._renderPanel(e6.panel), this._renderPanelAction(e6.panel), h3 > 1 ? this._renderActionsSections(e6, u) : 1 === h3 ? this._renderAction({ item: e6, action: this._getSingleActionButton(u), textEnabled: false }) : null);
  }
  _renderItemStatus(e6, t4) {
    const { visibleElements: i3 } = this;
    if (!i3.statusIndicators)
      return null;
    const { connectionStatus: s3, publishing: n6, updating: o3 } = e6, l3 = o3 && !t4, r3 = !!s3;
    return n2("calcite-icon", { class: this.classes({ [e5.statusIndicator]: true, [e5.publishing]: n6, [e5.updating]: l3, [e5.connectionStatus]: r3, [e5.connectionStatusConnected]: r3 && "connected" === s3 }), icon: r2({ connectionStatus: s3, publishing: n6 }), key: "layer-item-status", scale: "s", slot: "actions-end" });
  }
  _renderItemTemporaryIcon(e6) {
    return this.visibleElements.temporaryLayerIndicators && "persistenceEnabled" in e6.layer && !e6.layer.persistenceEnabled ? n2("calcite-icon", { class: e5.itemTemporaryIcon, icon: "temporary", key: "temporary-icon", scale: "s", slot: "actions-start", title: this.messages.temporary }) : null;
  }
  _renderItemToggle(e6, t4) {
    const { messages: i3, visibilityAppearance: s3 } = this, { visible: n6 } = e6, o3 = t4 == null ? void 0 : t4.visibilityMode;
    if ("inherited" === o3)
      return null;
    const l3 = t2({ visible: n6, exclusive: "exclusive" === o3, visibilityAppearance: s3 }), r3 = "checkbox" === s3, a2 = i3.layerVisibility;
    return n2("calcite-action", { appearance: "transparent", class: e5.visibleToggle, icon: r3 ? l3 : void 0, key: "visibility-toggle", onclick: () => this._toggleVisibility(e6, t4), scale: "s", slot: r3 ? "actions-start" : "actions-end", text: a2, title: a2 }, r3 ? null : n2("calcite-icon", { class: this.classes({ [e5.visibleIcon]: "exclusive" !== o3 && n6 }), icon: l3, scale: "s" }));
  }
  _renderPanel(e6) {
    return !(e6 == null ? void 0 : e6.open) || e6.disabled || e6.flowEnabled ? null : n2("div", { class: e5.itemContentBottom, key: `content-panel-${e6.uid}`, slot: "content-bottom" }, e6.render());
  }
  _renderPanelAction(e6) {
    if (!(e6 == null ? void 0 : e6.visible))
      return null;
    const { open: t4, title: i3, disabled: s3 } = e6;
    return n2("calcite-action", { active: t4, appearance: "transparent", disabled: s3, icon: t(e6), key: `action-${e6.uid}`, onclick: () => this._togglePanel(e6), scale: "s", slot: "actions-end", text: i3 ?? "", title: i3 ?? void 0 }, this._renderFallbackIcon(e6));
  }
  _renderActionsSections(e6, t4) {
    const i3 = this.messagesCommon.options;
    return n2("calcite-action-menu", { appearance: "transparent", key: "item-action-menu", label: this.messagesCommon.menu, open: e6.actionsOpen, overlayPositioning: "fixed", placement: "bottom-end", scale: "s", slot: "actions-end", onCalciteActionMenuOpen: (t5) => e6.actionsOpen = t5.target.open }, n2("calcite-action", { appearance: "transparent", icon: "ellipsis", scale: "s", slot: "trigger", text: i3, title: i3 }), t4.toArray().map((t5, i4) => this._renderActionSection(e6, t5, i4)));
  }
  _renderActionSection(e6, t4, i3) {
    return n2("calcite-action-group", { key: `action-section-${i3}` }, t4.toArray().map((t5) => this._renderAction({ item: e6, action: t5, textEnabled: true })));
  }
  _renderFallbackIcon(e6) {
    const { className: t4, icon: i3 } = e6;
    if (i3)
      return null;
    const s3 = "image" in e6 ? e6.image : void 0, n6 = { [e5.itemActionIcon]: !!t4, [e5.itemActionImage]: !!s3 };
    return t4 && (n6[t4] = true), s3 || t4 ? n2("span", { "aria-hidden": "true", class: this.classes(e5.itemActionIcon, n6), key: "icon", styles: n3(s3) }) : null;
  }
  _renderAction(e6) {
    const { item: t4, action: i3, textEnabled: s3 } = e6;
    if (!i3)
      return null;
    const { active: n6, disabled: o3, title: l3, type: a2, indicator: c } = i3;
    return n2("calcite-action", { active: "toggle" === a2 && i3.value, appearance: "transparent", disabled: o3, icon: t(i3), indicator: c, key: `action-${i3.uid}`, loading: n6, onclick: () => this._triggerAction(t4, i3), scale: "s", slot: s3 ? void 0 : "actions-end", text: l3 ?? "", textEnabled: s3, title: l3 ?? void 0 }, this._renderFallbackIcon(i3));
  }
  _setTooltipReference(e6, t4) {
    this._tooltipReferenceMap.set(t4.layer.uid, e6);
  }
  _removeTooltipReference(e6) {
    this._tooltipReferenceMap.delete(e6.layer.uid);
  }
  _moveLayerFromChildList({ toEl: e6, fromEl: t4, dragEl: i3, newIndex: s3 }) {
    const n6 = N(i3), o3 = N(e6), l3 = N(t4), r3 = x(t4), a2 = x(e6);
    r3 && a2 && this.viewModel.moveListItem({ targetItem: n6, fromParentItem: l3, toParentItem: o3, newIndex: s3, from: r3, to: a2 });
  }
  _handleCalciteListDragEnd(e6) {
    const { fromEl: t4, dragEl: i3, oldIndex: s3 } = e6;
    t4.insertBefore(i3, t4.children[s3]);
  }
  _sortLayers(e6, t4) {
    var _a, _b, _c, _d, _e, _f;
    if (e6)
      if (e6.group === this._rootGroupUid) {
        const i3 = x(e6), s3 = "base" === i3 ? (_c = (_b = (_a = this.view) == null ? void 0 : _a.map) == null ? void 0 : _b.basemap) == null ? void 0 : _c.baseLayers : "reference" === i3 ? (_f = (_e = (_d = this.view) == null ? void 0 : _d.map) == null ? void 0 : _e.basemap) == null ? void 0 : _f.referenceLayers : null;
        p(s3, t4);
      } else {
        const i3 = N(e6);
        if (!i3)
          return;
        b(i3, t4);
      }
  }
  _getSingleActionButton(e6) {
    return e6.reduce((e7) => e7).filter((e7) => e7 && "button" === e7.type).at(0);
  }
  _filterActions(e6) {
    return e6.map((e7) => e7.filter((e8) => e8.visible));
  }
  _countActions(e6) {
    return e6.reduce((e7, t4) => e7 + t4.length, 0);
  }
  _triggerAction(e6, t4) {
    t4 && e6 && ("toggle" === t4.type && (t4.value = !t4.value), this.triggerAction(t4, e6));
  }
  _handleCalciteListChange(e6) {
    const { selectionMode: t4, selectedItems: i3 } = this;
    if ("none" === t4)
      return;
    const s3 = e6.target.selectedItems.map((e7) => N(e7)).filter(Boolean);
    i3.removeAll(), i3.addMany(s3);
  }
  _handleCalciteListItemToggle(e6, t4) {
    e6.stopPropagation(), t4.open = e6.target.open;
  }
  _focusSelectedDragEl(e6, t4) {
    this._selectedDragItemLayerUid === t4.layer.uid && requestAnimationFrame(() => e6 == null ? void 0 : e6.setFocus());
  }
  _handleCalciteListItemDragHandleChange(e6, t4) {
    e6.stopPropagation();
    const i3 = e6.target.dragSelected;
    this._selectedDragItemLayerUid = i3 ? t4.layer.uid : null;
  }
  _handleCalciteListItemSelect(e6, t4, i3) {
    N(e6.target) === t4 && "none" === this.selectionMode && "inherited" !== (i3 == null ? void 0 : i3.visibilityMode) && this._toggleVisibility(t4, i3);
  }
  _togglePanel(e6) {
    e6.open = !e6.open, e6.open && (this._focusPanelFlowItem = true);
  }
  _toggleVisibility(e6, t4) {
    if (!e6)
      return;
    const i3 = t4 == null ? void 0 : t4.visibilityMode;
    "exclusive" === i3 && e6.visible || (e6.visible = !e6.visible);
  }
  _renderEditingInput() {
    const { messages: e6 } = this, { basemapTitle: t4 } = this.viewModel;
    return n2("div", { class: e5.editing }, n2("calcite-label", null, e6.basemapTitle, n2("calcite-input", { afterCreate: (e7) => this._editTitleInput = e7, label: e6.basemapTitle, name: "basemaptitle", pattern: S2, placeholder: e6.basemapTitle, required: true, title: e6.basemapTitle, type: "text", value: t4 ?? void 0 })));
  }
  _renderCancelButton() {
    const { messagesCommon: { cancel: e6 } } = this;
    return n2("calcite-button", { appearance: "outline", bind: this, label: e6, onclick: this._toggleEditingTitle, slot: "footer", title: e6, width: "half" }, e6);
  }
  _renderSubmitButton() {
    const { messagesCommon: e6 } = this;
    return n2("calcite-button", { label: e6.form.submit, slot: "footer", title: e6.form.submit, type: "submit", width: "half" }, e6.form.ok);
  }
  _renderEditingForm() {
    return this.editingTitle ? n2("form", { bind: this, onsubmit: this._formSubmit }, n2("calcite-flow-item", { afterCreate: this._focusEditingFlowItemNode, afterUpdate: this._focusEditingFlowItemNode, bind: this, heading: this.visibleElements.heading ? this.messages.basemapTitle : void 0, headingLevel: this.headingLevel, onCalciteFlowItemBack: (e6) => {
      e6.preventDefault(), this._toggleEditingTitle();
    } }, this._renderEditingInput(), this._renderCancelButton(), this._renderSubmitButton())) : null;
  }
  _renderEditTitleButton() {
    const { editingTitle: e6, visibleElements: t4, messagesCommon: i3 } = this, s3 = i3.edit;
    return t4.editTitleButton && !e6 ? n2("calcite-action", { bind: this, icon: "pencil", onclick: this._toggleEditingTitle, slot: "header-actions-end", text: s3, title: s3 }) : null;
  }
  _renderNoLayersInfoMessage(e6) {
    return n2("div", { slot: "message" }, e6);
  }
  _renderNoLayersInfo(e6, t4) {
    return n2("div", { class: e5.itemMessage }, n2("calcite-notice", { icon: "information", key: t4, kind: "info", open: true, width: "full" }, this._renderNoLayersInfoMessage(e6)));
  }
  _getFilteredItems(e6) {
    return e6 == null ? void 0 : e6.filter((e7) => !e7.hidden && (this.visibleElements.errors || !e7.error));
  }
  _renderItems() {
    const { collapsed: e6, visible: t4, visibleElements: { closeButton: i3, collapseButton: s3, heading: n6, flow: o3 }, messages: l3, viewModel: r3, referenceItems: a2, baseItems: c } = this, d4 = this.visibleElements.referenceLayers ? this._getFilteredItems(a2) : null, m2 = this.visibleElements.baseLayers ? this._getFilteredItems(c) : null, p2 = [n2("calcite-flow-item", { afterCreate: this._focusRootFlowItemNode, afterUpdate: this._focusRootFlowItemNode, bind: this, closable: i3, closed: !t4, collapsed: e6, collapsible: s3, heading: n6 ? r3.basemapTitle ?? l3.widgetLabel : void 0, headingLevel: this.headingLevel, key: "root-flow-item", onCalciteFlowItemClose: () => this.visible = false }, this._renderEditTitleButton(), this._renderReferenceSection(d4), this._renderBaseSection(m2, 1 === (m2 == null ? void 0 : m2.length))), this._renderEditingForm(), this._renderPanelFlowItems(m2), this._renderPanelFlowItems(d4)];
    return t4 ? [o3 ? n2("calcite-flow", { key: "root-flow" }, p2) : p2, this._renderItemTooltips(d4), this._renderItemTooltips(m2)] : null;
  }
  _renderChildList(e6, t4, i3 = []) {
    var _a;
    const { _rootGroupUid: s3, dragEnabled: n6 } = this, { children: o3 } = e6, l3 = q(e6), r3 = !l(e6.layer) && !l3 && n6 && "group" === ((_a = e6.layer) == null ? void 0 : _a.type);
    return l3 || r3 ? n2("calcite-list", { canPull: (e7) => this._canMove(e7, "pull"), canPut: (e7) => this._canMove(e7, "put"), "data-basemap-layer-type": t4, "data-item": e6, "data-layer-type": s3, dragEnabled: !!n6 && (e6.childrenSortable && d2(e6)), group: `${s3}-${e6.layer.uid}` }, o3 == null ? void 0 : o3.filter((e7) => !e7.hidden).toArray().map((s4) => this._renderItem(s4, t4, false, e6, [...i3, e6.title]))) : null;
  }
  _renderList(e6, t4, i3) {
    const { messages: s3, dragEnabled: n6, selectionMode: o3, filterPlaceholder: l3, baseFilterText: r3, referenceFilterText: a2, _baseFilterEnabled: c, _referenceFilterEnabled: d4, _rootGroupUid: m2 } = this, u = "reference" === t4 ? s3.noReferenceLayers : s3.noBaseLayers, h3 = "reference" === t4 ? d4 : c;
    return n2("calcite-block", { class: e5.section, collapsible: true, heading: "reference" === t4 ? s3.referenceHeading : s3.baseHeading, headingLevel: n4(this.headingLevel), key: `block-${t4}`, open: true }, 0 === (e6 == null ? void 0 : e6.length) ? this._renderNoLayersInfo(u, t4) : null, n2("calcite-list", { afterCreate: (e7) => {
      e7.addEventListener("focusin", this._setActiveItem), e7.addEventListener("focusout", this._clearActiveItem);
    }, afterRemoved: (e7) => {
      e7.removeEventListener("focusin", this._setActiveItem), e7.removeEventListener("focusout", this._clearActiveItem);
    }, canPull: (e7) => this._canMove(e7, "pull"), canPut: (e7) => this._canMove(e7, "put"), "data-basemap-layer-type": t4, "data-layer-type": m2, dragEnabled: n6, filterEnabled: h3, filterPlaceholder: l3, filterText: h3 ? "reference" === t4 ? a2 : r3 : "", group: m2, key: `list-${t4}`, label: s3.widgetLabel, onmouseleave: this._clearActiveItem, onmouseover: this._setActiveItem, selectionAppearance: "border", selectionMode: o3, onCalciteListChange: (e7) => this._handleCalciteListChange(e7), onCalciteListDragEnd: (e7) => this._handleCalciteListDragEnd(e7.detail), onCalciteListFilter: (e7) => {
      var _a;
      return this["reference" === t4 ? "referenceFilterText" : "baseFilterText"] = ((_a = e7.target) == null ? void 0 : _a.filterText) ?? "";
    }, onCalciteListOrderChange: (e7) => this._onCalciteListOrderChange(e7.detail) }, e6 == null ? void 0 : e6.toArray().map((e7) => this._renderItem(e7, t4, i3)), (e6 == null ? void 0 : e6.length) && h3 ? n2("div", { class: e5.filterNoResults, slot: "filter-no-results" }, n2("calcite-notice", { kind: "info", open: true, width: "full" }, this._renderNoLayersInfoMessage(u))) : null));
  }
  _renderBaseSection(e6, t4) {
    return this.visibleElements.baseLayers ? this._renderList(e6, "base", t4) : null;
  }
  _renderReferenceSection(e6) {
    return this.visibleElements.referenceLayers ? this._renderList(e6, "reference", false) : null;
  }
  _toggleEditingTitle() {
    const { editingTitle: e6 } = this, t4 = !e6;
    this.editingTitle = t4, t4 ? this._focusEditingFlowItem = true : this._focusRootFlowItem = true;
  }
  _formSubmit(e6) {
    var _a;
    e6.preventDefault();
    const t4 = (_a = this._editTitleInput) == null ? void 0 : _a.value;
    (t4 == null ? void 0 : t4.trim()) && (this.basemapTitle = t4), this._toggleEditingTitle();
  }
};
function x(e6) {
  return e6 == null ? void 0 : e6.getAttribute("data-basemap-layer-type");
}
e([y()], j.prototype, "_activeItem", void 0), e([y()], j.prototype, "_tooltipReferenceMap", void 0), e([y()], j.prototype, "_focusRootFlowItem", void 0), e([y()], j.prototype, "_focusPanelFlowItem", void 0), e([y()], j.prototype, "_focusEditingFlowItem", void 0), e([y()], j.prototype, "_baseFilterEnabled", null), e([y()], j.prototype, "_referenceFilterEnabled", null), e([y()], j.prototype, "basemapTitle", null), e([y()], j.prototype, "collapsed", void 0), e([y()], j.prototype, "dragEnabled", void 0), e([y()], j.prototype, "editingTitle", void 0), e([y()], j.prototype, "filterPlaceholder", void 0), e([y()], j.prototype, "baseFilterText", void 0), e([y()], j.prototype, "referenceFilterText", void 0), e([y()], j.prototype, "listItemCanGiveFunction", void 0), e([y()], j.prototype, "listItemCanReceiveFunction", void 0), e([y()], j.prototype, "baseListItemCreatedFunction", null), e([y()], j.prototype, "editingEnabled", null), e([y()], j.prototype, "headingLevel", void 0), e([y()], j.prototype, "icon", null), e([y()], j.prototype, "label", null), e([y(), e2("esri/widgets/BasemapLayerList/t9n/BasemapLayerList")], j.prototype, "messages", void 0), e([y(), e2("esri/t9n/common")], j.prototype, "messagesCommon", void 0), e([y()], j.prototype, "minFilterItems", void 0), e([y()], j.prototype, "multipleSelectionEnabled", null), e([y()], j.prototype, "referenceListItemCreatedFunction", null), e([y({ readOnly: true })], j.prototype, "baseItems", null), e([y({ readOnly: true })], j.prototype, "referenceItems", null), e([y()], j.prototype, "selectedItems", void 0), e([y()], j.prototype, "selectionMode", void 0), e([y()], j.prototype, "view", null), e([e4("trigger-action"), y({ type: d3 })], j.prototype, "viewModel", void 0), e([y()], j.prototype, "visibilityAppearance", void 0), e([y({ type: l2, nonNullable: true })], j.prototype, "visibleElements", void 0), j = e([a("esri.widgets.BasemapLayerList")], j);
var B = j;
export {
  B as default
};
//# sourceMappingURL=BasemapLayerList-62NWBMGK.js.map
