{
  "version": 3,
  "sources": ["../../@arcgis/core/views/interactive/support/utils.js", "../../@arcgis/core/views/interactive/GraphicManipulator.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{pt2px as o}from\"../../../core/screenUtils.js\";function s(s){let t=0,a=0,e=0;return s?(\"cim\"===s.type&&s.data.symbol&&\"symbolLayers\"in s.data.symbol&&s.data.symbol.symbolLayers&&s.data.symbol.symbolLayers.map((o=>{\"CIMVectorMarker\"===o.type&&o.anchorPoint&&(Math.abs(o.anchorPoint.x)>t&&(t=o.anchorPoint.x),Math.abs(o.anchorPoint.y)>a&&(a=o.anchorPoint.y),null!=o.size&&o.size>e&&(e=o.size))})),t=o(t),a=o(a),e=o(e),{offsetX:t,offsetY:a,size:e}):{offsetX:t,offsetY:a,size:e}}export{s as getSymbolInfo};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Accessor.js\";import o from\"../../core/Evented.js\";import{watch as i,sync as s}from\"../../core/reactiveUtils.js\";import{screenPointObjectToArray as r,pt2px as l,createScreenPointArray as n}from\"../../core/screenUtils.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as c}from\"../../core/accessorSupport/decorators/subclass.js\";import{squaredDistance as h}from\"../../core/libs/gl-matrix-2/math/vec2.js\";import{q as p}from\"../../chunks/vec32.js\";import{create as m}from\"../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{canProjectWithoutEngine as u,project as y}from\"../../geometry/projection.js\";import{projectPointToVector as g}from\"../../geometry/projection/projectPointToVector.js\";import{getGraphicEffectiveElevationMode as b}from\"../../support/elevationInfoUtils.js\";import{getDefaultSymbol2D as d}from\"../../symbols/support/defaults.js\";import f from\"../../symbols/support/ElevationInfo.js\";import{getSymbolInfo as _}from\"./support/utils.js\";import{intersectsDrapedGeometry as v}from\"../support/drapedUtils.js\";let S=class extends e{set graphic(t){this._circleCollisionCache=null,this._originalSymbol=t.symbol,this._set(\"graphic\",t),this.attachSymbolChanged()}get elevationInfo(){const{layer:t}=this.graphic,e=t&&\"elevationInfo\"in t?t.elevationInfo:null,o=b(this.graphic),i=e?e.offset:0;return new f({mode:o,offset:i})}set focusedSymbol(t){t!==this._get(\"focusedSymbol\")&&(this._set(\"focusedSymbol\",t),this._updateGraphicSymbol(),this._circleCollisionCache=null)}grabbableForEvent(){return!0}set grabbing(t){t!==this._get(\"grabbing\")&&(this._set(\"grabbing\",t),this._updateGraphicSymbol())}set hovering(t){t!==this._get(\"hovering\")&&(this._set(\"hovering\",t),this._updateGraphicSymbol())}set selected(t){t!==this._get(\"selected\")&&(this._set(\"selected\",t),this._updateGraphicSymbol(),this.events.emit(\"select-changed\",{action:t?\"select\":\"deselect\"}))}get _focused(){return this._get(\"hovering\")||this._get(\"grabbing\")}constructor(t){super(t),this.layer=null,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.dragging=!1,this.cursor=null,this.consumesClicks=!0,this.events=new o.EventEmitter,this._circleCollisionCache=null,this._graphicSymbolChangedHandle=null,this._originalSymbol=null}destroy(){this.detachSymbolChanged(),this._resetGraphicSymbol(),this._set(\"view\",null)}intersectionDistance(t){const e=this.graphic;if(!1===e.visible)return null;const o=e.geometry;if(null==o)return null;const i=this._get(\"focusedSymbol\"),s=null!=i?i:e.symbol;return\"2d\"===this.view.type?this._intersectDistance2D(this.view,t,o,s):this._intersectDistance3D(this.view,t,e)}attach(){this.attachSymbolChanged(),null!=this.layer&&this.layer.add(this.graphic)}detach(){this.detachSymbolChanged(),this._resetGraphicSymbol(),null!=this.layer&&this.layer.remove(this.graphic)}attachSymbolChanged(){this.detachSymbolChanged(),this._graphicSymbolChangedHandle=i((()=>this.graphic?.symbol),(t=>{null!=t&&t!==this.focusedSymbol&&t!==this._originalSymbol&&(this._originalSymbol=t,this._focused&&null!=this.focusedSymbol&&(this.graphic.symbol=this.focusedSymbol))}),s)}detachSymbolChanged(){null!=this._graphicSymbolChangedHandle&&(this._graphicSymbolChangedHandle.remove(),this._graphicSymbolChangedHandle=null)}onElevationChange(){}onViewChange(){}_updateGraphicSymbol(){this.graphic.symbol=this._focused&&null!=this.focusedSymbol?this.focusedSymbol:this._originalSymbol}_resetGraphicSymbol(){this.graphic.symbol=this._originalSymbol}_intersectDistance2D(t,e,o,i){if(null==(i=i||d(o)))return null;const s=1;let n=this._circleCollisionCache;if(\"point\"===o.type&&\"cim\"===i.type&&\"CIMPointSymbol\"===i.data.symbol?.type&&i.data.symbol.symbolLayers){const{offsetX:l,offsetY:n,size:a}=_(i),c=r(e,j),p=a/2,m=t.toScreen(o),u=m.x+l,y=m.y+n;return h(c,[u,y])<p*p?s:null}if(\"point\"!==o.type||\"simple-marker\"!==i.type)return v(e,o,t)?s:null;if(null==n||!n.originalPoint.equals(o)){const e=o,s=t.spatialReference;if(u(e.spatialReference,s)){const t=y(e,s);n={originalPoint:e.clone(),mapPoint:t,radiusPx:l(i.size)},this._circleCollisionCache=n}}if(null!=n){const o=r(e,j),a=t.toScreen?.(n.mapPoint);if(!a)return null;const c=n.radiusPx,p=a.x+l(i.xoffset),m=a.y-l(i.yoffset);return h(o,[p,m])<c*c?s:null}return null}_intersectDistance3D(t,e,o){const i=t.toMap(e,{include:[o]});return i&&g(i,C,t.renderSpatialReference)?p(C,t.state.camera.eye):null}};t([a({constructOnly:!0,nonNullable:!0})],S.prototype,\"graphic\",null),t([a()],S.prototype,\"elevationInfo\",null),t([a({constructOnly:!0,nonNullable:!0})],S.prototype,\"view\",void 0),t([a({value:null})],S.prototype,\"focusedSymbol\",null),t([a({constructOnly:!0})],S.prototype,\"layer\",void 0),t([a()],S.prototype,\"interactive\",void 0),t([a()],S.prototype,\"selectable\",void 0),t([a()],S.prototype,\"grabbable\",void 0),t([a({value:!1})],S.prototype,\"grabbing\",null),t([a()],S.prototype,\"dragging\",void 0),t([a()],S.prototype,\"hovering\",null),t([a({value:!1})],S.prototype,\"selected\",null),t([a()],S.prototype,\"cursor\",void 0),S=t([c(\"esri.views.interactive.GraphicManipulator\")],S);const C=m(),j=n();export{S as GraphicManipulator};\n"],
  "mappings": "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",
  "names": ["s", "a", "e", "o", "S", "e", "o", "i", "s", "n", "a", "c", "d", "u", "y", "t", "C"]
}
