{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/layers/TiledLayerView3D.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import{whenOnce as i}from\"../../../core/reactiveUtils.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as r}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerViewPerformanceInfo as l}from\"./support/LayerViewPerformanceInfo.js\";import{updatingProgress as s,updatingProgressValue as n}from\"../support/updatingProperties.js\";import{checkIfTileInfoSupportedForView as o}from\"../terrain/terrainUtils.js\";const c=c=>{let p=class extends c{get imageFormatIsOpaque(){return!1}get fullExtent(){return this.layer.fullExtent}get isOpaque(){return this.fullOpacity>=1&&this.imageFormatIsOpaque}get dataScaleRange(){const e=this.tileInfo.lods;let t=e[0].scale,i=e[e.length-1].scale;if(\"tilemapCache\"in this.layer&&this.layer.tilemapCache){const{effectiveMinLOD:e,effectiveMaxLOD:a}=this.layer.tilemapCache;t=this.tileInfo.lodAt(e).scale,i=this.tileInfo.lodAt(a).scale}return{minScale:t,maxScale:i}}get dataLevelRange(){const{minScale:e,maxScale:t}=this.dataScaleRange;return this.levelRangeFromScaleRange(e,t)}get displayLevelRange(){const e=this.layer.minScale||this.dataScaleRange.minScale,t=this.layer.maxScale||this.dataScaleRange.maxScale,i=this.levelRangeFromScaleRange(e,t);return this.layer.maxScale&&i.maxLevel++,i}get performanceInfo(){return new l(this.view.basemapTerrain.getUsedMemoryForLayerView(this))}getTileUrl(e,t,i){return this.layer.getTileUrl(e,t,i)}_addTilingSchemeMatchPromise(){if(null==this.fullExtent)return this.addResolvingPromise(Promise.reject(new t(\"tilingscheme:extent-not-defined\",\"This layer doesn't define a fullExtent.\")));const e=this._getTileInfoSupportError(this.tileInfo,this.fullExtent);if(e)return this.addResolvingPromise(Promise.reject(e));const a=i((()=>this.view?.basemapTerrain?.tilingSchemeLocked)).then((()=>{const e=this.view.basemapTerrain.tilingScheme,t=\"tilemapCache\"in this.layer?this.layer.tilemapCache?.effectiveMaxLOD:void 0,i=this._getTileInfoCompatibilityError(this.tileInfo,e,t);if(i)throw i}));this.addResolvingPromise(a)}_getTileInfoSupportError(e,i){const a=o(e,i,this.view.spatialReference,this.view.state.viewingMode,\"tilemapCache\"in this.layer?this.layer.tilemapCache?.effectiveMaxLOD:void 0);if(a){const e={layer:this.layer,error:a};let i;switch(a.name){case\"tilingscheme:spatial-reference-mismatch\":case\"tilingscheme:global-unsupported-spatial-reference\":case\"tilingscheme:local-unsupported-spatial-reference\":i=new t(\"layerview:spatial-reference-incompatible\",\"The spatial reference of this layer does not meet the requirements of the view\",e);break;default:i=new t(\"layerview:tiling-scheme-unsupported\",\"The tiling scheme of this layer is not supported by SceneView\",e)}return i}return null}_getTileInfoCompatibilityError(e,i,a){return null!=e&&i.compatibleWith(e,a)?null:new t(\"layerview:tiling-scheme-incompatible\",\"The tiling scheme of this layer is incompatible with the tiling scheme of the surface\")}levelRangeFromScaleRange(e,t){const i={minLevel:0,maxLevel:1/0},a=this.view&&this.view.basemapTerrain&&this.view.basemapTerrain.tilingScheme;if(!a)return i;const r=a.levels[0],l=e=>{const t=Math.log(r.scale/e)/Math.LN2;return.5-Math.abs(.5-t%1)<1e-9?Math.round(t):Math.ceil(t)};return null!=e&&e>0&&(i.minLevel=Math.max(0,l(e))),null!=t&&t>0&&(i.maxLevel=Math.max(0,l(t))),i}isUpdating(){return!!(this.view&&this.view.basemapTerrain&&this.view.basemapTerrain.updating)}};return e([a({readOnly:!0})],p.prototype,\"imageFormatIsOpaque\",null),e([a({readOnly:!0})],p.prototype,\"updating\",void 0),e([a(s)],p.prototype,\"updatingProgress\",void 0),e([a(n)],p.prototype,\"updatingProgressValue\",void 0),e([a()],p.prototype,\"fullExtent\",null),e([a({readOnly:!0})],p.prototype,\"isOpaque\",null),e([a()],p.prototype,\"dataScaleRange\",null),e([a({readOnly:!0})],p.prototype,\"dataLevelRange\",null),e([a({readOnly:!0})],p.prototype,\"displayLevelRange\",null),e([a()],p.prototype,\"layer\",void 0),p=e([r(\"esri.views.3d.layers.TiledLayerView3D\")],p),p};export{c as TiledLayerView3D};\n"],
  "mappings": "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",
  "names": ["c", "e", "t", "a", "i"]
}
