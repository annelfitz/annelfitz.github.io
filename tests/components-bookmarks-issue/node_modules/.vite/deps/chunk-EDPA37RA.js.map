{
  "version": 3,
  "sources": ["../../@arcgis/core/webdoc/support/resourceUtils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{allSettledErrors as t,throwIfAborted as r,eachAlways as o}from\"../../core/promiseUtils.js\";import{generateUUID as s}from\"../../core/uuid.js\";import{getSiblingOfSameTypeI as a,contentToBlob as c}from\"../../portal/support/resourceUtils.js\";async function p(e,t,r){const o=await u(e,t,r);await h(o,t,r)}async function n(e,t,r,o,s){const a=await u(r,o,s);await e.update({data:t}),await h(a,o,s)}async function u(o,p,n){if(!p?.resources)return;const u=p.portalItem===o.portalItem?new Set(o.paths):new Set;o.paths.length=0,o.portalItem=p.portalItem;const h=new Set(p.resources.toKeep.map((e=>e.resource.path))),i=new Set,m=[];h.forEach((e=>{u.delete(e),o.paths.push(e)}));const f=[],l=[],w=[];for(const e of p.resources.toUpdate)if(u.delete(e.resource.path),h.has(e.resource.path)||i.has(e.resource.path)){const{resource:t,content:r,finish:p}=e,n=a(t,s());o.paths.push(n.path),f.push({resource:n,content:await c(r),compress:e.compress}),p&&w.push((()=>p(n)))}else{o.paths.push(e.resource.path),l.push({resource:e.resource,content:await c(e.content),compress:e.compress});const t=e.finish;t&&w.push((()=>t(e.resource))),i.add(e.resource.path)}for(const e of p.resources.toAdd)if(o.paths.push(e.resource.path),u.has(e.resource.path))u.delete(e.resource.path);else{f.push({resource:e.resource,content:await c(e.content),compress:e.compress});const t=e.finish;t&&w.push((()=>t(e.resource)))}if(f.length||l.length){const{addOrUpdateResources:e}=await import(\"../../portal/support/resourceUtils.js\");await e(p.portalItem,f,\"add\",n),await e(p.portalItem,l,\"update\",n)}if(w.forEach((e=>e())),0===m.length)return u;const d=await t(m);if(r(n),d.length>0)throw new e(\"save:resources\",\"Failed to save one or more resources\",{errors:d});return u}async function h(e,t,r){if(!e||!t.portalItem)return;const s=[];for(const o of e){const e=t.portalItem.resourceFromPath(o);s.push(e.portalItem.removeResource(e,r))}await o(s)}export{p as saveResources,n as updateItemWithResources};\n"],
  "mappings": "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",
  "names": ["p", "n", "s", "u", "h", "m", "e"]
}
