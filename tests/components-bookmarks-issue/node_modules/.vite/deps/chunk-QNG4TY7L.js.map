{
  "version": 3,
  "sources": ["../../@arcgis/core/layers/support/FieldsIndex.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{isSerializable as i}from\"../../core/JSONSupport.js\";import t from\"../../core/Logger.js\";import{getOrCreateMapValue as s}from\"../../core/MapUtils.js\";import{UnknownTimeZone as n}from\"../../core/sql/UnknownTimeZone.js\";import{isDateField as r,isNumericField as l,isObjectIDField as o,isGlobalIDField as d,getFieldDefaultValue as a,isTimeOnlyField as m,normalizeFieldName as u}from\"./fieldUtils.js\";import{utc as f,unknown as F,fromTimeReference as h}from\"../../time/timeZoneUtils.js\";import{FixedOffsetZone as c,IANAZone as p}from\"luxon\";function y(e){return\"timeZone\"in e}function _(e){return\"timeZone\"in e}function g(e){return\"dateFieldsTimeZone\"in e}const T=new Map;class Z{static fromJSON(e){return new Z(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new Z(e.fields??[],S(e))}static fromLayerJSON(e){return new Z(e.fields??[],S(e))}constructor(e=[],i){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=i?new Map(i):null;const t=[];for(const s of this.fields){const e=s?.name,i=M(e);if(e&&i){const n=w(e);this._fieldsMap.set(e,s),this._fieldsMap.set(n,s),this._normalizedFieldsMap.set(i,s),t.push(`${n}:${s.type}:${this._timeZoneByFieldName?.get(e)}`),r(s)?(this.dateFields.push(s),this._dateFieldsSet.add(s)):l(s)&&(this._numericFieldsSet.add(s),this.numericFields.push(s)),o(s)||d(s)||(s.editable=null==s.editable||!!s.editable,s.nullable=null==s.nullable||!!s.nullable)}}t.sort(),this.uid=t.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)o(e)||d(e)||e.nullable||void 0!==a(e)||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===e?.uid}has(e){return null!=this.get(e)}get(e){if(!e)return;let i=this._fieldsMap.get(e);return i||(i=this._fieldsMap.get(w(e))??this._normalizedFieldsMap.get(M(e)),i&&this._fieldsMap.set(e,i),i)}getTimeZone(i){const s=this.get(i&&\"string\"!=typeof i?i.name:i);return s?this._timeZoneByFieldName?this._timeZoneByFieldName.get(s.name):\"date\"===s.type||\"esriFieldTypeDate\"===s.type?(t.getLogger(\"esri.layers.support.FieldsIndex\").error(new e(\"getTimeZone:no-timezone-information\",`no time zone information for field '${s.name}'`)),f):N.has(s.type)?F:null:null}getLuxonTimeZone(e){const i=this.getTimeZone(e);return i?i===F?n.instance:i===f?c.utcInstance:s(T,i,(()=>p.create(i))):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return m(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){return this.get(e)?.name??void 0}toJSON(){return{fields:this.fields.map((e=>i(e)?e.toJSON():e)),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function w(e){return e.trim().toLowerCase()}function M(e){return u(e)?.toLowerCase()??\"\"}const N=new Set([\"time-only\",\"date-only\",\"timestamp-offset\",\"esriFieldTypeDateOnly\",\"esriFieldTypeTimeOnly\",\"esriFieldTypeTimestampOffset\"]);function S(e){const i=new Map;if(!e.fields)return i;const t=!0===e.datesInUnknownTimezone,{timeInfo:s,editFieldsInfo:n}=e,r=(s?\"startField\"in s?s.startField:s.startTimeField:\"\")??\"\",l=(s?\"endField\"in s?s.endField:s.endTimeField:\"\")??\"\",o=g(e)?e.dateFieldsTimeZone??null:e.dateFieldsTimeReference?h(e.dateFieldsTimeReference):null,d=n?y(n)?n.timeZone??o:n.dateFieldsTimeReference?h(n.dateFieldsTimeReference):o??f:null,a=s?_(s)?s.timeZone??o:s.timeReference?h(s.timeReference):o:null,m=new Map([[w(n?.creationDateField??\"\"),d],[w(n?.editDateField??\"\"),d],[w(r),a],[w(l),a]]);for(const{name:u,type:f}of e.fields)if(N.has(f))i.set(u,F);else if(\"date\"!==f&&\"esriFieldTypeDate\"!==f)i.set(u,null);else if(t)i.set(u,F);else{const e=m.get(w(u??\"\"))??o;i.set(u,e)}return i}export{Z as default};\n"],
  "mappings": "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",
  "names": ["i", "t", "s", "e", "n", "r", "d", "a", "f"]
}
