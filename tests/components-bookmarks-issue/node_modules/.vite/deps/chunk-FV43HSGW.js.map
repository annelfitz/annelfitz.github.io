{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{translate as e}from\"../../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as s}from\"../../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{e as i,g as a,f as l,s as o}from\"../../../../../chunks/vec32.js\";import{ZEROS as c,create as r}from\"../../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{Float3DrawUniform as t}from\"../shaderModules/Float3DrawUniform.js\";import{Float3PassUniform as n}from\"../shaderModules/Float3PassUniform.js\";import{NoParameters as f,glsl as d}from\"../shaderModules/interfaces.js\";class u extends f{constructor(e){super(),this.slicePlaneLocalOrigin=e}}function _(e,s){m(e,s,new n(\"slicePlaneOrigin\",((e,i)=>H(s,e,i))),new n(\"slicePlaneBasis1\",((e,i)=>I(s,e,i,i.slicePlane?.basis1))),new n(\"slicePlaneBasis2\",((e,i)=>I(s,e,i,i.slicePlane?.basis2))))}function P(e,s){m(e,s,new t(\"slicePlaneOrigin\",((e,i)=>H(s,e,i))),new t(\"slicePlaneBasis1\",((e,i)=>I(s,e,i,i.slicePlane?.basis1))),new t(\"slicePlaneBasis2\",((e,i)=>I(s,e,i,i.slicePlane?.basis2))))}function m(e,s,...i){if(!s.hasSlicePlane){const i=d`#define rejectBySlice(_pos_) false\n#define discardBySlice(_pos_) {}\n#define highlightSlice(_color_, _pos_) (_color_)`;return s.hasSliceInVertexProgram&&e.vertex.code.add(i),void e.fragment.code.add(i)}s.hasSliceInVertexProgram&&e.vertex.uniforms.add(...i),e.fragment.uniforms.add(...i);const a=d`struct SliceFactors {\nfloat front;\nfloat side0;\nfloat side1;\nfloat side2;\nfloat side3;\n};\nSliceFactors calculateSliceFactors(vec3 pos) {\nvec3 rel = pos - slicePlaneOrigin;\nvec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);\nfloat slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);\nfloat basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);\nfloat basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);\nfloat basis1Dot = dot(slicePlaneBasis1, rel);\nfloat basis2Dot = dot(slicePlaneBasis2, rel);\nreturn SliceFactors(\ndot(slicePlaneNormal, pos) + slicePlaneW,\n-basis1Dot - basis1Len2,\nbasis1Dot - basis1Len2,\n-basis2Dot - basis2Len2,\nbasis2Dot - basis2Len2\n);\n}\nbool sliceByFactors(SliceFactors factors) {\nreturn factors.front < 0.0\n&& factors.side0 < 0.0\n&& factors.side1 < 0.0\n&& factors.side2 < 0.0\n&& factors.side3 < 0.0;\n}\nbool sliceEnabled() {\nreturn dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;\n}\nbool sliceByPlane(vec3 pos) {\nreturn sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));\n}\n#define rejectBySlice(_pos_) sliceByPlane(_pos_)\n#define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }`,l=d`vec4 applySliceHighlight(vec4 color, vec3 pos) {\nSliceFactors factors = calculateSliceFactors(pos);\nconst float HIGHLIGHT_WIDTH = 1.0;\nconst vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);\nfactors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\nfactors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\nfactors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\nfactors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\nfactors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\nif (sliceByFactors(factors)) {\nreturn color;\n}\nfloat highlightFactor = (1.0 - step(0.5, factors.front))\n* (1.0 - step(0.5, factors.side0))\n* (1.0 - step(0.5, factors.side1))\n* (1.0 - step(0.5, factors.side2))\n* (1.0 - step(0.5, factors.side3));\nreturn mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n}`,o=s.hasSliceHighlight?d`\n        ${l}\n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      `:d`#define highlightSlice(_color_, _pos_) (_color_)`;s.hasSliceInVertexProgram&&e.vertex.code.add(a),e.fragment.code.add(a),e.fragment.code.add(o)}function h(e,s,i){return e.instancedDoublePrecision?o(b,i.camera.viewInverseTransposeMatrix[3],i.camera.viewInverseTransposeMatrix[7],i.camera.viewInverseTransposeMatrix[11]):s.slicePlaneLocalOrigin}function p(e,s){return null!=e?l(v,s.origin,e):s.origin}function g(s,i,a){return s.hasSliceTranslatedView?null!=i?e(S,a.camera.viewMatrix,i):a.camera.viewMatrix:null}function H(e,s,a){if(null==a.slicePlane)return c;const l=h(e,s,a),o=p(l,a.slicePlane),r=g(e,l,a);return null!=r?i(v,o,r):o}function I(e,s,o,r){if(null==r||null==o.slicePlane)return c;const t=h(e,s,o),n=p(t,o.slicePlane),f=g(e,t,o);return null!=f?(a(B,r,n),i(v,n,f),i(B,B,f),l(B,B,v)):r}const b=r(),v=r(),B=r(),S=s();export{P as SliceDraw,_ as SlicePass,u as SlicePlaneParameters};\n"],
  "mappings": "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",
  "names": ["u", "n", "e", "i", "o", "l"]
}
