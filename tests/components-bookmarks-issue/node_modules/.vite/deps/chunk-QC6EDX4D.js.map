{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/environment/SimpleAtmosphereTechniqueConfiguration.js", "../../@arcgis/core/chunks/SimpleAtmosphere.glsl.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{parameter as n}from\"../webgl-engine/core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{DefaultTechniqueConfiguration as o}from\"../webgl-engine/materials/DefaultTechniqueConfiguration.js\";var r;!function(e){e[e.Cone=0]=\"Cone\",e[e.Cylinder=1]=\"Cylinder\",e[e.Underground=2]=\"Underground\",e[e.COUNT=3]=\"COUNT\"}(r||(r={}));class i extends o{constructor(){super(...arguments),this.geometry=r.Cone}}e([n({count:r.COUNT})],i.prototype,\"geometry\",void 0);export{r as SimpleAtmosphereGeometry,i as SimpleAtmosphereTechniqueConfiguration};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{create as e}from\"../core/libs/gl-matrix-2/factories/vec2f64.js\";import{create as o}from\"../core/libs/gl-matrix-2/factories/vec3f64.js\";import{SimpleAtmosphereGeometry as i}from\"../views/3d/environment/SimpleAtmosphereTechniqueConfiguration.js\";import{Transform as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{addMainLightDirection as t}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MainLighting.glsl.js\";import{Float2PassUniform as n}from\"../views/3d/webgl-engine/core/shaderModules/Float2PassUniform.js\";import{Float3PassUniform as s}from\"../views/3d/webgl-engine/core/shaderModules/Float3PassUniform.js\";import{FloatPassUniform as a}from\"../views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js\";import{NoParameters as l,glsl as d}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{Matrix4PassUniform as c}from\"../views/3d/webgl-engine/core/shaderModules/Matrix4PassUniform.js\";import{ShaderBuilder as m}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{Texture2DPassUniform as f}from\"../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js\";import{VertexAttribute as g}from\"../views/3d/webgl-engine/lib/VertexAttribute.js\";class p extends l{constructor(){super(...arguments),this.texV=e(),this.altitudeFade=0,this.innerScale=0,this.undergroundFadeAlpha=0,this.silhouette=new u}}class u{constructor(){this.center=o(),this.v1=o(),this.v2=o()}}function v(e){const o=new m,{vertex:l,fragment:p}=o;if(t(l),e.geometry===i.Underground)o.attributes.add(g.POSITION,\"vec2\"),o.varyings.add(\"color\",\"vec4\"),l.uniforms.add(new s(\"cameraPosition\",((e,o)=>o.camera.eye)),new a(\"undergroundFadeAlpha\",(e=>e.undergroundFadeAlpha))),l.code.add(d`void main(void) {\nfloat ndotl = dot(normalize(cameraPosition), mainLightDirection);\nfloat lighting = max(0.0, smoothstep(-1.0, 0.8, 2.0 * ndotl));\ncolor = vec4(vec3(lighting), undergroundFadeAlpha);\ngl_Position = vec4(position.xy, 1.0, 1.0);\n}`),p.code.add(d`void main() {\nfragColor = color;\n}`);else{o.include(r,e),o.attributes.add(g.POSITION,\"vec3\"),o.varyings.add(\"vtc\",\"vec2\"),o.varyings.add(\"falloff\",\"float\");const t=e.geometry===i.Cylinder;l.uniforms.add(new c(\"proj\",((e,o)=>o.camera.projectionMatrix)),new c(\"view\",((e,o)=>o.camera.viewMatrix))),t||(o.varyings.add(\"innerFactor\",\"float\"),l.uniforms.add(new s(\"silCircleCenter\",(e=>e.silhouette.center))),l.uniforms.add(new s(\"silCircleV1\",(e=>e.silhouette.v1))),l.uniforms.add(new s(\"silCircleV2\",(e=>e.silhouette.v2))),l.uniforms.add(new n(\"texV\",(e=>e.texV))),l.uniforms.add(new a(\"innerScale\",(e=>e.innerScale))));const m=6.2831853,u=1/128;l.code.add(d`\n\t\tvoid main(void) {\n      ${t?d`\n      vec3 pos = position;\n      float ndotl = mainLightDirection.z;\n      vtc = vec2(0.0, position.z + 0.05);`:d`\n      innerFactor = clamp(-position.z, 0.0, 1.0);\n      float scale = position.y * (1.0 + innerFactor * innerScale);\n      float phi = position.x * ${d.float(m*u)} + 1.0;\n      vec3 pos =  (silCircleCenter + sin(phi) * silCircleV1 + cos(phi) * silCircleV2) * scale;\n      float ndotl = dot(normalize(position.y > 0.0 ? pos: silCircleCenter), mainLightDirection);\n      vtc.x = position.x  * ${d.float(u)};\n      vtc.y = texV.x * (1.0 - position.z) + texV.y * position.z;\n      `}\n      falloff = max(0.0, smoothstep(-1.0, 0.8, 2.0 * ndotl));\n\n\t\t  gl_Position = transformPosition(proj, view, pos);\n\t\t  gl_Position.z = gl_Position.w; // project atmosphere onto the far plane\n    }\n\t  `),p.uniforms.add(new f(\"tex\",(e=>e.texture))),t||p.uniforms.add(new a(\"altitudeFade\",(e=>e.altitudeFade))),p.code.add(d`\n\t\tvoid main() {\n\t\t\tvec4 atmosphereColor = texture(tex, vtc) * falloff;\n      ${t?d`fragColor = atmosphereColor;`:d`\n\t\t\tvec4 innerColor = vec4(atmosphereColor.rgb, 1.0 - altitudeFade);\n\t\t\tfragColor = mix(atmosphereColor, innerColor, smoothstep(0.0, 1.0, innerFactor));\n      `}\n    }`)}return o}const h=Object.freeze(Object.defineProperty({__proto__:null,SilhouetteCircle:u,SimpleAtmospherePassParameters:p,build:v},Symbol.toStringTag,{value:\"Module\"}));export{p as S,h as a,u as b,v as c};\n"],
  "mappings": "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",
  "names": ["r", "e", "t", "n", "e", "o", "p", "r", "t", "u"]
}
