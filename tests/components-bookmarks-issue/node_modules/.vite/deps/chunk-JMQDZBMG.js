import {
  a as a2
} from "./chunk-5N5NXKL3.js";
import {
  e as e3
} from "./chunk-7RP2CUPD.js";
import {
  F
} from "./chunk-UVHAFHZU.js";
import {
  e as e6,
  t
} from "./chunk-4ZRUV2JM.js";
import {
  x as x3
} from "./chunk-2IUCAJMQ.js";
import {
  e as e5
} from "./chunk-HLKM6YBE.js";
import {
  e as e7
} from "./chunk-7KPPNEIJ.js";
import {
  I as I2,
  y as y2
} from "./chunk-F4RCQNKU.js";
import {
  A as A2,
  D as D2,
  E,
  J,
  L,
  M,
  P as P2,
  R,
  Y,
  ae,
  be,
  ce,
  de,
  he,
  ie,
  ne,
  oe,
  re,
  se,
  ue,
  v as v4,
  x as x2,
  z
} from "./chunk-KDAM4HTO.js";
import {
  e as e4
} from "./chunk-EAAEPSBY.js";
import {
  s as s6
} from "./chunk-ZOUC7PLM.js";
import {
  We
} from "./chunk-EWD7I5UU.js";
import {
  b as b2,
  m
} from "./chunk-W5ALAOW2.js";
import {
  d as d2
} from "./chunk-AKQ765JR.js";
import {
  f
} from "./chunk-QYC3GV65.js";
import {
  I,
  c,
  c2,
  i2 as i,
  i3 as i2,
  i5 as i3,
  m2
} from "./chunk-ETHGDNE6.js";
import {
  s as s5
} from "./chunk-QX66UTIR.js";
import {
  pe
} from "./chunk-X7VSXJWW.js";
import {
  r as r2
} from "./chunk-CXNX736Z.js";
import {
  D,
  e2,
  r
} from "./chunk-RGCWZ2KZ.js";
import {
  n as n2
} from "./chunk-5VMSFOCB.js";
import {
  v as v3
} from "./chunk-2SDMYJDE.js";
import {
  s as s4
} from "./chunk-C62RZQQX.js";
import {
  o
} from "./chunk-QLL2YG25.js";
import {
  x2 as x
} from "./chunk-M5ZB5S5C.js";
import {
  s as s3
} from "./chunk-IOB3DJMR.js";
import {
  U
} from "./chunk-SAYWXQVM.js";
import {
  P,
  d,
  v as v2
} from "./chunk-Z4Y53NDM.js";
import {
  S,
  y2 as y
} from "./chunk-NDIXNREV.js";
import {
  a3 as a
} from "./chunk-I2RC5KWA.js";
import {
  e
} from "./chunk-2F6FFF5T.js";
import {
  A,
  b,
  h,
  v
} from "./chunk-JGDJR5EV.js";
import {
  u
} from "./chunk-QHK5ZYFW.js";
import {
  n2 as n,
  s as s2
} from "./chunk-7RBRCL6S.js";
import {
  k,
  s
} from "./chunk-J2EGIWT6.js";

// node_modules/@arcgis/core/widgets/Feature/FeatureAttachments/FeatureAttachmentsViewModel.js
var s7 = class extends y2 {
  constructor(t3) {
    super(t3), this.description = null, this.title = null;
  }
};
e([y()], s7.prototype, "description", void 0), e([y()], s7.prototype, "title", void 0), s7 = e([a("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")], s7);
var c3 = s7;

// node_modules/@arcgis/core/widgets/Feature/support/FeatureElementInfo.js
var p = "esri-feature-element-info";
var n3 = { base: p, title: `${p}__title`, description: `${p}__description` };
var c4 = class extends D {
  constructor(e10, t3) {
    super(e10, t3), this.description = null, this.headingLevel = 2, this.title = null;
  }
  render() {
    return n2("div", { class: n3.base }, this._renderTitle(), this._renderDescription());
  }
  _renderTitle() {
    const { title: e10 } = this;
    return e10 ? n2(e5, { class: n3.title, level: this.headingLevel }, e10) : null;
  }
  _renderDescription() {
    const { description: e10 } = this;
    return e10 ? n2("div", { class: n3.description, key: "description" }, e10) : null;
  }
};
e([y()], c4.prototype, "description", void 0), e([y()], c4.prototype, "headingLevel", void 0), e([y()], c4.prototype, "title", void 0), c4 = e([a("esri.widgets.Feature.support.FeatureElementInfo")], c4);
var l = c4;

// node_modules/@arcgis/core/widgets/Feature/FeatureAttachments.js
var d3 = { base: "esri-feature-attachments" };
var h2 = class extends D {
  constructor(e10, t3) {
    super(e10, t3), this._featureElementInfo = null, this.attachmentsWidget = new I2(), this.headingLevel = 2, this.viewModel = new c3();
  }
  initialize() {
    this._featureElementInfo = new l(), this.addHandles([d(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.description, (_b = this.viewModel) == null ? void 0 : _b.title, this.headingLevel];
    }, () => this._setupFeatureElementInfo(), P), d(() => this.viewModel, (e10) => this.attachmentsWidget.viewModel = e10, P)]);
  }
  destroy() {
    var _a;
    this.attachmentsWidget.viewModel = null, this.attachmentsWidget.destroy(), (_a = this._featureElementInfo) == null ? void 0 : _a.destroy();
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e10) {
    this.viewModel.description = e10;
  }
  get displayType() {
    return this.attachmentsWidget.displayType;
  }
  set displayType(e10) {
    this.attachmentsWidget.displayType = e10;
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(e10) {
    this.viewModel.graphic = e10;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e10) {
    this.viewModel.title = e10;
  }
  render() {
    var _a;
    const { attachmentsWidget: e10 } = this;
    return n2("div", { class: d3.base }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), e10 == null ? void 0 : e10.render());
  }
  _setupFeatureElementInfo() {
    var _a;
    const { description: e10, title: t3, headingLevel: i4 } = this;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: e10, title: t3, headingLevel: i4 });
  }
};
e([y({ readOnly: true })], h2.prototype, "attachmentsWidget", void 0), e([y()], h2.prototype, "description", null), e([y()], h2.prototype, "displayType", null), e([y()], h2.prototype, "graphic", null), e([y()], h2.prototype, "headingLevel", void 0), e([y()], h2.prototype, "title", null), e([y({ type: c3 })], h2.prototype, "viewModel", void 0), h2 = e([a("esri.widgets.Feature.FeatureAttachments")], h2);
var c5 = h2;

// node_modules/@arcgis/core/widgets/Feature/FeatureContent/FeatureContentViewModel.js
var c6 = class extends S {
  constructor(t3) {
    super(t3), this._loadingPromise = null, this.created = null, this.creator = null, this.destroyer = null, this.graphic = null, this.addHandles(d(() => this.creator, (t4) => {
      this._destroyContent(), this._createContent(t4);
    }, P));
  }
  destroy() {
    this._destroyContent();
  }
  get state() {
    return this._loadingPromise ? "loading" : "ready";
  }
  _destroyContent() {
    const { created: t3, graphic: e10, destroyer: r3 } = this;
    t3 && e10 && (v4({ type: "content", value: r3, event: { graphic: e10 } }), this._set("created", null));
  }
  async _createContent(t3) {
    const e10 = this.graphic;
    if (!e10 || !t3)
      return;
    const r3 = v4({ type: "content", value: t3, event: { graphic: e10 } });
    this._loadingPromise = r3, this.notifyChange("state");
    const o2 = await r3;
    r3 === this._loadingPromise && (this._loadingPromise = null, this.notifyChange("state"), this._set("created", o2));
  }
};
e([y({ readOnly: true })], c6.prototype, "created", void 0), e([y()], c6.prototype, "creator", void 0), e([y()], c6.prototype, "destroyer", void 0), e([y({ type: f })], c6.prototype, "graphic", void 0), e([y({ readOnly: true })], c6.prototype, "state", null), c6 = e([a("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")], c6);
var p2 = c6;

// node_modules/@arcgis/core/widgets/Feature/FeatureContent.js
var n4 = "esri-feature-content";
var c7 = { base: n4, loaderContainer: `${n4}__loader-container`, loader: `${n4}__loader` };
var l2 = class extends D {
  constructor(e10, r3) {
    super(e10, r3), this.viewModel = null, this._addTargetToAnchors = (e11) => {
      Array.from(e11.querySelectorAll("a")).forEach((e12) => {
        x2(e12.href) && !e12.hasAttribute("target") && e12.setAttribute("target", "_blank");
      });
    };
  }
  get creator() {
    var _a;
    return (_a = this.viewModel) == null ? void 0 : _a.creator;
  }
  set creator(e10) {
    this.viewModel && (this.viewModel.creator = e10);
  }
  get graphic() {
    var _a;
    return (_a = this.viewModel) == null ? void 0 : _a.graphic;
  }
  set graphic(e10) {
    this.viewModel && (this.viewModel.graphic = e10);
  }
  render() {
    var _a;
    const e10 = (_a = this.viewModel) == null ? void 0 : _a.state;
    return n2("div", { class: c7.base }, "loading" === e10 ? this._renderLoading() : this._renderCreated());
  }
  _renderLoading() {
    return n2("div", { class: c7.loaderContainer, key: "loader" }, n2("div", { class: c7.loader }));
  }
  _renderCreated() {
    var _a;
    const e10 = (_a = this.viewModel) == null ? void 0 : _a.created;
    return e10 ? e10 instanceof HTMLElement ? n2("div", { afterCreate: this._attachToNode, bind: e10, key: e10 }) : e6(e10) ? n2("div", { key: e10 }, !e10.destroyed && e10.render()) : n2("div", { afterCreate: this._addTargetToAnchors, innerHTML: e10, key: e10 }) : null;
  }
  _attachToNode(e10) {
    const r3 = this;
    e10.appendChild(r3);
  }
};
e([y()], l2.prototype, "creator", null), e([y()], l2.prototype, "graphic", null), e([y({ type: p2 })], l2.prototype, "viewModel", void 0), l2 = e([a("esri.widgets.Feature.FeatureContent")], l2);
var p3 = l2;

// node_modules/@arcgis/core/widgets/Feature/FeatureFields/FeatureFieldsViewModel.js
var l3 = class extends S {
  constructor(o2) {
    super(o2), this.attributes = null, this.expressionInfos = null, this.description = null, this.fieldInfos = null, this.title = null;
  }
  get formattedFieldInfos() {
    const { expressionInfos: o2, fieldInfos: e10 } = this, t3 = [];
    return e10 == null ? void 0 : e10.forEach((e11) => {
      if (!(!e11.hasOwnProperty("visible") || e11.visible))
        return;
      const s9 = e11.clone();
      s9.label = M(s9, o2), t3.push(s9);
    }), t3;
  }
};
e([y()], l3.prototype, "attributes", void 0), e([y({ type: [i3] })], l3.prototype, "expressionInfos", void 0), e([y()], l3.prototype, "description", void 0), e([y({ type: [m2] })], l3.prototype, "fieldInfos", void 0), e([y({ readOnly: true })], l3.prototype, "formattedFieldInfos", null), e([y()], l3.prototype, "title", void 0), l3 = e([a("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")], l3);
var n5 = l3;

// node_modules/@arcgis/core/widgets/Feature/FeatureFields.js
var u2 = "esri-feature-fields";
var m3 = { base: u2, fieldHeader: `${u2}__field-header`, fieldData: `${u2}__field-data`, fieldDataDate: `${u2}__field-data--date` };
var c8 = class extends D {
  constructor(e10, t3) {
    super(e10, t3), this._featureElementInfo = null, this.viewModel = new n5(), this.messages = null, this.messagesURIUtils = null;
  }
  initialize() {
    this._featureElementInfo = new l(), this.addHandles(d(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.description, (_b = this.viewModel) == null ? void 0 : _b.title];
    }, () => this._setupFeatureElementInfo(), P));
  }
  destroy() {
    var _a;
    (_a = this._featureElementInfo) == null ? void 0 : _a.destroy();
  }
  get attributes() {
    return this.viewModel.attributes;
  }
  set attributes(e10) {
    this.viewModel.attributes = e10;
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e10) {
    this.viewModel.description = e10;
  }
  get expressionInfos() {
    return this.viewModel.expressionInfos;
  }
  set expressionInfos(e10) {
    this.viewModel.expressionInfos = e10;
  }
  get fieldInfos() {
    return this.viewModel.fieldInfos;
  }
  set fieldInfos(e10) {
    this.viewModel.fieldInfos = e10;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e10) {
    this.viewModel.title = e10;
  }
  render() {
    var _a;
    return n2("div", { class: m3.base }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), this._renderFields());
  }
  _renderFieldInfo(e10, t3) {
    const { attributes: s9 } = this.viewModel, i4 = e10.fieldName, r3 = e10.label || i4, o2 = s9 ? null == s9[i4] ? "" : s9[i4] : "", l5 = !(!e10.format || !e10.format.dateFormat), n8 = "number" == typeof o2 && !l5 ? this._forceLTR(o2) : a2(this.messagesURIUtils, o2), d6 = { [m3.fieldDataDate]: l5 };
    return n2("tr", { key: `fields-element-info-row-${i4}-${t3}` }, n2("th", { class: m3.fieldHeader, innerHTML: r3, key: `fields-element-info-row-header-${i4}-${t3}` }), n2("td", { class: this.classes(m3.fieldData, d6), innerHTML: n8, key: `fields-element-info-row-data-${i4}-${t3}` }));
  }
  _renderFields() {
    const { formattedFieldInfos: e10 } = this.viewModel;
    return (e10 == null ? void 0 : e10.length) ? n2("table", { class: e4.table, summary: this.messages.fieldsSummary }, n2("tbody", null, e10.map((e11, t3) => this._renderFieldInfo(e11, t3)))) : null;
  }
  _setupFeatureElementInfo() {
    var _a;
    const { description: e10, title: t3 } = this;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: e10, title: t3 });
  }
  _forceLTR(e10) {
    return `&lrm;${e10}`;
  }
};
e([y()], c8.prototype, "attributes", null), e([y()], c8.prototype, "description", null), e([y()], c8.prototype, "expressionInfos", null), e([y()], c8.prototype, "fieldInfos", null), e([y()], c8.prototype, "title", null), e([y({ type: n5, nonNullable: true })], c8.prototype, "viewModel", void 0), e([y(), e2("esri/widgets/Feature/t9n/Feature")], c8.prototype, "messages", void 0), e([y(), e2("esri/widgets/support/t9n/uriUtils")], c8.prototype, "messagesURIUtils", void 0), c8 = e([a("esri.widgets.Feature.FeatureFields")], c8);
var h3 = c8;

// node_modules/@arcgis/core/widgets/Feature/support/relatedFeatureUtils.js
var f2 = "esri.widgets.Feature.support.relatedFeatureUtils";
var m4 = () => n.getLogger(f2);
var d4 = /* @__PURE__ */ new Map();
function y3(e10) {
  if (!de(e10))
    return null;
  const [t3, r3] = e10.split("/").slice(1);
  return { layerId: t3, fieldName: r3 };
}
function j(e10, t3) {
  if (!t3.relationships)
    return null;
  let r3 = null;
  const { relationships: o2 } = t3;
  return o2.some((t4) => t4.id === parseInt(e10, 10) && (r3 = t4, true)), r3;
}
function g({ originRelationship: e10, relationships: t3, layerId: r3 }) {
  return t3.find(({ relatedTableId: t4, id: o2 }) => `${t4}` === r3 && o2 === (e10 == null ? void 0 : e10.id)) ?? null;
}
function h4(e10, t3) {
  const r3 = t3.toLowerCase();
  for (const o2 in e10)
    if (o2.toLowerCase() === r3)
      return e10[o2];
  return null;
}
function F2(e10, t3) {
  const r3 = j(e10, t3);
  if (!r3)
    return;
  return { url: `${t3.url}/${r3.relatedTableId}`, sourceSpatialReference: t3.spatialReference, relation: r3, relatedFields: [], outStatistics: [] };
}
function I3(e10, t3) {
  if (!t3)
    return;
  if (!e10)
    return;
  const { features: r3, statsFeatures: o2 } = e10, i4 = r3 == null ? void 0 : r3.value;
  t3.relatedFeatures = i4 ? i4.features : [];
  const s9 = o2 == null ? void 0 : o2.value;
  t3.relatedStatsFeatures = s9 ? s9.features : [];
}
function S2(e10, t3, r3, o2) {
  var _a;
  const i4 = new d2();
  return i4.outFields = ["*"], i4.relationshipId = "number" == typeof t3.id ? t3.id : parseInt(t3.id, 10), i4.objectIds = [e10.attributes[r3.objectIdField]], ((_a = r3.queryRelatedFeatures) == null ? void 0 : _a.call(r3, i4, o2)) ?? Promise.resolve({});
}
function w(e10, t3, r3) {
  let o2 = 0;
  const i4 = [];
  for (; o2 < t3.length; )
    i4.push(`${e10} IN (${t3.slice(o2, r3 + o2)})`), o2 += r3;
  return i4.join(" OR ");
}
function b3(e10) {
  return e10 ? s(e10) : void 0;
}
function R2(e10) {
  return e10 ? s(e10, (e11, t3) => JSON.stringify(e11.toJSON()) === JSON.stringify(t3.toJSON())) : void 0;
}
async function U2(e10, t3, r3, o2) {
  const i4 = r3.layerId.toString(), { layerInfo: u5, relation: p5, relatedFields: c10, outStatistics: f5, url: m7, sourceSpatialReference: d6 } = t3, y7 = b3(c10), j4 = R2(f5);
  if (!u5 || !p5)
    return null;
  const F5 = g({ originRelationship: p5, relationships: u5.relationships, layerId: i4 });
  if ((F5 == null ? void 0 : F5.relationshipTableId) && F5.keyFieldInRelationshipTable) {
    const t4 = (await S2(e10, F5, r3, o2))[e10.attributes[r3.objectIdField]];
    if (!t4)
      return null;
    const i5 = t4.features.map((e11) => e11.attributes[u5.objectIdField]);
    if ((j4 == null ? void 0 : j4.length) && u5.supportsStatistics) {
      const e11 = new b2();
      e11.where = w(u5.objectIdField, i5, 1e3), e11.outFields = y7, e11.outStatistics = j4, e11.sourceSpatialReference = d6;
      const r4 = { features: Promise.resolve(t4), statsFeatures: s6(m7, e11) };
      return v(r4);
    }
  }
  const I7 = F5 == null ? void 0 : F5.keyField;
  if (I7) {
    const t4 = pe(v5(u5.fields, I7)), r4 = h4(e10.attributes, p5.keyField), i5 = t4 ? `${I7}=${r4}` : `${I7}='${r4}'`, c11 = s6(m7, new b2({ where: i5, outFields: y7, sourceSpatialReference: d6 }), o2), f6 = !!(j4 == null ? void 0 : j4.length) && u5.supportsStatistics ? s6(m7, new b2({ where: i5, outFields: y7, outStatistics: j4, sourceSpatialReference: d6 }), o2) : null, g5 = { features: c11 };
    return f6 && (g5.statsFeatures = f6), v(g5);
  }
  return null;
}
function $(t3, r3) {
  return U(t3, { query: { f: "json" }, signal: r3 == null ? void 0 : r3.signal });
}
function N({ relatedInfos: e10, layer: t3 }, o2) {
  const n8 = {};
  return e10.forEach((e11, o3) => {
    const { relation: i4 } = e11;
    if (!i4) {
      const e12 = new s2("relation-required", "A relation is required on a layer to retrieve related records.");
      throw m4().error(e12), e12;
    }
    const { relatedTableId: s9 } = i4;
    if ("number" != typeof s9) {
      const e12 = new s2("A related table ID is required on a layer to retrieve related records.");
      throw m4().error(e12), e12;
    }
    const l5 = `${t3.url}/${s9}`, a3 = d4.get(l5), u5 = a3 ?? $(l5);
    a3 || d4.set(l5, u5), n8[o3] = u5;
  }), h(v(n8), o2);
}
function T({ graphic: e10, relatedInfos: t3, layer: r3 }, o2) {
  const i4 = {};
  return t3.forEach((t4, s9) => {
    t4.layerInfo && (i4[s9] = U2(e10, t4, r3, o2));
  }), v(i4);
}
function q({ relatedInfo: e10, fieldName: t3, fieldInfo: r3 }) {
  var _a, _b;
  if ((_a = e10.relatedFields) == null ? void 0 : _a.push(t3), r3.statisticType) {
    const o2 = new m({ statisticType: r3.statisticType, onStatisticField: t3, outStatisticFieldName: t3 });
    (_b = e10.outStatistics) == null ? void 0 : _b.push(o2);
  }
}
function v5(e10, t3) {
  if (null != e10) {
    t3 = t3.toLowerCase();
    for (const r3 of e10)
      if (r3 && r3.name.toLowerCase() === t3)
        return r3;
  }
  return null;
}

// node_modules/@arcgis/core/widgets/Feature/FeatureMedia/FeatureMediaViewModel.js
var I4 = { chartAnimation: true };
var v6 = class extends S {
  constructor(t3) {
    super(t3), this.abilities = { ...I4 }, this.activeMediaInfoIndex = 0, this.attributes = null, this.description = null, this.fieldInfoMap = null, this.formattedAttributes = null, this.expressionAttributes = null, this.isAggregate = false, this.layer = null, this.mediaInfos = null, this.popupTemplate = null, this.relatedInfos = null, this.title = null;
  }
  castAbilities(t3) {
    return { ...I4, ...t3 };
  }
  get activeMediaInfo() {
    return this.formattedMediaInfos[this.activeMediaInfoIndex] || null;
  }
  get formattedMediaInfos() {
    return this._formatMediaInfos() || [];
  }
  get formattedMediaInfoCount() {
    return this.formattedMediaInfos.length;
  }
  setActiveMedia(t3) {
    this._setContentElementMedia(t3);
  }
  next() {
    this._pageContentElementMedia(1);
  }
  previous() {
    this._pageContentElementMedia(-1);
  }
  _setContentElementMedia(t3) {
    const { formattedMediaInfoCount: e10 } = this, o2 = (t3 + e10) % e10;
    this.activeMediaInfoIndex = o2;
  }
  _pageContentElementMedia(t3) {
    const { activeMediaInfoIndex: e10 } = this, o2 = e10 + t3;
    this._setContentElementMedia(o2);
  }
  _formatMediaInfos() {
    const { mediaInfos: t3, layer: e10 } = this, i4 = this.attributes ?? {}, r3 = this.formattedAttributes ?? {}, a3 = this.expressionAttributes ?? {}, s9 = this.fieldInfoMap ?? /* @__PURE__ */ new Map();
    return (t3 == null ? void 0 : t3.map((t4) => {
      const o2 = t4 == null ? void 0 : t4.clone();
      if (!o2)
        return null;
      if (o2.title = D2({ attributes: i4, fieldInfoMap: s9, globalAttributes: r3, expressionAttributes: a3, layer: e10, text: o2.title }), o2.caption = D2({ attributes: i4, fieldInfoMap: s9, globalAttributes: r3, expressionAttributes: a3, layer: e10, text: o2.caption }), o2.altText = D2({ attributes: i4, fieldInfoMap: s9, globalAttributes: r3, expressionAttributes: a3, layer: e10, text: o2.altText }), "image" === o2.type) {
        const { value: t5 } = o2;
        return this._setImageValue({ value: t5, formattedAttributes: r3, layer: e10 }), o2.value.sourceURL ? o2 : void 0;
      }
      if ("pie-chart" === o2.type || "line-chart" === o2.type || "column-chart" === o2.type || "bar-chart" === o2.type) {
        const { value: t5 } = o2;
        return this._setChartValue({ value: t5, chartType: o2.type, attributes: i4, formattedAttributes: r3, layer: e10, expressionAttributes: a3 }), o2;
      }
      return null;
    }).filter(k)) ?? [];
  }
  _setImageValue(t3) {
    const e10 = this.fieldInfoMap ?? /* @__PURE__ */ new Map(), { value: o2, formattedAttributes: i4, layer: r3 } = t3, { linkURL: a3, sourceURL: s9 } = o2;
    if (s9) {
      const t4 = P2(s9, r3);
      o2.sourceURL = z({ formattedAttributes: i4, template: t4, fieldInfoMap: e10 });
    }
    if (a3) {
      const t4 = P2(a3, r3);
      o2.linkURL = z({ formattedAttributes: i4, template: t4, fieldInfoMap: e10 });
    }
  }
  _setChartValue(t3) {
    const { value: e10, attributes: o2, formattedAttributes: i4, chartType: r3, layer: a3, expressionAttributes: s9 } = t3, { popupTemplate: l5, relatedInfos: n8 } = this, { fields: p5, normalizeField: d6 } = e10, m7 = a3;
    e10.fields = R(p5, m7), d6 && (e10.normalizeField = L(d6, m7));
    if (!p5.some((t4) => !!(null != i4[t4] || de(t4) && (n8 == null ? void 0 : n8.size))))
      return;
    const h6 = (l5 == null ? void 0 : l5.fieldInfos) ?? [];
    p5.forEach((t4, a4) => {
      var _a;
      const l6 = (_a = e10.colors) == null ? void 0 : _a[a4];
      if (de(t4))
        return void (e10.series = [...e10.series, ...this._getRelatedChartInfos({ fieldInfos: h6, fieldName: t4, formattedAttributes: i4, chartType: r3, value: e10, color: l6 })]);
      const n9 = this._getChartOption({ value: e10, attributes: o2, chartType: r3, formattedAttributes: i4, expressionAttributes: s9, fieldName: t4, fieldInfos: h6, color: l6 });
      e10.series.push(n9);
    });
  }
  _getRelatedChartInfos(t3) {
    var _a;
    const { fieldInfos: e10, fieldName: o2, formattedAttributes: i4, chartType: r3, value: a3, color: s9 } = t3, l5 = [], n8 = y3(o2), p5 = n8 && ((_a = this.relatedInfos) == null ? void 0 : _a.get(n8.layerId.toString()));
    if (!p5)
      return l5;
    const { relatedFeatures: d6, relation: u5 } = p5;
    if (!u5 || !d6)
      return l5;
    const { cardinality: f5 } = u5;
    d6.forEach((t4) => {
      const { attributes: p6 } = t4;
      p6 && Object.keys(p6).forEach((t5) => {
        t5 === n8.fieldName && l5.push(this._getChartOption({ value: a3, attributes: p6, formattedAttributes: i4, fieldName: o2, chartType: r3, relatedFieldName: t5, hasMultipleRelatedFeatures: (d6 == null ? void 0 : d6.length) > 1, fieldInfos: e10, color: s9 }));
      });
    });
    return "one-to-many" === f5 || "many-to-many" === f5 ? l5 : [l5[0]];
  }
  _getTooltip({ label: t3, value: e10, chartType: o2 }) {
    return "pie-chart" === o2 ? `${t3}` : `${t3}: ${e10}`;
  }
  _getChartOption(t3) {
    var _a;
    const { value: e10, attributes: o2, formattedAttributes: i4, expressionAttributes: r3, fieldName: a3, relatedFieldName: n8, fieldInfos: p5, chartType: d6, hasMultipleRelatedFeatures: u5, color: I7 } = t3, v8 = this.layer, M4 = this.fieldInfoMap ?? /* @__PURE__ */ new Map(), { normalizeField: A4, tooltipField: g5 } = e10, x5 = A4 ? de(A4) ? o2[y3(A4).fieldName] : o2[A4] : null, _ = A2(a3) && r3 && void 0 !== r3[a3] ? r3[a3] : n8 && void 0 !== o2[n8] ? o2[n8] : void 0 !== o2[a3] ? o2[a3] : i4[a3], C4 = new i2({ fieldName: a3, color: I7, value: void 0 === _ ? null : _ && x5 ? _ / x5 : _ });
    if (de(a3)) {
      const t4 = M4.get(a3.toLowerCase()), e11 = g5 && M4.get(g5.toLowerCase()), r4 = (t4 == null ? void 0 : t4.fieldName) ?? a3, s9 = u5 && g5 ? y3(g5).fieldName : (e11 == null ? void 0 : e11.fieldName) ?? g5, l5 = u5 && s9 ? o2[s9] : i4[s9] ?? (t4 == null ? void 0 : t4.label) ?? (t4 == null ? void 0 : t4.fieldName) ?? n8, p6 = u5 && n8 ? o2[n8] : i4[r4];
      return C4.tooltip = this._getTooltip({ label: l5, value: p6, chartType: d6 }), C4;
    }
    const T3 = Y(p5, a3), N2 = L(a3, v8), F5 = g5 && void 0 !== i4[g5] ? i4[g5] : M(T3 || new m2({ fieldName: N2 }), (_a = this.popupTemplate) == null ? void 0 : _a.expressionInfos), j4 = i4[N2];
    return C4.tooltip = this._getTooltip({ label: F5, value: j4, chartType: d6 }), C4;
  }
};
e([y()], v6.prototype, "abilities", void 0), e([s3("abilities")], v6.prototype, "castAbilities", null), e([y()], v6.prototype, "activeMediaInfoIndex", void 0), e([y({ readOnly: true })], v6.prototype, "activeMediaInfo", null), e([y()], v6.prototype, "attributes", void 0), e([y()], v6.prototype, "description", void 0), e([y()], v6.prototype, "fieldInfoMap", void 0), e([y()], v6.prototype, "formattedAttributes", void 0), e([y()], v6.prototype, "expressionAttributes", void 0), e([y({ readOnly: true })], v6.prototype, "formattedMediaInfos", null), e([y()], v6.prototype, "isAggregate", void 0), e([y()], v6.prototype, "layer", void 0), e([y({ readOnly: true })], v6.prototype, "formattedMediaInfoCount", null), e([y()], v6.prototype, "mediaInfos", void 0), e([y()], v6.prototype, "popupTemplate", void 0), e([y()], v6.prototype, "relatedInfos", void 0), e([y()], v6.prototype, "title", void 0), v6 = e([a("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")], v6);
var M2 = v6;

// node_modules/@arcgis/core/widgets/Feature/FeatureMedia.js
var g2 = "esri-feature-media";
var v7 = { base: g2, mediaContainer: `${g2}__container`, mediaItemContainer: `${g2}__item-container`, mediaItem: `${g2}__item`, mediaItemText: `${g2}__item-text`, mediaItemTitle: `${g2}__item-title`, mediaItemCaption: `${g2}__item-caption`, mediaNavigation: `${g2}__item-navigation`, mediaPagination: `${g2}__pagination`, mediaPaginationText: `${g2}__pagination-text`, mediaPrevious: `${g2}__previous`, mediaPreviousIconLTR: `${g2}__previous-icon`, mediaPreviousIconRTL: `${g2}__previous-icon--rtl`, mediaNext: `${g2}__next`, mediaNextIconLTR: `${g2}__next-icon`, mediaNextIconRTL: `${g2}__next-icon--rtl`, mediaChart: `${g2}__chart`, mediaPaginationButton: `${g2}__pagination-button`, mediaPaginationIcon: `${g2}__pagination-icon`, mediaChartRendered: `${g2}__chart--rendered` };
var M3 = 15;
var w2 = "category";
var I5 = "value";
var A3 = "rgba(50, 50, 50, 1)";
var C = 250;
var y4 = 500;
var x4 = 200;
var T2 = class extends D {
  constructor(e10, t3) {
    super(e10, t3), this._refreshTimer = null, this._refreshIntervalInfo = null, this._featureElementInfo = null, this._chartRootMap = /* @__PURE__ */ new WeakMap(), this.viewModel = new M2(), this.messages = null, this._disposeChart = (e11) => {
      var _a;
      (_a = this._chartRootMap.get(e11)) == null ? void 0 : _a.dispose(), this._chartRootMap.delete(e11);
    }, this._createChart = async (e11) => {
      const { destroyed: t4, viewModel: i4 } = this;
      if (t4 || !i4 || !e11)
        return;
      const { createRoot: r3 } = await import("./chartUtilsAm5-GKML4DIP.js"), a3 = await r3(e11);
      this._chartRootMap.set(e11, a3), this._renderChart({ mediaInfo: i4.activeMediaInfo, root: a3 });
    };
  }
  initialize() {
    this._featureElementInfo = new l(), this.addHandles([d(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.activeMediaInfo, (_b = this.viewModel) == null ? void 0 : _b.activeMediaInfoIndex];
    }, () => this._setupMediaRefreshTimer(), P), d(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.description, (_b = this.viewModel) == null ? void 0 : _b.title];
    }, () => this._setupFeatureElementInfo(), P)]);
  }
  loadDependencies() {
    return r({ icon: () => import("./calcite-icon-25XWA6H7.js") });
  }
  destroy() {
    var _a;
    this._clearMediaRefreshTimer(), (_a = this._featureElementInfo) == null ? void 0 : _a.destroy();
  }
  get attributes() {
    return this.viewModel.attributes;
  }
  set attributes(e10) {
    this.viewModel.attributes = e10;
  }
  get activeMediaInfoIndex() {
    return this.viewModel.activeMediaInfoIndex;
  }
  set activeMediaInfoIndex(e10) {
    this.viewModel.activeMediaInfoIndex = e10;
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e10) {
    this.viewModel.description = e10;
  }
  get fieldInfoMap() {
    return this.viewModel.fieldInfoMap;
  }
  set fieldInfoMap(e10) {
    this.viewModel.fieldInfoMap = e10;
  }
  get layer() {
    return this.viewModel.layer;
  }
  set layer(e10) {
    this.viewModel.layer = e10;
  }
  get mediaInfos() {
    return this.viewModel.mediaInfos;
  }
  set mediaInfos(e10) {
    this.viewModel.mediaInfos = e10;
  }
  get popupTemplate() {
    return this.viewModel.popupTemplate;
  }
  set popupTemplate(e10) {
    this.viewModel.popupTemplate = e10;
  }
  get relatedInfos() {
    return this.viewModel.relatedInfos;
  }
  set relatedInfos(e10) {
    this.viewModel.relatedInfos = e10;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e10) {
    this.viewModel.title = e10;
  }
  render() {
    var _a;
    return n2("div", { bind: this, class: v7.base, onkeyup: this._handleMediaKeyup }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), this._renderMedia());
  }
  _renderMedia() {
    const { formattedMediaInfoCount: e10, activeMediaInfoIndex: t3 } = this.viewModel, i4 = this._renderMediaText();
    return e10 ? n2("div", { class: v7.mediaContainer, key: "media-element-container" }, this._renderMediaInfo(), n2("div", { class: v7.mediaNavigation }, i4, e10 > 1 ? n2("div", { class: v7.mediaPagination }, this._renderMediaPageButton("previous"), n2("span", { class: v7.mediaPaginationText }, s4(this.messages.pageText, { index: t3 + 1, total: e10 })), this._renderMediaPageButton("next")) : null)) : null;
  }
  _renderMediaText() {
    const { activeMediaInfo: e10 } = this.viewModel;
    if (!e10)
      return null;
    const t3 = e10 && e10.title ? n2("div", { class: v7.mediaItemTitle, innerHTML: e10.title, key: "media-title" }) : null, i4 = e10 && e10.caption ? n2("div", { class: v7.mediaItemCaption, innerHTML: e10.caption, key: "media-caption" }) : null;
    return t3 || i4 ? n2("div", { class: v7.mediaItemText, key: "media-text" }, t3, i4) : null;
  }
  _renderImageMediaInfo(e10) {
    const { _refreshIntervalInfo: t3 } = this, { activeMediaInfoIndex: i4, formattedMediaInfoCount: r3 } = this.viewModel, { value: a3, refreshInterval: s9, altText: o2, title: n8, type: l5 } = e10, { sourceURL: d6, linkURL: c10 } = a3, h6 = x2(c10 ?? void 0) ? "_blank" : "_self", p5 = "_blank" === h6 ? "noreferrer" : "", f5 = s9 ? t3 : null, _ = f5 ? f5.timestamp : 0, g5 = f5 ? f5.sourceURL : d6, v8 = n2("img", { alt: o2 || n8, key: `media-${l5}-${i4}-${r3}-${_}`, src: g5 ?? void 0 });
    return (c10 ? n2("a", { href: c10, rel: p5, target: h6, title: n8 }, v8) : null) ?? v8;
  }
  _renderChartMediaInfo(e10) {
    const { activeMediaInfoIndex: t3, formattedMediaInfoCount: i4 } = this.viewModel;
    return n2("div", { afterCreate: this._createChart, afterRemoved: this._disposeChart, bind: this, class: v7.mediaChart, key: `media-${e10.type}-${t3}-${i4}` });
  }
  _renderMediaInfoType() {
    const { activeMediaInfo: e10 } = this.viewModel;
    return e10 ? "image" === e10.type ? this._renderImageMediaInfo(e10) : e10.type.includes("chart") ? this._renderChartMediaInfo(e10) : null : null;
  }
  _renderMediaInfo() {
    const { activeMediaInfo: e10 } = this.viewModel;
    return e10 ? n2("div", { class: v7.mediaItemContainer, key: "media-container" }, n2("div", { class: v7.mediaItem, key: "media-item-container" }, this._renderMediaInfoType())) : null;
  }
  _renderMediaPageButton(e10) {
    if (this.viewModel.formattedMediaInfoCount < 2)
      return null;
    const t3 = "previous" === e10, i4 = t3 ? this.messages.previous : this.messages.next, r3 = t3 ? "chevron-left" : "chevron-right", a3 = t3 ? "media-previous" : "media-next", s9 = t3 ? this._previous : this._next;
    return n2("button", { "aria-label": i4, bind: this, class: v7.mediaPaginationButton, key: a3, onclick: s9, tabIndex: 0, title: i4, type: "button" }, n2("calcite-icon", { class: v7.mediaPaginationIcon, icon: r3, scale: "s" }));
  }
  _setupFeatureElementInfo() {
    var _a;
    const { description: e10, title: t3 } = this;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: e10, title: t3 });
  }
  _next() {
    this.viewModel.next();
  }
  _previous() {
    this.viewModel.previous();
  }
  _getRenderer() {
    if (!this.viewModel)
      return;
    const { isAggregate: e10, layer: t3 } = this.viewModel;
    return e10 && (t3 == null ? void 0 : t3.featureReduction) && "renderer" in t3.featureReduction ? t3.featureReduction.renderer : t3 == null ? void 0 : t3.renderer;
  }
  async _getSeriesColors(e10) {
    const { colorAm5: t3 } = await import("./chartCommon-AX7MNHHX.js"), i4 = /* @__PURE__ */ new Map();
    return e10.forEach((e11) => {
      e11.color && i4.set(e11, t3(e11.color.toCss(true)));
    }), i4;
  }
  async _getRendererColors() {
    const { colorAm5: e10 } = await import("./chartCommon-AX7MNHHX.js"), t3 = /* @__PURE__ */ new Map(), i4 = this._getRenderer(), r3 = "default";
    if (!i4)
      return t3;
    const a3 = await x3(i4);
    a3.delete(r3);
    return Array.from(a3.values()).every((e11) => 1 === (e11 == null ? void 0 : e11.length)) ? (Array.from(a3.keys()).forEach((i5) => {
      var _a, _b;
      const r4 = (_b = (_a = a3.get(i5)) == null ? void 0 : _a[0]) == null ? void 0 : _b.toCss(true);
      r4 && t3.set(i5, e10(r4));
    }), t3) : t3;
  }
  _handleMediaKeyup(e10) {
    const { key: t3 } = e10;
    "ArrowLeft" === t3 && (e10.stopPropagation(), this.viewModel.previous()), "ArrowRight" === t3 && (e10.stopPropagation(), this.viewModel.next());
  }
  _canAnimateChart() {
    return !!this.viewModel && (!!this.viewModel.abilities.chartAnimation && !e7());
  }
  _getChartAnimationMS() {
    return this._canAnimateChart() ? C : 0;
  }
  _getChartSeriesAnimationMS() {
    return this._canAnimateChart() ? y4 : 0;
  }
  async _renderChart(e10) {
    const { root: t3, mediaInfo: i4 } = e10, { value: r3, type: a3 } = i4, { ResponsiveThemeAm5: s9, DarkThemeAm5: o2, AnimatedThemeAm5: n8, ColorSetAm5: l5, ThemeAm5: d6, esriChartColorSet: m7 } = await import("./chartCommon-AX7MNHHX.js"), c10 = d6.new(t3);
    c10.rule("ColorSet").set("colors", m7), c10.rule("ColorSet").set("reuse", true);
    const h6 = [s9.new(t3), c10];
    r2() && h6.push(o2.new(t3)), this._canAnimateChart() && h6.push(n8.new(t3)), t3.setThemes(h6);
    const p5 = await this._getRendererColors(), u5 = await this._getSeriesColors(r3.series), _ = l5.new(t3, {}), g5 = u5.get(r3.series[0]), v8 = g5 ? { lineSettings: { stroke: g5 } } : void 0, M4 = r3.series.map((e11, t4) => {
      const i5 = u5.get(e11) || p5.get(e11.fieldName) || _.getIndex(t4);
      return { [w2]: e11.tooltip, [I5]: e11.value, columnSettings: { fill: i5, stroke: i5 }, ...v8 };
    }).filter((e11) => "pie-chart" !== a3 || null != e11.value && e11.value > 0);
    "pie-chart" === a3 ? this._createPieChart(e10, M4) : this._createXYChart(e10, M4);
  }
  _getDirection() {
    return v3(this.container) ? "rtl" : "ltr";
  }
  _isInversed() {
    return !!v3(this.container);
  }
  async _customizeChartTooltip(e10, t3 = "horizontal") {
    var _a;
    const { colorAm5: i4 } = await import("./chartCommon-AX7MNHHX.js");
    e10.setAll({ pointerOrientation: t3 }), (_a = e10.get("background")) == null ? void 0 : _a.setAll({ stroke: i4(A3) }), e10.label.setAll({ direction: this._getDirection(), oversizedBehavior: "wrap", maxWidth: x4 });
  }
  async _createPieChart(e10, t3) {
    const { TooltipAm5: i4 } = await import("./chartCommon-AX7MNHHX.js"), { PieChartAm5: r3, PieSeriesAm5: a3 } = await import("./pieChart-AQTEKT53.js"), { mediaInfo: s9, root: o2 } = e10, { title: n8 } = s9, l5 = 5, d6 = (s9 == null ? void 0 : s9.altText) || (s9 == null ? void 0 : s9.title) || "", m7 = o2.container.children.push(r3.new(o2, { ariaLabel: d6, focusable: true, paddingBottom: l5, paddingTop: l5, paddingLeft: l5, paddingRight: l5 })), c10 = "{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})", h6 = i4.new(o2, { labelText: c10 }), p5 = m7.series.push(a3.new(o2, { name: n8, valueField: I5, categoryField: w2, tooltip: h6 }));
    p5.ticks.template.set("forceHidden", true), p5.labels.template.set("forceHidden", true), p5.slices.template.states.create("active", { shiftRadius: l5 }), this._customizeChartTooltip(h6), p5.slices.template.setAll({ ariaLabel: c10, focusable: true, templateField: "columnSettings" }), p5.data.setAll(t3), p5.appear(this._getChartSeriesAnimationMS()), m7.appear(this._getChartAnimationMS()), m7.root.dom.classList.toggle(v7.mediaChartRendered, true);
  }
  _getMinSeriesValue(e10) {
    let t3 = 0;
    return e10.forEach((e11) => t3 = Math.min(e11.value, t3)), t3;
  }
  async _createColumnChart(e10, t3, i4) {
    const { TooltipAm5: r3, ScrollbarAm5: a3 } = await import("./chartCommon-AX7MNHHX.js"), { CategoryAxisAm5: s9, AxisRendererXAm5: o2, ValueAxisAm5: n8, AxisRendererYAm5: l5, ColumnSeriesAm5: d6 } = await import("./xyChart-HELH4TDM.js"), { mediaInfo: m7, root: c10 } = t3, { value: h6, title: p5 } = m7;
    e10.setAll({ wheelX: "panX", wheelY: "zoomX" });
    const u5 = e10.xAxes.push(s9.new(c10, { renderer: o2.new(c10, { inversed: this._isInversed() }), categoryField: w2 }));
    u5.get("renderer").labels.template.setAll({ forceHidden: true });
    const f5 = e10.yAxes.push(n8.new(c10, { renderer: l5.new(c10, { inside: false }), min: this._getMinSeriesValue(h6.series) }));
    f5.get("renderer").labels.template.setAll({ direction: this._getDirection() });
    const _ = "{categoryX}", g5 = r3.new(c10, { labelText: _ }), v8 = e10.series.push(d6.new(c10, { name: p5, xAxis: u5, yAxis: f5, valueYField: I5, categoryXField: w2, tooltip: g5 }));
    this._customizeChartTooltip(g5), v8.columns.template.setAll({ ariaLabel: _, focusable: true, templateField: "columnSettings" }), h6.series.length > M3 && e10.set("scrollbarX", a3.new(c10, { orientation: "horizontal" })), u5.data.setAll(i4), v8.data.setAll(i4), v8.appear(this._getChartSeriesAnimationMS()), e10.appear(this._getChartAnimationMS());
  }
  async _createBarChart(e10, t3, i4) {
    const { TooltipAm5: r3, ScrollbarAm5: a3 } = await import("./chartCommon-AX7MNHHX.js"), { CategoryAxisAm5: s9, AxisRendererXAm5: o2, ValueAxisAm5: n8, AxisRendererYAm5: l5, ColumnSeriesAm5: d6 } = await import("./xyChart-HELH4TDM.js"), { mediaInfo: m7, root: c10 } = t3, { value: h6, title: p5 } = m7;
    e10.setAll({ wheelX: "panY", wheelY: "zoomY" });
    const u5 = e10.yAxes.push(s9.new(c10, { renderer: l5.new(c10, { inversed: true }), categoryField: w2 }));
    u5.get("renderer").labels.template.setAll({ forceHidden: true });
    const f5 = e10.xAxes.push(n8.new(c10, { renderer: o2.new(c10, { inside: false, inversed: this._isInversed() }), min: this._getMinSeriesValue(h6.series) }));
    f5.get("renderer").labels.template.setAll({ direction: this._getDirection() });
    const _ = "{categoryY}", g5 = r3.new(c10, { labelText: _ }), v8 = e10.series.push(d6.new(c10, { name: p5, xAxis: f5, yAxis: u5, valueXField: I5, categoryYField: w2, tooltip: g5 }));
    this._customizeChartTooltip(g5, "vertical"), v8.columns.template.setAll({ ariaLabel: _, focusable: true, templateField: "columnSettings" }), h6.series.length > M3 && e10.set("scrollbarY", a3.new(c10, { orientation: "vertical" })), u5.data.setAll(i4), v8.data.setAll(i4), v8.appear(this._getChartSeriesAnimationMS()), e10.appear(this._getChartAnimationMS());
  }
  async _createLineChart(e10, t3, i4) {
    var _a, _b, _c;
    const { TooltipAm5: r3, ScrollbarAm5: a3 } = await import("./chartCommon-AX7MNHHX.js"), { CategoryAxisAm5: s9, AxisRendererXAm5: o2, ValueAxisAm5: n8, AxisRendererYAm5: l5, LineSeriesAm5: d6 } = await import("./xyChart-HELH4TDM.js"), { root: m7, mediaInfo: c10 } = t3, { value: h6, title: p5 } = c10;
    e10.setAll({ wheelX: "panX", wheelY: "zoomX" });
    const u5 = e10.xAxes.push(s9.new(m7, { renderer: o2.new(m7, { inversed: this._isInversed() }), categoryField: w2 }));
    u5.get("renderer").labels.template.setAll({ forceHidden: true });
    const f5 = e10.yAxes.push(n8.new(m7, { renderer: l5.new(m7, { inside: false }), min: this._getMinSeriesValue(h6.series) }));
    f5.get("renderer").labels.template.setAll({ direction: this._getDirection() });
    const _ = "{categoryX}", g5 = (_b = (_a = i4[0]) == null ? void 0 : _a.lineSettings) == null ? void 0 : _b.stroke, v8 = r3.new(m7, { getFillFromSprite: !g5, labelText: _ });
    g5 && ((_c = v8.get("background")) == null ? void 0 : _c.setAll({ fill: g5 }));
    const A4 = e10.series.push(d6.new(m7, { name: p5, xAxis: u5, yAxis: f5, valueYField: I5, categoryXField: w2, tooltip: v8 }));
    A4.strokes.template.setAll({ templateField: "lineSettings" }), this._customizeChartTooltip(v8, "vertical"), h6.series.length > M3 && e10.set("scrollbarX", a3.new(m7, { orientation: "horizontal" })), u5.data.setAll(i4), A4.data.setAll(i4), A4.appear(this._getChartSeriesAnimationMS()), e10.appear(this._getChartAnimationMS());
  }
  async _createXYChart(e10, t3) {
    const { XYChartAm5: i4, XYCursorAm5: r3 } = await import("./xyChart-HELH4TDM.js"), { root: a3, mediaInfo: s9 } = e10, { type: o2 } = s9, n8 = (s9 == null ? void 0 : s9.altText) || (s9 == null ? void 0 : s9.title) || "", l5 = a3.container.children.push(i4.new(a3, { ariaLabel: n8, focusable: true, panX: true, panY: true }));
    l5.set("cursor", r3.new(a3, {})), "column-chart" === o2 && await this._createColumnChart(l5, e10, t3), "bar-chart" === o2 && await this._createBarChart(l5, e10, t3), "line-chart" === o2 && await this._createLineChart(l5, e10, t3), l5.root.dom.classList.toggle(v7.mediaChartRendered, true);
  }
  _clearMediaRefreshTimer() {
    const { _refreshTimer: e10 } = this;
    e10 && (clearTimeout(e10), this._refreshTimer = null);
  }
  _updateMediaInfoTimestamp(e10) {
    const t3 = Date.now();
    this._refreshIntervalInfo = { timestamp: t3, sourceURL: e10 && this._getImageSource(e10, t3) };
  }
  _setupMediaRefreshTimer() {
    this._clearMediaRefreshTimer();
    const { activeMediaInfo: e10 } = this.viewModel;
    e10 && "image" === e10.type && e10.refreshInterval && this._setRefreshTimeout(e10);
  }
  _setRefreshTimeout(e10) {
    const { refreshInterval: t3, value: i4 } = e10;
    if (!t3)
      return;
    const r3 = 6e4 * t3;
    this._updateMediaInfoTimestamp(i4.sourceURL);
    const a3 = setInterval(() => {
      this._updateMediaInfoTimestamp(i4.sourceURL);
    }, r3);
    this._refreshTimer = a3;
  }
  _getImageSource(e10, t3) {
    const i4 = e10.includes("?") ? "&" : "?", [r3, a3 = ""] = e10.split("#");
    return `${r3}${i4}timestamp=${t3}${a3 ? "#" : ""}${a3}`;
  }
};
e([y()], T2.prototype, "_refreshIntervalInfo", void 0), e([y()], T2.prototype, "attributes", null), e([y()], T2.prototype, "activeMediaInfoIndex", null), e([y()], T2.prototype, "description", null), e([y()], T2.prototype, "fieldInfoMap", null), e([y()], T2.prototype, "layer", null), e([y()], T2.prototype, "mediaInfos", null), e([y()], T2.prototype, "popupTemplate", null), e([y()], T2.prototype, "relatedInfos", null), e([y()], T2.prototype, "title", null), e([y({ type: M2 })], T2.prototype, "viewModel", void 0), e([y(), e2("esri/widgets/Feature/t9n/Feature")], T2.prototype, "messages", void 0), T2 = e([a("esri.widgets.Feature.FeatureMedia")], T2);
var b4 = T2;

// node_modules/@arcgis/core/widgets/Feature/support/arcadeFeatureUtils.js
var n6 = "esri.widgets.Feature.support.arcadeFeatureUtils";
var s8 = () => n.getLogger(n6);
function p4(e10) {
  return "string" == typeof e10 ? ae(oe(e10)) : Array.isArray(e10) ? c9(e10) : "esri.arcade.Dictionary" === (e10 == null ? void 0 : e10.declaredClass) ? u3(e10) : e10;
}
function c9(e10) {
  return `<ul class="esri-widget__list">${e10.map((e11) => `<li>${"string" == typeof e11 ? ae(oe(e11)) : e11}</li>`).join("")}</ul>`;
}
function u3(e10) {
  const r3 = e10.keys().map((r4) => {
    const t3 = e10.field(r4);
    return `<tr><th>${r4}</th><td>${"string" == typeof t3 ? ae(oe(t3)) : t3}</td></tr>`;
  }).join("");
  return `<table class="${e4.table}">${r3}</table>`;
}
function l4() {
  return import("./arcade-5FEFNYWX.js");
}
function d5(e10) {
  return "createQuery" in e10 && "queryFeatures" in e10;
}
async function f3({ graphic: e10, view: r3, options: t3 }) {
  const { isAggregate: a3, layer: o2 } = e10;
  if (!a3 || !o2 || "2d" !== (r3 == null ? void 0 : r3.type))
    return [];
  const i4 = await r3.whenLayerView(o2);
  if (!d5(i4))
    return [];
  const n8 = i4.createQuery(), s9 = e10.getObjectId();
  n8.aggregateIds = null != s9 ? [s9] : [];
  const { features: p5 } = await i4.queryFeatures(n8, t3);
  return p5;
}
function y5({ layer: e10, aggregatedFeatures: r3, interceptor: a3 }) {
  const { fields: o2, objectIdField: i4, geometryType: n8, spatialReference: s9, displayField: p5 } = e10;
  return new We({ fields: o2, objectIdField: i4, geometryType: n8, spatialReference: s9, displayField: p5, interceptor: a3, ..."feature" === e10.type ? { templates: e10.templates, typeIdField: e10.typeIdField, types: e10.types } : null, source: r3 });
}
async function g3({ expressionInfo: e10, arcade: r3, interceptor: t3, spatialReference: a3, map: o2, graphic: i4, location: n8, view: p5, options: c10 }) {
  var _a;
  if (!(e10 == null ? void 0 : e10.expression))
    return null;
  const { isAggregate: u5 } = i4, l5 = (i4.sourceLayer || i4.layer) ?? void 0, d6 = u5 ? "feature-reduction-popup" : "popup", g5 = r3.createArcadeProfile(d6), m7 = r3.createArcadeExecutor(e10.expression, g5).catch((r4) => s8().error("arcade-executor-error", { error: r4, expressionInfo: e10 })), [w5, h6] = await Promise.all([f3({ graphic: i4, view: p5, options: c10 }), m7]);
  if (!h6)
    return null;
  const F5 = "feature-reduction-popup" === d6 ? y5({ layer: l5, aggregatedFeatures: w5, interceptor: t3 }) : void 0, $2 = { ..."feature-reduction-popup" === d6 ? { $aggregatedFeatures: F5 } : { $datastore: l5 == null ? void 0 : l5.url, $layer: "feature" === (l5 == null ? void 0 : l5.type) || "subtype-sublayer" === (l5 == null ? void 0 : l5.type) ? l5 : "scene" === (l5 == null ? void 0 : l5.type) && null != l5.associatedLayer ? l5.associatedLayer : void 0, $map: o2, $userInput: n8, $graph: "knowledge-graph-sublayer" === (l5 == null ? void 0 : l5.type) ? (_a = l5 == null ? void 0 : l5.parentCompositeLayer) == null ? void 0 : _a.knowledgeGraph : void 0 }, $feature: i4 }, v8 = { abortSignal: (c10 == null ? void 0 : c10.signal) ?? void 0, interceptor: t3 ?? void 0, rawOutput: true, spatialReference: a3 ?? void 0, timeZone: p5 == null ? void 0 : p5.timeZone };
  return await h6.executeAsync($2, v8).catch((r4) => s8().error("arcade-execution-error", { error: r4, graphic: i4, expressionInfo: e10 })).finally(() => F5 == null ? void 0 : F5.destroy());
}
async function m5({ expressionInfos: e10, spatialReference: t3, graphic: a3, interceptor: o2, map: i4, view: n8, location: s9, options: c10 }) {
  if (!(e10 == null ? void 0 : e10.length))
    return {};
  const u5 = await l4(), d6 = {};
  for (const r3 of e10)
    d6[`expression/${r3.name}`] = g3({ expressionInfo: r3, arcade: u5, interceptor: o2, spatialReference: t3, map: i4, graphic: a3, location: s9, view: n8, options: c10 });
  const f5 = await v(d6), y7 = {};
  for (const r3 in f5)
    y7[r3] = p4(f5[r3].value);
  return y7;
}

// node_modules/@arcgis/core/widgets/Feature/FeatureExpression/FeatureExpressionViewModel.js
var w3 = 1;
var j2 = class extends S {
  constructor(t3) {
    super(t3), this._abortController = null, this.expressionInfo = null, this.graphic = null, this.contentElement = null, this.contentElementViewModel = null, this.interceptor = null, this.location = null, this.view = null, this._cancelQuery = () => {
      const { _abortController: t4 } = this;
      t4 && t4.abort(), this._abortController = null;
    }, this._createVM = () => {
      var _a, _b;
      const t4 = (_a = this.contentElement) == null ? void 0 : _a.type;
      (_b = this.contentElementViewModel) == null ? void 0 : _b.destroy();
      const e10 = "fields" === t4 ? new n5() : "media" === t4 ? new M2() : "text" === t4 ? new p2() : null;
      this._set("contentElementViewModel", e10);
    }, this._compile = async () => {
      this._cancelQuery();
      const t4 = new AbortController();
      this._abortController = t4, await this._compileExpression(), this._abortController === t4 && (this._abortController = null);
    }, this._compileThrottled = e3(this._compile, w3, this), this._compileExpression = async () => {
      const { expressionInfo: t4, graphic: e10, interceptor: o2, spatialReference: r3, map: n8, location: i4, view: s9, _abortController: l5 } = this;
      if (!t4 || !e10)
        return void this._set("contentElement", null);
      const m7 = await l4();
      if (l5 !== this._abortController)
        return;
      const h6 = await g3({ arcade: m7, expressionInfo: t4, graphic: e10, location: i4, interceptor: o2, map: n8, spatialReference: r3, view: s9 });
      if (!h6 || "esri.arcade.Dictionary" !== h6.declaredClass)
        return void this._set("contentElement", null);
      const d6 = await h6.castAsJsonAsync(l5 == null ? void 0 : l5.signal), u5 = d6 == null ? void 0 : d6.type, _ = "media" === u5 ? I.fromJSON(d6) : "text" === u5 ? c2.fromJSON(d6) : "fields" === u5 ? c.fromJSON(d6) : null;
      this._set("contentElement", _);
    }, this.addHandles([d(() => [this.expressionInfo, this.graphic, this.map, this.spatialReference, this.view], () => this._compileThrottled(), P), d(() => [this.contentElement], () => this._createVM(), P)]);
  }
  initialize() {
    this.addHandles(this._compileThrottled);
  }
  destroy() {
    var _a;
    this._cancelQuery(), (_a = this.contentElementViewModel) == null ? void 0 : _a.destroy(), this._set("contentElementViewModel", null), this._set("contentElement", null);
  }
  get spatialReference() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.spatialReference) ?? null;
  }
  set spatialReference(t3) {
    this._override("spatialReference", t3);
  }
  get state() {
    const { _abortController: t3, contentElement: e10, contentElementViewModel: o2 } = this;
    return t3 ? "loading" : e10 || o2 ? "ready" : "disabled";
  }
  get map() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.map) ?? null;
  }
  set map(t3) {
    this._override("map", t3);
  }
};
e([y()], j2.prototype, "_abortController", void 0), e([y({ type: i })], j2.prototype, "expressionInfo", void 0), e([y({ type: f })], j2.prototype, "graphic", void 0), e([y({ readOnly: true })], j2.prototype, "contentElement", void 0), e([y({ readOnly: true })], j2.prototype, "contentElementViewModel", void 0), e([y()], j2.prototype, "interceptor", void 0), e([y({ type: x })], j2.prototype, "location", void 0), e([y()], j2.prototype, "spatialReference", null), e([y({ readOnly: true })], j2.prototype, "state", null), e([y()], j2.prototype, "map", null), e([y()], j2.prototype, "view", void 0), j2 = e([a("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")], j2);
var C2 = j2;

// node_modules/@arcgis/core/widgets/Feature/FeatureExpression.js
var m6 = "esri-feature";
var u4 = { base: `${m6}-expression`, loadingSpinnerContainer: `${m6}__loading-container` };
var g4 = class extends D {
  constructor(e10, t3) {
    super(e10, t3), this._contentWidget = null, this.viewModel = new C2();
  }
  initialize() {
    this.addHandles(d(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.contentElementViewModel;
    }, () => this._setupExpressionWidget(), P));
  }
  loadDependencies() {
    return r({ loader: () => import("./calcite-loader-64JUXTQT.js") });
  }
  destroy() {
    this._destroyContentWidget();
  }
  render() {
    var _a;
    const { state: e10 } = this.viewModel;
    return n2("div", { class: u4.base }, "loading" === e10 ? this._renderLoading() : "disabled" === e10 ? null : (_a = this._contentWidget) == null ? void 0 : _a.render());
  }
  _renderLoading() {
    return n2("div", { class: u4.loadingSpinnerContainer, key: "loading-container" }, n2("calcite-loader", { inline: true, label: "" }));
  }
  _destroyContentWidget() {
    const { _contentWidget: e10 } = this;
    e10 && (e10.viewModel = null, e10.destroy()), this._contentWidget = null;
  }
  _setupExpressionWidget() {
    const { contentElementViewModel: e10, contentElement: t3 } = this.viewModel, o2 = t3 == null ? void 0 : t3.type;
    this._destroyContentWidget();
    const s9 = e10 ? "fields" === o2 ? new h3({ viewModel: e10 }) : "media" === o2 ? new b4({ viewModel: e10 }) : "text" === o2 ? new p3({ viewModel: e10 }) : null : null;
    this._contentWidget = s9, this.scheduleRender();
  }
};
e([y({ type: C2 })], g4.prototype, "viewModel", void 0), g4 = e([a("esri.widgets.Feature.FeatureExpression")], g4);
var h5 = g4;

// node_modules/@arcgis/core/widgets/Feature/FeatureRelationship.js
var w4 = "esri-feature";
var b5 = `${w4}-relationship`;
var f4 = { base: b5, listContainer: `${b5}__list`, listItem: `${b5}__list-item`, listItemHidden: `${b5}__list-item--hidden`, listContainerQuerying: `${b5}__list--querying`, featureObserver: `${w4}__feature-observer`, stickySpinnerContainer: `${w4}__sticky-loading-container`, loadingSpinnerContainer: `${w4}__loading-container` };
var y6 = { title: true, description: true };
var F3 = class extends D {
  constructor(e10, t3) {
    super(e10, t3), this._featureElementInfo = null, this._relatedFeatureIntersectionObserverNode = null, this._relatedFeatureIntersectionObserver = new IntersectionObserver(([e11]) => {
      (e11 == null ? void 0 : e11.isIntersecting) && this._increaseFeaturePage();
    }, { root: window.document }), this.headingLevel = 2, this.viewModel = new F(), this.messages = null, this.messagesCommon = null, this.visibleElements = { ...y6 }, this._increaseFeaturePage = () => {
      const { state: e11, showAllEnabled: t4, relatedFeatures: s9, featuresPerPage: r3, featurePage: i4 } = this.viewModel;
      "ready" === e11 && t4 && s9.length >= r3 * i4 && this.viewModel.featurePage++;
    };
  }
  initialize() {
    this._featureElementInfo = new l(), this.addHandles([d(() => [this.viewModel.description, this.viewModel.title, this.headingLevel], () => this._setupFeatureElementInfo(), P), d(() => [this.viewModel.state, this.viewModel.showAllEnabled, this._relatedFeatureIntersectionObserverNode], () => this._handleRelatedFeatureObserverChange()), v2(() => this.viewModel.relatedFeatureViewModels, "change", () => this._setupRelatedFeatureViewModels())]);
  }
  loadDependencies() {
    return r({ icon: () => import("./calcite-icon-25XWA6H7.js"), list: () => import("./calcite-list-CC3BA3BY.js"), "list-item": () => import("./calcite-list-item-K4SMX7ZK.js"), loader: () => import("./calcite-loader-64JUXTQT.js"), notice: () => import("./calcite-notice-Q2MN4Y4I.js") });
  }
  destroy() {
    this._unobserveRelatedFeatureObserver(), this._featureElementInfo = u(this._featureElementInfo);
  }
  get displayShowAllButton() {
    const { showAllEnabled: e10, featureCount: t3, displayCount: s9, state: r3 } = this.viewModel;
    return !e10 && !!t3 && "ready" === r3 && (t3 > s9 || 0 === s9);
  }
  get displayListItems() {
    return this.displayShowAllButton || this.viewModel.relatedFeatureViewModels.length > 0;
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e10) {
    this.viewModel.description = e10;
  }
  get featureCountDescription() {
    const { messages: e10 } = this, { featureCount: t3 } = this.viewModel;
    return s4(e10 == null ? void 0 : e10.numberRecords, { number: t3 });
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e10) {
    this.viewModel.title = e10;
  }
  castVisibleElements(e10) {
    return { ...y6, ...e10 };
  }
  render() {
    var _a;
    const { state: e10 } = this.viewModel;
    return n2("div", { class: this.classes(f4.base, e4.widget) }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), "loading" === e10 ? this._renderLoading() : "disabled" === e10 ? this._renderRelationshipNotFound() : this._renderRelatedFeatures());
  }
  _renderStickyLoading() {
    return "querying" === this.viewModel.state ? n2("div", { class: f4.stickySpinnerContainer, key: "sticky-loader" }, this._renderLoadingIcon()) : null;
  }
  _renderLoadingIcon() {
    return n2("calcite-loader", { inline: true, label: "" });
  }
  _renderLoading() {
    return n2("div", { class: f4.loadingSpinnerContainer, key: "loading-container" }, this._renderLoadingIcon());
  }
  _renderShowAllIconNode() {
    return n2("calcite-icon", { icon: "list", scale: "s", slot: "content-end" });
  }
  _renderChevronIconNode() {
    const e10 = v3(this.container) ? "chevron-left" : "chevron-right";
    return n2("calcite-icon", { icon: e10, scale: "s", slot: "content-end" });
  }
  _renderRelatedFeature(e10) {
    var _a;
    const { itemDescriptionFieldName: t3 } = this.viewModel, s9 = e10.title;
    e10.description = t3 && ((_a = e10.formattedAttributes) == null ? void 0 : _a.global[t3]);
    const r3 = "loading" === e10.state;
    return n2("calcite-list-item", { class: this.classes(f4.listItem, { [f4.listItemHidden]: r3 }), description: e10.description ?? "", key: e10.uid, label: s9, onCalciteListItemSelect: () => this.emit("select-record", { featureViewModel: e10 }) }, this._renderChevronIconNode());
  }
  _renderShowAllListItem() {
    var _a;
    return this.displayShowAllButton ? n2("calcite-list-item", { description: this.featureCountDescription, key: "show-all-item", label: (_a = this.messages) == null ? void 0 : _a.showAll, onCalciteListItemSelect: () => this.emit("show-all-records") }, this._renderShowAllIconNode()) : null;
  }
  _renderNoRelatedFeaturesMessage() {
    var _a;
    return n2("calcite-notice", { icon: "information", key: "no-related-features-message", kind: "brand", open: true, scale: "s", width: "full" }, n2("div", { slot: "message" }, (_a = this.messages) == null ? void 0 : _a.noRelatedFeatures));
  }
  _renderFeatureObserver() {
    return n2("div", { afterCreate: this._relatedFeatureIntersectionObserverCreated, bind: this, class: f4.featureObserver, key: "feature-observer" });
  }
  _renderList() {
    const { relatedFeatureViewModels: e10 } = this.viewModel;
    return n2("calcite-list", null, e10.toArray().map((e11) => this._renderRelatedFeature(e11)), this._renderShowAllListItem());
  }
  _renderRelatedFeatures() {
    const { displayListItems: e10 } = this, { state: t3 } = this.viewModel;
    return n2("div", { class: this.classes(f4.listContainer, { [f4.listContainerQuerying]: "querying" === t3 }), key: "list-container" }, e10 ? this._renderList() : "ready" === t3 ? this._renderNoRelatedFeaturesMessage() : null, this._renderStickyLoading(), this._renderFeatureObserver());
  }
  _renderRelationshipNotFound() {
    var _a;
    return n2("calcite-notice", { icon: "exclamation-mark-triangle", key: "relationship-not-found", kind: "danger", open: true, scale: "s", width: "full" }, n2("div", { slot: "message" }, (_a = this.messages) == null ? void 0 : _a.relationshipNotFound));
  }
  _setupRelatedFeatureViewModels() {
    const { relatedFeatureViewModels: e10 } = this.viewModel, t3 = "related-feature-viewmodels";
    this.removeHandles(t3), e10 == null ? void 0 : e10.forEach((e11) => {
      this.addHandles(d(() => [e11.title, e11.state], () => this.scheduleRender(), P), t3);
    }), this.scheduleRender();
  }
  _setupFeatureElementInfo() {
    var _a;
    const { headingLevel: e10, visibleElements: t3 } = this, s9 = t3.description && this.description, r3 = t3.title && this.title;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: s9, title: r3, headingLevel: e10 });
  }
  async _handleRelatedFeatureObserverChange() {
    this._unobserveRelatedFeatureObserver();
    const { state: e10, showAllEnabled: t3 } = this.viewModel;
    await A(0), this._relatedFeatureIntersectionObserverNode && "ready" === e10 && t3 && this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode);
  }
  _relatedFeatureIntersectionObserverCreated(e10) {
    this._relatedFeatureIntersectionObserverNode = e10;
  }
  _unobserveRelatedFeatureObserver() {
    this._relatedFeatureIntersectionObserverNode && this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode);
  }
};
e([y()], F3.prototype, "_relatedFeatureIntersectionObserverNode", void 0), e([y({ readOnly: true })], F3.prototype, "displayShowAllButton", null), e([y({ readOnly: true })], F3.prototype, "displayListItems", null), e([y()], F3.prototype, "description", null), e([y({ readOnly: true })], F3.prototype, "featureCountDescription", null), e([y()], F3.prototype, "headingLevel", void 0), e([y()], F3.prototype, "title", null), e([y({ type: F })], F3.prototype, "viewModel", void 0), e([y(), e2("esri/widgets/Feature/t9n/Feature")], F3.prototype, "messages", void 0), e([y(), e2("esri/t9n/common")], F3.prototype, "messagesCommon", void 0), e([y()], F3.prototype, "visibleElements", void 0), e([s3("visibleElements")], F3.prototype, "castVisibleElements", null), F3 = e([a("esri.widgets.Feature.FeatureRelationship")], F3);
var I6 = F3;

// node_modules/@arcgis/core/arcade/featureset/support/FeatureSetQueryInterceptor.js
var e8 = class {
  constructor(e10, a3) {
    this.preLayerQueryCallback = e10, this.preRequestCallback = a3, this.preLayerQueryCallback || (this.preLayerQueryCallback = (e11) => {
    }), this.preRequestCallback || (this.preLayerQueryCallback = (e11) => {
    });
  }
};

// node_modules/@arcgis/core/widgets/Feature/FeatureViewModel.js
var G;
var z2 = 1;
var J2 = "content-view-models";
var K = "relationship-view-models";
var W = { attachmentsContent: true, chartAnimation: true, customContent: true, expressionContent: true, fieldsContent: true, mediaContent: true, textContent: true, relationshipContent: true };
var X = G = class extends s5(S) {
  constructor(e10) {
    super(e10), this._error = null, this._featureAbortController = null, this._graphicChangedThrottled = e3(this._graphicChanged, z2, this), this._expressionAttributes = null, this._graphicExpressionAttributes = null, this.abilities = { ...W }, this.content = null, this.contentViewModels = [], this.description = null, this.defaultPopupTemplateEnabled = false, this.formattedAttributes = null, this.lastEditInfo = null, this.location = null, this.relatedInfos = /* @__PURE__ */ new Map(), this.title = "", this.view = null, this._isAllowedContentType = (e11) => {
      const { abilities: t3 } = this;
      return "attachments" === e11.type && !!t3.attachmentsContent || "custom" === e11.type && !!t3.customContent || "fields" === e11.type && !!t3.fieldsContent || "media" === e11.type && !!t3.mediaContent || "text" === e11.type && !!t3.textContent || "expression" === e11.type && !!t3.expressionContent || "relationship" === e11.type && !!t3.relationshipContent;
    }, this.addHandles(d(() => [this.graphic, this._effectivePopupTemplate, this.abilities, this.timeZone], () => this._graphicChangedThrottled(), P));
  }
  initialize() {
    this.addHandles(this._graphicChangedThrottled);
  }
  destroy() {
    this._clear(), this._cancelFeatureQuery(), this._error = null, this.graphic = null, this._destroyContentViewModels(), this.relatedInfos.clear();
  }
  get _effectivePopupTemplate() {
    return null != this.graphic ? this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled) : null;
  }
  get _fieldInfoMap() {
    return re(ie(this._effectivePopupTemplate), this._sourceLayer);
  }
  get _sourceLayer() {
    return E(this.graphic);
  }
  castAbilities(e10) {
    return { ...W, ...e10 };
  }
  get isTable() {
    var _a;
    return ((_a = this._sourceLayer) == null ? void 0 : _a.isTable) || false;
  }
  get state() {
    return this.graphic ? this._error ? "error" : this.waitingForContent ? "loading" : "ready" : "disabled";
  }
  set graphic(e10) {
    this._set("graphic", (e10 == null ? void 0 : e10.clone()) ?? null);
  }
  get spatialReference() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.spatialReference) ?? null;
  }
  set spatialReference(e10) {
    this._override("spatialReference", e10);
  }
  get timeZone() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.timeZone) ?? o;
  }
  set timeZone(e10) {
    this._overrideIfSome("timeZone", e10);
  }
  get map() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.map) || null;
  }
  set map(e10) {
    this._override("map", e10);
  }
  get waitingForContent() {
    return !!this._featureAbortController;
  }
  setActiveMedia(e10, t3) {
    const i4 = this.contentViewModels[e10];
    i4 instanceof M2 && i4.setActiveMedia(t3);
  }
  nextMedia(e10) {
    const t3 = this.contentViewModels[e10];
    t3 instanceof M2 && t3.next();
  }
  previousMedia(e10) {
    const t3 = this.contentViewModels[e10];
    t3 instanceof M2 && t3.previous();
  }
  async updateGeometry() {
    var _a;
    const { graphic: e10, spatialReference: t3, _sourceLayer: i4 } = this;
    await (i4 == null ? void 0 : i4.load());
    const r3 = i4 == null ? void 0 : i4.objectIdField;
    if (!r3 || !e10 || !i4)
      return;
    const o2 = (_a = e10 == null ? void 0 : e10.attributes) == null ? void 0 : _a[r3];
    if (null == o2)
      return;
    const s9 = [o2];
    if (!e10.geometry) {
      const r4 = await se({ layer: i4, graphic: e10, outFields: [], objectIds: s9, returnGeometry: true, spatialReference: t3 }), o3 = r4 == null ? void 0 : r4.geometry;
      o3 && (e10.geometry = o3);
    }
  }
  _clear() {
    this._set("title", ""), this._set("content", null), this._set("formattedAttributes", null);
  }
  async _graphicChanged() {
    this._cancelFeatureQuery(), this._error = null, this._clear();
    const { graphic: e10 } = this;
    if (!e10)
      return;
    const t3 = new AbortController();
    this._featureAbortController = t3;
    try {
      await this._queryFeature({ signal: t3.signal });
    } catch (i4) {
      b(i4) || (this._error = i4, n.getLogger(this).error("error", "The popupTemplate could not be displayed for this feature.", { error: i4, graphic: e10, popupTemplate: this._effectivePopupTemplate }));
    }
    this._featureAbortController === t3 && (this._featureAbortController = null);
  }
  _cancelFeatureQuery() {
    const { _featureAbortController: e10 } = this;
    e10 && e10.abort(), this._featureAbortController = null;
  }
  _compileContentElement(e10, t3) {
    return "attachments" === e10.type ? this._compileAttachments(e10, t3) : "custom" === e10.type ? this._compileCustom(e10, t3) : "fields" === e10.type ? this._compileFields(e10, t3) : "media" === e10.type ? this._compileMedia(e10, t3) : "text" === e10.type ? this._compileText(e10, t3) : "expression" === e10.type ? this._compileExpression(e10, t3) : "relationship" === e10.type ? this._compileRelationship(e10, t3) : void 0;
  }
  _compileContent(e10) {
    if (this._destroyContentViewModels(), this.graphic)
      return Array.isArray(e10) ? e10.filter(this._isAllowedContentType).map((e11, t3) => this._compileContentElement(e11, t3)).filter(k) : "string" == typeof e10 ? this._compileText(new c2({ text: e10 }), 0).text : e10;
  }
  _destroyContentViewModels() {
    this.removeHandles(K), this.removeHandles(J2), this.contentViewModels.forEach((e10) => e10 && !e10.destroyed && e10.destroy()), this._set("contentViewModels", []);
  }
  _matchesFeature(e10, t3) {
    var _a;
    const i4 = (_a = e10 == null ? void 0 : e10.graphic) == null ? void 0 : _a.getObjectId(), r3 = t3 == null ? void 0 : t3.getObjectId();
    return null != i4 && null != r3 && i4 === r3;
  }
  _setRelatedFeaturesViewModels({ relatedFeatureViewModels: e10, relatedFeatures: t3, map: i4 }) {
    const { view: r3, spatialReference: o2, timeZone: s9 } = this;
    t3 == null ? void 0 : t3.filter(Boolean).forEach((t4) => {
      e10.some((e11) => this._matchesFeature(e11, t4)) || e10.add(new G({ abilities: { relationshipContent: false }, map: i4, view: r3, spatialReference: o2, timeZone: s9, graphic: t4 }));
    }), e10.forEach((i5) => {
      const r4 = t3 == null ? void 0 : t3.find((e11) => this._matchesFeature(i5, e11));
      r4 || e10.remove(i5);
    });
  }
  _setExpressionContentVM(e10, t3) {
    const i4 = this.formattedAttributes, { contentElement: r3, contentElementViewModel: o2 } = e10, s9 = r3 == null ? void 0 : r3.type;
    o2 && s9 && ("fields" === s9 && (this._createFieldsFormattedAttributes({ contentElement: r3, contentElementIndex: t3, formattedAttributes: i4 }), o2.set(this._createFieldsVMParams(r3, t3))), "media" === s9 && (this._createMediaFormattedAttributes({ contentElement: r3, contentElementIndex: t3, formattedAttributes: i4 }), o2.set(this._createMediaVMParams(r3, t3))), "text" === s9 && o2.set(this._createTextVMParams(r3)));
  }
  _compileRelationship(e10, t3) {
    const { displayCount: i4, orderByFields: r3, relationshipId: o2, title: s9, description: n8 } = e10, { _sourceLayer: a3, graphic: l5, map: p5 } = this;
    if (!J(a3))
      return;
    const d6 = new F({ displayCount: i4, graphic: l5, orderByFields: r3, relationshipId: o2, layer: a3, map: p5, ...this._compileTitleAndDesc({ title: s9, description: n8 }) });
    return this.contentViewModels[t3] = d6, this.addHandles(v2(() => d6.relatedFeatures, "change", () => this._setRelatedFeaturesViewModels(d6)), K), e10;
  }
  _compileExpression(e10, t3) {
    const { expressionInfo: i4 } = e10, { graphic: r3, map: o2, spatialReference: s9, view: n8, location: a3 } = this, l5 = new C2({ expressionInfo: i4, graphic: r3, interceptor: G.interceptor, map: o2, spatialReference: s9, view: n8, location: a3 });
    return this.contentViewModels[t3] = l5, this.addHandles(d(() => l5.contentElementViewModel, () => this._setExpressionContentVM(l5, t3), P), J2), e10;
  }
  _compileAttachments(e10, t3) {
    const { graphic: i4 } = this, { description: r3, title: o2 } = e10;
    return this.contentViewModels[t3] = new c3({ graphic: i4, ...this._compileTitleAndDesc({ title: o2, description: r3 }) }), e10;
  }
  _compileCustom(e10, t3) {
    const { graphic: i4 } = this, { creator: r3, destroyer: o2 } = e10;
    return this.contentViewModels[t3] = new p2({ graphic: i4, creator: r3, destroyer: o2 }), e10;
  }
  _compileTitleAndDesc({ title: e10, description: t3 }) {
    const { _fieldInfoMap: i4, _sourceLayer: r3, graphic: o2, formattedAttributes: s9 } = this, n8 = o2 == null ? void 0 : o2.attributes, a3 = this._expressionAttributes, l5 = s9.global;
    return { title: D2({ attributes: n8, fieldInfoMap: i4, globalAttributes: l5, expressionAttributes: a3, layer: r3, text: e10 }), description: D2({ attributes: n8, fieldInfoMap: i4, globalAttributes: l5, expressionAttributes: a3, layer: r3, text: t3 }) };
  }
  _createFieldsVMParams(e10, t3) {
    const i4 = this._effectivePopupTemplate, r3 = this.formattedAttributes, o2 = { ...r3 == null ? void 0 : r3.global, ...r3 == null ? void 0 : r3.content[t3] }, s9 = (e10 == null ? void 0 : e10.fieldInfos) || (i4 == null ? void 0 : i4.fieldInfos), n8 = s9 == null ? void 0 : s9.filter(({ fieldName: e11 }) => A2(e11) || de(e11) || o2.hasOwnProperty(e11)), a3 = i4 == null ? void 0 : i4.expressionInfos, { description: l5, title: p5 } = e10;
    return { attributes: o2, expressionInfos: a3, fieldInfos: n8, ...this._compileTitleAndDesc({ title: p5, description: l5 }) };
  }
  _compileFields(e10, t3) {
    const i4 = e10.clone(), r3 = new n5(this._createFieldsVMParams(e10, t3));
    return this.contentViewModels[t3] = r3, i4.fieldInfos = r3.formattedFieldInfos.slice(0), i4;
  }
  _createMediaVMParams(e10, t3) {
    const { abilities: i4, graphic: r3, _fieldInfoMap: o2, _effectivePopupTemplate: s9, relatedInfos: n8, _sourceLayer: a3, _expressionAttributes: l5 } = this, p5 = this.formattedAttributes, c10 = (r3 == null ? void 0 : r3.attributes) ?? {}, { description: d6, mediaInfos: u5, title: h6 } = e10;
    return { abilities: { chartAnimation: i4.chartAnimation }, activeMediaInfoIndex: e10.activeMediaInfoIndex || 0, attributes: c10, isAggregate: r3 == null ? void 0 : r3.isAggregate, layer: a3, fieldInfoMap: o2, formattedAttributes: { ...p5 == null ? void 0 : p5.global, ...p5 == null ? void 0 : p5.content[t3] }, expressionAttributes: l5, mediaInfos: u5, popupTemplate: s9, relatedInfos: n8, ...this._compileTitleAndDesc({ title: h6, description: d6 }) };
  }
  _compileMedia(e10, t3) {
    const i4 = e10.clone(), r3 = new M2(this._createMediaVMParams(e10, t3));
    return i4.mediaInfos = r3.formattedMediaInfos.slice(0), this.contentViewModels[t3] = r3, i4;
  }
  _createTextVMParams(e10) {
    var _a;
    const { graphic: t3, _fieldInfoMap: i4, _sourceLayer: r3, _expressionAttributes: o2 } = this;
    if (e10 && e10.text) {
      const s9 = (t3 == null ? void 0 : t3.attributes) ?? {}, n8 = ((_a = this.formattedAttributes) == null ? void 0 : _a.global) ?? {};
      e10.text = D2({ attributes: s9, fieldInfoMap: i4, globalAttributes: n8, expressionAttributes: o2, layer: r3, text: e10.text });
    }
    return { graphic: t3, creator: e10.text };
  }
  _compileText(e10, t3) {
    const i4 = e10.clone();
    return this.contentViewModels[t3] = new p2(this._createTextVMParams(i4)), i4;
  }
  _compileLastEditInfo() {
    const { _effectivePopupTemplate: e10, _sourceLayer: t3, graphic: i4, timeZone: r3 } = this;
    if (!e10)
      return;
    const { lastEditInfoEnabled: o2 } = e10, s9 = t3 == null ? void 0 : t3.editFieldsInfo;
    return o2 && s9 ? ne(s9, i4 == null ? void 0 : i4.attributes, r3, t3) : void 0;
  }
  _compileTitle(e10) {
    var _a;
    const { _fieldInfoMap: t3, _sourceLayer: i4, graphic: r3, _expressionAttributes: o2 } = this, s9 = (r3 == null ? void 0 : r3.attributes) ?? {}, n8 = ((_a = this.formattedAttributes) == null ? void 0 : _a.global) ?? {};
    return D2({ attributes: s9, fieldInfoMap: t3, globalAttributes: n8, expressionAttributes: o2, layer: i4, text: e10 });
  }
  async _getTitle() {
    const { _effectivePopupTemplate: e10, graphic: t3 } = this;
    return t3 ? v4({ type: "title", value: e10 == null ? void 0 : e10.title, event: { graphic: t3 } }) : null;
  }
  async _getContent() {
    const { _effectivePopupTemplate: e10, graphic: t3 } = this;
    return t3 ? v4({ type: "content", value: e10 == null ? void 0 : e10.content, event: { graphic: t3 } }) : null;
  }
  async _queryFeature(e10) {
    const { _featureAbortController: t3, _sourceLayer: i4, graphic: r3, _effectivePopupTemplate: o2 } = this, s9 = this.map, n8 = this.view, a3 = this.spatialReference, p5 = this.location;
    if (t3 !== this._featureAbortController || !r3)
      return;
    await ce({ graphic: r3, popupTemplate: o2, layer: i4, spatialReference: a3 }, e10);
    const { content: { value: c10 }, title: { value: d6 } } = await v({ content: this._getContent(), title: this._getTitle() }), { expressionAttributes: { value: u5 } } = await v({ checkForRelatedFeatures: this._checkForRelatedFeatures(e10), expressionAttributes: m5({ expressionInfos: o2 == null ? void 0 : o2.expressionInfos, spatialReference: a3, graphic: r3, map: s9, interceptor: G.interceptor, view: n8, options: e10, location: p5 }) });
    t3 === this._featureAbortController && r3 && (this._expressionAttributes = u5, this._graphicExpressionAttributes = { ...r3.attributes, ...u5 }, this._set("formattedAttributes", this._createFormattedAttributes(c10)), this._set("title", this._compileTitle(d6)), this._set("lastEditInfo", this._compileLastEditInfo() || null), this._set("content", this._compileContent(c10) || null));
  }
  _createMediaFormattedAttributes({ contentElement: e10, contentElementIndex: t3, formattedAttributes: i4 }) {
    const { _effectivePopupTemplate: r3, graphic: o2, relatedInfos: s9, _sourceLayer: n8, _fieldInfoMap: a3, _graphicExpressionAttributes: l5, timeZone: p5 } = this;
    i4.content[t3] = ue({ fieldInfos: r3 == null ? void 0 : r3.fieldInfos, graphic: o2, attributes: { ...l5, ...e10.attributes }, layer: n8, fieldInfoMap: a3, relatedInfos: s9, timeZone: p5 });
  }
  _createFieldsFormattedAttributes({ contentElement: e10, contentElementIndex: t3, formattedAttributes: i4 }) {
    if (e10.fieldInfos) {
      const { graphic: r3, relatedInfos: o2, _sourceLayer: s9, _fieldInfoMap: n8, _graphicExpressionAttributes: a3, timeZone: l5 } = this;
      i4.content[t3] = ue({ fieldInfos: e10.fieldInfos, graphic: r3, attributes: { ...a3, ...e10.attributes }, layer: s9, fieldInfoMap: n8, relatedInfos: o2, timeZone: l5 });
    }
  }
  _createFormattedAttributes(e10) {
    const { _effectivePopupTemplate: t3, graphic: i4, relatedInfos: r3, _sourceLayer: o2, _fieldInfoMap: s9, _graphicExpressionAttributes: n8, timeZone: a3 } = this, l5 = t3 == null ? void 0 : t3.fieldInfos, p5 = { global: ue({ fieldInfos: l5, graphic: i4, attributes: n8, layer: o2, fieldInfoMap: s9, relatedInfos: r3, timeZone: a3 }), content: [] };
    return Array.isArray(e10) && e10.forEach((e11, t4) => {
      "fields" === e11.type && this._createFieldsFormattedAttributes({ contentElement: e11, contentElementIndex: t4, formattedAttributes: p5 }), "media" === e11.type && this._createMediaFormattedAttributes({ contentElement: e11, contentElementIndex: t4, formattedAttributes: p5 });
    }), p5;
  }
  _checkForRelatedFeatures(e10) {
    const { graphic: t3, _effectivePopupTemplate: i4 } = this;
    return this._queryRelatedInfos(t3, ie(i4), e10);
  }
  async _queryRelatedInfos(e10, t3, i4) {
    const { relatedInfos: r3, _sourceLayer: o2 } = this;
    r3.clear();
    const s9 = null != (o2 == null ? void 0 : o2.associatedLayer) ? await (o2 == null ? void 0 : o2.associatedLayer.load(i4)) : o2;
    if (!s9 || !e10)
      return;
    const n8 = t3.filter((e11) => e11 && de(e11.fieldName));
    if (!(n8 == null ? void 0 : n8.length))
      return;
    t3.forEach((e11) => this._configureRelatedInfo(e11, s9));
    const a3 = await N({ relatedInfos: r3, layer: s9 }, i4);
    Object.keys(a3).forEach((e11) => {
      var _a;
      const t4 = r3.get(e11.toString()), i5 = (_a = a3[e11]) == null ? void 0 : _a.value;
      t4 && i5 && (t4.layerInfo = i5.data);
    });
    const l5 = await T({ graphic: e10, relatedInfos: r3, layer: s9 }, i4);
    Object.keys(l5).forEach((e11) => {
      var _a;
      I3((_a = l5[e11]) == null ? void 0 : _a.value, r3.get(e11.toString()));
    });
  }
  _configureRelatedInfo(e10, t3) {
    const { relatedInfos: i4 } = this, r3 = y3(e10.fieldName);
    if (!r3)
      return;
    const { layerId: o2, fieldName: s9 } = r3;
    if (!o2)
      return;
    const n8 = i4.get(o2.toString()) || F2(o2, t3);
    n8 && (q({ relatedInfo: n8, fieldName: s9, fieldInfo: e10 }), this.relatedInfos.set(o2, n8));
  }
};
X.interceptor = new e8(he, be), e([y()], X.prototype, "_error", void 0), e([y()], X.prototype, "_featureAbortController", void 0), e([y({ readOnly: true })], X.prototype, "_effectivePopupTemplate", null), e([y({ readOnly: true })], X.prototype, "_fieldInfoMap", null), e([y({ readOnly: true })], X.prototype, "_sourceLayer", null), e([y()], X.prototype, "abilities", void 0), e([s3("abilities")], X.prototype, "castAbilities", null), e([y({ readOnly: true })], X.prototype, "content", void 0), e([y({ readOnly: true })], X.prototype, "contentViewModels", void 0), e([y()], X.prototype, "description", void 0), e([y({ type: Boolean })], X.prototype, "defaultPopupTemplateEnabled", void 0), e([y({ readOnly: true })], X.prototype, "isTable", null), e([y({ readOnly: true })], X.prototype, "state", null), e([y({ readOnly: true })], X.prototype, "formattedAttributes", void 0), e([y({ type: f, value: null })], X.prototype, "graphic", null), e([y({ readOnly: true })], X.prototype, "lastEditInfo", void 0), e([y({ type: x })], X.prototype, "location", void 0), e([y({ readOnly: true })], X.prototype, "relatedInfos", void 0), e([y()], X.prototype, "spatialReference", null), e([y()], X.prototype, "timeZone", null), e([y({ readOnly: true })], X.prototype, "title", void 0), e([y()], X.prototype, "map", null), e([y({ readOnly: true })], X.prototype, "waitingForContent", null), e([y()], X.prototype, "view", void 0), X = G = e([a("esri.widgets.Feature.FeatureViewModel")], X);
var Y2 = X;

// node_modules/@arcgis/core/widgets/Feature/resources.js
var e9 = "esri-feature";
var t2 = { base: e9, container: `${e9}__size-container`, title: `${e9}__title`, main: `${e9}__main-container`, btn: `${e9}__button`, icon: `${e9}__icon`, content: `${e9}__content`, contentNode: `${e9}__content-node`, contentNodeText: `${e9}__content-node--text`, contentElement: `${e9}__content-element`, text: `${e9}__text`, lastEditedInfo: `${e9}__last-edited-info`, fields: `${e9}__fields`, fieldHeader: `${e9}__field-header`, fieldData: `${e9}__field-data`, fieldDataDate: `${e9}__field-data--date`, loadingSpinnerContainer: `${e9}__loading-container` };

// node_modules/@arcgis/core/widgets/Feature/support/FeatureContentMixin.js
var n7 = (n8) => {
  let i4 = class extends n8 {
    constructor() {
      super(...arguments), this.renderNodeContent = (e10) => e6(e10) && !e10.destroyed ? n2("div", { class: t2.contentNode, key: e10 }, e10.render()) : e10 instanceof HTMLElement ? n2("div", { afterCreate: this._attachToNode, bind: e10, class: t2.contentNode, key: e10 }) : t(e10) ? n2("div", { afterCreate: this._attachToNode, bind: e10.domNode, class: t2.contentNode, key: e10 }) : null;
    }
    _attachToNode(e10) {
      const o2 = this;
      e10.appendChild(o2);
    }
  };
  return i4 = e([a("esri.widgets.Feature.support.FeatureContentMixin")], i4), i4;
};

// node_modules/@arcgis/core/widgets/Feature.js
var b6;
var j3 = { title: true, content: true, lastEditedInfo: true };
var C3 = "relationship-handles";
var F4 = b6 = class extends n7(D) {
  constructor(e10, t3) {
    super(e10, t3), this._contentWidgets = [], this.flowItems = null, this.headingLevel = 2, this.messages = null, this.messagesCommon = null, this.visibleElements = { ...j3 }, this.viewModel = new Y2();
  }
  initialize() {
    this.addHandles(d(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.contentViewModels;
    }, () => this._setupContentWidgets(), P));
  }
  loadDependencies() {
    return r({ notice: () => import("./calcite-notice-Q2MN4Y4I.js"), loader: () => import("./calcite-loader-64JUXTQT.js") });
  }
  destroy() {
    this._destroyContentWidgets();
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(e10) {
    this.viewModel.graphic = e10;
  }
  get defaultPopupTemplateEnabled() {
    return this.viewModel.defaultPopupTemplateEnabled;
  }
  set defaultPopupTemplateEnabled(e10) {
    this.viewModel.defaultPopupTemplateEnabled = e10;
  }
  get isTable() {
    return this.viewModel.isTable;
  }
  get icon() {
    return "polygon";
  }
  set icon(e10) {
    this._overrideIfSome("icon", e10);
  }
  get label() {
    var _a;
    return ((_a = this.messages) == null ? void 0 : _a.widgetLabel) ?? "";
  }
  set label(e10) {
    this._overrideIfSome("label", e10);
  }
  get spatialReference() {
    return this.viewModel.spatialReference;
  }
  set spatialReference(e10) {
    this.viewModel.spatialReference = e10;
  }
  get timeZone() {
    return this.viewModel.timeZone;
  }
  set timeZone(e10) {
    this.viewModel.timeZone = e10;
  }
  get title() {
    return this.viewModel.title;
  }
  castVisibleElements(e10) {
    return { ...j3, ...e10 };
  }
  get map() {
    return this.viewModel.map;
  }
  set map(e10) {
    this.viewModel.map = e10;
  }
  get view() {
    return this.viewModel.view;
  }
  set view(e10) {
    this.viewModel.view = e10;
  }
  setActiveMedia(e10, t3) {
    return this.viewModel.setActiveMedia(e10, t3);
  }
  nextMedia(e10) {
    return this.viewModel.nextMedia(e10);
  }
  previousMedia(e10) {
    return this.viewModel.previousMedia(e10);
  }
  render() {
    const { state: e10 } = this.viewModel, t3 = n2("div", { class: t2.container, key: "container" }, this._renderTitle(), "error" === e10 ? this._renderError() : "loading" === e10 ? this._renderLoading() : this._renderContentContainer());
    return n2("div", { class: this.classes(t2.base, e4.widget) }, t3);
  }
  _renderError() {
    const { messagesCommon: e10, messages: t3, visibleElements: s9 } = this;
    return n2("calcite-notice", { icon: "exclamation-mark-circle", kind: "danger", open: true, scale: "s" }, s9.title ? n2("div", { key: "error-title", slot: "title" }, e10.errorMessage) : null, n2("div", { key: "error-message", slot: "message" }, t3.loadingError));
  }
  _renderLoading() {
    return n2("div", { class: t2.loadingSpinnerContainer, key: "loading-container" }, n2("calcite-loader", { inline: true, label: "" }));
  }
  _renderContentContainer() {
    const { visibleElements: e10 } = this;
    return e10.content ? n2("div", { class: t2.main }, [this._renderContent(), this._renderLastEditInfo()]) : null;
  }
  _renderTitle() {
    const { visibleElements: e10, title: t3 } = this;
    return e10.title ? n2(e5, { class: t2.title, innerHTML: t3, level: this.headingLevel }) : null;
  }
  _renderContent() {
    const e10 = this.viewModel.content, t3 = "content";
    if (!e10)
      return null;
    if (Array.isArray(e10))
      return e10.length ? n2("div", { class: t2.contentNode, key: `${t3}-content-elements` }, e10.map(this._renderContentElement, this)) : null;
    if ("string" == typeof e10) {
      const e11 = this._contentWidgets[0];
      return !e11 || e11.destroyed ? null : n2("div", { class: this.classes(t2.contentNode, t2.contentNodeText), key: `${t3}-content` }, e11.render());
    }
    return this.renderNodeContent(e10);
  }
  _renderContentElement(e10, t3) {
    var _a;
    const { visibleElements: s9 } = this;
    if ("boolean" != typeof s9.content && !((_a = s9.content) == null ? void 0 : _a[e10.type]))
      return null;
    switch (e10.type) {
      case "attachments":
        return this._renderAttachments(t3);
      case "custom":
        return this._renderCustom(e10, t3);
      case "fields":
        return this._renderFields(t3);
      case "media":
        return this._renderMedia(t3);
      case "text":
        return this._renderText(e10, t3);
      case "expression":
        return this._renderExpression(t3);
      case "relationship":
        return this._renderRelationship(t3);
      default:
        return null;
    }
  }
  _renderAttachments(e10) {
    const t3 = this._contentWidgets[e10];
    if (!t3 || t3.destroyed)
      return null;
    const { state: s9, attachmentInfos: i4 } = t3.viewModel;
    return "loading" === s9 || i4.length > 0 ? n2("div", { class: this.classes(t2.contentElement), key: this._buildKey("attachments-element", e10) }, t3.render()) : null;
  }
  _renderRelationship(e10) {
    const t3 = this._contentWidgets[e10];
    return t3 && !t3.destroyed && this.flowItems ? n2("div", { class: t2.contentElement, key: this._buildKey("relationship-element", e10) }, t3.render()) : null;
  }
  _renderExpression(e10) {
    const t3 = this._contentWidgets[e10];
    return !t3 || t3.destroyed ? null : n2("div", { class: t2.contentElement, key: this._buildKey("expression-element", e10) }, t3.render());
  }
  _renderCustom(e10, t3) {
    const { creator: s9 } = e10, i4 = this._contentWidgets[t3];
    return !i4 || i4.destroyed ? null : s9 ? n2("div", { class: t2.contentElement, key: this._buildKey("custom-element", t3) }, i4.render()) : null;
  }
  _renderFields(e10) {
    const t3 = this._contentWidgets[e10];
    return !t3 || t3.destroyed ? null : n2("div", { class: t2.contentElement, key: this._buildKey("fields-element", e10) }, t3.render());
  }
  _renderMedia(e10) {
    const t3 = this._contentWidgets[e10];
    return !t3 || t3.destroyed ? null : n2("div", { class: t2.contentElement, key: this._buildKey("media-element", e10) }, t3.render());
  }
  _renderLastEditInfo() {
    const { visibleElements: e10, messages: t3 } = this, { lastEditInfo: s9 } = this.viewModel;
    if (!s9 || !e10.lastEditedInfo)
      return null;
    const { date: i4, user: n8 } = s9, r3 = "edit" === s9.type ? n8 ? t3.lastEditedByUser : t3.lastEdited : n8 ? t3.lastCreatedByUser : t3.lastCreated, o2 = s4(r3, { date: i4, user: n8 });
    return n2("div", { class: this.classes(t2.lastEditedInfo, t2.contentElement), key: "edit-info-element" }, o2);
  }
  _renderText(e10, t3) {
    const s9 = e10.text, i4 = this._contentWidgets[t3];
    return !i4 || i4.destroyed ? null : s9 ? n2("div", { class: this.classes(t2.contentElement, t2.text), key: this._buildKey("text-element", t3) }, i4.render()) : null;
  }
  _buildKey(e10, ...t3) {
    var _a, _b;
    return `${e10}__${((_b = (_a = this.viewModel) == null ? void 0 : _a.graphic) == null ? void 0 : _b.uid) || "0"}-${t3.join("-")}`;
  }
  _destroyContentWidget(e10) {
    e10 && (e10.viewModel = null, !e10.destroyed && e10.destroy());
  }
  _destroyContentWidgets() {
    this.removeHandles(C3), this._contentWidgets.forEach((e10) => this._destroyContentWidget(e10)), this._contentWidgets = [];
  }
  _addFeatureRelationshipHandles(e10) {
    const { flowItems: t3, visibleElements: i4 } = this;
    this.addHandles([v2(() => e10, "select-record", ({ featureViewModel: e11 }) => {
      t3 && (e11.abilities = { relationshipContent: true }, t3.push(new b6({ flowItems: t3, viewModel: e11, visibleElements: i4 })));
    }), v2(() => e10, "show-all-records", () => {
      if (!t3)
        return;
      const { viewModel: s9 } = e10;
      s9.showAllEnabled = true;
      const i5 = new I6({ visibleElements: { title: false, description: false }, viewModel: s9 });
      this._addFeatureRelationshipHandles(i5), t3.push(i5);
    })], C3);
  }
  _setupContentWidgets() {
    var _a;
    this._destroyContentWidgets();
    const { headingLevel: e10, visibleElements: t3 } = this, s9 = (_a = this.viewModel) == null ? void 0 : _a.content, { contentViewModels: i4 } = this.viewModel;
    if (Array.isArray(s9))
      s9.forEach((s10, n8) => {
        if ("attachments" === s10.type && (this._contentWidgets[n8] = new c5({ displayType: s10.displayType, headingLevel: t3.title ? e10 + 1 : e10, viewModel: i4[n8] })), "fields" === s10.type && (this._contentWidgets[n8] = new h3({ viewModel: i4[n8] })), "media" === s10.type && (this._contentWidgets[n8] = new b4({ viewModel: i4[n8] })), "text" === s10.type && (this._contentWidgets[n8] = new p3({ viewModel: i4[n8] })), "custom" === s10.type && (this._contentWidgets[n8] = new p3({ viewModel: i4[n8] })), "expression" === s10.type && (this._contentWidgets[n8] = new h5({ viewModel: i4[n8] })), "relationship" === s10.type) {
          const e11 = new I6({ viewModel: i4[n8] });
          this._addFeatureRelationshipHandles(e11), this._contentWidgets[n8] = e11;
        }
      }, this);
    else {
      const e11 = i4[0];
      e11 && !e11.destroyed && (this._contentWidgets[0] = new p3({ viewModel: e11 }));
    }
    this.scheduleRender();
  }
};
e([y()], F4.prototype, "graphic", null), e([y()], F4.prototype, "defaultPopupTemplateEnabled", null), e([y()], F4.prototype, "flowItems", void 0), e([y()], F4.prototype, "headingLevel", void 0), e([y({ readOnly: true })], F4.prototype, "isTable", null), e([y()], F4.prototype, "icon", null), e([y()], F4.prototype, "label", null), e([y(), e2("esri/widgets/Feature/t9n/Feature")], F4.prototype, "messages", void 0), e([y(), e2("esri/t9n/common")], F4.prototype, "messagesCommon", void 0), e([y()], F4.prototype, "spatialReference", null), e([y()], F4.prototype, "timeZone", null), e([y({ readOnly: true })], F4.prototype, "title", null), e([y()], F4.prototype, "visibleElements", void 0), e([s3("visibleElements")], F4.prototype, "castVisibleElements", null), e([y()], F4.prototype, "map", null), e([y()], F4.prototype, "view", null), e([y({ type: Y2 })], F4.prototype, "viewModel", void 0), F4 = b6 = e([a("esri.widgets.Feature")], F4);
var W2 = F4;

export {
  Y2 as Y,
  t2 as t,
  n7 as n,
  W2 as W
};
//# sourceMappingURL=chunk-JMQDZBMG.js.map
