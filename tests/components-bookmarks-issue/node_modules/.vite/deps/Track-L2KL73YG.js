import {
  b as b2
} from "./chunk-3RDP2KYO.js";
import "./chunk-RIBUBPHP.js";
import "./chunk-IKON42NH.js";
import {
  e as e4
} from "./chunk-D5LHX57G.js";
import {
  i
} from "./chunk-WK2KEW7P.js";
import {
  e as e3
} from "./chunk-EAAEPSBY.js";
import "./chunk-5T2QNVDA.js";
import "./chunk-PCKG3UTS.js";
import "./chunk-QYC3GV65.js";
import "./chunk-ETHGDNE6.js";
import "./chunk-X2GCSX3A.js";
import "./chunk-I2X6UR6L.js";
import "./chunk-QX66UTIR.js";
import "./chunk-ZIJHDTB7.js";
import "./chunk-ZU6I4R6T.js";
import "./chunk-JI3AZJ7K.js";
import "./chunk-A5Q7MMP6.js";
import "./chunk-326OSIM5.js";
import "./chunk-R4CJB3GP.js";
import "./chunk-HTKSTTSR.js";
import "./chunk-6IED7TER.js";
import "./chunk-X7VSXJWW.js";
import "./chunk-VEODBKUJ.js";
import "./chunk-AG6JXA4M.js";
import "./chunk-B647DRFJ.js";
import "./chunk-PJNK3TLV.js";
import "./chunk-J7AMTUNG.js";
import "./chunk-G5EVVNIJ.js";
import "./chunk-HU5IGOTI.js";
import "./chunk-C24MEKSO.js";
import "./chunk-WDPG5BMO.js";
import "./chunk-TGXFDJCS.js";
import "./chunk-BOAEEYBE.js";
import "./chunk-VBUVOOM6.js";
import "./chunk-UMXV3EBO.js";
import "./chunk-ONK5AE7R.js";
import "./chunk-CZSTCON2.js";
import "./chunk-HV6S3GY2.js";
import "./chunk-IGR2BTWR.js";
import "./chunk-C7NPPGFR.js";
import "./chunk-ZPYA32PH.js";
import "./chunk-OCF7OAES.js";
import "./chunk-JZBR4X6W.js";
import "./chunk-OIJCMME5.js";
import "./chunk-4KLYOMH2.js";
import {
  D,
  e2,
  r
} from "./chunk-RGCWZ2KZ.js";
import {
  n
} from "./chunk-5VMSFOCB.js";
import "./chunk-LGQXPGTM.js";
import "./chunk-2SDMYJDE.js";
import "./chunk-TPLOIZC7.js";
import "./chunk-C62RZQQX.js";
import "./chunk-6Z6C6JVV.js";
import "./chunk-QLL2YG25.js";
import "./chunk-Z2PDA67N.js";
import "./chunk-IZKCZQUY.js";
import "./chunk-M5ZB5S5C.js";
import "./chunk-MBGZKT2Z.js";
import "./chunk-UWQ3OYA5.js";
import "./chunk-ORO4D3FB.js";
import "./chunk-YOPMY6TS.js";
import "./chunk-VIN55KNF.js";
import "./chunk-NIDZ6R4E.js";
import "./chunk-IOB3DJMR.js";
import "./chunk-BPRXWDBO.js";
import "./chunk-7MT4ACA4.js";
import "./chunk-RUN6MNXL.js";
import "./chunk-SAYWXQVM.js";
import "./chunk-SBL4URUW.js";
import "./chunk-Z4Y53NDM.js";
import "./chunk-PVUNFEWX.js";
import "./chunk-TXBMNSNF.js";
import "./chunk-BVQWKK2V.js";
import "./chunk-D25BO7X7.js";
import {
  y2 as y
} from "./chunk-NDIXNREV.js";
import {
  a3 as a
} from "./chunk-I2RC5KWA.js";
import "./chunk-SSFWZSUM.js";
import {
  e
} from "./chunk-2F6FFF5T.js";
import "./chunk-C26KUZ46.js";
import {
  b,
  d,
  k
} from "./chunk-JGDJR5EV.js";
import "./chunk-QHK5ZYFW.js";
import "./chunk-L65HKN25.js";
import "./chunk-7RBRCL6S.js";
import "./chunk-J2EGIWT6.js";
import "./chunk-MDRC3XUT.js";
import "./chunk-NCF6OYL5.js";
import "./chunk-Z4ZPL3B3.js";

// node_modules/@arcgis/core/widgets/Track/TrackViewModel.js
var n2 = 15e3;
var c = class extends b2 {
  constructor(t) {
    super(t), this._watchId = void 0, this._trackStartingTimeoutId = void 0, this._settingPosition = null, this._trackController = null, this.error = void 0, this.positionFilterFunction = null;
  }
  destroy() {
    this._stopTracking();
  }
  get state() {
    return this._geolocationUsable ? this.view && !this.view.ready ? "disabled" : this._settingPosition || void 0 !== this._trackStartingTimeoutId ? "waiting" : this.tracking ? "tracking" : null != this.error ? "error" : "ready" : "feature-unsupported";
  }
  get tracking() {
    return void 0 !== this._watchId;
  }
  start() {
    "disabled" !== this.state && "feature-unsupported" !== this.state && this._startTracking();
  }
  stop() {
    "disabled" !== this.state && "feature-unsupported" !== this.state && this._stopTracking();
  }
  _stopWatchingPosition() {
    void 0 !== this._watchId && (navigator.geolocation.clearWatch(this._watchId), this._watchId = void 0);
  }
  _stopTracking() {
    this._abortTrack(), this._clearWaitingTimer(), this._stopWatchingPosition(), this._clearGraphic();
  }
  _startTracking() {
    this._stopTracking();
    const t = k(async (t2) => {
      this._abortTrack();
      const i2 = new AbortController();
      this._trackController = i2;
      const { timestamp: o, coords: s } = t2, e5 = { timestamp: o, coords: { ...s } };
      this.error = void 0;
      try {
        if ("function" == typeof this.positionFilterFunction && !this.positionFilterFunction.call(null, { position: e5 }))
          return;
        if (await this.updatePosition(t2, i2), this._trackController !== i2)
          return;
        this._clearWaitingTimer(), this._addGraphic(), this.emit("track", { position: t2 }), this._trackController = null;
      } catch (a2) {
        if (b(a2))
          return;
        throw this._trackController = null, this._emitError(a2), this._clearWaitingTimer(), a2;
      }
    }, 0);
    this._watchId = navigator.geolocation.watchPosition((o) => {
      this._settingPosition = t(o).catch(d);
    }, this._handleWatchPositionError.bind(this), this.geolocationOptions ?? void 0), this._trackStartingTimeoutId = setTimeout(() => {
      this._trackStartingTimeoutId = void 0;
    }, n2);
  }
  _handleWatchPositionError(t) {
    t.code === t.PERMISSION_DENIED && this._stopTracking(), this._emitError(t);
  }
  _abortTrack() {
    var _a;
    (_a = this._trackController) == null ? void 0 : _a.abort(), this._trackController = null;
  }
  _clearWaitingTimer() {
    clearTimeout(this._trackStartingTimeoutId), this._trackStartingTimeoutId = void 0, this._settingPosition = null;
  }
  _emitError(t) {
    this.error = t, this.emit("track-error", { error: t });
  }
};
e([y()], c.prototype, "_watchId", void 0), e([y()], c.prototype, "_trackStartingTimeoutId", void 0), e([y()], c.prototype, "_settingPosition", void 0), e([y()], c.prototype, "error", void 0), e([y()], c.prototype, "positionFilterFunction", void 0), e([y({ readOnly: true })], c.prototype, "state", null), e([y({ readOnly: true })], c.prototype, "tracking", null), e([y()], c.prototype, "start", null), e([y()], c.prototype, "stop", null), c = e([a("esri.widgets.Track.TrackViewModel")], c);
var h = c;

// node_modules/@arcgis/core/widgets/Track.js
var d2 = { base: "esri-track" };
var g = "compass-north-circle";
var u = class extends D {
  constructor(o, e5) {
    super(o, e5), this.messages = null, this.viewModel = new h(), this._toggleTracking = () => {
      const o2 = this.viewModel;
      o2 && "feature-unsupported" !== o2.state && "disabled" !== o2.state && ("tracking" !== o2.state && "waiting" !== o2.state ? this.viewModel.start() : this.viewModel.stop());
    };
  }
  loadDependencies() {
    return r({ button: () => import("./calcite-button-V4T5NPWY.js"), tooltip: () => import("./calcite-tooltip-TDDUGVK4.js") });
  }
  get geolocationOptions() {
    return this.viewModel.geolocationOptions;
  }
  set geolocationOptions(o) {
    this.viewModel.geolocationOptions = o;
  }
  get goToLocationEnabled() {
    return this.viewModel.goToLocationEnabled;
  }
  set goToLocationEnabled(o) {
    this.viewModel.goToLocationEnabled = o;
  }
  get goToOverride() {
    return this.viewModel.goToOverride;
  }
  set goToOverride(o) {
    this.viewModel.goToOverride = o;
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(o) {
    this.viewModel.graphic = o;
  }
  get icon() {
    return "compass-north-circle";
  }
  set icon(o) {
    this._overrideIfSome("icon", o);
  }
  get label() {
    var _a;
    return ((_a = this.messages) == null ? void 0 : _a.widgetLabel) ?? "";
  }
  set label(o) {
    this._overrideIfSome("label", o);
  }
  get rotationEnabled() {
    return this.viewModel.rotationEnabled;
  }
  set rotationEnabled(o) {
    this.viewModel.rotationEnabled = o;
  }
  get scale() {
    return this.viewModel.scale;
  }
  set scale(o) {
    this.viewModel.scale = o;
  }
  get tracking() {
    return this.viewModel.tracking;
  }
  get view() {
    return this.viewModel.view;
  }
  set view(o) {
    this.viewModel.view = o;
  }
  start() {
    this.viewModel.start();
  }
  stop() {
    this.viewModel.stop();
  }
  render() {
    var _a;
    const { viewModel: o, messages: e5, icon: t } = this, i2 = o == null ? void 0 : o.state, r2 = "tracking" === i2, a2 = this._localizeError((_a = this.viewModel) == null ? void 0 : _a.error), l = (r2 ? e5 == null ? void 0 : e5.stopTracking : e5 == null ? void 0 : e5.startTracking) ?? "", p = "feature-unsupported" === i2, u2 = ("tracking" === i2 ? "pause" : void 0) ?? t, m2 = void 0 === i ? g : void 0;
    return n("div", { class: this.classes(d2.base, e3.widget) }, !p && n("calcite-button", { class: e3.widgetButton, disabled: "disabled" === i2, iconStart: u2 ?? m2, kind: "neutral", label: l, loading: "waiting" === i2, onclick: this._toggleTracking, title: l }), a2 ? n("calcite-tooltip", { open: true, overlayPositioning: "fixed", referenceElement: this.container }, a2) : null);
  }
  _localizeError(o) {
    var _a, _b, _c;
    return o instanceof GeolocationPositionError ? o.code === GeolocationPositionError.PERMISSION_DENIED ? (_a = this.messages) == null ? void 0 : _a.permissionError : o.code === GeolocationPositionError.TIMEOUT ? (_b = this.messages) == null ? void 0 : _b.timeoutError : (_c = this.messages) == null ? void 0 : _c.positionUnavailable : o instanceof Error ? o.message : void 0;
  }
};
e([y()], u.prototype, "geolocationOptions", null), e([y()], u.prototype, "goToLocationEnabled", null), e([y()], u.prototype, "goToOverride", null), e([y()], u.prototype, "graphic", null), e([y()], u.prototype, "icon", null), e([y()], u.prototype, "label", null), e([y(), e2("esri/widgets/Track/t9n/Track")], u.prototype, "messages", void 0), e([y()], u.prototype, "rotationEnabled", null), e([y()], u.prototype, "scale", null), e([y({ readOnly: true })], u.prototype, "tracking", null), e([y()], u.prototype, "view", null), e([y({ type: h }), e4(["track", "track-error"])], u.prototype, "viewModel", void 0), u = e([a("esri.widgets.Track")], u);
var m = u;
export {
  m as default
};
//# sourceMappingURL=Track-L2KL73YG.js.map
