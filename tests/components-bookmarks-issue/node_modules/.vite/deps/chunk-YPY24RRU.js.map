{
  "version": 3,
  "sources": ["../../@arcgis/core/support/basemapUtils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport e from\"../Basemap.js\";import r from\"../config.js\";import t from\"../core/Collection.js\";import n from\"../core/Logger.js\";import{destroyMaybe as a,mappedFind as i}from\"../core/maybe.js\";import{Url as l,makeAbsolute as s,normalize as u}from\"../core/urlUtils.js\";import{ensureType as c}from\"../core/accessorSupport/ensureType.js\";import{effectEquals as o}from\"../layers/effects/utils.js\";import{esriBasemapDefinitions as f}from\"./basemapDefinitions.js\";const p=()=>n.getLogger(\"esri.support.basemapUtils\");function y(){return{}}function m(e){for(const r in e){const t=e[r];a(t),delete e[r]}}function b(t,n){let a;if(\"string\"==typeof t){const i=t in f,l=!i&&t.includes(\"/\");if(!i&&!l){const e=Object.entries(f).filter((([e,t])=>r.apiKey&&!t.classic||!r.apiKey&&(t.classic||t.is3d))).map((([e])=>`\"${e}\"`)).sort().join(\", \");return p().warn(`Unable to find basemap definition for: ${t}. Try one of these: ${e}`),null}n&&(a=n[t]),a||(a=i?e.fromId(t):new e({style:{id:t}}),n&&(n[t]=a))}else a=c(e,t);return a?.destroyed&&(p().warn(\"The provided basemap is already destroyed\",{basemap:a}),a=null),a}function d(e){return\"Web Scene\"===e.portalItem?.type||e.referenceLayers.some((e=>\"scene\"===e.type))}function L(e){return!!e?.portalItem?.tags?.some((e=>\"beta\"===e.toLowerCase()))}function S(e,r){return e.basemap?.referenceLayers?.some((e=>e.uid===r))||e.basemap?.baseLayers?.some((e=>e.uid===r))}function v(e,r=null){const t=b(e);if(!t)return null;const n=t.clone();return r&&(n.baseLayers=T(n.baseLayers,r.baseLayers),n.referenceLayers=T(n.referenceLayers,r.referenceLayers)),n}let g;function h(e){if(g)return g(e);let r=null;const t=M(e),n=!t?.baseLayers.length;for(const a in f){const e=K(t,$(f[a]),{mustMatchReferences:n});if(\"equal\"===e){r=a;break}\"base-layers-equal\"===e&&(r=a)}return r}function I(e){g=e}function R(e,r){if(e===r)return!0;if(null!=e?.portalItem?.id&&e.portalItem.id===r?.portalItem?.id)return!0;return\"equal\"===K(M(e),M(r),{mustMatchReferences:!0})}function T(e,r){const n=new t;return e.forEach((e=>{const t=r.find((r=>\"scene\"!==r.type&&D(A(e),A(r))))||e;n.includes(t)?n.push(e):n.push(t)})),n}function w(e){return!!e?.baseLayers.concat(e.referenceLayers).some(j)}function j(e){if(x(e.url))return!0;if(\"vector-tile\"===e.type)for(const r in e.sourceNameToSource){const t=e.sourceNameToSource[r];if(x(t?.sourceUrl))return!0}return!1}function U(e,r){if(null==r||null==e)return{spatialReference:null,updating:!1};if(\"not-loaded\"===r.loadStatus)return r.load(),{spatialReference:null,updating:!0};if(r.spatialReference)return{spatialReference:r.spatialReference,updating:!1};if(0===r.baseLayers.length)return{spatialReference:null,updating:!1};const t=r.baseLayers.at(0);switch(t.loadStatus){case\"not-loaded\":t.load();case\"loading\":return{spatialReference:null,updating:!0};case\"failed\":return{spatialReference:null,updating:!1}}const n=((\"supportedSpatialReferences\"in t?t.supportedSpatialReferences:null)||[\"tileInfo\"in t?t.tileInfo?.spatialReference:t.spatialReference]).filter(Boolean),a=e.spatialReference;return a?{spatialReference:n.find((e=>a.equals(e)))??n[0]??null,updating:!1}:{spatialReference:n[0],updating:!1}}const q=/^(basemaps|ibasemaps).*-api\\.arcgis\\.com$/i;function x(e){if(!e)return!1;const r=new l(s(e));return!!r.authority&&q.test(r.authority)}function M(e){return e?!e.loaded&&e.resourceInfo?$(e.resourceInfo.data):{baseLayers:k(e.baseLayers),referenceLayers:k(e.referenceLayers)}:null}function k(e){return(t.isCollection(e)?e.toArray():e).map(A)}function A(e){return{type:e.type,effect:\"effect\"in e?e.effect:void 0,url:E(\"urlTemplate\"in e&&e.urlTemplate||e.url||\"styleUrl\"in e&&e.styleUrl||\"\"),minScale:\"minScale\"in e&&null!=e.minScale?e.minScale:0,maxScale:\"maxScale\"in e&&null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visible||!!e.visible,sublayers:\"map-image\"!==e.type&&\"wms\"!==e.type||null==e.sublayers?void 0:e.sublayers?.map((e=>({id:e.id,visible:e.visible}))),activeLayerId:\"wmts\"===e.type?e.activeLayer?.id:void 0}}function C(e){return e.isReference||\"ArcGISSceneServiceLayer\"===e.layerType}function $(e){return e?{baseLayers:G((e.baseMapLayers??[]).filter((e=>!C(e)))),referenceLayers:G((e.baseMapLayers??[]).filter((e=>C(e))))}:null}function G(e){return e.map((e=>B(e)))}function B(e){let r;switch(e.layerType){case\"VectorTileLayer\":r=\"vector-tile\";break;case\"ArcGISTiledMapServiceLayer\":r=\"tile\";break;case\"ArcGISSceneServiceLayer\":r=\"scene\";break;default:r=\"unknown\"}return{type:r,effect:e.effect,url:E(e.templateUrl||e.urlTemplate||e.styleUrl||e.url),minScale:e.minScale??0,maxScale:e.maxScale??0,opacity:e.opacity??1,visible:null==e.visibility||!!e.visibility,sublayers:void 0,activeLayerId:void 0}}function K(e,r,t){if(null!=e!=(null!=r))return\"not-equal\";if(!e||!r)return\"equal\";if(!N(e.baseLayers,r.baseLayers))return\"not-equal\";return N(e.referenceLayers,r.referenceLayers)?\"equal\":t.mustMatchReferences?\"not-equal\":\"base-layers-equal\"}function N(e,r){if(e.length!==r.length)return!1;for(let t=0;t<e.length;t++)if(!D(e[t],r[t]))return!1;return!0}function D(e,r){if(e.type!==r.type||e.url!==r.url||e.minScale!==r.minScale||e.maxScale!==r.maxScale||e.visible!==r.visible||e.opacity!==r.opacity)return!1;if(!o(e.effect,r.effect))return!1;if(null!=e.activeLayerId||null!=r.activeLayerId)return e.activeLayerId===r.activeLayerId;if(null!=e.sublayers||null!=r.sublayers){if(null==e.sublayers||null==r.sublayers||e.sublayers.length!==r.sublayers.length)return!1;for(let t=0;t<e.sublayers.length;t++){const n=e.sublayers.at(t),a=r.sublayers.at(t);if(n?.id!==a?.id||n?.visible!==a?.visible)return!1}}return!0}function E(e){return e?u(e).replace(/^\\s*https?:/i,\"\").toLowerCase():\"\"}function O(e){if(!e)return null;const{thumbnailUrl:r}=e;if(r)return r;const t=h(e);return t?f[t].thumbnailUrl:i(e.baseLayers,V)}function V(e){return\"portalItem\"in e?e.portalItem?.thumbnailUrl:void 0}export{v as clonePreservingTiledLayers,R as contentEquals,y as createCache,m as destroyCache,b as ensureType,U as findSpatialReference,O as getBasemapThumbnailUrl,h as getWellKnownBasemapId,w as hasDeveloperBasemapLayer,d as isBasemap3D,L as isBasemapInBeta,S as isBasemapLayer,j as isDeveloperBasemapLayer,I as overrideGetWellKnownBasemapId};\n"],
  "mappings": "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",
  "names": ["r", "n", "e", "t", "d", "K", "r", "K", "n", "e", "x", "V"]
}
