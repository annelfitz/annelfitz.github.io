{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/layers/ImageryLayerView3D.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{debounce as a}from\"../../../core/promiseUtils.js\";import{when as t}from\"../../../core/reactiveUtils.js\";import\"../../../core/Logger.js\";import\"../../../core/has.js\";import\"../../../core/RandomLCG.js\";import\"../../../core/Error.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import r from\"./DynamicLayerView3D.js\";import s from\"../../layers/ImageryLayerView.js\";let n=class extends(s(r)){constructor(){super(...arguments),this.type=\"imagery-3d\",this.redrawDebounced=a((async e=>{this.redraw(((e,a)=>this._redrawImage(e,a)),e)}),2e3)}initialize(){this.addHandles([t((()=>this.view.basemapTerrain.ready),(()=>this._initializeMaximumDataResolution()),{once:!0,initial:!0}),this.layer.on(\"redraw\",(()=>this._updatingHandles.addPromise(this.redrawDebounced())))]),this._updatingHandles.add((()=>this.layer?.exportImageServiceParameters?.version),(()=>{this._updatingHandles.addPromise(this.refreshDebounced())})),this._updatingHandles.add((()=>this.layer?.renderer),(()=>{this._updatingHandles.addPromise(this.refreshDebounced())})),this._updatingHandles.add((()=>this.timeExtent),(()=>this._updatingHandles.addPromise(this.refreshDebounced())))}_initializeMaximumDataResolution(){this.maximumDataResolution=this.layer.loaded?this.layer.serviceRasterInfo.pixelSize:null}getFetchOptions(){return{timeExtent:this.timeExtent}}async processResult(e,a,t){a.imageOrCanvasElement?e.image=a.imageOrCanvasElement:(e.image=document.createElement(\"canvas\"),e.pixelData=a.pixelData,await this._redrawImage(e,t))}async _redrawImage(e,a){if(!(e.image instanceof HTMLCanvasElement)||null==e.pixelData)throw new Error;const t=e.image,i=t.getContext(\"2d\"),r=await this.layer.applyRenderer(e.pixelData,{signal:a}),s=this.layer.applyFilter(r).pixelBlock;if(null==s)throw new Error;t.width=s.width,t.height=s.height;const n=i.createImageData(s.width,s.height);n.data.set(s.getAsRGBA()),i.putImageData(n,0,0)}};n=e([i(\"esri.views.3d.layers.ImageryLayerView3D\")],n);const o=n;export{o as default};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIsc,IAAI,IAAE,cAAc,EAAE,CAAC,EAAE;AAAA,EAAC,cAAa;AAAC,UAAM,GAAG,SAAS,GAAE,KAAK,OAAK,cAAa,KAAK,kBAAgB,EAAG,OAAMA,OAAG;AAAC,WAAK,OAAQ,CAACA,IAAEC,OAAI,KAAK,aAAaD,IAAEC,EAAC,GAAGD,EAAC;AAAA,IAAC,GAAG,GAAG;AAAA,EAAC;AAAA,EAAC,aAAY;AAAC,SAAK,WAAW,CAAC,EAAG,MAAI,KAAK,KAAK,eAAe,OAAQ,MAAI,KAAK,iCAAiC,GAAG,EAAC,MAAK,MAAG,SAAQ,KAAE,CAAC,GAAE,KAAK,MAAM,GAAG,UAAU,MAAI,KAAK,iBAAiB,WAAW,KAAK,gBAAgB,CAAC,CAAE,CAAC,CAAC,GAAE,KAAK,iBAAiB,IAAK,MAAE;AAJh3B;AAIk3B,8BAAK,UAAL,mBAAY,iCAAZ,mBAA0C;AAAA,OAAU,MAAI;AAAC,WAAK,iBAAiB,WAAW,KAAK,iBAAiB,CAAC;AAAA,IAAC,CAAE,GAAE,KAAK,iBAAiB,IAAK,MAAE;AAJrgC;AAIugC,wBAAK,UAAL,mBAAY;AAAA,OAAW,MAAI;AAAC,WAAK,iBAAiB,WAAW,KAAK,iBAAiB,CAAC;AAAA,IAAC,CAAE,GAAE,KAAK,iBAAiB,IAAK,MAAI,KAAK,YAAa,MAAI,KAAK,iBAAiB,WAAW,KAAK,iBAAiB,CAAC,CAAE;AAAA,EAAC;AAAA,EAAC,mCAAkC;AAAC,SAAK,wBAAsB,KAAK,MAAM,SAAO,KAAK,MAAM,kBAAkB,YAAU;AAAA,EAAI;AAAA,EAAC,kBAAiB;AAAC,WAAM,EAAC,YAAW,KAAK,WAAU;AAAA,EAAC;AAAA,EAAC,MAAM,cAAcA,IAAEC,IAAE,GAAE;AAAC,IAAAA,GAAE,uBAAqBD,GAAE,QAAMC,GAAE,wBAAsBD,GAAE,QAAM,SAAS,cAAc,QAAQ,GAAEA,GAAE,YAAUC,GAAE,WAAU,MAAM,KAAK,aAAaD,IAAE,CAAC;AAAA,EAAE;AAAA,EAAC,MAAM,aAAaA,IAAEC,IAAE;AAAC,QAAG,EAAED,GAAE,iBAAiB,sBAAoB,QAAMA,GAAE;AAAU,YAAM,IAAI;AAAM,UAAM,IAAEA,GAAE,OAAM,IAAE,EAAE,WAAW,IAAI,GAAE,IAAE,MAAM,KAAK,MAAM,cAAcA,GAAE,WAAU,EAAC,QAAOC,GAAC,CAAC,GAAE,IAAE,KAAK,MAAM,YAAY,CAAC,EAAE;AAAW,QAAG,QAAM;AAAE,YAAM,IAAI;AAAM,MAAE,QAAM,EAAE,OAAM,EAAE,SAAO,EAAE;AAAO,UAAMC,KAAE,EAAE,gBAAgB,EAAE,OAAM,EAAE,MAAM;AAAE,IAAAA,GAAE,KAAK,IAAI,EAAE,UAAU,CAAC,GAAE,EAAE,aAAaA,IAAE,GAAE,CAAC;AAAA,EAAC;AAAC;AAAE,IAAE,EAAE,CAAC,EAAE,yCAAyC,CAAC,GAAE,CAAC;AAAE,IAAM,IAAE;",
  "names": ["e", "a", "n"]
}
