{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/layers/support/PopupSceneLayerView.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Error.js\";import\"../../../../core/Logger.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import{subclass as r}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{unpackFieldNames as s,populateMissingFields as a}from\"../../../../layers/support/fieldUtils.js\";import{getFetchPopupTemplate as o,getRequiredFields as p}from\"../../../layers/support/popupUtils.js\";const i=i=>{let c=class extends i{_validateFetchPopupFeatures(e){const{layer:r}=this,{popupEnabled:s}=r;if(!s)throw new t(\"scenelayerview3d:fetchPopupFeatures\",\"Popups are disabled\",{layer:r});if(!o(r,e))throw new t(\"scenelayerview3d:fetchPopupFeatures\",\"Layer does not define a popup template\",{layer:r})}async prepareFetchPopupFeatures(e){}async fetchPopupFeaturesFromGraphics(e,t){if(this._validateFetchPopupFeatures(t),0===e.length)return[];const r=\"scene\"===this.layer.type&&null!=this.layer.associatedLayer?this.layer.associatedLayer:this.layer;let i=[];\"fieldsIndex\"in this.layer&&(i=s(this.layer.fieldsIndex,await p(r,o(this.layer,t)))),await this.prepareFetchPopupFeatures(i);const c=new Set,n=[],l=[];for(const s of e)a(i,s,c)?l.push(s):n.push(s);if(0===l.length)return n;const u=new Map;for(let s=0;s<e.length;s++)u.set(e[s].getObjectId()??0,s);const h=await this.whenGraphicAttributes(l,[...c]).catch((()=>l)).then((e=>n.concat(e)));return h.sort(((e,t)=>{const r=e.getObjectId()??0,s=u.get(r)??0,a=t.getObjectId()??0;return s-(u.get(a)??0)})),h}};return c=e([r(\"esri.views.3d.layers.support.PopupSceneLayerView\")],c),c};export{i as PopupSceneLayerView};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;AAIqe,IAAM,IAAE,CAAAA,OAAG;AAAC,MAAI,IAAE,cAAcA,GAAC;AAAA,IAAC,4BAA4BC,IAAE;AAAC,YAAK,EAAC,OAAM,EAAC,IAAE,MAAK,EAAC,cAAaC,GAAC,IAAE;AAAE,UAAG,CAACA;AAAE,cAAM,IAAI,EAAE,uCAAsC,uBAAsB,EAAC,OAAM,EAAC,CAAC;AAAE,UAAG,CAAC,EAAE,GAAED,EAAC;AAAE,cAAM,IAAI,EAAE,uCAAsC,0CAAyC,EAAC,OAAM,EAAC,CAAC;AAAA,IAAC;AAAA,IAAC,MAAM,0BAA0BA,IAAE;AAAA,IAAC;AAAA,IAAC,MAAM,+BAA+BA,IAAE,GAAE;AAAC,UAAG,KAAK,4BAA4B,CAAC,GAAE,MAAIA,GAAE;AAAO,eAAM,CAAC;AAAE,YAAM,IAAE,YAAU,KAAK,MAAM,QAAM,QAAM,KAAK,MAAM,kBAAgB,KAAK,MAAM,kBAAgB,KAAK;AAAM,UAAID,KAAE,CAAC;AAAE,uBAAgB,KAAK,UAAQA,KAAE,EAAE,KAAK,MAAM,aAAY,MAAM,EAAE,GAAE,EAAE,KAAK,OAAM,CAAC,CAAC,CAAC,IAAG,MAAM,KAAK,0BAA0BA,EAAC;AAAE,YAAMG,KAAE,oBAAI,OAAIC,KAAE,CAAC,GAAE,IAAE,CAAC;AAAE,iBAAUF,MAAKD;AAAE,WAAED,IAAEE,IAAEC,EAAC,IAAE,EAAE,KAAKD,EAAC,IAAEE,GAAE,KAAKF,EAAC;AAAE,UAAG,MAAI,EAAE;AAAO,eAAOE;AAAE,YAAM,IAAE,oBAAI;AAAI,eAAQF,KAAE,GAAEA,KAAED,GAAE,QAAOC;AAAI,UAAE,IAAID,GAAEC,EAAC,EAAE,YAAY,KAAG,GAAEA,EAAC;AAAE,YAAM,IAAE,MAAM,KAAK,sBAAsB,GAAE,CAAC,GAAGC,EAAC,CAAC,EAAE,MAAO,MAAI,CAAE,EAAE,KAAM,CAAAF,OAAGG,GAAE,OAAOH,EAAC,CAAE;AAAE,aAAO,EAAE,KAAM,CAACA,IAAEI,OAAI;AAAC,cAAMC,KAAEL,GAAE,YAAY,KAAG,GAAEC,KAAE,EAAE,IAAII,EAAC,KAAG,GAAEC,KAAEF,GAAE,YAAY,KAAG;AAAE,eAAOH,MAAG,EAAE,IAAIK,EAAC,KAAG;AAAA,MAAE,CAAE,GAAE;AAAA,IAAC;AAAA,EAAC;AAAE,SAAO,IAAE,EAAE,CAAC,EAAE,kDAAkD,CAAC,GAAE,CAAC,GAAE;AAAC;",
  "names": ["i", "e", "s", "c", "n", "t", "r", "a"]
}
