{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js", "../../@arcgis/core/chunks/ShadedColorMaterial.glsl.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{addCameraPosition as e}from\"./util/View.glsl.js\";import{FloatPassUniform as i}from\"../shaderModules/FloatPassUniform.js\";import{glsl as r}from\"../shaderModules/interfaces.js\";function o(o,c){if(!c.screenSizeEnabled)return;const n=o.vertex;e(n,c),n.uniforms.add(new i(\"perScreenPixelRatio\",((e,i)=>i.camera.perScreenPixelRatio)),new i(\"screenSizeScale\",(e=>e.screenSizeScale))),n.code.add(r`float computeRenderPixelSizeAt( vec3 pWorld ){\nvec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\nfloat viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));\nreturn viewDirectionDistance * perScreenPixelRatio;\n}\nvec3 screenSizeScaling(vec3 position, vec3 anchor){\nreturn position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;\n}`)}export{o as ScreenSizeScaling};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{create as e}from\"../core/libs/gl-matrix-2/factories/vec4f64.js\";import{ScreenSizeScaling as o}from\"../views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js\";import{ShaderOutput as r}from\"../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js\";import{SliceDraw as i}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as a}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{multipassTerrainTest as l}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{symbolAlphaCutoff as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaCutoff.js\";import{ColorConversion as n}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{addProjViewLocalOrigin as s,addViewNormal as t}from\"../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js\";import{Float3PassUniform as c}from\"../views/3d/webgl-engine/core/shaderModules/Float3PassUniform.js\";import{Float4PassUniform as g}from\"../views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js\";import{glsl as m}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as v}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{TransparencyPassType as f}from\"../views/3d/webgl-engine/lib/TransparencyPassType.js\";import{VertexAttribute as u}from\"../views/3d/webgl-engine/lib/VertexAttribute.js\";function p(e){const p=new v,b=e.multipassEnabled&&(e.output===r.Color||e.output===r.Alpha);p.include(a,e),p.include(o,e),p.include(i,e);const{vertex:h,fragment:C}=p;return C.include(n),s(h,e),C.uniforms.add(new g(\"uColor\",(e=>e.color))),p.attributes.add(u.POSITION,\"vec3\"),p.varyings.add(\"vWorldPosition\",\"vec3\"),b&&p.varyings.add(\"depth\",\"float\"),e.screenSizeEnabled&&p.attributes.add(u.OFFSET,\"vec3\"),e.shadingEnabled&&(t(h),p.attributes.add(u.NORMAL,\"vec3\"),p.varyings.add(\"vViewNormal\",\"vec3\")),h.code.add(m`\n    void main(void) {\n      vWorldPosition = ${e.screenSizeEnabled?\"screenSizeScaling(offset, position)\":\"position\"};\n  `),e.shadingEnabled&&h.code.add(m`vec3 worldNormal = normal;\nvViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),h.code.add(m`\n    ${b?\"depth = (view * vec4(vWorldPosition, 1.0)).z;\":\"\"}\n    gl_Position = transformPosition(proj, view, vWorldPosition);\n  }\n  `),b&&p.include(l,e),C.code.add(m`\n    void main() {\n      discardBySlice(vWorldPosition);\n      ${b?\"terrainDepthTest(depth);\":\"\"}\n    `),e.shadingEnabled?(C.uniforms.add(new c(\"shadingDirection\",(e=>e.shadingDirection))),C.uniforms.add(new g(\"shadedColor\",(e=>w(e.shadingTint,e.color)))),C.code.add(m`vec3 viewNormalNorm = normalize(vViewNormal);\nfloat shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\nvec4 finalColor = mix(uColor, shadedColor, shadingFactor);`)):C.code.add(m`vec4 finalColor = uColor;`),C.code.add(m`\n      ${e.output===r.ObjectAndLayerIdColor?m`finalColor.a = 1.0;`:\"\"}\n      if (finalColor.a < ${m.float(d)}) {\n        discard;\n      }\n      ${e.output===r.Alpha?m`fragColor = vec4(finalColor.a);`:\"\"}\n\n      ${e.output===r.Color?m`fragColor = highlightSlice(finalColor, vWorldPosition); ${e.transparencyPassType===f.Color?\"fragColor = premultiplyAlpha(fragColor);\":\"\"}`:\"\"}\n    }\n    `),p}function w(e,o){const r=1-e[3],i=e[3]+o[3]*r;return 0===i?(b[3]=i,b):(b[0]=(e[0]*e[3]+o[0]*o[3]*r)/i,b[1]=(e[1]*e[3]+o[1]*o[3]*r)/i,b[2]=(e[2]*e[3]+o[2]*o[3]*r)/i,b[3]=o[3],b)}const b=e(),h=Object.freeze(Object.defineProperty({__proto__:null,build:p},Symbol.toStringTag,{value:\"Module\"}));export{h as S,p as b};\n"],
  "mappings": "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",
  "names": ["o", "n", "e", "p", "e", "o", "b", "h"]
}
