{
  "version": 3,
  "sources": ["../../@arcgis/core/widgets/Track/TrackViewModel.js", "../../@arcgis/core/widgets/Track.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import{ignoreAbortErrors as i,debounce as o,isAbortError as r}from\"../../core/promiseUtils.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as e}from\"../../core/accessorSupport/decorators/subclass.js\";import a from\"../support/GeolocationPositioning.js\";const n=15e3;let c=class extends a{constructor(t){super(t),this._watchId=void 0,this._trackStartingTimeoutId=void 0,this._settingPosition=null,this._trackController=null,this.error=void 0,this.positionFilterFunction=null}destroy(){this._stopTracking()}get state(){return this._geolocationUsable?this.view&&!this.view.ready?\"disabled\":this._settingPosition||void 0!==this._trackStartingTimeoutId?\"waiting\":this.tracking?\"tracking\":null!=this.error?\"error\":\"ready\":\"feature-unsupported\"}get tracking(){return void 0!==this._watchId}start(){\"disabled\"!==this.state&&\"feature-unsupported\"!==this.state&&this._startTracking()}stop(){\"disabled\"!==this.state&&\"feature-unsupported\"!==this.state&&this._stopTracking()}_stopWatchingPosition(){void 0!==this._watchId&&(navigator.geolocation.clearWatch(this._watchId),this._watchId=void 0)}_stopTracking(){this._abortTrack(),this._clearWaitingTimer(),this._stopWatchingPosition(),this._clearGraphic()}_startTracking(){this._stopTracking();const t=o((async t=>{this._abortTrack();const i=new AbortController;this._trackController=i;const{timestamp:o,coords:s}=t,e={timestamp:o,coords:{...s}};this.error=void 0;try{if(\"function\"==typeof this.positionFilterFunction&&!this.positionFilterFunction.call(null,{position:e}))return;if(await this.updatePosition(t,i),this._trackController!==i)return;this._clearWaitingTimer(),this._addGraphic(),this.emit(\"track\",{position:t}),this._trackController=null}catch(a){if(r(a))return;throw this._trackController=null,this._emitError(a),this._clearWaitingTimer(),a}}),0);this._watchId=navigator.geolocation.watchPosition((o=>{this._settingPosition=t(o).catch(i)}),this._handleWatchPositionError.bind(this),this.geolocationOptions??void 0),this._trackStartingTimeoutId=setTimeout((()=>{this._trackStartingTimeoutId=void 0}),n)}_handleWatchPositionError(t){t.code===t.PERMISSION_DENIED&&this._stopTracking(),this._emitError(t)}_abortTrack(){this._trackController?.abort(),this._trackController=null}_clearWaitingTimer(){clearTimeout(this._trackStartingTimeoutId),this._trackStartingTimeoutId=void 0,this._settingPosition=null}_emitError(t){this.error=t,this.emit(\"track-error\",{error:t})}};t([s()],c.prototype,\"_watchId\",void 0),t([s()],c.prototype,\"_trackStartingTimeoutId\",void 0),t([s()],c.prototype,\"_settingPosition\",void 0),t([s()],c.prototype,\"error\",void 0),t([s()],c.prototype,\"positionFilterFunction\",void 0),t([s({readOnly:!0})],c.prototype,\"state\",null),t([s({readOnly:!0})],c.prototype,\"tracking\",null),t([s()],c.prototype,\"start\",null),t([s()],c.prototype,\"stop\",null),c=t([e(\"esri.widgets.Track.TrackViewModel\")],c);const h=c;export{h as default};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../chunks/tslib.es6.js\";import{property as e}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import\"../core/Logger.js\";import\"../core/RandomLCG.js\";import{subclass as t}from\"../core/accessorSupport/decorators/subclass.js\";import i from\"./Widget.js\";import{loadCalciteComponents as r}from\"./support/componentsUtils.js\";import{globalCss as s}from\"./support/globalCss.js\";import{legacyIcon as n}from\"./support/legacyIcon.js\";import\"./support/widgetUtils.js\";import{messageBundle as a}from\"./support/decorators/messageBundle.js\";import{vmEvent as l}from\"./support/decorators/vmEvent.js\";import{tsx as c}from\"./support/jsxFactory.js\";import p from\"./Track/TrackViewModel.js\";const d={base:\"esri-track\"},g=\"compass-north-circle\";let u=class extends i{constructor(o,e){super(o,e),this.messages=null,this.viewModel=new p,this._toggleTracking=()=>{const o=this.viewModel;o&&\"feature-unsupported\"!==o.state&&\"disabled\"!==o.state&&(\"tracking\"!==o.state&&\"waiting\"!==o.state?this.viewModel.start():this.viewModel.stop())}}loadDependencies(){return r({button:()=>import(\"@esri/calcite-components/dist/components/calcite-button.js\"),tooltip:()=>import(\"@esri/calcite-components/dist/components/calcite-tooltip.js\")})}get geolocationOptions(){return this.viewModel.geolocationOptions}set geolocationOptions(o){this.viewModel.geolocationOptions=o}get goToLocationEnabled(){return this.viewModel.goToLocationEnabled}set goToLocationEnabled(o){this.viewModel.goToLocationEnabled=o}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(o){this.viewModel.goToOverride=o}get graphic(){return this.viewModel.graphic}set graphic(o){this.viewModel.graphic=o}get icon(){return\"compass-north-circle\"}set icon(o){this._overrideIfSome(\"icon\",o)}get label(){return this.messages?.widgetLabel??\"\"}set label(o){this._overrideIfSome(\"label\",o)}get rotationEnabled(){return this.viewModel.rotationEnabled}set rotationEnabled(o){this.viewModel.rotationEnabled=o}get scale(){return this.viewModel.scale}set scale(o){this.viewModel.scale=o}get tracking(){return this.viewModel.tracking}get view(){return this.viewModel.view}set view(o){this.viewModel.view=o}start(){this.viewModel.start()}stop(){this.viewModel.stop()}render(){const{viewModel:o,messages:e,icon:t}=this,i=o?.state,r=\"tracking\"===i,a=this._localizeError(this.viewModel?.error),l=(r?e?.stopTracking:e?.startTracking)??\"\",p=\"feature-unsupported\"===i,u=(\"tracking\"===i?\"pause\":void 0)??t,m=void 0===n?g:void 0;return c(\"div\",{class:this.classes(d.base,s.widget)},!p&&c(\"calcite-button\",{class:s.widgetButton,disabled:\"disabled\"===i,iconStart:u??m,kind:\"neutral\",label:l,loading:\"waiting\"===i,onclick:this._toggleTracking,title:l}),a?c(\"calcite-tooltip\",{open:!0,overlayPositioning:\"fixed\",referenceElement:this.container},a):null)}_localizeError(o){return o instanceof GeolocationPositionError?o.code===GeolocationPositionError.PERMISSION_DENIED?this.messages?.permissionError:o.code===GeolocationPositionError.TIMEOUT?this.messages?.timeoutError:this.messages?.positionUnavailable:o instanceof Error?o.message:void 0}};o([e()],u.prototype,\"geolocationOptions\",null),o([e()],u.prototype,\"goToLocationEnabled\",null),o([e()],u.prototype,\"goToOverride\",null),o([e()],u.prototype,\"graphic\",null),o([e()],u.prototype,\"icon\",null),o([e()],u.prototype,\"label\",null),o([e(),a(\"esri/widgets/Track/t9n/Track\")],u.prototype,\"messages\",void 0),o([e()],u.prototype,\"rotationEnabled\",null),o([e()],u.prototype,\"scale\",null),o([e({readOnly:!0})],u.prototype,\"tracking\",null),o([e()],u.prototype,\"view\",null),o([e({type:p}),l([\"track\",\"track-error\"])],u.prototype,\"viewModel\",void 0),u=o([t(\"esri.widgets.Track\")],u);const m=u;export{m as default};\n"],
  "mappings": "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",
  "names": ["n", "b", "t", "i", "e", "a", "d", "e", "o", "i", "r", "a", "u", "m"]
}
