{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{Float3PassUniform as e}from\"../../shaderModules/Float3PassUniform.js\";import{Float4sPassUniform as o}from\"../../shaderModules/Float4sPassUniform.js\";import{FloatsPassUniform as r}from\"../../shaderModules/FloatsPassUniform.js\";import{glsl as v}from\"../../shaderModules/interfaces.js\";import{Matrix3PassUniform as t}from\"../../shaderModules/Matrix3PassUniform.js\";import{VertexAttribute as a}from\"../../../lib/VertexAttribute.js\";import{vvColorNumber as i}from\"../../../materials/VisualVariablePassParameters.js\";function l(l,n){const{vertex:s,attributes:u}=l;n.hasVvInstancing&&(n.vvSize||n.vvColor)&&u.add(a.INSTANCEFEATUREATTRIBUTE,\"vec4\"),n.vvSize?(s.uniforms.add(new e(\"vvSizeMinSize\",(e=>e.vvSize.minSize))),s.uniforms.add(new e(\"vvSizeMaxSize\",(e=>e.vvSize.maxSize))),s.uniforms.add(new e(\"vvSizeOffset\",(e=>e.vvSize.offset))),s.uniforms.add(new e(\"vvSizeFactor\",(e=>e.vvSize.factor))),s.uniforms.add(new t(\"vvSymbolRotationMatrix\",(e=>e.vvSymbolRotationMatrix))),s.uniforms.add(new e(\"vvSymbolAnchor\",(e=>e.vvSymbolAnchor))),s.code.add(v`vec3 vvScale(vec4 _featureAttribute) {\nreturn clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n}\nvec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\nreturn vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n}`),s.code.add(v`\n      const float eps = 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ${n.hasVvInstancing?v`\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }`:\"\"}\n    `)):s.code.add(v`vec4 localPosition() { return vec4(position, 1.0); }\nvec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }`),n.vvColor?(s.constants.add(\"vvColorNumber\",\"int\",i),s.uniforms.add(new r(\"vvColorValues\",(e=>e.vvColor.values),i),new o(\"vvColorColors\",(e=>e.vvColor.colors),i)),s.code.add(v`\n      vec4 interpolateVVColor(float value) {\n        if (value <= vvColorValues[0]) {\n          return vvColorColors[0];\n        }\n\n        for (int i = 1; i < vvColorNumber; ++i) {\n          if (vvColorValues[i] >= value) {\n            float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\n            return mix(vvColorColors[i-1], vvColorColors[i], f);\n          }\n        }\n        return vvColorColors[vvColorNumber - 1];\n      }\n\n      vec4 vvGetColor(vec4 featureAttribute) {\n        return interpolateVVColor(featureAttribute.y);\n      }\n\n      ${n.hasVvInstancing?v`\n            vec4 vvColor() {\n              return vvGetColor(instanceFeatureAttribute);\n            }`:\"vec4 vvColor() { return vec4(1.0); }\"}\n    `)):s.code.add(v`vec4 vvColor() { return vec4(1.0); }`)}export{l as VisualVariables};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;AAIsgB,SAAS,EAAEA,IAAE,GAAE;AAAC,QAAK,EAAC,QAAO,GAAE,YAAW,EAAC,IAAEA;AAAE,IAAE,oBAAkB,EAAE,UAAQ,EAAE,YAAU,EAAE,IAAI,EAAE,0BAAyB,MAAM,GAAE,EAAE,UAAQ,EAAE,SAAS,IAAI,IAAIC,GAAE,iBAAiB,CAAAA,OAAGA,GAAE,OAAO,OAAQ,CAAC,GAAE,EAAE,SAAS,IAAI,IAAIA,GAAE,iBAAiB,CAAAA,OAAGA,GAAE,OAAO,OAAQ,CAAC,GAAE,EAAE,SAAS,IAAI,IAAIA,GAAE,gBAAgB,CAAAA,OAAGA,GAAE,OAAO,MAAO,CAAC,GAAE,EAAE,SAAS,IAAI,IAAIA,GAAE,gBAAgB,CAAAA,OAAGA,GAAE,OAAO,MAAO,CAAC,GAAE,EAAE,SAAS,IAAI,IAAIA,GAAE,0BAA0B,CAAAA,OAAGA,GAAE,sBAAuB,CAAC,GAAE,EAAE,SAAS,IAAI,IAAIA,GAAE,kBAAkB,CAAAA,OAAGA,GAAE,cAAe,CAAC,GAAE,EAAE,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,EAKvhC,GAAE,EAAE,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOP,EAAE,kBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAOjB,EAAE;AAAA,KACN,KAAG,EAAE,KAAK,IAAI;AAAA,gEAC6C,GAAE,EAAE,WAAS,EAAE,UAAU,IAAI,iBAAgB,OAAMA,EAAC,GAAE,EAAE,SAAS,IAAI,IAAIC,GAAE,iBAAiB,CAAAD,OAAGA,GAAE,QAAQ,QAAQA,EAAC,GAAE,IAAIA,GAAE,iBAAiB,CAAAA,OAAGA,GAAE,QAAQ,QAAQA,EAAC,CAAC,GAAE,EAAE,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAmBvO,EAAE,kBAAgB;AAAA;AAAA;AAAA,iBAGX,sCAAsC;AAAA,KAChD,KAAG,EAAE,KAAK,IAAI,uCAAuC;AAAC;",
  "names": ["l", "e", "o"]
}
