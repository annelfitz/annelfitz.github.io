{
  "version": 3,
  "sources": ["../../@arcgis/core/portal/support/resourceUtils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport e from\"../../request.js\";import t from\"../../core/Error.js\";import{join as r,getPathExtension as s}from\"../../core/urlUtils.js\";async function o(e,t={},s){await e.load(s);const o=r(e.itemUrl,\"resources\"),{start:a=1,num:n=10,sortOrder:c=\"asc\",sortField:l=\"resource\"}=t,i={query:{start:a,num:n,sortOrder:c,sortField:l,token:e.apiKey},signal:s?.signal},u=await e.portal.request(o,i);return{total:u.total,nextStart:u.nextStart,resources:u.resources.map((({created:t,size:r,resource:s})=>({created:new Date(t),size:r,resource:e.resourceFromPath(s)})))}}async function a(e,s,o,a){const n=new Map;for(const{resource:r,content:i,compress:u,access:p}of s){if(!r.hasPath())throw new t(`portal-item-resource-${o}:invalid-path`,\"Resource does not have a valid path\");const[e,s]=l(r.path),a=`${e}/${u??\"\"}/${p??\"\"}`;n.has(a)||n.set(a,{prefix:e,compress:u,access:p,files:[]});n.get(a).files.push({fileName:s,content:i})}await e.load(a);const c=r(e.userItemUrl,\"add\"===o?\"addResources\":\"updateResources\");for(const{prefix:t,compress:r,access:l,files:i}of n.values()){const s=25;for(let o=0;o<i.length;o+=s){const n=i.slice(o,o+s),u=new FormData;t&&\".\"!==t&&u.append(\"resourcesPrefix\",t),r&&u.append(\"compress\",\"true\"),l&&u.append(\"access\",l);let p=0;for(const{fileName:e,content:t}of n)u.append(\"file\"+ ++p,t,e);u.append(\"f\",\"json\"),await e.portal.request(c,{method:\"post\",body:u,signal:a?.signal})}}}async function n(e,s,o){if(!s.hasPath())throw new t(\"portal-item-resources-remove:invalid-path\",\"Resource does not have a valid path\");await e.load(o);const a=r(e.userItemUrl,\"removeResources\");await e.portal.request(a,{method:\"post\",query:{resource:s.path},signal:o?.signal}),s.portalItem=null}async function c(e,t){await e.load(t);const s=r(e.userItemUrl,\"removeResources\");return e.portal.request(s,{method:\"post\",query:{deleteAll:!0},signal:t?.signal})}function l(e){const t=e.lastIndexOf(\"/\");return-1===t?[\".\",e]:[e.slice(0,t),e.slice(t+1)]}function i(e){const[t,r]=u(e),[s,o]=l(t);return[s,o,r]}function u(e){const t=s(e);return null==t?[e,\"\"]:[e.slice(0,e.length-t.length-1),`.${t}`]}async function p(t){if(\"blob\"===t.type)return t.blob;if(\"json\"===t.type)return new Blob([t.jsonString],{type:\"application/json\"});return(await e(t.url,{responseType:\"blob\"})).data}function f(e,t){if(!e.hasPath())return null;const[s,,o]=i(e.path);return e.portalItem.resourceFromPath(r(s,t+o))}function m(e,t){if(!e.hasPath())return null;const[s,,o]=i(e.path);return e.portalItem.resourceFromPath(r(s,t+o))}export{a as addOrUpdateResources,p as contentToBlob,o as fetchResources,f as getSiblingOfSameType,m as getSiblingOfSameTypeI,c as removeAllResources,n as removeResource,i as splitPrefixFileNameAndExtension};\n"],
  "mappings": "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",
  "names": ["s", "o", "a", "n", "c", "l", "i", "u", "t", "p", "e"]
}
