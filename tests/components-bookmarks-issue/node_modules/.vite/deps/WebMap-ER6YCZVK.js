import {
  n2 as n6
} from "./chunk-IHPJVVBQ.js";
import {
  f as f5
} from "./chunk-GR36ZHR3.js";
import {
  T
} from "./chunk-6N3VNDLJ.js";
import "./chunk-FDNEUO76.js";
import {
  i as i2,
  i2 as i3,
  l as l2
} from "./chunk-7UWJ5WTY.js";
import "./chunk-LRSI5HZ3.js";
import "./chunk-NUS62V7H.js";
import "./chunk-P6IY7ZIQ.js";
import "./chunk-6EZXOD6N.js";
import "./chunk-T522M7RE.js";
import "./chunk-M7V6LN55.js";
import {
  m as m2
} from "./chunk-BQ5JBA3I.js";
import {
  L
} from "./chunk-QHWIMHBR.js";
import "./chunk-7PVGO24P.js";
import "./chunk-EL74TSJT.js";
import {
  l
} from "./chunk-BSYULFZQ.js";
import {
  n as n5,
  p
} from "./chunk-5T2QNVDA.js";
import "./chunk-YKIGDW5O.js";
import "./chunk-YPY24RRU.js";
import "./chunk-O7RKI2QW.js";
import "./chunk-EWD7I5UU.js";
import "./chunk-4UEJR4VO.js";
import "./chunk-BUEJAM23.js";
import "./chunk-LQR76D5M.js";
import "./chunk-2CWW7O7M.js";
import "./chunk-Q5NCQLSM.js";
import "./chunk-FLBJ53KN.js";
import "./chunk-YH2IYJYF.js";
import "./chunk-GGHKH3LP.js";
import "./chunk-VS6AHHIY.js";
import "./chunk-DIT542IP.js";
import "./chunk-HFYOMP47.js";
import "./chunk-TOKUWZQG.js";
import "./chunk-JNGJWHJD.js";
import "./chunk-QMPD4WXY.js";
import "./chunk-OF4YIONV.js";
import "./chunk-YBPOKK6D.js";
import "./chunk-AHEDDTVZ.js";
import "./chunk-Z4ALW6LX.js";
import "./chunk-H4O73SDK.js";
import "./chunk-UVXSAP7V.js";
import "./chunk-IZ3VJLQ6.js";
import "./chunk-DRC4XSYG.js";
import "./chunk-IHQNQQJC.js";
import "./chunk-4IKPTZ53.js";
import "./chunk-DXMBDX2I.js";
import "./chunk-TUVEYM7U.js";
import "./chunk-5S637BGW.js";
import "./chunk-BFOJPIF7.js";
import "./chunk-7UUNSIMA.js";
import "./chunk-GMRQGGML.js";
import "./chunk-BYK4ZOU2.js";
import "./chunk-OHYLFFUW.js";
import "./chunk-XW3FDKYP.js";
import "./chunk-Y7RXGLGH.js";
import "./chunk-3JC3OUNW.js";
import "./chunk-RO3CTAP7.js";
import "./chunk-GKMVTGGM.js";
import "./chunk-XGTCDM4C.js";
import "./chunk-QNG4TY7L.js";
import "./chunk-RW5QMWE6.js";
import "./chunk-LGMX4E7L.js";
import "./chunk-2QCWKZIQ.js";
import "./chunk-2NPNEA6N.js";
import "./chunk-U34ZXOJT.js";
import "./chunk-OKRW5W44.js";
import "./chunk-RGAA5Z76.js";
import "./chunk-Q6RZBEZ6.js";
import "./chunk-PC66NY33.js";
import "./chunk-YY2VB3AE.js";
import "./chunk-VEYMN5N3.js";
import "./chunk-H6NTWZSO.js";
import "./chunk-BMT3OVAP.js";
import "./chunk-W5ALAOW2.js";
import "./chunk-FHDHOWK5.js";
import "./chunk-Y546C2O5.js";
import "./chunk-IYKBAIQE.js";
import "./chunk-BDRVHR2K.js";
import {
  r as r3
} from "./chunk-DVIGFJWY.js";
import "./chunk-AKEHDP75.js";
import "./chunk-5MMGIT64.js";
import "./chunk-AKQ765JR.js";
import "./chunk-ERD6I7QP.js";
import "./chunk-QIT4M76C.js";
import "./chunk-EZL4LTMD.js";
import "./chunk-F3BQGS35.js";
import "./chunk-Z3NX5DTX.js";
import "./chunk-J4RP32NG.js";
import "./chunk-6NLHKXEW.js";
import "./chunk-LMO6NZJA.js";
import "./chunk-A5QTLE4Y.js";
import "./chunk-SCHTG6ZQ.js";
import "./chunk-PCKG3UTS.js";
import "./chunk-OHE3HDFF.js";
import "./chunk-QYC3GV65.js";
import "./chunk-ETHGDNE6.js";
import "./chunk-X2GCSX3A.js";
import "./chunk-I2X6UR6L.js";
import "./chunk-NVYR73RE.js";
import {
  f as f3
} from "./chunk-HV2SFSJW.js";
import "./chunk-CYVKDANA.js";
import {
  A
} from "./chunk-7EQJLP2H.js";
import "./chunk-4ZLXDMI5.js";
import {
  t
} from "./chunk-SBARCIDP.js";
import "./chunk-EMYOYGGK.js";
import "./chunk-6PMFOUWZ.js";
import "./chunk-3KPZ3BQR.js";
import "./chunk-5JYVZQZR.js";
import "./chunk-UUG4W2PI.js";
import "./chunk-WW22JHXA.js";
import {
  S as S3
} from "./chunk-ZAM62XN5.js";
import "./chunk-RKVEKQ5O.js";
import "./chunk-P7J4JFEH.js";
import "./chunk-G7FOE26O.js";
import "./chunk-USOPZ2Q6.js";
import "./chunk-S5I4QKJD.js";
import "./chunk-LSM34QAB.js";
import "./chunk-HWHMO3CO.js";
import "./chunk-NCRCDVOW.js";
import "./chunk-QX66UTIR.js";
import "./chunk-JW7VBMHD.js";
import "./chunk-GLLRUDMY.js";
import "./chunk-ZIJHDTB7.js";
import "./chunk-ZU6I4R6T.js";
import "./chunk-JI3AZJ7K.js";
import "./chunk-A5Q7MMP6.js";
import "./chunk-326OSIM5.js";
import {
  i
} from "./chunk-R4CJB3GP.js";
import "./chunk-HTKSTTSR.js";
import "./chunk-6IED7TER.js";
import "./chunk-X7VSXJWW.js";
import "./chunk-VEODBKUJ.js";
import "./chunk-AG6JXA4M.js";
import {
  n as n4
} from "./chunk-B647DRFJ.js";
import "./chunk-PJNK3TLV.js";
import {
  y as y2
} from "./chunk-J7AMTUNG.js";
import "./chunk-G5EVVNIJ.js";
import "./chunk-HU5IGOTI.js";
import "./chunk-C24MEKSO.js";
import "./chunk-WDPG5BMO.js";
import {
  o as o3
} from "./chunk-TGXFDJCS.js";
import "./chunk-BOAEEYBE.js";
import "./chunk-VBUVOOM6.js";
import "./chunk-AKLOTDO2.js";
import "./chunk-6AQIVLDN.js";
import "./chunk-I5RCKVDX.js";
import "./chunk-6CWL7BCV.js";
import "./chunk-DVI5RM3W.js";
import {
  e as e2
} from "./chunk-RDPH36VD.js";
import {
  f as f4
} from "./chunk-LBXFRGMS.js";
import "./chunk-VTH4DAHQ.js";
import "./chunk-HLDUDRTD.js";
import {
  S as S2
} from "./chunk-SLQA5YBV.js";
import {
  Q
} from "./chunk-UMXV3EBO.js";
import {
  m
} from "./chunk-ONK5AE7R.js";
import "./chunk-CZSTCON2.js";
import "./chunk-2ICUS4HL.js";
import "./chunk-ZXJ6I4RF.js";
import "./chunk-GBF2OQAY.js";
import "./chunk-WNNYD62G.js";
import "./chunk-HV6S3GY2.js";
import "./chunk-IGR2BTWR.js";
import "./chunk-C7NPPGFR.js";
import "./chunk-ZPYA32PH.js";
import "./chunk-OCF7OAES.js";
import "./chunk-JZBR4X6W.js";
import "./chunk-OIJCMME5.js";
import "./chunk-4KLYOMH2.js";
import "./chunk-TPLOIZC7.js";
import "./chunk-C62RZQQX.js";
import "./chunk-6Z6C6JVV.js";
import {
  o as o2
} from "./chunk-QLL2YG25.js";
import {
  n as n3
} from "./chunk-Z2PDA67N.js";
import "./chunk-5LSHHVQ5.js";
import "./chunk-IZKCZQUY.js";
import {
  d as d2
} from "./chunk-M5ZB5S5C.js";
import {
  f as f2
} from "./chunk-MBGZKT2Z.js";
import "./chunk-UWQ3OYA5.js";
import "./chunk-ORO4D3FB.js";
import {
  o
} from "./chunk-YOPMY6TS.js";
import {
  r
} from "./chunk-VIN55KNF.js";
import "./chunk-NIDZ6R4E.js";
import "./chunk-IOB3DJMR.js";
import "./chunk-BPRXWDBO.js";
import "./chunk-7MT4ACA4.js";
import {
  n as n2
} from "./chunk-RUN6MNXL.js";
import "./chunk-BIAXSBMP.js";
import {
  kt,
  ot,
  r as r2,
  tt
} from "./chunk-SAYWXQVM.js";
import {
  d,
  f
} from "./chunk-SBL4URUW.js";
import {
  w
} from "./chunk-Z4Y53NDM.js";
import {
  V
} from "./chunk-PVUNFEWX.js";
import "./chunk-TXBMNSNF.js";
import "./chunk-BVQWKK2V.js";
import "./chunk-D25BO7X7.js";
import {
  S,
  y2 as y
} from "./chunk-NDIXNREV.js";
import {
  a3 as a2
} from "./chunk-I2RC5KWA.js";
import "./chunk-SSFWZSUM.js";
import {
  e
} from "./chunk-2F6FFF5T.js";
import "./chunk-C26KUZ46.js";
import {
  k as k2
} from "./chunk-JGDJR5EV.js";
import {
  u
} from "./chunk-QHK5ZYFW.js";
import "./chunk-L65HKN25.js";
import {
  a,
  n2 as n,
  s
} from "./chunk-7RBRCL6S.js";
import {
  k
} from "./chunk-J2EGIWT6.js";
import "./chunk-Z4ZPL3B3.js";

// node_modules/@arcgis/core/webdoc/geotriggersInfo/ExpressionInfo.js
var p2 = class extends i(f) {
  constructor(r4) {
    super(r4), this.expression = null, this.returnType = "string", this.title = null;
  }
};
e([y({ type: String, json: { write: { isRequired: true } } })], p2.prototype, "expression", void 0), e([y({ type: ["number", "string"], json: { write: true } })], p2.prototype, "returnType", void 0), e([y({ type: String, json: { write: true } })], p2.prototype, "title", void 0), p2 = e([a2("esri.webdoc.geotriggersInfo.ExpressionInfo")], p2);
var i4 = p2;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/DeviceLocationFeed.js
var c = new n2({ deviceLocation: "device-location" });
var a3 = class extends i(f) {
  constructor(o6) {
    super(o6), this.filterExpression = null, this.type = "device-location";
  }
};
e([y({ type: i4, json: { write: true } })], a3.prototype, "filterExpression", void 0), e([y({ type: c.apiValues, readOnly: true, json: { type: c.jsonValues, read: c.read, write: c.write } })], a3.prototype, "type", void 0), a3 = e([a2("esri.webdoc.geotriggersInfo.DeviceLocationFeed")], a3);
var n7 = a3;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/FeatureFilter.js
var m3 = class extends i(f) {
  constructor(o6) {
    super(o6), this.geometry = null, this.where = null;
  }
};
e([y({ types: n4, json: { read: y2, write: true } })], m3.prototype, "geometry", void 0), e([y({ type: String, json: { write: true } })], m3.prototype, "where", void 0), m3 = e([a2("esri.webdoc.geotriggersInfo.FeatureFilter")], m3);
var c2 = m3;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/FeatureLayerSource.js
var p3 = class extends i(f) {
  constructor(r4) {
    super(r4), this.layerId = null, this.layerUrl = null, this.type = "feature-layer";
  }
};
e([y({ type: String, json: { write: { overridePolicy() {
  return { isRequired: null === this.layerUrl };
} } } })], p3.prototype, "layerId", void 0), e([y({ type: String, json: { write: { overridePolicy() {
  return { isRequired: null === this.layerId };
} } } })], p3.prototype, "layerUrl", void 0), e([o3({ featureLayer: "feature-layer" }, { readOnly: true })], p3.prototype, "type", void 0), p3 = e([a2("esri.webdoc.geotriggersInfo.FeatureLayerSource")], p3);
var a4 = p3;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/FeatureFenceParameters.js
var a5 = class extends i(f) {
  constructor(r4) {
    super(r4), this.fenceSource = null, this.filter = null, this.bufferDistance = null, this.type = "features";
  }
};
e([y({ type: a4, json: { write: { isRequired: true } } })], a5.prototype, "fenceSource", void 0), e([y({ type: c2, json: { write: true } })], a5.prototype, "filter", void 0), e([y({ type: Number, json: { write: true } })], a5.prototype, "bufferDistance", void 0), e([o3({ features: "features" }, { readOnly: true })], a5.prototype, "type", void 0), a5 = e([a2("esri.webdoc.geotriggersInfo.FeatureFenceParameters")], a5);
var u2 = a5;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/Geotrigger.js
var c3 = class extends i(f) {
  constructor(o6) {
    super(o6), this.type = "fence";
  }
};
e([o3({ fence: "fence" }, { readOnly: true })], c3.prototype, "type", void 0), c3 = e([a2("esri.webdoc.geotriggersInfo.Geotrigger")], c3);
var p4 = c3;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/GeotriggerNotificationOptions.js
var p5 = class extends i(f) {
  constructor(o6) {
    super(o6), this.expressionInfo = null, this.requestedActions = null;
  }
};
e([y({ type: i4, json: { write: true } })], p5.prototype, "expressionInfo", void 0), e([y({ type: [String], json: { write: true } })], p5.prototype, "requestedActions", void 0), p5 = e([a2("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")], p5);
var c4 = p5;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/support/typeUtils.js
var t2 = new n2({ enterContainsAndExitDoesNotContain: "enter-contains-and-exit-does-not-contain", enterContainsAndExitDoesNotIntersect: "enter-contains-and-exit-does-not-intersect", enterIntersectsAndExitDoesNotIntersect: "enter-intersects-and-exit-does-not-intersect" });
var n8 = new n2({ useGeometry: "use-geometry", useGeometryWithAccuracy: "use-geometry-with-accuracy" });
var o4 = new n2({ enter: "enter", enterOrExit: "enter-or-exit", exit: "exit" });

// node_modules/@arcgis/core/webdoc/geotriggersInfo/FenceGeotrigger.js
var m4 = class extends p4 {
  constructor(e3) {
    super(e3), this.enterExitRule = "enter-contains-and-exit-does-not-intersect", this.feed = null, this.feedAccuracyMode = "use-geometry", this.fenceNotificationRule = null, this.fenceParameters = null, this.name = null, this.notificationOptions = null, this.type = "fence";
  }
};
e([o3(t2)], m4.prototype, "enterExitRule", void 0), e([y({ type: n7, json: { write: { isRequired: true } } })], m4.prototype, "feed", void 0), e([o3(n8)], m4.prototype, "feedAccuracyMode", void 0), e([y({ type: o4.apiValues, json: { type: o4.jsonValues, read: o4.read, write: { writer: o4.write, isRequired: true } } })], m4.prototype, "fenceNotificationRule", void 0), e([y({ type: u2, json: { write: { isRequired: true } } })], m4.prototype, "fenceParameters", void 0), e([y({ type: String, json: { write: true } })], m4.prototype, "name", void 0), e([y({ type: c4, json: { write: true } })], m4.prototype, "notificationOptions", void 0), e([o3({ fence: "fence" }, { readOnly: true })], m4.prototype, "type", void 0), m4 = e([a2("esri.webdoc.geotriggersInfo.FenceGeotrigger")], m4);
var u3 = m4;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/support/geotriggerTypes.js
var o5 = { base: p4, key: "type", typeMap: { fence: u3 } };

// node_modules/@arcgis/core/webdoc/GeotriggersInfo.js
var i5 = class extends i(f) {
  constructor(r4) {
    super(r4), this.geotriggers = null;
  }
};
e([y({ types: [o5], json: { write: { isRequired: true } } })], i5.prototype, "geotriggers", void 0), i5 = e([a2("esri.webdoc.GeotriggersInfo")], i5);
var c5 = i5;

// node_modules/@arcgis/core/webdoc/RangeInfo.js
var s2;
var a6 = s2 = class extends f {
  constructor(e3) {
    super(e3), this.activeRange = null, this.currentRangeExtent = null, this.fullRangeExtent = null;
  }
  clone() {
    return new s2(a({ activeRange: this.activeRange, currentRangeExtent: this.currentRangeExtent, fullRangeExtent: this.fullRangeExtent }));
  }
};
e([y({ type: String, nonNullable: true, json: { read: { source: "activeRangeName" }, write: { target: "activeRangeName", isRequired: true } } })], a6.prototype, "activeRange", void 0), e([y({ type: [Number], json: { write: true } })], a6.prototype, "currentRangeExtent", void 0), e([y({ type: [Number], json: { write: true } })], a6.prototype, "fullRangeExtent", void 0), a6 = s2 = e([a2("esri.webdoc.RangeInfo")], a6);
var c6 = a6;

// node_modules/@arcgis/core/webdoc/support/webdocLoadUtils.js
function p6(e3, t3) {
  var _a;
  return t3.resourceInfo ? l3(t3, t3.resourceInfo, { origin: e3.origin }) : ((_a = t3.portalItem) == null ? void 0 : _a.id) ? c7(e3, t3, t3.portalItem) : Promise.resolve();
}
function l3(e3, t3, r4) {
  const o6 = { context: { ...r4, layerContainerType: "operational-layers" } };
  return e3.portalItem && (o6.context.portal = e3.portalItem.portal || Q.getDefault()), import("./layersCreator-SR6BJJA3.js").then(({ populateOperationalLayers: r5 }) => {
    const n10 = [], i6 = t3.operationalLayers;
    (i6 == null ? void 0 : i6.length) && n10.push(r5(e3.layers, i6, o6));
    const a8 = { ...o6, context: { ...o6.context, layerContainerType: "tables" }, defaultLayerType: "ArcGISFeatureLayer" }, s4 = t3.tables;
    return (s4 == null ? void 0 : s4.length) && n10.push(r5(e3.tables, s4, a8)), Promise.allSettled(n10).then(() => {
    });
  });
}
async function c7(e3, o6, n10) {
  var _a;
  if (await n10.load().catch((r4) => {
    throw new s(`${e3.name}:load-portal-item`, "Failed to load portal item", { error: r4 });
  }), n10.type !== e3.itemType)
    throw new s(`${e3.name}:invalid-portal-item`, `Invalid portal item type '${n10.type}', expected '${e3.itemType}'`, { type: n10.type });
  const a8 = await n10.fetchData();
  o6.resourceInfo = a8;
  const s4 = e2(n10, e3.origin);
  await m5(e3, o6, a8, s4), o6.resourceReferences = { portalItem: n10, paths: s4.readResourcePaths };
  const p8 = await f6(o6.initialViewProperties, n10, n.getLogger(o6));
  if (p8) {
    const t3 = ((_a = o6.initialViewProperties) == null ? void 0 : _a.clone()) ?? e3.createInitialViewProperties();
    t3.viewpoint = p8, o6.initialViewProperties = t3;
  }
}
function m5(e3, t3, r4, o6) {
  const n10 = u4(e3, r4);
  return t3.read(n10, o6), l3(t3, n10, o6);
}
function u4(e3, t3) {
  const r4 = e3.parseVersion(t3.version || "", e3.name);
  return e3.currentVersion.validate(r4), t3.version = `${r4.major}.${r4.minor}`, t3;
}
async function f6(t3, r4, o6) {
  var _a;
  const n10 = (_a = t3 == null ? void 0 : t3.viewpoint) == null ? void 0 : _a.targetGeometry;
  if (n10)
    return null;
  const i6 = await y3(t3, r4, o6);
  if (!i6)
    return null;
  return new l({ targetGeometry: i6 });
}
async function y3(e3, t3, r4) {
  const n10 = e3 == null ? void 0 : e3.spatialReference, i6 = t3 == null ? void 0 : t3.extent;
  if (!n10 || !i6)
    return null;
  if (n10.isWGS84)
    return i6.clone();
  if (n10.isWebMercator)
    return d2(i6);
  const { getGeometryServiceURL: p8 } = await import("./geometryServiceUtils-GBJDXKQL.js");
  try {
    const e4 = await p8(t3), r5 = new p({ geometries: [i6], outSpatialReference: n10 });
    return (await n5(e4, r5))[0];
  } catch (l5) {
    r4.error("Error projecting item's extent:", l5);
  }
  return null;
}

// node_modules/@arcgis/core/webmap/ApplicationProperties.js
var p7;
var n9 = p7 = class extends f {
  constructor(o6) {
    super(o6), this.editing = null, this.offline = null, this.viewing = null;
  }
  clone() {
    return new p7(a({ editing: this.editing, offline: this.offline, viewing: this.viewing }));
  }
};
e([y({ json: { write: true } })], n9.prototype, "editing", void 0), e([y({ json: { write: true } })], n9.prototype, "offline", void 0), e([y({ type: i3, json: { write: true } })], n9.prototype, "viewing", void 0), n9 = p7 = e([a2("esri.webmap.ApplicationProperties")], n9);
var c8 = n9;

// node_modules/@arcgis/core/webmap/InitialViewProperties.js
var a7 = class extends i(S) {
  constructor(o6) {
    super(o6), this.background = null, this.rangeInfo = null, this.spatialReference = null, this.timeZone = o2, this.viewpoint = null;
  }
};
e([y({ type: m2 })], a7.prototype, "background", void 0), e([y({ type: c6 })], a7.prototype, "rangeInfo", void 0), e([y({ type: f2 })], a7.prototype, "spatialReference", void 0), e([y({ nonNullable: true })], a7.prototype, "timeZone", void 0), e([y({ type: l })], a7.prototype, "viewpoint", void 0), a7 = e([a2("esri.webmap.InitialViewProperties")], a7);
var l4 = a7;

// node_modules/@arcgis/core/webmap/Version.js
var s3 = class extends r3 {
  constructor(r4, s4) {
    super(r4, s4, "webmap");
  }
};

// node_modules/@arcgis/core/WebMap.js
var M = new s3(2, 30);
var Z = "Web Map";
var W = "webmap";
var $ = "web-map";
var C = V.ofType(f5);
var G = V.ofType(T);
var z = /* @__PURE__ */ new Map([["image/jpeg", "jpeg"], ["image/jpg", "jpg"], ["image/png", "png"], ["image/gif", "gif"]]);
var D = "ArcGIS Pro";
var q = f4.JSAPI;
var H = { currentVersion: M, createInitialViewProperties: () => new l4(), parseVersion: s3.parse, itemType: Z, name: W, origin: $ };
var K = class extends S3(m.LoadableMixin(n3(L))) {
  constructor(e3) {
    super(e3), this._isAuthoringAppSetByUser = false, this._isAuthoringAppVersionSetByUser = false, this._thumbnailFilename = null, this._updateFromPromise = null, this.resourceReferences = { portalItem: null, paths: [] }, this.applicationProperties = null, this.bookmarks = new C(), this.floorInfo = null, this.geotriggersInfo = null, this.initialViewProperties = new l4(), this.ipsInfo = null, this.portalItem = null, this.presentation = null, this.sourceVersion = null, this.widgets = null, this.utilityNetworks = null, this._debouncedSaveOperations = k2(async (e4, t3, r4) => {
      const { save: i6, saveAs: o6 } = await import("./webdocSaveUtils-RF56M2DI.js");
      switch (e4) {
        case A.SAVE:
          return i6(H, this, t3);
        case A.SAVE_AS:
          return o6(H, this, r4, t3);
      }
    }), this.authoringApp = this.authoringAppVersion = null, this._isAuthoringAppSetByUser = this._isAuthoringAppVersionSetByUser = false;
  }
  destroy() {
    if (this.portalItem = u(this.portalItem), this.utilityNetworks) {
      const e3 = this.utilityNetworks.removeAll();
      for (const t3 of e3)
        t3.destroy();
      this.utilityNetworks.destroy();
    }
  }
  initialize() {
    if (this.when().catch((e3) => {
      n.getLogger(this).error("#load()", "Failed to load web map", e3);
    }), this.resourceInfo) {
      let t3;
      try {
        t3 = this._validateJSON(this.resourceInfo);
      } catch (e3) {
        return void this.addResolvingPromise(Promise.reject(e3));
      }
      this.read(t3);
    }
  }
  set authoringApp(e3) {
    this._isAuthoringAppSetByUser = true, this._set("authoringApp", e3);
  }
  writeAuthoringApp(e3, t3) {
    e3 && this._isAuthoringAppSetByUser ? t3.authoringApp = e3 : t3.authoringApp = q;
  }
  set authoringAppVersion(e3) {
    this._isAuthoringAppVersionSetByUser = true, this._set("authoringAppVersion", e3);
  }
  writeAuthoringAppVersion(e3, r4) {
    e3 && this._isAuthoringAppVersionSetByUser ? r4.authoringAppVersion = e3 : r4.authoringAppVersion = r2;
  }
  readInitialViewProperties(e3, t3) {
    var _a;
    const r4 = new l4();
    t3.background && (r4.background = m2.fromJSON(t3.background));
    const o6 = (_a = t3.initialState) == null ? void 0 : _a.viewpoint;
    if (o6) {
      if (o6.rotation) {
        s3.parse(t3.version || "", "webmap").lessThan(2, 20) && t3.authoringApp === D && (o6.rotation *= -1);
      }
      r4.viewpoint = l.fromJSON(o6);
    }
    return t3.mapRangeInfo && (r4.rangeInfo = c6.fromJSON(t3.mapRangeInfo)), t3.spatialReference && (r4.spatialReference = f2.fromJSON(t3.spatialReference)), t3.timeZone && (r4.timeZone = t3.timeZone), r4;
  }
  writeInitialViewProperties(e3, t3, r4, i6) {
    var _a;
    e3 && (((_a = e3.background) == null ? void 0 : _a.color) && (t3.background = e3.background.write({}, i6)), e3.viewpoint && (t3.initialState = { viewpoint: e3.viewpoint.write({}, i6) }), e3.rangeInfo && (t3.mapRangeInfo = e3.rangeInfo.toJSON(i6)), e3.spatialReference && (t3.spatialReference = e3.spatialReference.write({}, i6)), t3.timeZone = e3.timeZone);
  }
  writeLayers(e3, t3, r4, i6) {
    t3[r4] = this._writeLayers(e3, i6, "operational-layers");
  }
  readSourceVersion(e3, t3) {
    const [r4, i6] = t3.version.split(".");
    return new s3(parseInt(r4, 10), parseInt(i6, 10));
  }
  writeSourceVersion(e3, t3, r4) {
    t3[r4] = `${M.major}.${M.minor}`;
  }
  writeTables(e3, t3, r4, i6) {
    const o6 = this._writeLayers(e3, i6, "tables");
    o6.length && (t3[r4] = o6);
  }
  get thumbnailUrl() {
    var _a;
    return ((_a = this.portalItem) == null ? void 0 : _a.thumbnailUrl) || null;
  }
  set thumbnailUrl(e3) {
    e3 ? (this._override("thumbnailUrl", e3), this._thumbnailFilename = this._generateCustomThumbnailFilename(e3)) : this._clearThumbnailOverride();
  }
  get updatingFromView() {
    return !!this._updateFromPromise;
  }
  load(e3) {
    return this.addResolvingPromise(p6(H, this)), Promise.resolve(this);
  }
  loadAll() {
    return t(this, (e3) => {
      e3(this.ground, this.basemap, this.layers, this.tables);
    });
  }
  read(e3, t3) {
    t3 = { ...t3, origin: $ };
    const r4 = this._getAuthoringPropsState();
    d(this, e3, (t4) => super.read(e3, t4), t3), this._restoreAuthoringPropsFromState(r4);
  }
  write(e3, t3) {
    if ("loaded" !== this.loadStatus) {
      const e4 = new s("webmap:not-loaded", "Web map must be loaded before it can be serialized");
      throw n.getLogger(this).error("#toJSON()", "Web map must be loaded before it can be serialized", this.loadError || this.loadStatus), e4;
    }
    return this._removeDanglingLayerRefs(), t3 = { ...t3, origin: $, restrictedWebMapWriting: true, webmap: this }, super.write(e3, t3);
  }
  async save(e3) {
    return this._debouncedSaveOperations(A.SAVE, e3);
  }
  async saveAs(e3, t3) {
    return this._debouncedSaveOperations(A.SAVE_AS, t3, e3);
  }
  async updateFrom(e3, t3) {
    const r4 = this._updateFromInternal(e3, t3);
    this._updateFromPromise = r4, await r4;
    r4 === this._updateFromPromise && (this._updateFromPromise = null);
  }
  getLayerJSONFromResourceInfo(e3) {
    var _a, _b, _c, _d;
    const t3 = this.resourceInfo;
    return this._collectAllLayersJSON([...((_a = t3 == null ? void 0 : t3.baseMap) == null ? void 0 : _a.baseMapLayers) || [], ...(t3 == null ? void 0 : t3.operationalLayers) || [], ...((_d = (_c = (_b = this.basemap) == null ? void 0 : _b.resourceInfo) == null ? void 0 : _c.data) == null ? void 0 : _d.baseMapLayers) || []]).find((t4) => t4.id === e3.id);
  }
  async updateItemThumbnail() {
    var _a;
    this.thumbnailUrl && this._isOverridden("thumbnailUrl") && (await ((_a = this.portalItem) == null ? void 0 : _a.updateThumbnail({ thumbnail: this.thumbnailUrl, filename: this._thumbnailFilename })), this._clearThumbnailOverride());
  }
  getThumbnailState() {
    let e3 = this.thumbnailUrl;
    return e3 && (e3 = this._isOverridden("thumbnailUrl") ? e3 : kt(e3, "w", "8192")), { thumbnailUrl: e3, filename: this._thumbnailFilename };
  }
  restoreThumbnailFromState(e3) {
    this.thumbnailUrl = e3.thumbnailUrl, this._thumbnailFilename = e3.filename;
  }
  _collectAllLayersJSON(e3) {
    return e3.reduce((e4, t3) => (e4.push(t3), "GroupLayer" === t3.layerType && (e4 = e4.concat(this._collectAllLayersJSON(t3.layers || []))), e4), []);
  }
  _writeLayers(e3, t3, r4) {
    t3 = { ...t3, layerContainerType: r4 };
    return e3.map((e4) => f3(e4, "tables" === r4 ? null : this.getLayerJSONFromResourceInfo(e4), t3)).filter(k).toArray();
  }
  _validateJSON(e3) {
    const t3 = s3.parse(e3.version || "", "webmap");
    return M.validate(t3), e3.version = `${t3.major}.${t3.minor}`, e3;
  }
  _removeDanglingLayerRefs() {
    var _a, _b, _c;
    const e3 = this.applicationProperties, t3 = (_a = e3 == null ? void 0 : e3.viewing) == null ? void 0 : _a.search, r4 = (e4) => this.allLayers.some((t4) => t4.id === e4);
    if (t3 && t3.layers && (t3.layers = t3.layers.filter((e4) => r4(e4.id))), t3 && t3.tables && (t3.tables = t3.tables.filter((e4) => this.tables.some((t4) => t4.id === e4.id))), e3) {
      const t4 = (_b = e3.editing) == null ? void 0 : _b.locationTracking;
      (t4 == null ? void 0 : t4.info) && !r4(t4.info.layerId) && (e3.editing = null);
    }
    const i6 = (_c = this.presentation) == null ? void 0 : _c.slides;
    i6 && i6.forEach((e4) => {
      e4.visibleLayers && (e4.visibleLayers = e4.visibleLayers.filter((e5) => r4(e5.id)));
    });
  }
  async _updateFromInternal(e3, t3) {
    if (t3 ?? (t3 = {}), await w(() => e3.ready), this._updateInitialViewProperties(e3, t3), e3.map === this)
      for (const r4 of e3.allLayerViews)
        "visible" in r4 && "visible" in r4.layer && r4._isOverridden("visible") && (r4.layer.visible = r4.visible), "featureEffect" in r4 && "featureEffect" in r4.layer && r4._isOverridden("featureEffect") && (r4.layer.featureEffect = r4.featureEffect);
    await this._updateThumbnailUrl(e3, t3);
  }
  _updateInitialViewProperties(e3, t3) {
    var _a, _b;
    if (t3.backgroundExcluded || (this.initialViewProperties.background = (_a = e3.background) == null ? void 0 : _a.clone()), this.initialViewProperties.spatialReference = (_b = e3.spatialReference) == null ? void 0 : _b.clone(), this.initialViewProperties.timeZone = e3.timeZone, t3.viewpointExcluded || (this.initialViewProperties.viewpoint = new l({ rotation: e3.rotation, scale: t3.scalePreserved ? e3.scale : null, targetGeometry: this._getViewExtent(e3) })), !t3.widgetsExcluded)
      for (const r4 of e3.persistableViewModels)
        r4.updateWebDocument(this);
  }
  _getViewExtent(e3) {
    const t3 = e3.center.clone().normalize(), r4 = e3.extent.clone(), i6 = r4.width / 2;
    return r4.xmin = t3.x - i6, r4.xmax = t3.x + i6, r4;
  }
  async _updateThumbnailUrl(e3, t3) {
    if (t3.thumbnailExcluded)
      return;
    const r4 = i2(e3, t3.thumbnailSize), i6 = await e3.takeScreenshot({ format: "png", width: r4.width, height: r4.height });
    this._setAutoGeneratedThumbnail(i6.dataUrl);
  }
  _setAutoGeneratedThumbnail(e3) {
    this.thumbnailUrl = e3, this._thumbnailFilename = null;
  }
  _clearThumbnailOverride() {
    this._clearOverride("thumbnailUrl"), this.clear("thumbnailUrl", "user"), this._thumbnailFilename = null;
  }
  _generateCustomThumbnailFilename(e3) {
    if (tt(e3)) {
      const t3 = ot(e3), r4 = t3 == null ? void 0 : t3.mediaType, i6 = r4 && z.get(r4.toLowerCase()) || null, o6 = `thumbnail${Date.now()}`;
      return i6 ? `${o6}.${i6}` : o6;
    }
    return null;
  }
  _getAuthoringPropsState() {
    return { authoringApp: this.authoringApp, authoringAppVersion: this.authoringAppVersion, isAuthoringAppSetByUser: this._isAuthoringAppSetByUser, isAuthoringAppVersionSetByUser: this._isAuthoringAppVersionSetByUser };
  }
  _restoreAuthoringPropsFromState(e3) {
    e3.isAuthoringAppSetByUser ? this.authoringApp = e3.authoringApp : this._isAuthoringAppSetByUser = false, e3.isAuthoringAppVersionSetByUser ? this.authoringAppVersion = e3.authoringAppVersion : this._isAuthoringAppVersionSetByUser = false;
  }
  static fromJSON(e3) {
    const t3 = e3;
    if (!t3)
      throw new s("webmap:empty-resource", "Expected a JSON resource but got nothing");
    return new this({ resourceInfo: t3 });
  }
};
K.VERSION = M, e([y()], K.prototype, "_updateFromPromise", void 0), e([y({ type: c8, json: { write: true } })], K.prototype, "applicationProperties", void 0), e([y({ type: String, json: { write: { allowNull: true, ignoreOrigin: true } } })], K.prototype, "authoringApp", null), e([r("authoringApp")], K.prototype, "writeAuthoringApp", null), e([y({ type: String, json: { write: { allowNull: true, ignoreOrigin: true } } })], K.prototype, "authoringAppVersion", null), e([r("authoringAppVersion")], K.prototype, "writeAuthoringAppVersion", null), e([y({ type: C, json: { write: { overridePolicy: (e3) => ({ enabled: !!(e3 && e3.length > 0), ignoreOrigin: true }) } } })], K.prototype, "bookmarks", void 0), e([y({ type: l2, json: { name: "mapFloorInfo", write: true } })], K.prototype, "floorInfo", void 0), e([y({ type: c5, json: { write: true } })], K.prototype, "geotriggersInfo", void 0), e([y({ type: l4, nonNullable: true, json: { read: { source: ["background", "initialState.viewpoint", "mapRangeInfo", "spatialReference", "timeZone"] }, write: { ignoreOrigin: true, target: { background: { type: m2 }, "initialState.viewpoint": { type: l }, mapRangeInfo: { type: c6 }, spatialReference: { type: f2 }, "timeZone:": { type: String } } } } })], K.prototype, "initialViewProperties", void 0), e([o("initialViewProperties")], K.prototype, "readInitialViewProperties", null), e([r("initialViewProperties")], K.prototype, "writeInitialViewProperties", null), e([y({ json: { write: true, name: "mapIPSInfo" } })], K.prototype, "ipsInfo", void 0), e([y({ json: { read: false, write: { target: "operationalLayers", ignoreOrigin: true } } })], K.prototype, "layers", void 0), e([r("layers")], K.prototype, "writeLayers", null), e([y({ type: S2 })], K.prototype, "portalItem", void 0), e([y({ json: { write: true } })], K.prototype, "presentation", void 0), e([y()], K.prototype, "resourceInfo", void 0), e([y({ readOnly: true, type: s3, json: { read: { source: "version" }, write: { allowNull: true, ignoreOrigin: true, target: "version", isRequired: true } } })], K.prototype, "sourceVersion", void 0), e([o("sourceVersion")], K.prototype, "readSourceVersion", null), e([r("sourceVersion")], K.prototype, "writeSourceVersion", null), e([y({ json: { read: false, write: { ignoreOrigin: true } } })], K.prototype, "tables", void 0), e([r("tables")], K.prototype, "writeTables", null), e([y()], K.prototype, "thumbnailUrl", null), e([y()], K.prototype, "updatingFromView", null), e([y({ type: n6, json: { write: true } })], K.prototype, "widgets", void 0), e([y({ type: G, json: { read: true, write: true } })], K.prototype, "utilityNetworks", void 0), K = e([a2("esri.WebMap")], K);
var Q2 = K;
export {
  Q2 as default
};
//# sourceMappingURL=WebMap-ER6YCZVK.js.map
