import {
  e as e5
} from "./chunk-HLKM6YBE.js";
import {
  i as i3
} from "./chunk-WK2KEW7P.js";
import {
  e as e4
} from "./chunk-EAAEPSBY.js";
import {
  a as a4
} from "./chunk-NA6Q3Z3J.js";
import {
  o as o2
} from "./chunk-I7LDU4W6.js";
import {
  d as d2
} from "./chunk-F3BQGS35.js";
import {
  y as y2
} from "./chunk-Z3NX5DTX.js";
import "./chunk-J4RP32NG.js";
import "./chunk-6NLHKXEW.js";
import {
  D as D2,
  V as V2,
  b as b2,
  p,
  v as v2
} from "./chunk-LMO6NZJA.js";
import "./chunk-A5QTLE4Y.js";
import "./chunk-SCHTG6ZQ.js";
import {
  R
} from "./chunk-G7YFDDME.js";
import "./chunk-PCKG3UTS.js";
import "./chunk-3VMVD66K.js";
import "./chunk-QYC3GV65.js";
import "./chunk-ETHGDNE6.js";
import "./chunk-X2GCSX3A.js";
import {
  f as f3,
  i as i2,
  s as s2,
  u as u3
} from "./chunk-I2X6UR6L.js";
import "./chunk-NCRCDVOW.js";
import "./chunk-QX66UTIR.js";
import "./chunk-ZIJHDTB7.js";
import "./chunk-ZU6I4R6T.js";
import "./chunk-JI3AZJ7K.js";
import "./chunk-A5Q7MMP6.js";
import "./chunk-326OSIM5.js";
import "./chunk-R4CJB3GP.js";
import "./chunk-HTKSTTSR.js";
import "./chunk-6IED7TER.js";
import {
  J
} from "./chunk-X7VSXJWW.js";
import "./chunk-VEODBKUJ.js";
import "./chunk-AG6JXA4M.js";
import "./chunk-B647DRFJ.js";
import "./chunk-PJNK3TLV.js";
import "./chunk-J7AMTUNG.js";
import "./chunk-G5EVVNIJ.js";
import "./chunk-HU5IGOTI.js";
import "./chunk-C24MEKSO.js";
import "./chunk-WDPG5BMO.js";
import {
  o
} from "./chunk-TGXFDJCS.js";
import {
  c as c2,
  e as e3,
  u as u2
} from "./chunk-BOAEEYBE.js";
import "./chunk-VBUVOOM6.js";
import {
  S as S3
} from "./chunk-SLQA5YBV.js";
import {
  Q,
  c
} from "./chunk-UMXV3EBO.js";
import {
  m as m2
} from "./chunk-ONK5AE7R.js";
import "./chunk-CZSTCON2.js";
import {
  j as j2
} from "./chunk-HV6S3GY2.js";
import "./chunk-IGR2BTWR.js";
import "./chunk-C7NPPGFR.js";
import "./chunk-ZPYA32PH.js";
import "./chunk-OCF7OAES.js";
import "./chunk-JZBR4X6W.js";
import "./chunk-OIJCMME5.js";
import "./chunk-4KLYOMH2.js";
import {
  D,
  e2,
  r
} from "./chunk-RGCWZ2KZ.js";
import {
  n as n3
} from "./chunk-5VMSFOCB.js";
import "./chunk-LGQXPGTM.js";
import {
  x
} from "./chunk-2SDMYJDE.js";
import "./chunk-TPLOIZC7.js";
import "./chunk-C62RZQQX.js";
import "./chunk-6Z6C6JVV.js";
import {
  E,
  j
} from "./chunk-QLL2YG25.js";
import "./chunk-Z2PDA67N.js";
import {
  w
} from "./chunk-IZKCZQUY.js";
import "./chunk-M5ZB5S5C.js";
import {
  f as f2
} from "./chunk-MBGZKT2Z.js";
import "./chunk-UWQ3OYA5.js";
import "./chunk-ORO4D3FB.js";
import "./chunk-YOPMY6TS.js";
import "./chunk-VIN55KNF.js";
import "./chunk-NIDZ6R4E.js";
import "./chunk-IOB3DJMR.js";
import "./chunk-BPRXWDBO.js";
import {
  a as a3
} from "./chunk-7MT4ACA4.js";
import {
  i,
  n as n2
} from "./chunk-RUN6MNXL.js";
import {
  F,
  K,
  S as S2,
  U,
  ot,
  t3 as t
} from "./chunk-SAYWXQVM.js";
import {
  f
} from "./chunk-SBL4URUW.js";
import {
  P,
  d
} from "./chunk-Z4Y53NDM.js";
import {
  V
} from "./chunk-PVUNFEWX.js";
import "./chunk-TXBMNSNF.js";
import "./chunk-BVQWKK2V.js";
import "./chunk-D25BO7X7.js";
import {
  S,
  y2 as y
} from "./chunk-NDIXNREV.js";
import {
  a3 as a2,
  v
} from "./chunk-I2RC5KWA.js";
import "./chunk-SSFWZSUM.js";
import {
  e
} from "./chunk-2F6FFF5T.js";
import "./chunk-C26KUZ46.js";
import {
  b,
  m,
  u2 as u
} from "./chunk-JGDJR5EV.js";
import "./chunk-QHK5ZYFW.js";
import "./chunk-L65HKN25.js";
import {
  a,
  n2 as n,
  s
} from "./chunk-7RBRCL6S.js";
import {
  k
} from "./chunk-J2EGIWT6.js";
import "./chunk-MDRC3XUT.js";
import "./chunk-NCF6OYL5.js";
import "./chunk-Z4ZPL3B3.js";

// node_modules/@arcgis/core/rest/support/fileFormat.js
var p2 = new n2({ PDF: "pdf", PNG32: "png32", PNG8: "png8", JPG: "jpg", GIF: "gif", EPS: "eps", SVG: "svg", SVGZ: "svgz" });
var n4 = p2.fromJSON.bind(p2);
var g = p2.toJSON.bind(p2);

// node_modules/@arcgis/core/widgets/Print/FileLink.js
var p3 = class extends S {
  constructor(t4) {
    super(t4), this.state = "pending", this.url = "";
  }
  initialize() {
    this.addHandles(d(() => [this.extension, this.name], () => this._setFormattedFileName(), P));
  }
  _setFormattedFileName() {
    this.name && this.extension && (this.formattedName = this.count ? `${this.name}(${this.count})${this.extension}` : `${this.name}.${this.extension}`);
  }
};
e([y()], p3.prototype, "count", void 0), e([y()], p3.prototype, "error", void 0), e([y()], p3.prototype, "extension", void 0), e([y()], p3.prototype, "formattedName", void 0), e([y()], p3.prototype, "name", void 0), e([y()], p3.prototype, "state", void 0), e([y()], p3.prototype, "url", void 0), p3 = e([a2("esri.widgets.Print.FileLink")], p3);
var a5 = p3;

// node_modules/@arcgis/core/rest/geoprocessor/GPOptions.js
var c3;
var i4 = c3 = class extends S {
  constructor(e9) {
    super(e9), this.outSpatialReference = null, this.processExtent = null, this.processSpatialReference = null, this.returnColumnName = false, this.returnFeatureCollection = false, this.returnM = false, this.returnZ = false;
  }
  static from(e9) {
    return v(c3, e9);
  }
};
e([y({ type: f2 })], i4.prototype, "outSpatialReference", void 0), e([y({ type: w })], i4.prototype, "processExtent", void 0), e([y({ type: f2 })], i4.prototype, "processSpatialReference", void 0), e([y({ nonNullable: true })], i4.prototype, "returnColumnName", void 0), e([y({ nonNullable: true })], i4.prototype, "returnFeatureCollection", void 0), e([y({ nonNullable: true })], i4.prototype, "returnM", void 0), e([y({ nonNullable: true })], i4.prototype, "returnZ", void 0), i4 = c3 = e([a2("esri.rest.geoprocessor.GPOptions")], i4);
var l = i4;

// node_modules/@arcgis/core/layers/support/MapImage.js
var p4 = class extends f {
  constructor() {
    super(...arguments), this.extent = null, this.height = null, this.href = null, this.opacity = 1, this.rotation = 0, this.scale = null, this.visible = true, this.width = null;
  }
};
e([y({ type: w })], p4.prototype, "extent", void 0), e([y()], p4.prototype, "height", void 0), e([y()], p4.prototype, "href", void 0), e([y()], p4.prototype, "opacity", void 0), e([y()], p4.prototype, "rotation", void 0), e([y()], p4.prototype, "scale", void 0), e([y()], p4.prototype, "visible", void 0), e([y()], p4.prototype, "width", void 0), p4 = e([a2("esri.layers.support.MapImage")], p4);
var i5 = p4;

// node_modules/@arcgis/core/rest/support/DataFile.js
var e6 = class extends f {
  constructor(r4) {
    super(r4), this.itemId = null, this.url = null;
  }
};
e([y({ type: String, json: { read: { source: "itemID" }, write: { target: "itemID" } } })], e6.prototype, "itemId", void 0), e([y({ type: String, json: { write: true } })], e6.prototype, "url", void 0), e6 = e([a2("esri.rest.support.DataFile")], e6);
var p5 = e6;

// node_modules/@arcgis/core/rest/support/LinearUnit.js
var i6 = new n2({ esriMeters: "meters", esriFeet: "feet", esriKilometers: "kilometers", esriMiles: "miles", esriNauticalMiles: "nautical-miles", esriYards: "yards" }, { ignoreUnknown: false });
var p6 = class extends f {
  constructor(r4) {
    super(r4), this.distance = 0, this.units = null;
  }
};
e([y({ json: { write: true } })], p6.prototype, "distance", void 0), e([y({ json: { read: i6.read, write: i6.write } })], p6.prototype, "units", void 0), p6 = e([a2("esri.rest.support.LinearUnit")], p6);
var c4 = p6;

// node_modules/@arcgis/core/rest/support/parameterValueUtils.js
var a6 = "multi-value-";
var t2 = new n2({ GPBoolean: "boolean", GPDataFile: "data-file", GPDate: "date", GPDouble: "double", GPFeatureRecordSetLayer: "feature-record-set-layer", Field: "field", GPLinearUnit: "linear-unit", GPLong: "long", GPRasterData: "raster-data", GPRasterDataLayer: "raster-data-layer", GPRecordSet: "record-set", GPString: "string", GPValueTable: "value-table", "GPMultiValue:GPBoolean": `${a6}boolean`, "GPMultiValue:GPDataFile": `${a6}data-file`, "GPMultiValue:GPDate": `${a6}date`, "GPMultiValue:GPDouble": `${a6}double`, "GPMultiValue:GPFeatureRecordSetLayer": `${a6}feature-record-set-layer`, "GPMultiValue:Field": `${a6}field`, "GPMultiValue:GPLinearUnit": `${a6}linear-unit`, "GPMultiValue:GPLong": `${a6}long`, "GPMultiValue:GPRasterData": `${a6}raster-data`, "GPMultiValue:GPRasterDataLayer": `${a6}raster-data-layer`, "GPMultiValue:GPRecordSet": `${a6}record-set`, "GPMultiValue:GPString": `${a6}string` });

// node_modules/@arcgis/core/rest/support/ParameterValue.js
var a7 = class extends f {
  constructor(r4) {
    super(r4), this.dataType = null, this.paramName = null, this.value = null;
  }
};
e([o(t2, { ignoreUnknown: false })], a7.prototype, "dataType", void 0), e([y()], a7.prototype, "paramName", void 0), e([y()], a7.prototype, "value", void 0), a7 = e([a2("esri.rest.support.ParameterValue")], a7);
var m3 = a7;

// node_modules/@arcgis/core/rest/support/RasterData.js
var e7 = class extends f {
  constructor(r4) {
    super(r4), this.format = null, this.itemId = null, this.url = null;
  }
};
e([y()], e7.prototype, "format", void 0), e([y({ json: { read: { source: "itemID" }, write: { target: "itemID" } } })], e7.prototype, "itemId", void 0), e([y()], e7.prototype, "url", void 0), e7 = e([a2("esri.rest.support.RasterData")], e7);
var p7 = e7;

// node_modules/@arcgis/core/rest/geoprocessor/utils.js
async function y3(r4, a11, n5, s7, i9) {
  const u5 = {}, m6 = {}, c6 = [];
  return S4(s7, c6, u5), R(c6).then((t4) => {
    const { outSpatialReference: c7, processExtent: f5, processSpatialReference: l3, returnColumnName: p12, returnFeatureCollection: y5, returnM: S7, returnZ: d6 } = n5, { path: N3 } = f3(r4);
    for (const e9 in u5) {
      const [r5, a12] = u5[e9];
      m6[e9] = t4.slice(r5, a12);
    }
    const j5 = c7 ? c7.wkid || c7 : null, g5 = l3 ? l3.wkid || l3 : null, O2 = "execute" === a11 ? { returnColumnName: p12 || void 0, returnFeatureCollection: y5 || void 0, returnM: S7 || void 0, returnZ: d6 || void 0 } : null, R3 = J2({ ...f5 ? { context: { extent: f5, outSR: j5, processSR: g5 } } : { "env:outSR": j5, "env:processSR": g5 }, ...s7, ...O2, f: "json" }, null, m6), v4 = { ...i9, query: R3 };
    return U(`${N3}/${a11}`, v4);
  });
}
function S4(e9, r4, t4) {
  for (const a11 in e9) {
    const n5 = e9[a11];
    if (n5 && "object" == typeof n5 && n5 instanceof d2) {
      const { features: e10 } = n5;
      t4[a11] = [r4.length, r4.length + e10.length], e10.forEach((e11) => {
        r4.push(e11.geometry);
      });
    }
  }
}
async function d3(e9, t4) {
  switch (e9) {
    case "boolean":
    case "double":
    case "long":
    case "string":
    case "value-table":
      return t4;
    case "date":
      return new Date(t4);
    case "data-file":
      return p5.fromJSON(t4);
    case "linear-unit":
      return c4.fromJSON(t4);
    case "feature-record-set-layer":
      if ("url" in t4)
        return p5.fromJSON(t4);
      if ("layerDefinition" in t4) {
        const e10 = new (0, (await import("./FeatureLayer-I6BSIWIF.js")).default)(), { layerDefinition: a11, featureSet: n5 } = t4;
        return e10.read({ layerDefinition: a11, featureSet: n5 }, { origin: "portal-item" }), e10.spatialReference = f2.fromJSON(n5.spatialReference ?? a11.spatialReference ?? a11.extent.spatialReference), e10;
      }
      return d2.fromJSON(t4);
    case "record-set":
      return "url" in t4 ? p5.fromJSON(t4) : d2.fromJSON(t4);
    case "raster-data":
    case "raster-data-layer":
      return "mapImage" in t4 ? i5.fromJSON(t4.mapImage) : p7.fromJSON(t4);
    case "field":
      return y2.fromJSON(t4);
  }
}
function N(e9) {
  return e9.startsWith(a6);
}
function j3(e9) {
  return e9.replace(a6, "");
}
async function g2(e9) {
  const r4 = t2.fromJSON(e9.dataType), { paramName: t4 } = e9, a11 = N(r4) ? await Promise.all(e9.value.map((e10) => d3(j3(r4), e10))) : await d3(r4, e9.value);
  return new m3({ dataType: r4, paramName: t4, value: a11 });
}
function J2(e9, r4, t4) {
  for (const a11 in e9) {
    const r5 = e9[a11];
    Array.isArray(r5) ? e9[a11] = JSON.stringify(r5.map((e10) => J2({ item: e10 }, true).item)) : r5 instanceof Date && (e9[a11] = r5.getTime());
  }
  return s2(e9, r4, t4);
}

// node_modules/@arcgis/core/rest/geoprocessor/execute.js
async function m4(m6, o5, a11, p12) {
  return a11 = l.from(a11 || {}), y3(m6, "execute", a11, o5 ?? {}, p12).then(async ({ data: s7 }) => {
    var _a, _b;
    return { results: await Promise.all(((_a = s7.results) == null ? void 0 : _a.map(g2)) ?? []), messages: ((_b = s7.messages) == null ? void 0 : _b.map((s8) => a4.fromJSON(s8))) ?? [] };
  });
}

// node_modules/@arcgis/core/rest/support/JobInfo.js
var j4;
var d4 = i()({ esriJobCancelled: "job-cancelled", esriJobCancelling: "job-cancelling", esriJobDeleted: "job-deleted", esriJobDeleting: "job-deleting", esriJobTimedOut: "job-timed-out", esriJobExecuting: "job-executing", esriJobFailed: "job-failed", esriJobNew: "job-new", esriJobSubmitted: "job-submitted", esriJobSucceeded: "job-succeeded", esriJobWaiting: "job-waiting" }, { ignoreUnknown: false });
var h = j4 = class extends f {
  constructor(e9) {
    super(e9), this.jobId = null, this.jobStatus = null, this.messages = null, this.progress = null, this.requestOptions = null, this.sourceUrl = null, this._timer = void 0;
  }
  async cancelJob(e9) {
    const { jobId: s7, sourceUrl: o5 } = this, { path: r4 } = f3(o5), i9 = { ...this.requestOptions, ...e9, query: { f: "json" } };
    this._clearTimer();
    const a11 = `${r4}/jobs/${s7}/cancel`, { data: n5 } = await U(a11, i9), { messages: c6, jobStatus: l3, progress: p12 } = j4.fromJSON(n5);
    return this.set({ messages: c6, jobStatus: l3, progress: p12 }), this;
  }
  destroy() {
    clearInterval(this._timer);
  }
  async checkJobStatus(e9) {
    const { path: s7 } = f3(this.sourceUrl), o5 = { ...this.requestOptions, ...e9, query: { f: "json" } }, r4 = `${s7}/jobs/${this.jobId}`, { data: i9 } = await U(r4, o5), { messages: a11, jobStatus: n5, progress: c6 } = j4.fromJSON(i9);
    return this.set({ messages: a11, jobStatus: n5, progress: c6 }), this;
  }
  async fetchResultData(e9, s7, o5) {
    s7 = l.from(s7 || {});
    const { returnColumnName: r4, returnFeatureCollection: i9, returnM: a11, returnZ: n5, outSpatialReference: c6 } = s7, { path: m6 } = f3(this.sourceUrl), j5 = J2({ returnColumnName: r4 || null, returnFeatureCollection: i9 || null, returnM: a11 || null, returnZ: n5 || null, outSR: c6, returnType: "data", f: "json" }, null), d6 = { ...this.requestOptions, ...o5, query: j5 }, h3 = `${m6}/jobs/${this.jobId}/results/${e9}`, { data: g5 } = await U(h3, d6);
    return g2(g5);
  }
  async fetchResultImage(e9, s7, o5) {
    const { path: r4 } = f3(this.sourceUrl), i9 = { ...s7.toJSON(), f: "json" }, a11 = J2(i9), n5 = { ...this.requestOptions, ...o5, query: a11 }, c6 = `${r4}/jobs/${this.jobId}/results/${e9}`, { data: l3 } = await U(c6, n5);
    return g2(l3);
  }
  async fetchResultMapImageLayer() {
    const { path: e9 } = f3(this.sourceUrl), t4 = e9.indexOf("/GPServer/"), s7 = `${e9.substring(0, t4)}/MapServer/jobs/${this.jobId}`;
    return new (0, (await import("./MapImageLayer-TBL2CROJ.js")).default)({ url: s7 });
  }
  async waitForJobCompletion(e9 = {}) {
    const { interval: t4 = 1e3, signal: s7, statusCallback: o5 } = e9;
    return new Promise((e10, a11) => {
      m(s7, () => {
        this._clearTimer(), a11(u());
      }), this._clearTimer();
      const n5 = setInterval(() => {
        this._timer || a11(u()), this.checkJobStatus(this.requestOptions).then((t5) => {
          const { jobStatus: s8 } = t5;
          switch (this.jobStatus = s8, s8) {
            case "job-succeeded":
              this._clearTimer(), e10(this);
              break;
            case "job-submitted":
            case "job-executing":
            case "job-waiting":
            case "job-new":
              o5 && o5(this);
              break;
            case "job-cancelled":
            case "job-cancelling":
            case "job-deleted":
            case "job-deleting":
            case "job-timed-out":
            case "job-failed":
              this._clearTimer(), a11(this);
          }
        });
      }, t4);
      this._timer = n5;
    });
  }
  _clearTimer() {
    clearInterval(this._timer), this._timer = void 0;
  }
};
e([y()], h.prototype, "jobId", void 0), e([o(d4, { ignoreUnknown: false })], h.prototype, "jobStatus", void 0), e([y({ type: [a4] })], h.prototype, "messages", void 0), e([y()], h.prototype, "progress", void 0), e([y()], h.prototype, "requestOptions", void 0), e([y({ json: { write: true } })], h.prototype, "sourceUrl", void 0), h = j4 = e([a2("esri.rest.support.JobInfo")], h);
var g3 = h;

// node_modules/@arcgis/core/rest/geoprocessor/submitJob.js
async function s3(s7, m6, n5, f5) {
  return n5 = l.from(n5 || {}), y3(s7, "submitJob", n5, m6 ?? {}, f5).then(({ data: o5 }) => {
    const r4 = g3.fromJSON(o5);
    return r4.sourceUrl = s7, r4;
  });
}

// node_modules/@arcgis/core/rest/support/layoutTemplate.js
var t3 = new n2({ MAP_ONLY: "map-only", "A3 Landscape": "a3-landscape", "A3 Portrait": "a3-portrait", "A4 Landscape": "a4-landscape", "A4 Portrait": "a4-portrait", "Letter ANSI A Landscape": "letter-ansi-a-landscape", "Letter ANSI A Portrait": "letter-ansi-a-portrait", "Tabloid ANSI B Landscape": "tabloid-ansi-b-landscape", "Tabloid ANSI B Portrait": "tabloid-ansi-b-portrait" });
var r2 = t3.fromJSON.bind(t3);
var o3 = t3.toJSON.bind(t3);

// node_modules/@arcgis/core/rest/support/printTaskUtils.js
var o4 = "simple-marker";
var a8 = "picture-marker";
var l2 = "simple-line";
var s4 = "simple-fill";
var u4 = "shield-label-symbol";
var f4 = "text";
function y4(y5, c6) {
  const { graphic: p12, renderer: m6, symbol: d6 } = c6, g5 = d6.type;
  if (g5 === f4 || g5 === u4 || !("visualVariables" in m6) || !m6.visualVariables)
    return;
  const b4 = m6.getVisualVariablesForType("size"), h3 = m6.getVisualVariablesForType("color"), V4 = m6.getVisualVariablesForType("opacity"), w3 = m6.getVisualVariablesForType("rotation"), T3 = b4[0], v4 = h3[0], G2 = V4[0], S7 = w3[0];
  if (T3) {
    const t4 = g5 === o4 ? d6.style : null, i9 = V2(T3, p12, { shape: t4 });
    null != i9 && (g5 === o4 ? y5.size = e3(i9) : g5 === a8 ? (y5.width = e3(i9), y5.height = e3(i9)) : g5 === l2 ? y5.width = e3(i9) : y5.outline && (y5.outline.width = e3(i9)));
  }
  if (v4) {
    const e9 = p(v4, p12);
    (e9 && g5 === o4 || g5 === l2 || g5 === s4) && (y5.color = e9 ? e9.toJSON() : void 0);
  }
  if (G2) {
    const e9 = v2(G2, p12);
    null != e9 && y5.color && (y5.color[3] = Math.round(255 * e9));
  }
  S7 && (y5.angle = -b2(m6, p12));
}
function c5() {
  return { layerDefinition: { name: "multipointLayer", geometryType: "esriGeometryMultipoint", drawingInfo: { renderer: null } }, featureSet: { geometryType: "esriGeometryMultipoint", features: [] } };
}
function p8() {
  return { layerDefinition: { name: "polygonLayer", geometryType: "esriGeometryPolygon", drawingInfo: { renderer: null } }, featureSet: { geometryType: "esriGeometryPolygon", features: [] } };
}
function m5() {
  return { layerDefinition: { name: "pointLayer", geometryType: "esriGeometryPoint", drawingInfo: { renderer: null } }, featureSet: { geometryType: "esriGeometryPoint", features: [] } };
}
function d5() {
  return { layerDefinition: { name: "polylineLayer", geometryType: "esriGeometryPolyline", drawingInfo: { renderer: null } }, featureSet: { geometryType: "esriGeometryPolyline", features: [] } };
}
function g4(e9, r4 = 15) {
  const t4 = e9.canvas.width, i9 = e9.canvas.height, n5 = e9.getImageData(0, 0, t4, i9).data;
  let o5, a11, l3, s7, u5, f5;
  e:
    for (a11 = i9; a11--; )
      for (o5 = t4; o5--; )
        if (n5[4 * (t4 * a11 + o5) + 3] > r4) {
          f5 = a11;
          break e;
        }
  if (!f5)
    return null;
  e:
    for (o5 = t4; o5--; )
      for (a11 = f5 + 1; a11--; )
        if (n5[4 * (t4 * a11 + o5) + 3] > r4) {
          u5 = o5;
          break e;
        }
  e:
    for (o5 = 0; o5 <= u5; ++o5)
      for (a11 = f5 + 1; a11--; )
        if (n5[4 * (t4 * a11 + o5) + 3] > r4) {
          l3 = o5;
          break e;
        }
  e:
    for (a11 = 0; a11 <= f5; ++a11)
      for (o5 = l3; o5 <= u5; ++o5)
        if (n5[4 * (t4 * a11 + o5) + 3] > r4) {
          s7 = a11;
          break e;
        }
  return { x: l3, y: s7, width: u5 - l3, height: f5 - s7 };
}
function b3(e9, r4) {
  const t4 = e9.allLayerViews.items;
  if (r4 === e9.scale)
    return t4.filter((e10) => !e10.suspended);
  const i9 = new Array();
  for (const n5 of t4)
    T(n5.parent) && !i9.includes(n5.parent) || !n5.visible || r4 && "isVisibleAtScale" in n5 && !n5.isVisibleAtScale(r4) || i9.push(n5);
  return i9;
}
function h2(e9) {
  return "bing-maps" === (e9 == null ? void 0 : e9.type);
}
function V3(e9) {
  return e9 && "blendMode" in e9 && "effect" in e9;
}
function w2(e9) {
  return "csv" === (e9 == null ? void 0 : e9.type);
}
function T(e9) {
  return "esri.views.2d.layers.GroupLayerView2D" === (e9 == null ? void 0 : e9.declaredClass);
}
function v3(e9) {
  const r4 = e9.layer;
  if (V3(r4)) {
    const t4 = r4.blendMode;
    if ((!t4 || "normal" === t4) && (r4.effect || "featureEffect" in e9 && e9.featureEffect))
      return true;
  }
  return false;
}

// node_modules/@arcgis/core/rest/support/PrintTemplate.js
var p9 = class extends S {
  constructor(t4) {
    super(t4), this.attributionVisible = true, this.exportOptions = { width: 800, height: 1100, dpi: 96 }, this.forceFeatureAttributes = false, this.format = "png32", this.includeCharts = false, this.includeTables = false, this.label = null, this.layout = "map-only", this.layoutItem = null, this.layoutOptions = null, this.outScale = 0, this.report = null, this.reportItem = null, this.reportOptions = null, this.scalePreserved = true, this.showLabels = true;
  }
};
e([y()], p9.prototype, "attributionVisible", void 0), e([y()], p9.prototype, "exportOptions", void 0), e([y()], p9.prototype, "forceFeatureAttributes", void 0), e([y()], p9.prototype, "format", void 0), e([y()], p9.prototype, "includeCharts", void 0), e([y()], p9.prototype, "includeTables", void 0), e([y()], p9.prototype, "label", void 0), e([y()], p9.prototype, "layout", void 0), e([y({ type: S3 })], p9.prototype, "layoutItem", void 0), e([y()], p9.prototype, "layoutOptions", void 0), e([y()], p9.prototype, "outScale", void 0), e([y()], p9.prototype, "report", void 0), e([y({ type: S3 })], p9.prototype, "reportItem", void 0), e([y()], p9.prototype, "reportOptions", void 0), e([y()], p9.prototype, "scalePreserved", void 0), e([y()], p9.prototype, "showLabels", void 0), p9 = e([a2("esri.rest.support.PrintTemplate")], p9);
var i7 = p9;

// node_modules/@arcgis/core/rest/support/reportTemplate.js
var e8 = new n2({ "Attribute List Letter ANSI A Landscape": "attribute-list-letter-ansi-a-landscape", "Attribute List Letter ANSI A Portrait": "attribute-list-letter-ansi-a-portrait", "Attribute List With Group Letter ANSI A Landscape": "attribute-list-with-group-letter-ansi-a-landscape", "Attribute List With Group Letter ANSI A Portrait": "attribute-list-with-group-letter-ansi-a-portrait", "Page per Feature Letter ANSI A Landscape": "page-per-feature-letter-ansi-a-landscape", "Page per Feature Letter ANSI A Portrait": "page-per-feature-letter-ansi-a-portrait" });
var r3 = e8.fromJSON.bind(e8);
var a9 = e8.toJSON.bind(e8);

// node_modules/@arcgis/core/rest/print.js
var F2 = { Feet: "ft", Kilometers: "km", Meters: "m", Miles: "mi" };
var R2 = new n2({ esriFeet: "Feet", esriKilometers: "Kilometers", esriMeters: "Meters", esriMiles: "Miles" });
var N2 = new n2({ esriExecutionTypeSynchronous: "sync", esriExecutionTypeAsynchronous: "async" });
var J3 = /* @__PURE__ */ new Map();
async function U2(e9, i9, r4) {
  const a11 = k2(e9);
  let n5 = J3.get(a11);
  return Promise.resolve().then(() => n5 ? { data: n5.gpMetadata } : (n5 = { gpServerUrl: a11, is11xService: false, legendLayerNameMap: {}, legendLayers: [] }, U(a11, i2({ f: "json" }, r4)))).then((e10) => (n5.gpMetadata = e10.data, n5.cimVersion = n5.gpMetadata.cimVersion, n5.is11xService = !!n5.cimVersion, J3.set(a11, n5), C(i9, n5))).then((t4) => {
    const a12 = pe(n5);
    let s7;
    const o5 = (e10) => {
      var _a, _b;
      return "sync" === a12 ? (_b = (_a = e10.results) == null ? void 0 : _a[0]) == null ? void 0 : _b.value : s7.fetchResultData("Output_File", null, r4).then((e11) => e11.value);
    };
    return "async" === a12 ? s3(e9, t4, void 0, r4).then((e10) => (s7 = e10, e10.waitForJobCompletion({ interval: i9.updateDelay }).then(o5))) : m4(e9, t4, void 0, r4).then(o5);
  });
}
async function C(t4, r4) {
  var _a, _b, _c, _d, _e, _f, _g;
  r4 = r4 || { is11xService: false, legendLayerNameMap: {}, legendLayers: [] };
  const a11 = t4.template || new i7();
  null == a11.showLabels && (a11.showLabels = true);
  const n5 = a11.exportOptions;
  let s7;
  const o5 = o3(a11.layout);
  if (n5) {
    if (s7 = { dpi: n5.dpi }, "map_only" === o5.toLowerCase() || "" === o5) {
      const e9 = n5.width, t5 = n5.height;
      s7.outputSize = null != e9 && null != t5 ? [e9, t5] : void 0;
    }
  }
  const l3 = a11.layoutOptions;
  let c6;
  if (l3) {
    let e9, t5;
    "Miles" === l3.scalebarUnit || "Kilometers" === l3.scalebarUnit ? (e9 = "Kilometers", t5 = "Miles") : "Meters" !== l3.scalebarUnit && "Feet" !== l3.scalebarUnit || (e9 = "Meters", t5 = "Feet"), c6 = { titleText: l3.titleText, authorText: l3.authorText, copyrightText: l3.copyrightText, customTextElements: l3.customTextElements, elementOverrides: l3.elementOverrides, scaleBarOptions: { metricUnit: R2.toJSON(e9), metricLabel: e9 ? F2[e9] : void 0, nonMetricUnit: R2.toJSON(t5), nonMetricLabel: t5 ? F2[t5] : void 0 } };
  }
  let u5 = null;
  (l3 == null ? void 0 : l3.legendLayers) && (u5 = l3.legendLayers.map((e9) => {
    const t5 = e9.layerId;
    r4.legendLayerNameMap[t5] = e9.title;
    const i9 = { id: t5 };
    return e9.subLayerIds && (i9.subLayerIds = e9.subLayerIds), i9;
  }));
  const y5 = await A(t4, a11, r4);
  if (y5.operationalLayers) {
    const e9 = new RegExp("[\\u4E00-\\u9FFF\\u0E00-\\u0E7F\\u0900-\\u097F\\u3040-\\u309F\\u30A0-\\u30FF\\u31F0-\\u31FF]"), t5 = /[\u0600-\u06FF]/, a12 = (i9) => {
      var _a2;
      const r5 = i9.text, a13 = i9.font, n7 = (_a2 = a13 == null ? void 0 : a13.family) == null ? void 0 : _a2.toLowerCase();
      r5 && a13 && ("arial" === n7 || "arial unicode ms" === n7) && (a13.family = e9.test(r5) ? "Arial Unicode MS" : "Arial", "normal" !== a13.style && t5.test(r5) && (a13.family = "Arial Unicode MS"));
    }, n6 = () => {
      throw new s("print:cim-symbol-unsupported", "CIMSymbol is not supported by a print service published from ArcMap");
    };
    for (const i9 of y5.operationalLayers)
      if ((_a = i9.featureCollection) == null ? void 0 : _a.layers)
        for (const e10 of i9.featureCollection.layers) {
          if ((_d = (_c = (_b = e10.layerDefinition) == null ? void 0 : _b.drawingInfo) == null ? void 0 : _c.renderer) == null ? void 0 : _d.symbol) {
            const t6 = e10.layerDefinition.drawingInfo.renderer;
            "esriTS" === t6.symbol.type ? a12(t6.symbol) : "CIMSymbolReference" !== t6.symbol.type || r4.is11xService || n6();
          }
          if ((_e = e10.featureSet) == null ? void 0 : _e.features)
            for (const t6 of e10.featureSet.features)
              t6.symbol && ("esriTS" === t6.symbol.type ? a12(t6.symbol) : "CIMSymbolReference" !== t6.symbol.type || r4.is11xService || n6());
        }
      else
        !r4.is11xService && ((_g = (_f = i9.layerDefinition) == null ? void 0 : _f.drawingInfo) == null ? void 0 : _g.renderer) && JSON.stringify(i9.layerDefinition.drawingInfo.renderer).includes('"type":"CIMSymbolReference"') && n6();
  }
  t4.outSpatialReference && (y5.mapOptions.spatialReference = t4.outSpatialReference.toJSON()), Object.assign(y5, { exportOptions: s7, layoutOptions: c6 || {} }), Object.assign(y5.layoutOptions, { legendOptions: { operationalLayers: null != u5 ? u5 : r4.legendLayers.slice() } }), r4.legendLayers.length = 0, J3.set(r4.gpServerUrl, r4);
  const p12 = { Web_Map_as_JSON: JSON.stringify(y5), Format: g(a11.format), Layout_Template: o5, Layout_Item_ID: void 0, Report_Template: a9(a11.report), Report_Item_ID: void 0 };
  if (a11.layoutItem) {
    delete p12.Layout_Template;
    const t5 = a11.layoutItem;
    await t5.load(), "public" !== t5.access && t && await t.getCredential(r4.gpServerUrl), p12.Layout_Item_ID = JSON.stringify({ id: t5.id });
  }
  if (a11.reportItem) {
    delete p12.Report_Template;
    const t5 = a11.reportItem;
    await t5.load(), "public" !== t5.access && t && await t.getCredential(r4.gpServerUrl), p12.Report_Item_ID = JSON.stringify({ id: t5.id });
  }
  return t4.extraParameters && Object.assign(p12, t4.extraParameters), p12;
}
async function A(e9, t4, i9) {
  const r4 = e9.view;
  let a11 = r4.spatialReference;
  const n5 = { operationalLayers: await _(r4, t4, i9) };
  t4.includeTables && (n5.tables = await ie(r4));
  let s7 = i9.ssExtent || e9.extent || r4.extent;
  if (a11 && a11.isWrappable && (s7 = s7.clone()._normalize(true), a11 = s7.spatialReference), n5.mapOptions = { extent: s7 && s7.toJSON(), spatialReference: a11 && a11.toJSON(), showAttribution: t4.attributionVisible }, i9.ssExtent = null, r4.background && (n5.background = r4.background.toJSON()), r4.rotation && (n5.mapOptions.rotation = -r4.rotation), t4.scalePreserved && (n5.mapOptions.scale = t4.outScale || r4.scale), null != r4.timeExtent) {
    const e10 = null != r4.timeExtent.start ? r4.timeExtent.start.getTime() : null, t5 = null != r4.timeExtent.end ? r4.timeExtent.end.getTime() : null;
    n5.mapOptions.time = [e10, t5];
  }
  return t4.reportOptions && (n5.reportOptions = t4.reportOptions), n5;
}
function k2(e9) {
  let t4 = e9;
  const i9 = t4.lastIndexOf("/GPServer/");
  return i9 > 0 && (t4 = t4.slice(0, i9 + 9)), t4;
}
async function _(e9, t4, i9) {
  var _a;
  const r4 = [], a11 = { layerView: null, printTemplate: t4, view: e9 };
  let n5 = 0;
  t4.scalePreserved && (n5 = t4.outScale || e9.scale);
  const s7 = b3(e9, n5);
  for (const o5 of s7) {
    const e10 = o5.layer;
    if (!e10.loaded || "group" === (e10 == null ? void 0 : e10.type))
      continue;
    let t5;
    a11.layerView = o5, t5 = v3(o5) ? await ee(e10, a11, i9) : h2(e10) ? z(e10) : w2(e10) ? await $(e10, a11, i9) : "feature" === (e10 == null ? void 0 : e10.type) ? await W(e10, a11, i9) : "geojson" === (e10 == null ? void 0 : e10.type) ? await q(e10, a11, i9) : "graphics" === (e10 == null ? void 0 : e10.type) ? await B(e10, a11, i9) : "imagery" === (e10 == null ? void 0 : e10.type) ? H(e10, i9) : "imagery-tile" === (e10 == null ? void 0 : e10.type) ? await G(e10, a11, i9) : "kml" === (e10 == null ? void 0 : e10.type) ? await Q2(e10, a11, i9) : "map-image" === (e10 == null ? void 0 : e10.type) ? X(e10, a11, i9) : "map-notes" === (e10 == null ? void 0 : e10.type) ? await Y(a11, i9) : "open-street-map" === (e10 == null ? void 0 : e10.type) ? Z() : "stream" === (e10 == null ? void 0 : e10.type) ? await te(e10, a11, i9) : "tile" === (e10 == null ? void 0 : e10.type) ? re(e10, i9) : "vector-tile" === (e10 == null ? void 0 : e10.type) ? await ae(e10, a11, i9) : "web-tile" === (e10 == null ? void 0 : e10.type) ? ne(e10) : "wms" === (e10 == null ? void 0 : e10.type) ? se(e10, i9) : "wmts" === (e10 == null ? void 0 : e10.type) ? oe(e10) : await ee(e10, a11, i9), t5 && (Array.isArray(t5) ? r4.push(...t5) : (t5.id = e10.id, t5.title = i9.legendLayerNameMap[e10.id] || e10.title, t5.opacity = o5.fullOpacity, t5.minScale = e10.minScale || 0, t5.maxScale = e10.maxScale || 0, V3(e10) && e10.blendMode && "normal" !== e10.blendMode && (t5.blendMode = e10.blendMode), r4.push(t5)));
  }
  if (n5)
    for (const o5 of r4)
      o5.minScale = 0, o5.maxScale = 0;
  if ((_a = e9.graphics) == null ? void 0 : _a.length) {
    const a12 = await K2(null, e9.graphics, t4, i9);
    a12 && r4.push(a12);
  }
  return r4;
}
function z(e9) {
  return { culture: e9.culture, key: e9.key, type: "BingMaps" + ("aerial" === e9.style ? "Aerial" : "hybrid" === e9.style ? "Hybrid" : "Road") };
}
async function $(e9, t4, i9) {
  e9.legendEnabled && i9.legendLayers.push({ id: e9.id });
  const r4 = t4.layerView, a11 = t4.printTemplate;
  let n5;
  if (!i9.is11xService || r4.filter || e9.portalItem && "public" !== e9.portalItem.access) {
    return K2(e9, await ye(r4), a11, i9);
  }
  return n5 = { type: "CSV" }, e9.write(n5, { origin: "web-map" }), delete n5.popupInfo, delete n5.layerType, n5.showLabels = a11.showLabels && e9.labelsVisible, n5;
}
async function K2(e9, t4, i9, r4) {
  var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j;
  let a11;
  const n5 = p8(), s7 = d5(), o5 = m5(), l3 = c5(), y5 = m5();
  if (y5.layerDefinition.name = "textLayer", delete y5.layerDefinition.drawingInfo, e9) {
    if ("esri.layers.FeatureLayer" === e9.declaredClass || "esri.layers.StreamLayer" === e9.declaredClass ? n5.layerDefinition.name = s7.layerDefinition.name = o5.layerDefinition.name = l3.layerDefinition.name = r4.legendLayerNameMap[e9.id] || e9.get("arcgisProps.title") || e9.title : "esri.layers.GraphicsLayer" === e9.declaredClass && (t4 = e9.graphics.items), e9.renderer) {
      const t5 = e9.renderer.toJSON(), i10 = n5.layerDefinition.drawingInfo;
      i10 && (i10.renderer = t5);
      const r5 = s7.layerDefinition.drawingInfo;
      r5 && (r5.renderer = t5);
      const a12 = o5.layerDefinition.drawingInfo;
      a12 && (a12.renderer = t5);
      const c6 = l3.layerDefinition.drawingInfo;
      c6 && (c6.renderer = t5);
    }
    if (i9.showLabels && e9.labelsVisible && "function" == typeof e9.write) {
      const t5 = e9.write({}, { origin: "web-map" }), i10 = (_b = (_a = t5.layerDefinition) == null ? void 0 : _a.drawingInfo) == null ? void 0 : _b.labelingInfo;
      if (i10) {
        a11 = true;
        const e10 = n5.layerDefinition.drawingInfo;
        e10 && (e10.labelingInfo = i10);
        const t6 = s7.layerDefinition.drawingInfo;
        t6 && (t6.labelingInfo = i10);
        const r5 = o5.layerDefinition.drawingInfo;
        r5 && (r5.labelingInfo = i10);
        const c6 = l3.layerDefinition.drawingInfo;
        c6 && (c6.labelingInfo = i10);
      }
    }
  }
  let p12;
  (e9 == null ? void 0 : e9.renderer) || a11 || (delete n5.layerDefinition.drawingInfo, delete s7.layerDefinition.drawingInfo, delete o5.layerDefinition.drawingInfo, delete l3.layerDefinition.drawingInfo);
  const f5 = e9 == null ? void 0 : e9.fieldsIndex, d6 = e9 == null ? void 0 : e9.renderer;
  if (f5) {
    const t5 = /* @__PURE__ */ new Set();
    a11 && await J(t5, e9), d6 && "function" == typeof d6.collectRequiredFields && await d6.collectRequiredFields(t5, f5), p12 = Array.from(t5);
    const i10 = f5.fields.map((e10) => e10.toJSON());
    n5.layerDefinition.fields = i10, s7.layerDefinition.fields = i10, o5.layerDefinition.fields = i10, l3.layerDefinition.fields = i10;
  }
  const m6 = t4 == null ? void 0 : t4.length;
  let g5;
  for (let u5 = 0; u5 < m6; u5++) {
    const a12 = t4[u5] || t4.at(u5);
    if (false === a12.visible || !a12.geometry)
      continue;
    if (g5 = a12.toJSON(), g5.hasOwnProperty("popupTemplate") && delete g5.popupTemplate, ((_c = g5.geometry) == null ? void 0 : _c.z) && delete g5.geometry.z, ((_d = g5.symbol) == null ? void 0 : _d.outline) && "esriCLS" === g5.symbol.outline.type && !r4.is11xService)
      continue;
    !r4.is11xService && ((_g = (_f = (_e = g5.symbol) == null ? void 0 : _e.outline) == null ? void 0 : _f.color) == null ? void 0 : _g[3]) && (g5.symbol.outline.color[3] = 255);
    const f6 = (e9 == null ? void 0 : e9.renderer) && ("valueExpression" in e9.renderer && e9.renderer.valueExpression || "hasVisualVariables" in e9.renderer && e9.renderer.hasVisualVariables());
    if (!g5.symbol && (e9 == null ? void 0 : e9.renderer) && f6 && !r4.is11xService) {
      const t5 = e9.renderer, i10 = await t5.getSymbolAsync(a12);
      if (!i10)
        continue;
      g5.symbol = i10.toJSON(), "hasVisualVariables" in t5 && t5.hasVisualVariables() && y4(g5.symbol, { renderer: t5, graphic: a12, symbol: i10 });
    }
    if (g5.symbol && (g5.symbol.angle || delete g5.symbol.angle, fe(g5.symbol) ? g5.symbol = await ce(g5.symbol, r4) : g5.symbol.text && delete g5.attributes), (!i9 || !i9.forceFeatureAttributes) && (p12 == null ? void 0 : p12.length)) {
      const e10 = {};
      for (const t5 of p12)
        ((_h = g5.attributes) == null ? void 0 : _h.hasOwnProperty(t5)) && (e10[t5] = g5.attributes[t5]);
      g5.attributes = e10;
    }
    "polygon" === a12.geometry.type ? n5.featureSet.features.push(g5) : "polyline" === a12.geometry.type ? s7.featureSet.features.push(g5) : "point" === a12.geometry.type ? ((_i = g5.symbol) == null ? void 0 : _i.text) ? y5.featureSet.features.push(g5) : o5.featureSet.features.push(g5) : "multipoint" === a12.geometry.type ? l3.featureSet.features.push(g5) : "extent" === a12.geometry.type && (g5.geometry = j2.fromExtent(a12.geometry).toJSON(), n5.featureSet.features.push(g5));
  }
  const h3 = [n5, s7, l3, o5, y5].filter((e10) => e10.featureSet.features.length > 0);
  for (const c6 of h3) {
    const e10 = c6.featureSet.features.every((e11) => e11.symbol);
    if (e10 && (!i9 || !i9.forceFeatureAttributes))
      for (const t5 of c6.featureSet.features)
        delete t5.attributes;
    e10 && delete c6.layerDefinition.drawingInfo, ((_j = c6.layerDefinition.drawingInfo) == null ? void 0 : _j.renderer) && await ue(c6.layerDefinition.drawingInfo.renderer, r4);
  }
  return h3.length ? { featureCollection: { layers: h3 }, showLabels: a11 } : null;
}
async function W(e9, t4, i9) {
  var _a, _b, _c, _d, _e, _f, _g;
  let r4;
  const a11 = e9.renderer, n5 = parseFloat(i9.cimVersion);
  if ("binning" === ((_a = e9.featureReduction) == null ? void 0 : _a.type) || "cluster" === ((_b = e9.featureReduction) == null ? void 0 : _b.type) && (!i9.is11xService || n5 < 2.9) || "pie-chart" === (a11 == null ? void 0 : a11.type) || "dot-density" === (a11 == null ? void 0 : a11.type) && (!i9.is11xService || n5 < 2.6))
    return ee(e9, t4, i9);
  e9.legendEnabled && i9.legendLayers.push({ id: e9.id });
  const s7 = t4.layerView, { printTemplate: o5, view: l3 } = t4, c6 = a11 && ("valueExpression" in a11 && a11.valueExpression || "hasVisualVariables" in a11 && a11.hasVisualVariables()), u5 = "feature-layer" !== ((_c = e9.source) == null ? void 0 : _c.type) && "ogc-feature" !== ((_d = e9.source) == null ? void 0 : _d.type);
  if (!i9.is11xService && c6 || s7.filter || u5 || !a11 || "field" in a11 && null != a11.field && ("string" != typeof a11.field || !e9.getField(a11.field))) {
    const t5 = await ye(s7);
    r4 = await K2(e9, t5, o5, i9);
  } else {
    if (r4 = { id: (f5 = e9.write()).id, title: f5.title, url: f5.url, layerType: f5.layerType, customParameters: f5.customParameters, layerDefinition: f5.layerDefinition, charts: o5.includeCharts ? f5.charts : void 0 }, r4.showLabels = o5.showLabels && e9.labelsVisible, le(r4, e9), ((_f = (_e = r4.layerDefinition) == null ? void 0 : _e.drawingInfo) == null ? void 0 : _f.renderer) && (delete r4.layerDefinition.minScale, delete r4.layerDefinition.maxScale, await ue(r4.layerDefinition.drawingInfo.renderer, i9), "visualVariables" in a11 && a11.visualVariables && a11.visualVariables[0])) {
      const e10 = a11.visualVariables[0];
      if ("size" === e10.type && e10.maxSize && "number" != typeof e10.maxSize && e10.minSize && "number" != typeof e10.minSize) {
        const t6 = D2(e10, l3.scale);
        r4.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize = t6.minSize, r4.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize = t6.maxSize;
      }
    }
    const t5 = o2(s7);
    if (t5 && (r4.layerDefinition || (r4.layerDefinition = {}), r4.layerDefinition.definitionExpression = r4.layerDefinition.definitionExpression ? `(${r4.layerDefinition.definitionExpression}) AND (${t5})` : t5), ((_g = s7.hasHighlight) == null ? void 0 : _g.call(s7)) && "getHighlightIds" in s7) {
      const e10 = s7;
      r4.selectionObjectIds = e10.getHighlightIds();
    }
  }
  var f5;
  return r4;
}
async function q(e9, t4, i9) {
  var _a, _b;
  if ("binning" === ((_a = e9.featureReduction) == null ? void 0 : _a.type) || "cluster" === ((_b = e9.featureReduction) == null ? void 0 : _b.type))
    return ee(e9, t4, i9);
  e9.legendEnabled && i9.legendLayers.push({ id: e9.id });
  return K2(e9, await ye(t4.layerView), t4.printTemplate, i9);
}
async function B(e9, { printTemplate: t4 }, i9) {
  return K2(e9, null, t4, i9);
}
function H(e9, t4) {
  e9.legendEnabled && t4.legendLayers.push({ id: e9.id });
  const i9 = { layerType: (r4 = e9.write()).layerType, customParameters: r4.customParameters };
  var r4;
  if (i9.bandIds = e9.bandIds, i9.compressionQuality = e9.compressionQuality, i9.format = e9.format, i9.interpolation = e9.interpolation, (e9.mosaicRule || e9.definitionExpression) && (i9.mosaicRule = e9.exportImageServiceParameters.mosaicRule.toJSON()), e9.rasterFunction || e9.renderer)
    if (t4.is11xService)
      e9.rasterFunction && (i9.renderingRule = e9.rasterFunction.toJSON()), e9.renderer && (i9.layerDefinition = i9.layerDefinition || {}, i9.layerDefinition.drawingInfo = i9.layerDefinition.drawingInfo || {}, i9.layerDefinition.drawingInfo.renderer = e9.renderer.toJSON());
    else {
      const t5 = e9.exportImageServiceParameters.combineRendererWithRenderingRule();
      t5 && (i9.renderingRule = t5.toJSON());
    }
  return le(i9, e9), i9;
}
async function G(e9, t4, i9) {
  var _a;
  if ("flow" === ((_a = e9.renderer) == null ? void 0 : _a.type))
    return ee(e9, t4, i9);
  e9.legendEnabled && i9.legendLayers.push({ id: e9.id });
  const r4 = { bandIds: (a11 = e9.write() || {}).bandIds, customParameters: a11.customParameters, interpolation: a11.interpolation, layerDefinition: a11.layerDefinition };
  var a11;
  return r4.layerType = "ArcGISImageServiceLayer", le(r4, e9), r4;
}
async function Q2(e9, t4, i9) {
  const r4 = t4.printTemplate;
  if (i9.is11xService) {
    const t5 = { type: "kml" };
    return e9.write(t5, { origin: "web-map" }), delete t5.layerType, t5.url = K(e9.url), t5;
  }
  const a11 = [], n5 = t4.layerView;
  n5.allVisibleMapImages.forEach((t5, i10) => {
    const r5 = { id: `${e9.id}_image${i10}`, type: "image", title: e9.id, minScale: e9.minScale || 0, maxScale: e9.maxScale || 0, opacity: n5.fullOpacity, extent: t5.extent };
    "data:image/png;base64," === t5.href.substr(0, 22) ? r5.imageData = t5.href.substr(22) : r5.url = t5.href, a11.push(r5);
  });
  const s7 = [...n5.allVisiblePoints.items, ...n5.allVisiblePolylines.items, ...n5.allVisiblePolygons.items], l3 = { id: e9.id, ...await K2(null, s7, r4, i9) };
  return a11.push(l3), a11;
}
function X(e9, { view: t4 }, i9) {
  var _a, _b;
  let r4;
  const a11 = { id: e9.id, subLayerIds: [] };
  let n5 = [];
  const s7 = t4.scale, o5 = (e10) => {
    const t5 = 0 === s7, i10 = 0 === e10.minScale || s7 <= e10.minScale, r5 = 0 === e10.maxScale || s7 >= e10.maxScale;
    if (e10.visible && (t5 || i10 && r5))
      if (e10.sublayers)
        e10.sublayers.forEach(o5);
      else {
        const t6 = e10.toExportImageJSON(), i11 = { id: e10.id, name: e10.title, layerDefinition: { drawingInfo: t6.drawingInfo, definitionExpression: t6.definitionExpression, source: t6.source } };
        n5.unshift(i11), a11.subLayerIds.push(e10.id);
      }
  };
  var l3;
  return e9.sublayers && e9.sublayers.forEach(o5), n5.length && (n5 = n5.map(({ id: e10, name: t5, layerDefinition: i10 }) => ({ id: e10, name: t5, layerDefinition: i10 })), r4 = { layerType: (l3 = e9.write()).layerType, customParameters: l3.customParameters }, r4.layers = n5, r4.visibleLayers = ((_b = (_a = e9.capabilities) == null ? void 0 : _a.exportMap) == null ? void 0 : _b.supportsDynamicLayers) ? void 0 : a11.subLayerIds, le(r4, e9), e9.legendEnabled && i9.legendLayers.push(a11)), r4;
}
async function Y({ layerView: e9, printTemplate: t4 }, i9) {
  const r4 = [], a11 = e9.layer;
  if (null != a11.featureCollections)
    for (const n5 of a11.featureCollections) {
      const e10 = await K2(n5, n5.source, t4, i9);
      e10 && r4.push(...e10.featureCollection.layers);
    }
  else if (null != a11.sublayers)
    for (const n5 of a11.sublayers) {
      const e10 = await K2(null, n5.graphics, t4, i9);
      e10 && r4.push(...e10.featureCollection.layers);
    }
  return { featureCollection: { layers: r4 } };
}
function Z() {
  return { type: "OpenStreetMap" };
}
async function ee(e9, { printTemplate: t4, view: i9 }, r4) {
  var _a;
  const n5 = { type: "image" }, s7 = { format: "png", ignoreBackground: true, layers: [e9] };
  0 !== i9.rotation && (s7.rotation = 0);
  const o5 = r4.ssExtent || i9.extent.clone();
  let c6 = 96, u5 = true, y5 = true;
  if (t4.exportOptions) {
    const e10 = t4.exportOptions;
    null != e10.dpi && e10.dpi > 0 && (c6 = e10.dpi), null != e10.width && e10.width > 0 && (u5 = e10.width % 2 == i9.width % 2), null != e10.height && e10.height > 0 && (y5 = e10.height % 2 == i9.height % 2);
  }
  if ("map-only" === t4.layout && t4.scalePreserved && (!t4.outScale || t4.outScale === i9.scale) && 96 === c6 && (!u5 || !y5) && (s7.area = { x: 0, y: 0, width: i9.width, height: i9.height }, u5 || (s7.area.width -= 1), y5 || (s7.area.height -= 1), !r4.ssExtent)) {
    const e10 = i9.toMap(c2(s7.area.width, s7.area.height));
    o5.ymin = e10.y, o5.xmax = e10.x, r4.ssExtent = o5;
  }
  n5.extent = o5.clone()._normalize(true).toJSON();
  const p12 = await i9.takeScreenshot(s7);
  return n5.imageData = (_a = ot(p12.dataUrl)) == null ? void 0 : _a.data, n5;
}
async function te(e9, { layerView: t4, printTemplate: i9 }, r4) {
  e9.legendEnabled && r4.legendLayers.push({ id: e9.id });
  return K2(e9, await ye(t4), i9, r4);
}
async function ie(e9) {
  var _a, _b;
  const t4 = [], i9 = [];
  for (const a11 of e9.map.allTables)
    "feature" !== a11.type || a11.loaded || i9.push(a11.load());
  i9.length && await Promise.allSettled(i9);
  for (const a11 of e9.map.allTables)
    if ("feature" === a11.type && a11.loaded && a11.isTable && "feature-layer" === ((_a = a11.source) == null ? void 0 : _a.type)) {
      const e10 = { id: (r4 = a11.write()).id, title: r4.title, customParameters: r4.customParameters, layerDefinition: { definitionExpression: (_b = r4.layerDefinition) == null ? void 0 : _b.definitionExpression }, url: r4.url };
      le(e10, a11), t4.push(e10);
    }
  var r4;
  return t4.length ? t4 : void 0;
}
function re(e9, t4) {
  e9.legendEnabled && t4.legendLayers.push({ id: e9.id });
  const i9 = { layerType: (r4 = e9.write()).layerType, customParameters: r4.customParameters };
  var r4;
  return le(i9, e9), i9;
}
async function ae(e9, t4, i9) {
  if (i9.is11xService && e9.serviceUrl && e9.styleUrl) {
    const t5 = u3(e9.styleUrl, e9.apiKey), r4 = u3(e9.serviceUrl, e9.apiKey);
    if (!t5 && !r4 || "2.1.0" !== i9.cimVersion) {
      const i10 = { type: "VectorTileLayer" };
      return i10.styleUrl = K(e9.styleUrl), i10.token = t5, r4 !== t5 && (i10.additionalTokens = [{ url: e9.serviceUrl, token: r4 }]), i10;
    }
  }
  return ee(e9, t4, i9);
}
function ne(e9) {
  var _a;
  const t4 = (_a = e9.urlTemplate) == null ? void 0 : _a.replace(/\${/g, "{"), i9 = { type: "WebTiledLayer", urlTemplate: t4, credits: e9.copyright };
  return e9.subDomains && e9.subDomains.length > 0 && (i9.subDomains = e9.subDomains), i9;
}
function se(e9, t4) {
  let i9;
  const r4 = [], a11 = (e10) => {
    e10.visible && (e10.sublayers ? e10.sublayers.forEach(a11) : e10.name && r4.unshift(e10.name));
  };
  return e9.sublayers && e9.sublayers.forEach(a11), r4.length && (e9.legendEnabled && t4.legendLayers.push({ id: e9.id, subLayerIds: r4 }), i9 = { type: "wms", customLayerParameters: e9.customLayerParameters, customParameters: e9.customParameters, transparentBackground: e9.imageTransparency, visibleLayers: r4, url: K(e9.url), version: e9.version }), i9;
}
function oe(e9) {
  const t4 = e9.activeLayer;
  return { type: "wmts", customLayerParameters: e9.customLayerParameters, customParameters: e9.customParameters, format: t4.imageFormat, layer: t4.id, style: t4.styleId, tileMatrixSet: t4.tileMatrixSetId, url: K(e9.url) };
}
function le(e9, t4) {
  t4.url && (e9.url = K(e9.url || t4.url), e9.token = u3(e9.url, t4.apiKey));
}
async function ce(e9, i9) {
  var _a;
  i9.canvas || (i9.canvas = document.createElement("canvas"));
  const r4 = 1024;
  i9.canvas.width = r4, i9.canvas.height = r4;
  const a11 = i9.canvas.getContext("2d");
  let o5, l3;
  if (e9.path) {
    const t4 = new Path2D(e9.path);
    t4.closePath(), a11.fillStyle = Array.isArray(e9.color) ? `rgba(${e9.color[0]},${e9.color[1]},${e9.color[2]},${e9.color[3] / 255})` : "rgb(0,0,0)", a11.fill(t4);
    const i10 = g4(a11);
    if (!i10)
      return null;
    a11.clearRect(0, 0, r4, r4);
    const s7 = u2(e9.size) / Math.max(i10.width, i10.height);
    a11.scale(s7, s7);
    const c6 = r4 / s7, u5 = c6 / 2 - i10.width / 2 - i10.x, y5 = c6 / 2 - i10.height / 2 - i10.y;
    if (a11.translate(u5, y5), Array.isArray(e9.color) && a11.fill(t4), ((_a = e9.outline) == null ? void 0 : _a.width) && Array.isArray(e9.outline.color)) {
      const r5 = e9.outline;
      a11.lineWidth = u2(r5.width) / s7, a11.lineJoin = "round", a11.strokeStyle = `rgba(${r5.color[0]},${r5.color[1]},${r5.color[2]},${r5.color[3] / 255})`, a11.stroke(t4), i10.width += a11.lineWidth, i10.height += a11.lineWidth;
    }
    i10.width *= s7, i10.height *= s7;
    const p12 = a11.getImageData(r4 / 2 - i10.width / 2, r4 / 2 - i10.height / 2, Math.ceil(i10.width), Math.ceil(i10.height));
    o5 = p12.width, l3 = p12.height, a11.canvas.width = o5, a11.canvas.height = l3, a11.putImageData(p12, 0, 0);
  } else {
    const i10 = "image/svg+xml" === e9.contentType ? "data:image/svg+xml;base64," + e9.imageData : e9.url, r5 = (await U(i10, { responseType: "image" })).data;
    o5 = u2(e9.width), l3 = u2(e9.height), a11.canvas.width = o5, a11.canvas.height = l3, a11.drawImage(r5, 0, 0, a11.canvas.width, a11.canvas.height);
  }
  return { type: "esriPMS", imageData: a11.canvas.toDataURL("image/png").substr(22), angle: e9.angle, contentType: "image/png", height: e3(l3), width: e3(o5), xoffset: e9.xoffset, yoffset: e9.yoffset };
}
async function ue(e9, t4) {
  const i9 = e9.type;
  if ("simple" === i9 && fe(e9.symbol))
    e9.symbol = await ce(e9.symbol, t4);
  else if ("uniqueValue" === i9 || "classBreaks" === i9) {
    fe(e9.defaultSymbol) && (e9.defaultSymbol = await ce(e9.defaultSymbol, t4));
    const r4 = e9["uniqueValue" === i9 ? "uniqueValueInfos" : "classBreakInfos"];
    if (r4)
      for (const e10 of r4)
        fe(e10.symbol) && (e10.symbol = await ce(e10.symbol, t4));
  }
}
async function ye(e9) {
  return e9.queryFeatures(e9.createQuery()).then((e10) => e10.features);
}
function pe(e9) {
  var _a;
  return ((_a = e9.gpMetadata) == null ? void 0 : _a.executionType) ? N2.fromJSON(e9.gpMetadata.executionType) : "sync";
}
function fe(e9) {
  var _a;
  return e9 && (e9.path || "image/svg+xml" === e9.contentType || ((_a = e9.url) == null ? void 0 : _a.endsWith(".svg")));
}

// node_modules/@arcgis/core/rest/support/PrintParameters.js
var s5 = class extends S {
  constructor(t4) {
    super(t4), this.extent = null, this.extraParameters = null, this.outSpatialReference = null, this.template = null, this.updateDelay = 1e3, this.view = null;
  }
};
e([y()], s5.prototype, "extent", void 0), e([y()], s5.prototype, "extraParameters", void 0), e([y()], s5.prototype, "outSpatialReference", void 0), e([y()], s5.prototype, "template", void 0), e([y()], s5.prototype, "updateDelay", void 0), e([y()], s5.prototype, "view", void 0), s5 = e([a2("esri.rest.support.PrintParameters")], s5);
var p10 = s5;

// node_modules/@arcgis/core/widgets/Print/CustomTemplate.js
var i8 = class extends f {
  constructor(o5) {
    super(o5), this.description = null, this.format = null, this.label = null, this.layout = null, this.layoutItem = null, this.layoutOptions = null, this.layoutTemplateInfo = null;
  }
};
e([y()], i8.prototype, "description", void 0), e([y({ json: { read: n4 } })], i8.prototype, "format", void 0), e([y()], i8.prototype, "label", void 0), e([y({ json: { read: r2 } })], i8.prototype, "layout", void 0), e([y({ type: S3 })], i8.prototype, "layoutItem", void 0), e([y()], i8.prototype, "layoutOptions", void 0), e([y()], i8.prototype, "layoutTemplateInfo", void 0), i8 = e([a2("esri.widgets.Print.CustomTemplate")], i8);
var a10 = i8;

// node_modules/@arcgis/core/widgets/Print/PrintViewModel.js
var S5 = V.ofType(a10);
function x2(t4) {
  var _a;
  t4.layoutOptions ?? (t4.layoutOptions = {}), (_a = t4.layoutOptions).customTextElements ?? (_a.customTextElements = []);
  const e9 = "date";
  if (!t4.layoutOptions.customTextElements.find((t5) => e9 in t5)) {
    const { customTextElements: e10 } = t4.layoutOptions;
    let r4 = j(Date.now(), E("short-date"));
    "ar" === a3() && (r4 = "‏" + r4), e10.push({ date: r4 });
  }
}
var L = class extends m2 {
  constructor(t4) {
    super(t4), this._serviceTemplateCustomTextElements = null, this.allowedFormats = "all", this.allowedLayouts = "all", this.defaultTemplates = new S5(), this.error = null, this.extraParameters = null, this.includeDefaultTemplates = true, this.portal = Q.getDefault(), this.printServiceUrl = null, this.printTimeout = 12e4, this.templatesInfo = null, this.updateDelay = 1e3, this.view = null, this.templateCustomTextElements = null;
  }
  destroy() {
    this.view = null;
  }
  get effectivePrintServiceUrl() {
    return this.printServiceUrl ?? null;
  }
  get effectiveTemplateCustomTextElements() {
    if (!this._serviceTemplateCustomTextElements)
      return {};
    const t4 = a(this._serviceTemplateCustomTextElements);
    return this.templateCustomTextElements && Object.keys(this.templateCustomTextElements).forEach((e9) => {
      var _a;
      const r4 = t4[e9];
      if (r4) {
        const t5 = (_a = this.templateCustomTextElements) == null ? void 0 : _a[e9];
        r4.forEach((e10) => {
          const [r5] = Object.entries(e10)[0];
          t5 == null ? void 0 : t5.forEach((t6) => {
            const [o5, s7] = Object.entries(t6)[0];
            r5 === o5 && (e10[r5] = s7);
          });
        });
      }
    }), Object.freeze(t4);
  }
  get state() {
    var _a;
    return "loading" === this.loadStatus ? "initializing" : "failed" === this.loadStatus || this.error ? "error" : "loaded" === this.loadStatus && ((_a = this.view) == null ? void 0 : _a.ready) ? "ready" : "disabled";
  }
  async load(t4) {
    return this.addResolvingPromise(this._loadResources(t4).catch((t5) => this.error = t5)), this;
  }
  async getLayoutTemplateInfo(t4, r4) {
    const { id: o5 } = t4;
    "public" !== t4.access && t && await t.getCredential(this._printServiceLayoutsUrl);
    const s7 = { Layout_Item_ID: JSON.stringify({ id: o5 }) }, { results: i9 } = await m4(this._printServiceLayoutsUrl, s7, null, r4), a11 = i9[0].value[0], l3 = a11.layoutOptions.mapSurroundInfos.find(({ type: t5 }) => "CIMMarkerNorthArrow" === t5);
    return l3 && (this.templateToNorthArrowInfo[o5] = l3), a11;
  }
  async print(t4) {
    const { view: e9, extraParameters: r4, updateDelay: o5 } = this;
    if (!e9)
      throw new s("print:view-required", "view is not set");
    x2(t4);
    const s7 = new p10({ view: e9, template: t4, extraParameters: r4, updateDelay: o5 });
    try {
      return await U2(this.effectivePrintServiceUrl, s7, { timeout: this.printTimeout });
    } catch (a11) {
      throw new s("print:export-error", "An error occurred while exporting the web map.", { error: a11 });
    }
  }
  toPrintTemplate({ attributionEnabled: t4, author: e9, copyright: r4, customTextElements: o5, dpi: s7, forceFeatureAttributes: i9, format: a11, height: l3, includeTables: p12, layout: n5, layoutItem: m6, legendEnabled: u5, northArrowEnabled: c6, scale: f5, scaleEnabled: d6, title: y5, width: h3 }) {
    const v4 = new i7({ attributionVisible: t4, forceFeatureAttributes: i9, format: a11, includeTables: p12, layout: n5, layoutItem: m6, layoutOptions: { authorText: e9 || "", copyrightText: r4 || "", customTextElements: o5, titleText: y5 || "" }, outScale: f5 ?? 0, scalePreserved: d6 });
    h3 && (v4.exportOptions.width = h3), l3 && (v4.exportOptions.height = l3), s7 && (v4.exportOptions.dpi = s7), !u5 && v4.layoutOptions && (v4.layoutOptions.legendLayers = []);
    const T3 = this.templateToNorthArrowInfo[(m6 == null ? void 0 : m6.id) ?? n5];
    if (T3) {
      !(T3.visible === c6) && v4.layoutOptions && (v4.layoutOptions.elementOverrides = { [T3.name]: { visible: c6 } });
    }
    return v4;
  }
  async _loadResources(t4) {
    var _a, _b, _c;
    let e9 = [];
    if (!this.printServiceUrl) {
      if (this.destroyed)
        return;
      try {
        await this.portal.load(t4);
      } catch (a11) {
        throw new s("print:could-not-load-portal", "Cannot load print resource information from portal", { error: a11, url: this.effectivePrintServiceUrl });
      }
      const r5 = (_a = this.portal.helperServices) == null ? void 0 : _a.printTask;
      r5 && (this._set("effectivePrintServiceUrl", r5.url), e9 = ((_b = r5.templates) == null ? void 0 : _b.map((t5) => a10.fromJSON(t5))) ?? []);
    }
    this.defaultTemplates.addMany(e9);
    const r4 = (_c = this.effectivePrintServiceUrl) == null ? void 0 : _c.toLowerCase().split("/");
    if (!(r4 == null ? void 0 : r4.includes("gpserver")))
      throw new s("print:invalid-print-service-url", "Can't fetch print templates information from provided URL", { url: this.effectivePrintServiceUrl });
    const [o5, s7] = await Promise.all([this._getPrintServiceLayouts(t4), this._getPrintServiceTemplates(t4)]);
    if (this._processPrintServiceLayouts(o5), this._processPrintServiceTemplates(s7), !this.printServiceUrl) {
      const e10 = await this._getPortalCustomTemplates(t4);
      this.defaultTemplates.addMany(e10);
    }
  }
  async _getPortalCustomTemplates(t4) {
    const { layoutGroupQuery: e9 } = this.portal;
    if (!e9)
      return [];
    const r4 = new c({ query: e9, disableExtraQuery: true }), o5 = await this.portal.queryGroups(r4, t4);
    if (!o5.total)
      return [];
    const s7 = o5.results[0], i9 = new c({ num: 100, query: "type:Layout" }), a11 = (await s7.queryItems(i9, t4)).results;
    return a11.length ? a11.map((t5) => new a10({ label: t5.title, layoutItem: t5 })) : [];
  }
  _processPrintServiceTemplates(t4) {
    this._set("templatesInfo", t4);
  }
  async _getPrintServiceLayouts(t4) {
    let e9 = [];
    const r4 = async (e10) => {
      this._printServiceLayoutsUrl = this.effectivePrintServiceUrl.replace(/(\/GPServer\/).+/i, `$1${encodeURI(e10)}`);
      return (await m4(this._printServiceLayoutsUrl, null, null, t4)).results[0].value;
    };
    try {
      e9 = await r4("Get Layout Templates Info Task");
    } catch {
    }
    if (!e9 || e9.length < 1)
      try {
        e9 = await r4("Get Layout Templates Info");
      } catch {
      }
    return e9;
  }
  _processPrintServiceLayouts(t4) {
    const e9 = {}, r4 = {};
    t4.forEach(({ layoutTemplate: t5, layoutOptions: { customTextElements: o5, mapSurroundInfos: s7 } }) => {
      const i9 = r2(t5);
      e9[i9] = o5, s7 && (r4[i9] = s7.find(({ type: t6 }) => "CIMMarkerNorthArrow" === t6));
    }), this._serviceTemplateCustomTextElements = Object.freeze(e9), this.templateToNorthArrowInfo = r4;
  }
  async _getPrintServiceTemplates(t4) {
    let e9;
    try {
      ({ data: e9 } = await U(this.effectivePrintServiceUrl, { ...t4, query: { f: "json" }, timeout: this.printTimeout }));
    } catch (l3) {
      throw b(l3) ? l3 : new s("print:unavailable-service-info", "Can't fetch templates info from service", { error: l3 });
    }
    const { parameters: o5 } = e9, s7 = o5.find(({ name: t5 }) => "Format" === t5), a11 = o5.find(({ name: t5 }) => "Layout_Template" === t5);
    return { format: this._getFormat(s7), layout: this._getLayout(a11) };
  }
  _getFormat(t4) {
    const e9 = "all" === this.allowedFormats ? t4.choiceList : t4.choiceList.filter((t5) => this.allowedFormats.includes(n4(t5))), r4 = (e9.length ? e9 : t4.choiceList).map(n4).filter(k), s7 = n4(t4.defaultValue), i9 = r4.includes(s7) ? s7 : r4[0];
    return { choiceList: r4, defaultValue: i9 };
  }
  _getLayout(t4) {
    const e9 = t4.choiceList.filter((t5) => "map_only" !== t5.toLowerCase()), r4 = "all" === this.allowedLayouts ? e9 : e9.filter((t5) => this.allowedLayouts.includes(r2(t5))), s7 = (r4.length ? r4 : e9).map(r2).filter(k), i9 = r2(t4.defaultValue), a11 = s7.includes(i9) ? i9 : s7.find((t5) => /(?=.*letter)(?=.*landscape)/i.test(t5)) ?? s7.find((t5) => /(?=.*a4)(?=.*landscape)/i.test(t5)) ?? s7[0];
    return { choiceList: s7, defaultValue: a11 };
  }
};
e([y()], L.prototype, "_serviceTemplateCustomTextElements", void 0), e([y()], L.prototype, "allowedFormats", void 0), e([y()], L.prototype, "allowedLayouts", void 0), e([y({ type: S5 })], L.prototype, "defaultTemplates", void 0), e([y()], L.prototype, "error", void 0), e([y()], L.prototype, "extraParameters", void 0), e([y()], L.prototype, "includeDefaultTemplates", void 0), e([y({ readOnly: true })], L.prototype, "effectivePrintServiceUrl", null), e([y()], L.prototype, "effectiveTemplateCustomTextElements", null), e([y({ type: Q })], L.prototype, "portal", void 0), e([y()], L.prototype, "printServiceUrl", void 0), e([y()], L.prototype, "printTimeout", void 0), e([y({ readOnly: true })], L.prototype, "state", null), e([y({ readOnly: true })], L.prototype, "templatesInfo", void 0), e([y()], L.prototype, "updateDelay", void 0), e([y()], L.prototype, "view", void 0), e([y()], L.prototype, "templateCustomTextElements", void 0), e([y()], L.prototype, "templateToNorthArrowInfo", void 0), L = e([a2("esri.widgets.Print.PrintViewModel")], L);
var _2 = L;

// node_modules/@arcgis/core/widgets/Print/TemplateOptions.js
var s6 = class extends S {
  constructor(t4) {
    super(t4), this.attributionEnabled = true, this.author = null, this.copyright = null, this.customTextElements = null, this.dpi = 96, this.fileName = null, this.forceFeatureAttributes = false, this.format = "pdf", this.height = null, this.includeTables = true, this.layout = "letter-ansi-a-landscape", this.layoutItem = null, this.legendEnabled = true, this.northArrowEnabled = false, this.scale = null, this.scaleEnabled = false, this.title = null, this.width = null;
  }
};
e([y()], s6.prototype, "attributionEnabled", void 0), e([y()], s6.prototype, "author", void 0), e([y()], s6.prototype, "copyright", void 0), e([y()], s6.prototype, "customTextElements", void 0), e([y()], s6.prototype, "dpi", void 0), e([y()], s6.prototype, "fileName", void 0), e([y()], s6.prototype, "forceFeatureAttributes", void 0), e([y()], s6.prototype, "format", void 0), e([y()], s6.prototype, "height", void 0), e([y()], s6.prototype, "includeTables", void 0), e([y()], s6.prototype, "layout", void 0), e([y({ type: S3 })], s6.prototype, "layoutItem", void 0), e([y()], s6.prototype, "legendEnabled", void 0), e([y()], s6.prototype, "northArrowEnabled", void 0), e([y()], s6.prototype, "scale", void 0), e([y()], s6.prototype, "scaleEnabled", void 0), e([y()], s6.prototype, "title", void 0), e([y()], s6.prototype, "width", void 0), s6 = e([a2("esri.widgets.Print.TemplateOptions")], s6);
var p11 = s6;

// node_modules/@arcgis/core/widgets/Print.js
var O = V.ofType(a5);
var T2 = "MAP_ONLY";
var x3;
!function(t4) {
  t4.layout = "layoutTab", t4.mapOnly = "mapOnlyTab";
}(x3 || (x3 = {}));
var C2 = "esri-print";
var I = `${C2}__advanced-options-button`;
var S6 = { base: C2, headerTitle: `${C2}__header-title`, inputText: `${C2}__input-text`, layoutTabList: `${C2}__layout-tab-list`, layoutTab: `${C2}__layout-tab`, layoutSection: `${C2}__layout-section`, mapOnlySection: `${C2}__map-only-section`, scaleInput: `${C2}__scale-input`, loader: `${C2}__loader`, advancedOptionsButton: I, advancedOptionsButtonContainer: `${I}-container`, advancedOptionsButtonTitle: `${I}-title`, advancedOptionsButtonIconOpened: `${I}-icon--opened`, advancedOptionsButtonIconClosed: `${I}-icon--closed`, advancedOptionsButtonIconClosed_RTL: `${I}-icon--closed-rtl`, refreshButton: `${C2}__refresh-button`, swapButton: `${C2}__swap-button`, printButton: `${C2}__export-button`, formSectionContainer: `${C2}__form-section-container`, advancedOptionsSection: `${C2}__advanced-options-section`, advancedOptionsContainer: `${C2}__advanced-options-container`, authorInfoContainer: `${C2}__author-info-container`, copyrightInfoContainer: `${C2}__copyright-info-container`, exportedFilesContainer: `${C2}__export-panel-container`, exportedFilesTitle: `${C2}__export-title`, exportedFile: `${C2}__exported-file`, exportedFileLink: `${C2}__exported-file-link`, exportedFileLinkTitle: `${C2}__exported-file-link-title`, heightContainer: `${C2}__height-container`, legendInfoContainer: `${C2}__legend-info-container`, printWidgetContainer: `${C2}__container`, panelContainer: `${C2}__panel-container`, scaleInfoContainer: `${C2}__scale-info-container`, scaleInputContainer: `${C2}__scale-input-container`, sizeContainer: `${C2}__size-container`, widthContainer: `${C2}__width-container`, panelError: `${C2}__panel--error`, exportedFileError: `${C2}__exported-file--error` };
function L2(t4) {
  const e9 = 8.3333, a11 = 11.4583;
  return { width: Math.round(t4 * e9), height: Math.round(t4 * a11) };
}
function M(t4) {
  return !isNaN(t4) && t4 > 0;
}
function k3(t4) {
  return (t4 == null ? void 0 : t4.toUpperCase()) === T2;
}
var $2 = class extends D {
  constructor(t4, e9) {
    super(t4, e9), this._activeTabFocusRequested = false, this._advancedOptionsVisibleForLayout = false, this._advancedOptionsVisibleForMapOnly = false, this._awaitingServerResponse = false, this._exportedFileNameMap = {}, this._layoutTabSelected = true, this._pendingExportScroll = false, this._rootNode = null, this.exportedLinks = new O(), this.headingLevel = 3, this.templateOptions = new p11(), this.viewModel = new _2(), this._onInput = (t5) => {
      this._layoutTabSelected ? this.templateOptions.title = t5.target.value : this.templateOptions.fileName = t5.target.value;
    }, this._removeLink = (t5) => {
      const e10 = t5.currentTarget["data-item"];
      e10 && "error" === e10.state && this.exportedLinks.remove(e10);
    }, this._handleLinkClick = (t5) => {
      const e10 = t5.currentTarget, { href: a11 } = e10, i9 = u3(this.viewModel.effectivePrintServiceUrl);
      if (!i9)
        return;
      if (!t5.isTrusted)
        return void t5.stopPropagation();
      t5.preventDefault();
      const n5 = new URL(a11);
      n5.searchParams.set("token", i9), e10.href = n5.href, e10.click(), e10.href = a11;
    }, this._focusOnTabChange = this._focusOnTabChange.bind(this);
  }
  initialize() {
    this.addHandles([d(() => {
      var _a;
      return [this.templateOptions.format, (_a = this.viewModel.templatesInfo) == null ? void 0 : _a.format.defaultValue];
    }, ([t5, e10]) => {
      if (e10 && !t5)
        return void (this.templateOptions.format = e10);
      if (!t5 || !e10 || !this.viewModel.templatesInfo)
        return;
      if (this.viewModel.templatesInfo.format.choiceList.includes(t5))
        return;
      const a11 = this.viewModel.templatesInfo.format.choiceList.find((e11) => e11.toUpperCase().includes(`(${t5.toUpperCase()})`));
      this.templateOptions.format = a11 ?? e10;
    }), d(() => {
      var _a;
      return [this.templateOptions.layout, (_a = this.viewModel.templatesInfo) == null ? void 0 : _a.layout.defaultValue];
    }, ([t5, e10]) => {
      if (e10 && !t5)
        return void (this.templateOptions.layout = e10);
      if (!t5 || !e10 || !this.viewModel.templatesInfo)
        return;
      if (this._layoutTabSelected = !k3(t5), !this._layoutTabSelected)
        return;
      this.viewModel.templatesInfo.layout.choiceList.includes(t5) || (this.templateOptions.layout = e10);
      const i10 = this.viewModel.effectiveTemplateCustomTextElements[this.templateOptions.layout];
      this.templateOptions.customTextElements = i10 ? a(i10) : null;
    }), d(() => this.templateOptions.dpi, (t5) => {
      t5 <= 0 && (this.templateOptions.dpi = 1);
    }), d(() => {
      var _a;
      return (_a = this.viewModel.view) == null ? void 0 : _a.scale;
    }, (t5) => {
      !t5 || this.templateOptions.scaleEnabled && this.templateOptions.scale || (this.templateOptions.scale = t5);
    })]);
    const { height: t4, width: e9 } = this.templateOptions;
    this.templateOptions.width = e9 || 800, this.templateOptions.height = t4 || 1100;
    const i9 = setTimeout(() => {
      this._awaitingServerResponse = true, this.scheduleRender();
    }, 500);
    this.viewModel.load().then(() => {
      clearTimeout(i9), this._awaitingServerResponse = false;
    });
  }
  loadDependencies() {
    return r({ combobox: () => import("./calcite-combobox-2DABLAR5.js"), "combobox-item": () => import("./calcite-combobox-item-CJU6ESRT.js"), input: () => import("./calcite-input-CHG5BNQ7.js"), label: () => import("./calcite-label-W4VTHQAF.js") });
  }
  get allowedFormats() {
    return this.viewModel.allowedFormats;
  }
  set allowedFormats(t4) {
    this.viewModel.allowedFormats = t4;
  }
  get allowedLayouts() {
    return this.viewModel.allowedLayouts;
  }
  set allowedLayouts(t4) {
    this.viewModel.allowedLayouts = t4;
  }
  get error() {
    return this.viewModel.error;
  }
  get extraParameters() {
    return this.viewModel.extraParameters;
  }
  set extraParameters(t4) {
    this.viewModel.extraParameters = t4;
  }
  get icon() {
    return "print";
  }
  set icon(t4) {
    this._overrideIfSome("icon", t4);
  }
  get includeDefaultTemplates() {
    return this.viewModel.includeDefaultTemplates;
  }
  set includeDefaultTemplates(t4) {
    this.viewModel.includeDefaultTemplates = t4;
  }
  get label() {
    var _a;
    return ((_a = this.messages) == null ? void 0 : _a.widgetLabel) ?? "";
  }
  set label(t4) {
    this._overrideIfSome("label", t4);
  }
  get portal() {
    return this.viewModel.portal;
  }
  set portal(t4) {
    this.viewModel.portal = t4;
  }
  get printServiceUrl() {
    return this.viewModel.printServiceUrl;
  }
  set printServiceUrl(t4) {
    this.viewModel.printServiceUrl = t4;
  }
  get templateCustomTextElements() {
    return this.viewModel.templateCustomTextElements;
  }
  set templateCustomTextElements(t4) {
    this.viewModel.templateCustomTextElements = t4;
  }
  get view() {
    return this.viewModel.view;
  }
  set view(t4) {
    this.viewModel.view = t4;
  }
  render() {
    var _a, _b, _c, _d;
    const { includeDefaultTemplates: t4, messages: e9, templateOptions: a11, viewModel: i9, view: n5 } = this, { attributionEnabled: o5, author: s7, copyright: l3, dpi: r4, format: p12, height: c6, layout: u5, layoutItem: h3, legendEnabled: m6, northArrowEnabled: b4, scaleEnabled: f5, scale: g5, width: O2 } = a11, T3 = "ready" !== i9.state || this._awaitingServerResponse, C3 = this._renderTitleOrFileNameSection(), I2 = n3("div", { class: S6.formSectionContainer }, n3("calcite-label", null, e9.fileFormatTitle, n3("calcite-combobox", { clearDisabled: true, label: e9.formatDefaultOption, maxItems: 6, placeholder: e9.formatDefaultOption, selectionMode: "single-persist", onCalciteComboboxChange: ({ target: t5 }) => {
      this.templateOptions.format = t5.selectedItems[0].value;
    } }, (_b = (_a = i9.templatesInfo) == null ? void 0 : _a.format) == null ? void 0 : _b.choiceList.sort().map((t5, e10) => n3("calcite-combobox-item", { key: `file-format-${e10}`, selected: t5 === this.templateOptions.format, textLabel: g(t5), value: t5 }))))), L3 = i9.defaultTemplates.length && t4 ? i9.defaultTemplates.toArray().filter(({ label: t5 }) => !k3(t5)).sort((t5, e10) => (t5.label ?? "") > (e10.label ?? "") ? 1 : -1).map((t5, a12) => {
      var _a2;
      return n3("calcite-combobox-item", { "data-item-id": (_a2 = t5.layoutItem) == null ? void 0 : _a2.id, key: `organization-template-${a12}`, textLabel: t5.label ?? e9.untitled, title: t5.description ?? "", value: t5.layout });
    }) : null, M2 = !((_d = (_c = i9.templatesInfo) == null ? void 0 : _c.layout) == null ? void 0 : _d.choiceList.length) || t4 && i9.defaultTemplates.length ? null : i9.templatesInfo.layout.choiceList.map((t5) => ({ label: e9[t5] ?? t5.replaceAll("_", " "), value: t5 })).sort((t5, e10) => t5.label > e10.label ? 1 : 0).map(({ label: t5, value: e10 }, a12) => n3("calcite-combobox-item", { key: `service-template-${a12}`, selected: e10 === this.templateOptions.layout, textLabel: t5, value: e10 })), $3 = n3("div", { class: S6.formSectionContainer }, n3("calcite-label", null, e9.template, n3("calcite-combobox", { clearDisabled: true, label: e9.selectTemplate, maxItems: 6, placeholder: e9.selectTemplate, selectionMode: "single", onCalciteComboboxChange: ({ target: t5 }) => {
      const e10 = t5.selectedItems[0], a12 = e10.getAttribute("data-item-id");
      if (a12) {
        const t6 = this.viewModel.defaultTemplates.find(({ layoutItem: t7 }) => a12 === (t7 == null ? void 0 : t7.id));
        this._applyTemplate(t6);
      } else
        this._applyTemplate(e10.value);
    } }, L3, M2))), F4 = n3("div", { class: S6.formSectionContainer }, n3("label", null, e9.dpi, n3("input", { bind: this, class: this.classes(S6.inputText, e4.input), "data-input-name": "dpi", min: "1", onchange: this._handleDPIChange, tabIndex: 0, type: "number", value: `${r4}` }))), E2 = n3("div", { class: this.classes(S6.scaleInfoContainer, S6.formSectionContainer) }, n3("label", null, n3("input", { bind: this, checked: f5, "data-option-name": "scaleEnabled", onchange: this._toggleInputValue, tabIndex: 0, type: "checkbox" }), e9.scale), n3("div", { class: S6.scaleInputContainer }, n3("input", { "aria-label": e9.scaleLabel, "aria-valuenow": `${g5}`, bind: this, class: this.classes(S6.inputText, e4.input, S6.scaleInput), "data-input-name": "scale", disabled: !f5, onchange: this._updateInputValue, role: "spinbutton", tabIndex: 0, type: "number", value: `${g5}` }), n3("button", { "aria-label": e9.reset, bind: this, class: this.classes(e4.widgetButton, S6.refreshButton, i3.refresh), onclick: this._resetToCurrentScale, tabIndex: 0, type: "button" }))), A2 = this._advancedOptionsVisibleForLayout ? n3("div", { "aria-labelledby": `${this.id}__advancedOptionsForLayout`, class: S6.advancedOptionsContainer }, E2, n3("div", { class: this.classes(S6.authorInfoContainer, S6.formSectionContainer) }, n3("label", null, e9.author, n3("input", { bind: this, class: this.classes(S6.inputText, e4.input), "data-input-name": "author", onchange: this._updateInputValue, tabIndex: 0, type: "text", value: s7 ?? "" }))), n3("div", { class: this.classes(S6.copyrightInfoContainer, S6.formSectionContainer) }, n3("label", null, e9.copyright, n3("input", { bind: this, class: this.classes(S6.inputText, e4.input), "data-input-name": "copyright", onchange: this._updateInputValue, tabIndex: 0, type: "text", value: l3 ?? "" }))), F4, n3("div", { class: this.classes(S6.legendInfoContainer, S6.formSectionContainer) }, n3("label", null, n3("input", { bind: this, checked: m6, "data-option-name": "legendEnabled", onchange: this._toggleInputValue, tabIndex: 0, type: "checkbox" }), e9.legend)), this.viewModel.templateToNorthArrowInfo[(h3 == null ? void 0 : h3.id) ?? u5] ? n3("div", { class: this.classes(S6.legendInfoContainer, S6.formSectionContainer), key: "north-arrow" }, n3("label", null, n3("input", { bind: this, checked: b4, "data-option-name": "northArrowEnabled", onchange: this._toggleInputValue, tabIndex: 0, type: "checkbox" }), e9.northArrow)) : null, this._renderCustomTextElementSection()) : null, V4 = this._advancedOptionsVisibleForMapOnly ? n3("div", { "aria-labelledby": `${this.id}__advancedOptionsForMapOnly`, class: S6.advancedOptionsContainer }, E2, F4, n3("div", { class: S6.formSectionContainer }, n3("label", null, n3("input", { bind: this, checked: o5, "data-option-name": "attributionEnabled", onchange: this._toggleInputValue, tabIndex: 0, type: "checkbox" }), e9.attribution)), this._renderCustomTextElementSection()) : null, j5 = this._layoutTabSelected ? n3("section", { "aria-labelledby": `${this.id}__layoutTab`, class: S6.layoutSection, id: `${this.id}__layoutContent`, key: "esri-print__layoutContent", role: "tabpanel" }, n3("div", { class: S6.panelContainer }, C3, $3, this._layoutTabSelected ? I2 : null), n3("div", { class: this.classes(S6.panelContainer, S6.advancedOptionsSection) }, n3("button", { "aria-expanded": this._advancedOptionsVisibleForLayout ? "true" : "false", "aria-label": e9.advancedOptions, bind: this, class: S6.advancedOptionsButton, onclick: this._showAdvancedOptions, type: "button" }, n3("div", { class: S6.advancedOptionsButtonContainer }, n3("span", { "aria-hidden": "true", class: this.classes(i3.rightTriangleArrow, S6.advancedOptionsButtonIconClosed) }), n3("span", { "aria-hidden": "true", class: this.classes(i3.leftTriangleArrow, S6.advancedOptionsButtonIconClosed_RTL) }), n3("span", { "aria-hidden": "true", class: this.classes(i3.downArrow, S6.advancedOptionsButtonIconOpened) }), n3("span", { class: S6.advancedOptionsButtonTitle }, e9.advancedOptions))), A2)) : n3("section", { "aria-labelledby": `${this.id}__mapOnlyTab`, class: S6.mapOnlySection, id: `${this.id}__mapOnlyContent`, key: "esri-print__mapOnlyContent", role: "tabpanel" }, n3("div", { class: S6.panelContainer }, C3, this._layoutTabSelected ? null : I2, n3("div", { class: this.classes(S6.sizeContainer, S6.formSectionContainer) }, n3("div", { class: S6.widthContainer }, n3("label", null, e9.width, n3("input", { bind: this, class: this.classes(S6.inputText, e4.input), "data-input-name": "width", onchange: this._updateInputValue, tabIndex: 0, type: "number", value: `${O2}` }))), n3("div", { class: S6.heightContainer }, n3("label", null, e9.height, n3("input", { bind: this, class: this.classes(S6.inputText, e4.input), "data-input-name": "height", onchange: this._updateInputValue, tabIndex: 0, type: "number", value: `${c6}` }))), n3("button", { "aria-label": e9.swap, bind: this, class: this.classes(e4.widgetButton, S6.swapButton, i3.swap), onclick: this._switchInput, tabIndex: 0, type: "button" })), n3("div", { class: this.classes(S6.panelContainer, S6.advancedOptionsSection) }, n3("button", { "aria-expanded": this._advancedOptionsVisibleForMapOnly ? "true" : "false", "aria-label": e9.advancedOptions, bind: this, class: S6.advancedOptionsButton, onclick: this._showAdvancedOptions, type: "button" }, n3("div", { class: S6.advancedOptionsButtonContainer }, n3("span", { "aria-hidden": "true", class: this.classes(i3.rightTriangleArrow, S6.advancedOptionsButtonIconClosed) }), n3("span", { "aria-hidden": "true", class: this.classes(i3.leftTriangleArrow, S6.advancedOptionsButtonIconClosed_RTL) }), n3("span", { "aria-hidden": "true", class: this.classes(i3.downArrow, S6.advancedOptionsButtonIconOpened) }), n3("span", { class: S6.advancedOptionsButtonTitle }, e9.advancedOptions))), V4))), P2 = this.exportedLinks.toArray(), B2 = this._renderExportedLink(P2), N3 = { [e4.buttonDisabled]: T3 || !u5 && !p12 }, D3 = !n5 || "2d" !== n5.type, R3 = n3("div", { class: S6.panelError }, D3 ? e9.sceneViewError : e9.serviceError), U3 = n3("div", null, n3("ul", { bind: this, class: S6.layoutTabList, onclick: this._toggleLayoutPanel, onkeydown: this._handleLayoutPanelKeyDown, role: "tablist" }, n3("li", { afterCreate: this._focusOnTabChange, afterUpdate: this._focusOnTabChange, "aria-selected": `${this._layoutTabSelected}`, class: S6.layoutTab, "data-tab-id": x3.layout, id: `${this.id}__layoutTab`, role: "tab", tabIndex: 0 }, e9.layoutTab), n3("li", { afterCreate: this._focusOnTabChange, afterUpdate: this._focusOnTabChange, "aria-selected": `${!this._layoutTabSelected}`, class: S6.layoutTab, "data-tab-id": x3.mapOnly, id: `${this.id}__mapOnlyTab`, role: "tab", tabIndex: 0 }, e9.mapOnlyTab)), j5, n3("button", { "aria-label": e9.exportDescription, bind: this, class: this.classes(S6.printButton, e4.button, N3), disabled: T3, onclick: this._handlePrintMap, tabIndex: 0, type: "button" }, e9.export), n3("div", { afterUpdate: this._scrollExportIntoView, bind: this, class: S6.exportedFilesContainer }, n3(e5, { class: S6.exportedFilesTitle, level: this.headingLevel }, e9.exportText), P2.length > 0 ? null : n3("div", null, n3("div", null, e9.exportHint)), B2)), H2 = n3("div", { class: S6.printWidgetContainer }, n3("header", { class: S6.headerTitle }, e9.export), this.error || D3 || !n5 ? R3 : U3), z2 = "initializing" === i9.state ? this._renderLoader() : H2;
    return n3("div", { bind: this, class: this.classes(S6.base, e4.widget, e4.panel) }, z2);
  }
  _renderCustomTextElementSection() {
    const { customTextElements: t4 } = this.templateOptions;
    return t4 ? n3("div", { class: S6.formSectionContainer, key: "custom-text-elements" }, t4.map((t5) => {
      const [e9, a11] = Object.entries(t5)[0];
      return "date" === e9 ? null : n3("label", { key: e9 }, e9, n3("input", { bind: this, class: this.classes(S6.inputText, e4.input), "data-input-custom": true, "data-input-name": e9, onchange: this._updateInputValue, type: "text", value: a11 }));
    })) : null;
  }
  async _applyTemplate(t4) {
    var _a, _b;
    if (!t4)
      return;
    if ("string" == typeof t4)
      return this.templateOptions.layout = t4, void (this.templateOptions.layoutItem = null);
    if (!t4.layoutTemplateInfo && t4.layoutItem)
      try {
        this._awaitingServerResponse = true, t4.layoutTemplateInfo = await this.viewModel.getLayoutTemplateInfo(t4.layoutItem);
        const { hasLegend: e10, mapSurroundInfos: a12 } = t4.layoutTemplateInfo.layoutOptions, i9 = a12.some(({ type: t5, visible: e11 }) => "CIMMarkerNorthArrow" === t5 && e11);
        t4.layoutOptions = { legend: e10, northArrow: i9 };
      } catch (l3) {
        n.getLogger(this).error(`Failed to load layout info for ${t4.label}`, l3);
      } finally {
        this._awaitingServerResponse = false;
      }
    const { format: e9, layoutItem: a11 } = t4, n5 = t4.layout ?? this.templateOptions.layout, o5 = ((_a = t4.layoutOptions) == null ? void 0 : _a.legend) ?? this.templateOptions.legendEnabled, s7 = ((_b = t4.layoutOptions) == null ? void 0 : _b.northArrow) ?? this.templateOptions.northArrowEnabled;
    this.templateOptions.set({ format: e9, layout: n5, layoutItem: a11, legendEnabled: o5, northArrowEnabled: s7 });
  }
  _renderTitleOrFileNameSection() {
    const { title: t4, fileName: e9, titlePlaceHolder: a11, fileNamePlaceHolder: i9 } = this.messages, n5 = this._layoutTabSelected ? t4 : e9, o5 = this._layoutTabSelected ? a11 : i9, s7 = this._layoutTabSelected ? this.templateOptions.title : this.templateOptions.fileName;
    return n3("div", { class: S6.formSectionContainer }, n3("calcite-label", null, n5, n3("calcite-input", { placeholder: o5, value: s7 ?? "", onCalciteInputInput: this._onInput })));
  }
  _focusOnTabChange(t4) {
    if (!this._activeTabFocusRequested)
      return;
    const e9 = t4.getAttribute("data-tab-id");
    ("layoutTab" === e9 && this._layoutTabSelected || "mapOnlyTab" === e9 && !this._layoutTabSelected) && (t4.focus(), this._activeTabFocusRequested = false);
  }
  _renderLoader() {
    const t4 = { [S6.loader]: this._awaitingServerResponse };
    return n3("div", { class: this.classes(t4), key: "loader" });
  }
  _createFileLink(t4, e9) {
    const a11 = e9 || this.messages.untitled, i9 = t4.format.toLowerCase(), n5 = i9.includes("png") ? "png" : i9, o5 = a11 + n5;
    return void 0 !== this._exportedFileNameMap[o5] ? this._exportedFileNameMap[o5]++ : this._exportedFileNameMap[o5] = 0, new a5({ name: a11, extension: n5, count: this._exportedFileNameMap[o5] });
  }
  _resetToCurrentScale() {
    var _a;
    this.templateOptions.scale = (_a = this.viewModel.view) == null ? void 0 : _a.scale;
  }
  _updateCustomTextElementValue(t4, e9, a11) {
    t4.find((t5) => {
      const [a12] = Object.entries(t5)[0];
      return a12 === e9;
    })[e9] = a11;
  }
  _updateInputValue(t4) {
    const e9 = t4.target, a11 = e9.getAttribute("data-input-name"), i9 = !!e9["data-input-custom"], { templateOptions: n5 } = this;
    if (i9)
      return void this._updateCustomTextElementValue(n5.customTextElements, a11, e9.value);
    let o5;
    if ("number" === e9.type) {
      if (!M(e9.valueAsNumber)) {
        const t5 = n5[a11];
        return void (e9.value = `${t5}`);
      }
      o5 = e9.valueAsNumber;
    } else
      o5 = e9.value;
    n5[a11] = o5;
  }
  _handleDPIChange(t4) {
    this._updateInputValue(t4);
    const e9 = t4.currentTarget.valueAsNumber, { height: a11, width: i9 } = L2(e9), { templateOptions: n5 } = this;
    n5.height = a11, n5.width = i9;
  }
  _handlePrintMap() {
    var _a;
    this._pendingExportScroll = true;
    const { templateOptions: t4 } = this, e9 = this.viewModel.toPrintTemplate(t4), a11 = this._layoutTabSelected ? (_a = e9.layoutOptions) == null ? void 0 : _a.titleText : t4.fileName, i9 = this._createFileLink(e9, a11);
    this.exportedLinks.add(i9), this.emit("submit", { link: i9 }), this.viewModel.print(e9).then((t5) => {
      i9.set({ url: t5 && t5.url, state: "ready" });
    }).catch((t5) => {
      i9.set({ error: t5, state: "error" });
    }).then(() => {
      this.emit("complete", { link: i9 }), this.scheduleRender();
    });
  }
  _switchInput() {
    [this.templateOptions.width, this.templateOptions.height] = [this.templateOptions.height, this.templateOptions.width];
  }
  _showAdvancedOptions() {
    this._layoutTabSelected ? this._advancedOptionsVisibleForLayout = !this._advancedOptionsVisibleForLayout : this._advancedOptionsVisibleForMapOnly = !this._advancedOptionsVisibleForMapOnly;
  }
  _scrollExportIntoView() {
    if (!this._pendingExportScroll)
      return;
    this._pendingExportScroll = false;
    const t4 = this._rootNode;
    if (!t4)
      return;
    const { clientHeight: e9, scrollHeight: a11 } = t4, i9 = a11 - e9;
    i9 > 0 && (t4.scrollTop = i9);
  }
  _toggleInputValue(t4) {
    const e9 = t4.target, a11 = e9.getAttribute("data-option-name");
    this.templateOptions[a11] = e9.checked, "scaleEnabled" === a11 && (this.templateOptions[a11] || this._resetToCurrentScale());
  }
  _renderExportedLink(t4) {
    const e9 = this.messages;
    return t4.map((t5) => {
      const { error: a11, url: i9, state: n5 } = t5, l3 = t5.formattedName ?? "", r4 = "error" === n5, p12 = "pending" === n5, d6 = "ready" === n5, c6 = { [e4.anchorDisabled]: p12 || r4 };
      let u5 = i9 || null;
      u5 && (u5 = S2(u5));
      const h3 = F(i9, location.href), m6 = { [i3.loadingIndicator]: p12, [e4.rotating]: p12, [i3.download]: h3 && d6, [i3.launchLinkExternal]: !h3 && d6, [i3.error]: r4, [S6.exportedFileError]: r4 }, b4 = { [S6.exportedFileError]: r4 };
      let v4;
      v4 = p12 ? e9.pending : d6 ? e9.ready : e9.errorMessage;
      const f5 = r4 ? "print-task:cim-symbol-unsupported" === (a11 == null ? void 0 : a11.name) ? e9.exportWebMapCIMError : e9.exportWebMapError : "";
      return n3("div", { "aria-label": v4, class: S6.exportedFile, "data-item": t5, key: l3, onclick: this._removeLink, title: f5 }, n3("a", { "aria-label": `${l3}. ${e9.linkReady}`, class: this.classes(S6.exportedFileLink, e4.anchor, c6), download: l3, href: u5 ?? "", onclick: this._handleLinkClick, rel: "noreferrer", tabIndex: 0, target: "_blank" }, n3("span", { class: this.classes(m6) }), n3("span", { class: this.classes(S6.exportedFileLinkTitle, b4) }, l3)));
    });
  }
  _toggleLayoutPanel(t4) {
    const e9 = t4.target;
    this._toggleTab(e9.getAttribute("data-tab-id"));
  }
  _toggleTab(t4, e9 = true) {
    var _a, _b;
    this._layoutTabSelected = t4 === x3.layout, this.templateOptions.layout = this._layoutTabSelected ? ((_b = (_a = this.viewModel.templatesInfo) == null ? void 0 : _a.layout) == null ? void 0 : _b.defaultValue) ?? "letter-ansi-a-landscape" : T2, this.templateOptions.layoutItem = null, e9 && (this._activeTabFocusRequested = true);
  }
  _handleLayoutPanelKeyDown(t4) {
    const { key: e9 } = t4, a11 = t4.target.getAttribute("data-tab-id");
    if (x(e9))
      return this._toggleTab(a11), t4.preventDefault(), void t4.stopPropagation();
    "ArrowLeft" !== e9 && "ArrowRight" !== e9 || (this._toggleTab(a11 === x3.layout ? x3.mapOnly : x3.layout), t4.preventDefault(), t4.stopPropagation());
  }
};
e([y()], $2.prototype, "allowedFormats", null), e([y()], $2.prototype, "allowedLayouts", null), e([y()], $2.prototype, "error", null), e([y({ type: O })], $2.prototype, "exportedLinks", void 0), e([y()], $2.prototype, "extraParameters", null), e([y()], $2.prototype, "headingLevel", void 0), e([y()], $2.prototype, "icon", null), e([y()], $2.prototype, "includeDefaultTemplates", null), e([y()], $2.prototype, "label", null), e([y(), e2("esri/widgets/Print/t9n/Print")], $2.prototype, "messages", void 0), e([y()], $2.prototype, "portal", null), e([y()], $2.prototype, "printServiceUrl", null), e([y()], $2.prototype, "templateCustomTextElements", null), e([y({ type: p11 })], $2.prototype, "templateOptions", void 0), e([y()], $2.prototype, "view", null), e([y({ type: _2 })], $2.prototype, "viewModel", void 0), $2 = e([a2("esri.widgets.Print")], $2);
var F3 = $2;
export {
  F3 as default
};
//# sourceMappingURL=Print-MU6ULODD.js.map
