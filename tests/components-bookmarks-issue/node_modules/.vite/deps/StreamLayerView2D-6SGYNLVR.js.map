{
  "version": 3,
  "sources": ["../../@arcgis/core/views/2d/layers/StreamLayerView2D.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import r from\"../../../core/Error.js\";import{handlesGroup as t,makeHandle as s}from\"../../../core/handleUtils.js\";import{watch as o}from\"../../../core/reactiveUtils.js\";import{property as n}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import a from\"../../../rest/support/FeatureSet.js\";import c from\"./FeatureLayerView2D.js\";import{handleNoEngineError as l}from\"./support/handleNoEngineError.js\";import h from\"../../layers/StreamLayerView.js\";let p=class extends(h(c)){constructor(){super(...arguments),this.pipelineConnectionStatus=\"disconnected\",this.pipelineErrorString=null}initialize(){this.addHandles([o((()=>this.layer.customParameters),(e=>this._worker.streamMessenger.updateCustomParameters(e))),this.layer.on(\"send-message-to-socket\",(e=>this._worker.streamMessenger.sendMessageToSocket(e))),this.layer.on(\"send-message-to-client\",(e=>{this._worker.streamMessenger.sendMessageToClient(e),this._isUserPaused&&\"type\"in e&&\"clear\"===e.type&&this.incrementSourceRefreshVersion()})),o((()=>this.layer.purgeOptions),(()=>this._update())),o((()=>this.suspended),this._onSuspendedChange.bind(this))],\"constructor\"),this._doResume()}destroy(){this._doPause()}get connectionError(){return this.pipelineErrorString?new r(\"stream-controller\",this.pipelineErrorString):null}on(e,r){if(Array.isArray(e))return t(e.map((e=>this.on(e,r))));const o=[\"data-received\",\"message-received\"].includes(e);o&&this._worker.streamMessenger.enableEvent(e,!0);const n=super.on(e,r),i=this;return s((()=>{n.remove(),o&&(i._worker.closed||i.hasEventListener(e)||i._worker.streamMessenger.enableEvent(e,!1))}))}queryLatestObservations(e,t){if(!(this.layer.timeInfo?.endField||this.layer.timeInfo?.startField||this.layer.timeInfo?.trackIdField))throw new r(\"streamlayer-no-timeField\",\"queryLatestObservation can only be used with services that define a TrackIdField\");return l(this._worker.features.executeQueryForLatestObservations(this._cleanUpQuery(e),t).then((e=>{const r=a.fromJSON(e);return r.features.forEach((e=>{e.layer=this.layer,e.sourceLayer=this.layer})),r})),new a({features:[]}))}detach(){super.detach(),this.pipelineConnectionStatus=\"disconnected\"}get _streamConnectionStatus(){return this.pipelineConnectionStatus}_doPause(){null!=this._refreshInterval&&(clearInterval(this._refreshInterval),this._refreshInterval=null)}_doResume(){this._refreshInterval=setInterval((()=>this.incrementSourceRefreshVersion()),this.layer.updateInterval)}_doDisconnect(){this._worker.streamMessenger.disconnect(),this._doPause()}_doConnect(){this._worker.streamMessenger.connect(),this.resume()}_doClear(){this._worker.streamMessenger.clear(),null==this._refreshInterval&&this.incrementSourceRefreshVersion()}_createClientOptions(){const e=super._createClientOptions(),r=this;return{...e,get container(){return r.featureContainer},setProperty:e=>{this.set(e.propertyName,e.value)}}}};e([n()],p.prototype,\"pipelineConnectionStatus\",void 0),e([n()],p.prototype,\"pipelineErrorString\",void 0),e([n({readOnly:!0})],p.prototype,\"connectionError\",null),e([n({readOnly:!0})],p.prototype,\"_streamConnectionStatus\",null),p=e([i(\"esri.views.2d.layers.StreamLayerView2D\")],p);const u=p;export{u as default};\n"],
  "mappings": "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",
  "names": ["e", "r", "o", "n", "d"]
}
