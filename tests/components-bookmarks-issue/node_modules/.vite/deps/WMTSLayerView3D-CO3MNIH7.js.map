{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/layers/WMTSLayerView3D.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Collection.js\";import i from\"../../../core/Logger.js\";import{whenOnce as r}from\"../../../core/reactiveUtils.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/RandomLCG.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import{getTileMaxtrixSetFromActiveLayer as l}from\"../../../layers/support/layerUtils.js\";import{LayerView3D as a}from\"./LayerView3D.js\";import{TiledLayerView3D as n}from\"./TiledLayerView3D.js\";import h from\"../../layers/LayerView.js\";import d from\"../../layers/RefreshableLayerView.js\";let m=class extends(d(n(a(h)))){constructor(){super(...arguments),this.type=\"wmts-3d\"}initialize(){this._getCompatibleTileInfoMatrixSet((e=>this._getTileInfoSupportError(e.tileInfo,e.fullExtent)));const e=r((()=>this.view?.basemapTerrain?.tilingSchemeLocked)).then((()=>{const e=this._getCompatibleTileInfoMatrixSet((e=>this._getTileInfoError(e.tileInfo,e.fullExtent)));null!=e&&(null!==e.id&&this.layer.activeLayer.tileMatrixSetId!==e.id&&(this.layer.activeLayer.tileMatrixSetId=e.id),e.tileInfo&&(this.tileInfo=e.tileInfo),this.layer.fullExtent=e.fullExtent)}));this.addResolvingPromise(e),this.when((()=>this._postInitialize()))}get hasMixedImageFormats(){return!0}refresh(){this.emit(\"data-changed\")}canResume(){if(!super.canResume())return!1;const e=this.layer.activeLayer.tileMatrixSet;return null!=e&&!this._getTileInfoError(e.tileInfo,e.fullExtent)}async doRefresh(){this.suspended||this.emit(\"data-changed\")}_postInitialize(){this._updatingHandles.add((()=>this.layer?.activeLayer?.styleId),(()=>this.refresh())),this._updatingHandles.add((()=>this.layer?.activeLayer),(e=>{const t=this._getCompatibleTileInfoMatrixSet((e=>this._getTileInfoError(e.tileInfo,e.fullExtent)),!0);t&&null!=t.id&&e.tileMatrixSetId!==t.id&&(this.layer.activeLayer.tileMatrixSetId=t.id),this.notifyChange(\"suspended\"),this.canResume()&&this.refresh()}))}_getCompatibleTileInfoMatrixSet(e,r=!1){const s=l(this.layer);if(null!=s){if(t.isCollection(s)){const t=s.find((t=>{const s=e(t);return null!=s&&(r?i.getLogger(this).error(\"The selected tile matrix set is not compatible with the view\",s):this.addResolvingPromise(Promise.reject(s))),null==s}));return t}const o=e(s);return null!=o&&(r?i.getLogger(this).error(\"The selected tile matrix set is not compatible with the view\",o):this.addResolvingPromise(Promise.reject(o))),s}return null}_getTileInfoError(e,t){return this._getTileInfoSupportError(e,t)||this._getTileInfoCompatibilityError(e,this.view.basemapTerrain.tilingScheme)}};e([s({readOnly:!0})],m.prototype,\"hasMixedImageFormats\",null),e([s()],m.prototype,\"layer\",void 0),e([s()],m.prototype,\"suspended\",void 0),e([s()],m.prototype,\"tileInfo\",void 0),m=e([o(\"esri.views.3d.layers.WMTSLayerView3D\")],m);const p=m;export{p as default};\n"],
  "mappings": "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",
  "names": ["n", "e", "t", "s"]
}
