/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{isSome as e}from"../../../core/arrayUtils.js";import{getDisplayFieldName as t}from"../../../layers/support/fieldUtils.js";import{loadPanelContentComponents as r,PanelContentSection as a,PanelContent as l}from"./PanelContent.js";import{ItemList as o}from"../../FeatureTemplates/ItemList.js";import"../../support/widgetUtils.js";import{tsx as s}from"../../support/jsxFactory.js";const i=()=>r();function n({editorItems:t,filterText:r,id:i,messagesTemplates:n,onFilterTextChange:m,onSelectFeature:c,workflow:u}){const f=new Map,p=u.data.candidates;let y=0;p.map((e=>({label:d(e),id:e.attributes[e.layer.objectIdField],data:e}))).filter((({label:e,data:a})=>{const l=r.toLowerCase(),{title:o}=a.layer,s=t.find((e=>e.layer===a.sourceLayer));return s?s.supportsUpdateWorkflow&&(!l||e?.toLowerCase().includes(l)||o?.toLowerCase().includes(l)):null})).filter(e).forEach((e=>{y++;const t=e.data.layer;f.has(t)?f.get(t)?.items.push(e):f.set(t,{id:`${t.id}`,label:t.title??"",items:[e]})}));const h=t.toArray().map((({layer:e})=>f.get(e))).filter(e),I=y>10||r.length>0;return s(l,{key:"feature-list"},s(a,null,o({enableListScroll:!1,filterEnabled:I,filterText:r,id:i,items:h,messages:{filterPlaceholder:n.filterPlaceholder,noItems:n.noItems,noMatches:n.noMatches},onFilterChange:e=>m(e),onItemMouseEnter:e=>c(e.data),onItemMouseLeave:()=>c(null),onItemSelect:e=>c(e.data,!0)})))}function d(e){const r=e.layer;if(!r)return null;const a=r.fieldsIndex.get(r.objectIdField),l=a.alias||a.name,{attributes:o}=e,s=t(r);return s&&o[s]&&`${o[s]}`||`${l}: ${o[a.name]}`}export{n as FeatureList,i as loadFeatureListComponents};
