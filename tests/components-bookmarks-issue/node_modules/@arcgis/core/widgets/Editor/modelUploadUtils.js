/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{makeHandle as e,handlesGroup as r}from"../../core/handleUtils.js";import{throwIfAborted as o}from"../../core/promiseUtils.js";import{watch as t}from"../../core/reactiveUtils.js";import{showProgressCursor as a}from"./workflowUtils.js";async function n({view:n,data:c,signal:l,next:i,cancel:u}){const{creationInfo:m}=c;if(!m)return e();if(!s(m))return e();const{layer:p}=m,f=null!=m.geometryToPlace;if(m.geometryToPlace=null,f)return u(),e();const{Upload:d}=await import("./Upload.js");o(l);const y=new d;c.upload=y;let w=null;const U=()=>w?.remove(),g=r([t((()=>y.state),(e=>{switch(e){case"default":case"error":U();break;case"pending":U(),w=a(n);break;case"success":m.maxFeatures=1,m.geometryToPlace=y.result,U(),i()}})),e((()=>{y.cancel(),U()}))]);return y.uploadTo(p),g}function s(e){const r=e?.layer;return"scene"===r?.type}export{n as handleModelUpload,s as isModelUpload};
