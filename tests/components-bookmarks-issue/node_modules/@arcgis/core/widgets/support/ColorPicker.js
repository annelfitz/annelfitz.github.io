/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import o from"../../Color.js";import{watch as t,syncAndInitial as r}from"../../core/reactiveUtils.js";import{property as s}from"../../core/accessorSupport/decorators/property.js";import"../../core/has.js";import"../../core/Logger.js";import"../../core/RandomLCG.js";import{subclass as i}from"../../core/accessorSupport/decorators/subclass.js";import n from"../Widget.js";import{loadCalciteComponents as a}from"./componentsUtils.js";import"./widgetUtils.js";import{messageBundle as p}from"./decorators/messageBundle.js";import{tsx as l}from"./jsxFactory.js";const c="esri-color-picker",d={base:c,backgroundPattern:`${c}__bg-pattern`,toggleButton:`${c}__toggle-button`,popover:`${c}__popover`};let m=class extends n{constructor(e,t){super(e,t),this.value=new o,this.alphaEnabled=!0,this._containerElement=null,this._button=null,this._open=!1,this._onColorInput=e=>{const t=e.target.value,r="string"==typeof t?new o(t):new o;this.value=r,this.onChange?.(r)}}initialize(){this.addHandles(t((()=>({container:this._containerElement,value:this.value})),(({container:e,value:o})=>{e?.style.setProperty("--esri-color-picker-value",o.toCss(!0))}),r))}loadDependencies(){return a({button:()=>import("@esri/calcite-components/dist/components/calcite-button.js"),"color-picker":()=>import("@esri/calcite-components/dist/components/calcite-color-picker.js"),popover:()=>import("@esri/calcite-components/dist/components/calcite-popover.js")})}render(){const e=this._messages,o=this._open?e.close:e.open;return l("div",{afterCreate:e=>this._containerElement=e,class:this.classes(d.base,this.class)},l("div",{class:d.backgroundPattern,key:"background-pattern"}),l("calcite-button",{afterCreate:e=>this._button=e,appearance:"transparent",class:d.toggleButton,key:"popover-trigger",kind:"neutral",label:o,scale:"s",tabIndex:-1,title:o}),l("calcite-popover",{autoClose:!0,class:d.popover,key:"popover",label:e.label,overlayPositioning:"fixed",referenceElement:this._button,onCalcitePopoverClose:()=>this._open=!1,onCalcitePopoverOpen:()=>this._open=!0},l("calcite-color-picker",{alphaChannel:this.alphaEnabled,channelsDisabled:!0,key:"color-picker",savedDisabled:!0,value:this.value.toCss(),onCalciteColorPickerInput:this._onColorInput})))}};e([s()],m.prototype,"class",void 0),e([s()],m.prototype,"value",void 0),e([s()],m.prototype,"alphaEnabled",void 0),e([s()],m.prototype,"onChange",void 0),e([s()],m.prototype,"_containerElement",void 0),e([s()],m.prototype,"_button",void 0),e([s()],m.prototype,"_open",void 0),e([s(),p("esri/widgets/support/t9n/ColorPicker")],m.prototype,"_messages",void 0),m=e([i("esri.widgets.support.ColorPicker")],m);export{m as ColorPicker};
