/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import t from"../../request.js";import o from"../../core/Error.js";import{parseUrl as i,encode as e,asValidOptions as r}from"../utils.js";import s from"./support/ValidateNetworkTopologyResult.js";async function a(o,a,n){const d=i(o),l=a.toJSON();a.validationSet&&(l.validationSet=JSON.stringify(a.validationSet));const u={...l,returnEdits:!0,f:"json"},p=e({...d.query,...u}),m=r(p,{...n,method:"post"}),v=`${d.path}/validateNetworkTopology`,{data:y}=await t(v,m),c=s.fromJSON(y);return c.serviceEdits=c.serviceEdits?.map((t=>({layerId:t.id,editedFeatures:t.editedFeatures})))??[],c}async function n(s,a,n){if(!a.gdbVersion)throw new o("submit-validate-network-topology-job:missing-gdb-version","version is missing");const d=i(s),l=a.toJSON();a.validationSet&&(l.validationSet=JSON.stringify(a.validationSet));const u=r(d.query,{query:e({...l,returnEdits:!0,async:!0,f:"json"}),...n,method:"post"}),p=`${d.path}/validateNetworkTopology`,{data:m}=await t(p,u);return m?m.statusUrl:null}export{n as submitValidateNetworkTopologyJob,a as validateNetworkTopology};
