/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{on as t}from"../../core/events.js";import{isAborted as e,createResolver as o}from"../../core/promiseUtils.js";import{whenOnce as n}from"../../core/reactiveUtils.js";async function i(t,o,i){const r=a(t);if(!r?.activeTooltipInfo?.editableFields?.find((t=>t.name===o)))return;t.tooltipOptions.forceEnabled=!0;const{handle:s,promise:l}=c(r.tooltip);try{if(await r.tooltip.enterInputMode(o),e(i))return;if(await Promise.race([n((()=>r.destroyed||"feedback"===r.tooltip.content?.mode),i),l]),e(i))return;t.tooltipOptions.forceEnabled=!1}finally{s.remove()}}const r=new Set(["calcite-input","calcite-button","calcite-action","calcite-dropdown","calcite-dropdown-item"]);function c(e){const n=o(),i=t(e.contentContainer,"focusout",(({relatedTarget:t})=>{const e=t instanceof HTMLElement?t.tagName.toLowerCase():null;e&&r.has(e)||n.resolve()}));return{promise:n.promise,handle:i}}function a(t){const{activeComponent:e}=t;switch(e?.type){case"draw-2d":case"draw-3d":return e;default:return null}}export{i as showTooltipAndFocusField};
