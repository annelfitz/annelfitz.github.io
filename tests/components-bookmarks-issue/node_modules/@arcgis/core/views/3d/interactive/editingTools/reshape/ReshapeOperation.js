/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{_ as t}from"../../../../../chunks/tslib.es6.js";import"../../../../../geometry.js";import e from"../../../../../core/Accessor.js";import{removeUnordered as i}from"../../../../../core/arrayUtils.js";import{unitRGBAFromColor as a}from"../../../../../core/colorUtils.js";import"../../../../../core/has.js";import n from"../../../../../core/Evented.js";import o from"../../../../../core/Handles.js";import{handlesGroup as s,makeHandle as l,destroyHandle as r}from"../../../../../core/handleUtils.js";import{destroyMaybe as p,removeMaybe as h}from"../../../../../core/maybe.js";import{zeroMeters as d,createLength as u,scale as c}from"../../../../../core/quantityUtils.js";import{watch as m,initial as f,on as g}from"../../../../../core/reactiveUtils.js";import{getMetersPerUnitForSR as _}from"../../../../../core/unitUtils.js";import{property as v}from"../../../../../core/accessorSupport/decorators/property.js";import"../../../../../core/Logger.js";import{subclass as M}from"../../../../../core/accessorSupport/decorators/subclass.js";import{IDENTITY as b}from"../../../../../core/libs/gl-matrix-2/factories/mat4f64.js";import{l as x,f as O,m as y,s as E,g as j,h as I}from"../../../../../chunks/vec32.js";import{fromValues as T,create as S}from"../../../../../core/libs/gl-matrix-2/factories/vec3f64.js";import{UpdatingHandles as w}from"../../../../../core/support/UpdatingHandles.js";import H from"../../../../../geometry/Polyline.js";import{projectPoint as V}from"../../../../../geometry/support/plane.js";import{sv3d as A}from"../../../../../geometry/support/vectorStacks.js";import{makeDehydratedPoint as L}from"../../../../../layers/graphics/dehydratedPoint.js";import{isVolumetricSymbol as G}from"../../../../../symbols/support/utils.js";import{Manipulator3D as D}from"../../Manipulator3D.js";import{createManipulatorMaterial as P,createManipulatorOutlineMaterial as k,placeAtObject as U}from"../../manipulatorUtils.js";import{RenderObject as N}from"../../RenderObject.js";import{SegmentLabels3D as C}from"../../SegmentLabels3D.js";import{SnappingVisualizer3D as R}from"../../SnappingVisualizer3D.js";import{screenToMapXYAtLocation as F,screenToRenderPlaneFromEvent as X,convertToMapCoordinates as Z}from"../dragEventPipeline3D.js";import{orientation as z}from"../geometryUtils.js";import{ManipulatorType as Y}from"../ManipulatorType.js";import{canMoveZOperations as q}from"../manipulatorUtils.js";import{Settings as W}from"../settings.js";import{createVisualElements as K}from"../visualElementUtils.js";import{discRadiusSmall as B}from"../manipulations/config.js";import{ManipulationType as J,MoveManipulation as Q}from"../manipulations/MoveManipulation.js";import{axisConstrainedDragSign as $}from"../manipulations/moveUtils.js";import{MoveXYObjectManipulation as tt}from"../manipulations/MoveXYObjectManipulation.js";import{createEdgeOffsetIntersectionPlane as et,createEdgeOffsetOperation as it,edgeOffsetRotationMatrix as at,screenEdgeLengthSquared as nt}from"./edgeOffsetUtils.js";import{OutlineVisualElement as ot}from"../../visualElements/OutlineVisualElement.js";import{createExtrudedTriangle as st,createSphereGeometry as lt}from"../../../webgl-engine/lib/GeometryUtil.js";import{MouseButton as rt}from"../../../../input/IViewEvents.js";import{sceneSnappingAtLocation as pt,addMapDelta as ht,createManipulatorDragEventPipeline as dt,dragAtLocation as ut,addScreenDelta as ct}from"../../../../interactive/dragEventPipeline.js";import{ManipulatorStateCustomFlags as mt,ManipulatorStateFlags as ft}from"../../../../interactive/interfaces.js";import{AccumulationBehavior as gt}from"../../../../interactive/editGeometry/interfaces.js";import{SnappingContext as _t}from"../../../../interactive/snapping/SnappingContext.js";import{createSnapDragEventPipelineStep as vt}from"../../../../interactive/snapping/SnappingDragPipelineStep.js";import{ReshapeEdgeOffsetTooltipInfo as Mt}from"../../../../interactive/tooltip/ReshapeTooltipInfos.js";import{Tooltip as bt}from"../../../../interactive/tooltip/Tooltip.js";import{TranslateZTooltipInfo as xt,TranslateXYTooltipInfo as Ot,TranslateTooltipInfo as yt,TranslateVertexZTooltipInfo as Et,TranslateVertexXYTooltipInfo as jt,TranslateVertexTooltipInfo as It}from"../../../../interactive/tooltip/TranslateTooltipInfos.js";import{makeElevationField as Tt}from"../../../../interactive/tooltip/fields/fields.js";import{autoArea2D as St}from"../../../../support/automaticAreaMeasurementUtils.js";import{autoLength2D as wt,autoDistanceBetweenPoints2D as Ht}from"../../../../support/automaticLengthMeasurementUtils.js";import{elevationFromPoint as Vt,verticalSignedDistanceBetweenPoints as At}from"../../../../support/euclideanLengthMeasurementUtils.js";import{geodesicDistance as Lt}from"../../../../support/geodesicLengthMeasurementUtils.js";import Gt from"../../../../../geometry/SpatialReference.js";let Dt=class extends e{get _operations(){return this.object.operations}constructor(t){super(t),this._selectedIndex=0,this._manipulatorHandles=new o,this._manipulatorInfos=[],this._numGrabbing=0,this._numDragging=0,this._reshapeEventState=zt.NONE,this._updatingHandles=new w,this._recreatingManipulators=!1,this._settings=new W({getTheme:()=>this.view.effectiveTheme}),this.events=new n,this._latestTooltipInfo=null,this._translateTooltipInfo=null,this._translateXYTooltipInfo=null,this._translateZTooltipInfo=null,this._translateVertexTooltipInfo=null,this._translateVertexXYTooltipInfo=null,this._translateVertexZTooltipInfo=null,this._edgeOffsetTooltipInfo=null,this._vertexLaserLineVisualElement=null}initialize(){const{view:t}=this,e=this._settings.manipulators,i=e.vertex;this._vertexManipulatorMaterial=P(a(i.color),i.renderOccluded),this._vertexManipulatorOutlineMaterial=k(a(i.outlineColor),i.renderOccluded),this._vertexManipulatorHoverOutlineMaterial=k(a(i.hoverOutlineColor),i.renderOccluded);const n=e.edge;this._edgeManipulatorMaterial=P(a(n.color),n.renderOccluded),this._edgeManipulatorOutlineMaterial=k(a(n.outlineColor),n.renderOccluded);const o=e.edgeOffset;this._edgeOffsetManipulatorMaterial=P(a(o.color),o.renderOccluded,!1),this._edgeOffsetManipulatorHoverMaterial=P(a(o.hoverColor),o.renderOccluded,!1);const s=e.selected;this._selectedManipulatorMaterial=P(a(s.color),s.renderOccluded),this._selectedManipulatorOutlineMaterial=k(a(s.outlineColor),s.renderOccluded),this._selectedManipulatorHoverOutlineMaterial=k(a(s.hoverOutlineColor),s.renderOccluded),this.tooltip=new bt({view:t}),this.addHandles([m((()=>{const t=this._settings.manipulators;return{vertexSettings:t.vertex,edgeSettings:t.edge,edgeOffsetSettings:t.edgeOffset,selectedSettings:t.selected}}),(({vertexSettings:t,edgeSettings:e,edgeOffsetSettings:i,selectedSettings:a})=>{t.applyColor(this._vertexManipulatorMaterial),t.applyOutline(this._vertexManipulatorOutlineMaterial),t.applyHoverOutline(this._vertexManipulatorHoverOutlineMaterial),e.applyColor(this._edgeManipulatorMaterial),e.applyOutline(this._edgeManipulatorOutlineMaterial),i.applyColor(this._edgeOffsetManipulatorMaterial),i.applyHover(this._edgeOffsetManipulatorHoverMaterial),a.applyColor(this._selectedManipulatorMaterial),a.applyOutline(this._selectedManipulatorOutlineMaterial),a.applyHoverOutline(this._selectedManipulatorHoverOutlineMaterial)})),m((()=>this.object.visible),(t=>{for(const e of this._manipulatorInfos)e.manipulator.available=t,"edge"===e.type&&"edgeManipulator"in e&&(e.edgeManipulator.available=t)})),m((()=>({labels:this._segmentLabels,enabled:this.sketchOptions.labels.enabled,edgeOffsetEnabled:this.enableEdgeOffset})),(({labels:t,enabled:e,edgeOffsetEnabled:i})=>{null!=t&&(t.visible=e,t.edgeDistance=i?"far":"default")}),f),m((()=>this.sketchOptions.tooltips.effectiveEnabled),(t=>{this.tooltip.info=t?this._latestTooltipInfo:null}),f),g((()=>this._operations),"vertex-update",(t=>{this._updateManipulatorPositions(t.vertices)}),{onListenerAdd:()=>this._recreateManipulators()}),g((()=>this._operations?.data),"change",(t=>{"undo"!==t.operation&&"redo"!==t.operation||this._recreateManipulators()}))])}destroy(){this._segmentLabels=p(this._segmentLabels),this.tooltip=p(this.tooltip),this._removeManipulators(),this._updatingHandles.destroy()}get updating(){return this._updatingHandles.updating}get manipulators(){return this.tool.manipulators}get view(){return this.tool.view}get object(){return this.tool.object}get enableZShape(){return this.tool.enableZShape}get enableZVertex(){return this.tool.enableZVertex}get enableMoveObject(){return this.tool.enableMoveObject}get enableMidpoints(){return this.tool.enableMidpoints}get enableEdgeOffset(){return this.tool.enableEdgeOffset}get sketchOptions(){return this.tool.sketchOptions}get _accentColor(){return this.view.effectiveTheme.accentColor}removeSelectedVertices(){const t=this._manipulatorInfos.filter((t=>t.manipulator.selected&&"vertex"===t.type));this._removeVertices(t)}onManipulatorSelectionChanged(){this.events.emit("manipulators-changed")}_removeManipulators(){this._manipulatorHandles.removeAll(),this._moveManipulation=p(this._moveManipulation),this._objectMoveManipulation=p(this._objectMoveManipulation),this.manipulators.removeAll(),this._manipulatorInfos=[],this._numGrabbing=0,this._numDragging=0}_createManipulators(t){if(null==this._operations)return;const e=this.object.elevationInfo;for(const i of this._operations.data.components){const a=t?.byComponentIndex.get(i.index);for(const t of i.vertices){const i=a?.has(t.index);this._createVertexOrEdgeManipulator(t,e,i)}for(const t of i.edges)this._createVertexOrEdgeManipulator(t,e)}this._createObjectMoveManipulation(),this._createMoveManipulation(e),this._createVisualElements()}get canRedo(){return null!=this._operations&&this._operations.canRedo}get canUndo(){return null!=this._operations&&this._operations.canUndo}redo(){return this._operations?.redo()}undo(){return this.events.emit("undo"),this._operations?.undo()}_recreateManipulators(){if(!this._recreatingManipulators){if(this._recreatingManipulators=!0,this._removeManipulators(),this._hideTooltip(),this._operations&&this._segmentLabels?.context?.editGeometryOperations===this._operations||(this._segmentLabels=p(this._segmentLabels)),this._createManipulators(),!this._segmentLabels&&this._operations){const t=this.sketchOptions.labels;this._segmentLabels=new C({context:{view:this.view,editGeometryOperations:this._operations,elevationInfo:this.object.elevationInfo,labelOptions:t},visible:t.enabled})}this._recreatingManipulators=!1}}_perObjectManipulatorDragAction(t,e){if("end"===e.action)return e;let i=0;const a=[],n=this._manipulatorInfos.some((t=>"vertex"===t.type&&t.manipulator.selected)),o=t===Yt.SELECTED_OR_ALL&&n;for(const s of this._manipulatorInfos)"vertex"===s.type&&(s.manipulator.grabbing||o&&!s.manipulator.selected||a.push(s),i++);this._moveVertices(a,e);if(a.length===i){if(this._updateEventState(zt.MOVING),this.destroyed)return e;this.events.emit("move",{type:"move",dx:e.screenDeltaX,dy:e.screenDeltaY,object:this.object})}else{if(this._updateEventState(zt.RESHAPING),this.destroyed)return e;this.events.emit("reshape",{type:"reshape",object:this.object})}return e}_isMultiVertexSelection(){return this._manipulatorInfos.reduce(((t,e)=>"vertex"===e.type&&e.manipulator.selected?t+1:t),0)>1}_perVertexManipulatorDragAction(t){if(this._updateEventState(zt.RESHAPING),this.destroyed)return;const{mapDeltaX:e,mapDeltaY:i,mapDeltaZ:a}=t;if(!e&&!i&&!a)return;const n=[];for(const o of this._manipulatorInfos)"vertex"===o.type&&(o.manipulator.selected&&!o.manipulator.grabbing||o===t.info)&&n.push(o);this._moveVertices(n,t,gt.ACCUMULATE_STEPS),this.events.emit("reshape",{type:"reshape",object:this.object})}_updateEventState(t){if(t===this._reshapeEventState)return!1;switch(t){case zt.NONE:if(0!==this._numGrabbing||0!==this._numDragging)return!1;switch(this._reshapeEventState){case zt.MOVING:this.events.emit("move",{type:"move-stop",dx:0,dy:0,object:this.object});break;case zt.RESHAPING:this.events.emit("reshape",{type:"reshape-stop",object:this.object})}break;case zt.MOVING:switch(this._reshapeEventState){case zt.NONE:this.events.emit("move",{type:"move-start",dx:0,dy:0,object:this.object});break;case zt.RESHAPING:this.events.emit("reshape",{type:"reshape-stop",object:this.object}),this.destroyed||this.events.emit("move",{type:"move-start",dx:0,dy:0,object:this.object})}break;case zt.RESHAPING:switch(this._reshapeEventState){case zt.NONE:this.events.emit("reshape",{type:"reshape-start",object:this.object});break;case zt.MOVING:this.events.emit("move",{type:"move-stop",dx:0,dy:0,object:this.object}),this.destroyed||this.events.emit("reshape",{type:"reshape-start",object:this.object})}}if(this.destroyed)return!1;const e=this._reshapeEventState!==t;return this._reshapeEventState=t,e}_createObjectMoveManipulation(){const{tool:t,view:e,object:i,_operations:a}=this;if(a){if(this._objectMoveManipulation=new tt({tool:t,view:e,object:i}),this.enableMoveObject){let t=null;this._manipulatorHandles.add(this._objectMoveManipulation.createDragPipeline(((e,i,n)=>{i.next((t=>this._trackNumDragging(t))).next((e=>("start"===e.action&&(t=a.createUndoGroup()),e))).next((t=>this._perObjectManipulatorDragAction(Yt.ALL,t))).next((t=>(this._updateTranslateObjectTooltip(J.XY,t),t))).next((e=>{"end"===e.action&&(this._hideTooltip(),t=h(t))})),n.next((()=>this._onDragCancel(!0,(()=>t=h(t)))))}))),this._objectMoveManipulation.forEachManipulator((t=>this._manipulatorHandles.add(this._watchAndUpdateGrabState(t,!1))))}else this._objectMoveManipulation.forEachManipulator((t=>{t.grabbable=!1,t.cursor=null}));this._objectMoveManipulation.forEachManipulator((t=>this._manipulatorHandles.add(t.events.on("immediate-click",(t=>{this._manipulatorInfos.some((t=>t.manipulator.selected))?this._clearSelection():this.events.emit("immediate-click",{...t,object:this.object}),t.stopPropagation()})))))}}_createMoveManipulation(t){const{object:e,tool:i,view:a,_operations:n}=this;if(!n)return;this._moveManipulation=new Q({tool:i,view:a,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZShape&&q(e.operations,e.elevationInfo),snapToScene:!1,radius:Q.radiusForSymbol(e.graphic?.symbol)}),this._moveManipulation.forEachManipulator((t=>this.addHandles([t.events.on("immediate-click",(e=>{this._moveManipulation.zManipulation.hasManipulator(t)||this._manipulatorInfos.some((t=>t.manipulator.selected))||this.events.emit("immediate-click",{...e,object:this.object}),e.stopPropagation()})),this._watchAndUpdateGrabState(t,!1)])));const o=t=>e=>{this.addHandles(e.events.on("focus-changed",(({action:e})=>{"focus"===e?this._updateTranslateTooltip(t):this._hideTooltip()})))};this._moveManipulation.xyManipulation.forEachManipulator(o(J.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(o(J.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(o(J.Z)),this._moveManipulation.elevationInfo={mode:"absolute-height",offset:0};const s=n.data.spatialReference;this.addHandles([this._moveManipulation.createDragPipeline(((a,o,s,l,r)=>{const{snappingStep:p,cancelSnapping:h}=vt({predicate:t=>!!t.info,snappingManager:i.snappingManager,snappingContext:new _t({editGeometryOperations:n,elevationInfo:t,pointer:r,excludeFeature:e.graphic,visualizer:new R}),updatingHandles:this._updatingHandles,useZ:!1});return l=l.next((t=>(this._onDragCancel(),t))).next(h),{steps:s=s.next((t=>this._trackNumDragging(t))).next((t=>{const e=this._manipulatorInfos.filter((t=>"vertex"===t.type&&t.manipulator.selected));return t.manipulatorType===Y.TRANSLATE_XY&&1===e.length?{...t,info:e[0],snapOrigin:e[0].handle.pos}:t})).next(pt(this.view,t,e.graphic??void 0)).next(...p).next(ht()).next((t=>this._perObjectManipulatorDragAction(Yt.SELECTED_OR_ALL,t))).next((t=>(this._updateTranslateTooltip(a,t),t))),cancel:l}}),t,s,e.graphic),m((()=>e.visible),(()=>this._updateMoveManipulationPosition()),f),e.on("committed",(()=>{this._recreatingManipulators||this._updateMoveManipulationPosition()})),m((()=>e.isDraped),(t=>{this._updateMoveManipulationPosition();const e="align-move-manipulation";t?this.addHandles(this.view.elevationProvider.on("elevation-change",(()=>this._updateMoveManipulationPosition())),e):this.removeHandles(e)}),f)])}_createVisualElements(){const{object:t,view:e}=this,i=K({view:e,object:t,forEachManipulator:t=>{if(!this.destroyed&&!this._recreatingManipulators){this._objectMoveManipulation.forEachManipulator(t),this._moveManipulation.forEachManipulator(t);for(const e of this._manipulatorInfos)t(e.manipulator,Y.TRANSLATE_XY)}},onManipulatorsChanged:t=>this.events.on("manipulators-changed",t)});null!=i&&(this._outlineVisualElement=i.visualElement instanceof ot?i.visualElement:null);const a=this._outlineVisualElement;if(null!=a){const e=()=>{t.isDraped||this._updateMoveManipulationPosition()};this._manipulatorHandles.add(g((()=>a.events),"attachment-origin-changed",e,{onListenerAdd:e}))}this._manipulatorHandles.add(i)}_createEdgeOffsetManipulator(t,e=this.object.elevationInfo){const i=this._operations;if(t.component.vertices.length<=2||!i)return null;const a=this._settings.manipulators.edgeOffset,n=a.size/2,o=n+a.collisionPadding,l=n/o,r=l*Math.sqrt(3)/2;null==this._edgeOffsetManipulatorGeometryInside&&(this._edgeOffsetManipulatorGeometryInside=st(this._edgeOffsetManipulatorMaterial,r,l/2,l/2,a.height,a.offset)),null==this._edgeOffsetManipulatorGeometryOutside&&(this._edgeOffsetManipulatorGeometryOutside=st(this._edgeOffsetManipulatorMaterial,-r,l/2,l/2,a.height,-a.offset));const p=[new N(this._edgeOffsetManipulatorGeometryInside.instantiate(),ft.Unfocused),new N(this._edgeOffsetManipulatorGeometryInside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),ft.Focused),new N(this._edgeOffsetManipulatorGeometryOutside.instantiate(),ft.Unfocused),new N(this._edgeOffsetManipulatorGeometryOutside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),ft.Focused)],h=new D({view:this.view,renderObjects:p,elevationInfo:"on-the-ground"!==e.mode||G(this.object.graphic?.symbol)?{mode:"absolute-height",offset:0}:e,worldOriented:!1,focusMultiplier:1,radius:o,available:this.object.visible,collisionType:{type:"disc",direction:T(0,0,1)},collisionPriority:1,metadata:{deleting:!1}}),u=new D({view:this.view,worldSized:!0,worldOriented:!1,available:this.object.visible,collisionPriority:-10,cursor:this.enableMoveObject?"move":"default",metadata:{deleting:!1}}),c={manipulator:h,handle:t,locationUpdateHandle:null,type:"edge",selectedIndex:0,edgeManipulator:u,elevationInfo:e,visibilityHandle:null};this._autoHideEdgeOffsetManipulator(c,a.minSquaredEdgeLength),this._updateEdgeOffsetManipulator(c);const m=[];for(const s of[t.leftVertex,t.rightVertex]){const t=this._getManipulatorInfoFromHandle(s);null!=t&&m.push(t.manipulator.events.on("location-update",(()=>this._updateEdgeOffsetManipulator(c))))}c.locationUpdateHandle=s(m),this._manipulatorHandles.add(c.locationUpdateHandle,h),this._manipulatorHandles.add([this._watchAndUpdateGrabState(h,!0),this._watchAndUpdateGrabState(u,!0)],h),this._manipulatorHandles.add(dt(h,this._createEdgeOffsetPipeline(c,e)),h),this._manipulatorHandles.add(dt(u,((t,a,n,o)=>{if("touch"===o){this._createEdgeOffsetPipeline(c,e)(t,a,n)}else if(this.enableMoveObject){const o=this.object.graphic,s=i.data.spatialReference;a.next((t=>this._trackNumDragging(t))).next(ut(this.view,t.elevationAlignedLocation)).next(F(this.view,t.elevationAlignedLocation,e,s,o)).next(ct()).next(ht()).next((t=>this._perObjectManipulatorDragAction(Yt.ALL,t))).next((t=>(this._updateTranslateObjectTooltip(J.XY,t),t))).next((t=>{"end"===t.action&&this._hideTooltip()})),n.next((()=>this._onDragCancel(!t.metadata.deleting)))}})),h);const f=t=>{this._manipulatorInfos.some((t=>t.manipulator.selected))?this._clearSelection():this.events.emit("immediate-click",{...t,object:this.object}),t.stopPropagation()};return this._manipulatorHandles.add([h.events.on("immediate-click",f),u.events.on("immediate-click",f),h.events.on("focus-changed",(({action:t})=>{const{sketchOptions:e,tooltip:i}=this;if("focus"===t){const t=this._edgeOffsetTooltipInfo??=new Mt({sketchOptions:e});t.distance=d,t.sketchOptions=e,this._updateTooltipAreaOrTotalLength(t),this._latestTooltipInfo=t,i.info=e.tooltips.effectiveEnabled?this._latestTooltipInfo:null}else this._hideTooltip()}))],h),this._manipulatorInfos.push(c),this.manipulators.add(h),this.manipulators.add(u),this.events.emit("manipulators-changed"),c}_autoHideEdgeOffsetManipulator(t,e){const i=t.manipulator,a=t.edgeManipulator,n=()=>{t.visibilityHandle=h(t.visibilityHandle);const n=this._getManipulatorInfoFromHandle(t.handle.leftVertex),o=this._getManipulatorInfoFromHandle(t.handle.rightVertex),r=null!=n&&null!=o&&nt(n.manipulator.renderLocation,o.manipulator.renderLocation,this.view.state.camera)<e;(!i.focused&&!a.focused||r)&&(i.grabbable=!r,a.grabbable=!r,t.visibilityHandle=s([i.disableDisplay(),l((()=>{i.grabbable=!0,a.grabbable=this.enableMoveObject}))]))};this._manipulatorHandles.add([i.events.on("focus-changed",n),a.events.on("focus-changed",n),l((()=>{h(t.visibilityHandle),a.metadata.deleting=!0,this.manipulators.remove(a)}))],i),n()}_updateEdgeOffsetManipulator(t){if(!this._operations)return;this._updateManipulatorPosition(t);const{coordinateHelper:e}=this._operations.data,i=et(this.view,t.manipulator.elevationAlignedLocation,it(e,t.handle,t.manipulator.elevationInfo)),a=this._getManipulatorInfoFromHandle(t.handle.leftVertex),n=this._getManipulatorInfoFromHandle(t.handle.rightVertex);if(null==a||null==n)return;const o=a.manipulator.renderLocation,s=n.manipulator.renderLocation,l=null!=i?at(i,o,s):b;t.manipulator.modelTransform=l,t.edgeManipulator.elevationAlignedLocation=t.manipulator.elevationAlignedLocation,t.edgeManipulator.modelTransform=l;const r=x(O(Ft,o,s))/2;t.edgeManipulator.collisionType={type:"line",paths:[[[-r,0,0],[r,0,0]]]}}_createEdgeOffsetPipeline(t,e){return(i,a,n)=>{const o=this._operations;if(!o)return;this._clearSelection();const{step:s,cleanup:l}=this._initializeEdgeOffset(t,e,o);a.next((t=>this._trackNumDragging(t))).next(ut(this.view,i.elevationAlignedLocation)).next(s).next(X(this.view)).next(Z(this.view,o.data.spatialReference)).next(ht()).next(kt()).next(this._applyEdgeOffsetStep(t)).next(this._showEdgeOffsetTooltip()).next((t=>{"end"===t.action&&l()})),n.next((()=>{i.metadata.deleting||(l(),this._onDragCancel())}))}}_initializeEdgeOffset(t,e,i){const{view:n}=this,o=it(i.data.coordinateHelper,t.handle,e),l=i.createUndoGroup(),p=et(n,t.manipulator.elevationAlignedLocation,o);if(o.requiresSplitEdgeLeft){const e=this._getManipulatorInfoFromHandle(t.handle.leftVertex.leftEdge);null!=e&&this._splitEdgeManipulator(e,1)}if(o.requiresSplitEdgeRight){const e=this._getManipulatorInfoFromHandle(t.handle.rightVertex.rightEdge);null!=e&&this._splitEdgeManipulator(e,0)}const d=()=>new H({paths:[[t.handle.leftVertex.pos,t.handle.rightVertex.pos]],spatialReference:i.data.spatialReference}),u=this._settings,c=new ot({view:n,isDraped:this.object.isDraped,geometry:d(),elevationInfo:t.elevationInfo,width:u.visualElements.lineObjects.outline.width,attached:!1,isDecoration:!0});let g;const _=()=>{this._cleanEdgeOffsetCollapsedEdges(t),g=h(g)},v=this.events.on("undo",_);return g=s([m((()=>a(this._accentColor)),(t=>c.color=t),f),r(c),m((()=>this.object.isDraped),(t=>c.isDraped=t)),this.object.on("committed",(()=>c.geometry=d())),l,v]),c.attached=!0,{step:t=>null==o||null==p?(_(),null):{...t,operation:o,plane:p},cleanup:_}}_applyEdgeOffsetStep(t){return e=>{if(this.destroyed||null==e.operation)return e;this._updateEventState(zt.RESHAPING);const{mapDeltaX:i,mapDeltaY:a,mapDeltaZ:n}=e;return(i||a||n)&&(this._offsetEdge(t,e),this.events.emit("reshape",{type:"reshape",object:this.object})),e}}_showEdgeOffsetTooltip(){return t=>{const{mapEnd:e,signedDistance:i,operation:a}=t,{tooltip:n,sketchOptions:o}=this;if(null!=i&&this._operations){const n=this._edgeOffsetTooltipInfo??=new Mt({sketchOptions:o});n.sketchOptions=o,n.distance="end"===t.action?d:Ct(this.object.isDraped,i*a.selectedArrow,e,a.plane,this._operations.data.coordinateHelper),this._updateTooltipAreaOrTotalLength(n),this._latestTooltipInfo=n}else this._latestTooltipInfo=null;return n.info=o.tooltips.effectiveEnabled?this._latestTooltipInfo:null,t}}_cleanEdgeOffsetCollapsedEdges(t){if(!this._operations)return;const e=t.handle.leftVertex.leftEdge?.leftVertex,i=t.handle.leftVertex,a=t.handle.rightVertex.rightEdge?.rightVertex,n=t.handle.rightVertex,o=this._operations.data.coordinateHelper,s=[];if(e&&o.distance(e.pos,i.pos)<Xt){const t=this._getManipulatorInfoFromHandle(i);null!=t&&s.push(t)}if(o.distance(i.pos,n.pos)<Xt||a&&o.distance(a.pos,n.pos)<Xt){const t=this._getManipulatorInfoFromHandle(n);null!=t&&s.push(t)}s.length&&this._removeVertices(s)}_createVertexOrEdgeManipulator(t,e=this.object.elevationInfo,i=!1){const{view:a,_operations:n}=this;if(!n)return null;const o=this._settings;if("edge"===t.type){if(this.enableEdgeOffset)return this._createEdgeOffsetManipulator(t,e);if(!this.enableMidpoints)return null}if(null==this._vertexManipulatorGeometry||null==this._vertexManipulatorOutlineGeometry){const{size:t,outlineSize:e}=Ut(o.manipulators.vertex);this._vertexManipulatorGeometry=lt(this._vertexManipulatorMaterial,t,16,16),this._vertexManipulatorOutlineGeometry=lt(this._vertexManipulatorOutlineMaterial,e,16,16)}if(null==this._edgeManipulatorGeometry||null==this._edgeManipulatorOutlineGeometry){const{size:t,outlineSize:e}=Ut(o.manipulators.edge);this._edgeManipulatorGeometry=lt(this._edgeManipulatorMaterial,t,16,16),this._edgeManipulatorOutlineGeometry=lt(this._edgeManipulatorOutlineMaterial,e,16,16)}const l=this._operations?.data.type,r="point"===l||"mesh"===l?[]:[new N(this._vertexManipulatorGeometry.instantiate(),Zt.Vertex|ft.Unselected),new N(this._vertexManipulatorOutlineGeometry.instantiate(),Zt.Vertex|ft.Unfocused|ft.Unselected),new N(this._vertexManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),Zt.Vertex|ft.Focused|ft.Unselected),new N(this._vertexManipulatorGeometry.instantiate({material:this._selectedManipulatorMaterial}),ft.Selected),new N(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorOutlineMaterial}),ft.Selected|ft.Unfocused),new N(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorHoverOutlineMaterial}),ft.Selected|ft.Focused)];this.enableMidpoints&&r.push(new N(this._edgeManipulatorGeometry.instantiate({material:this._vertexManipulatorMaterial}),Zt.Edge|ft.Focused|ft.Unselected),new N(this._edgeManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),Zt.Edge|ft.Focused|ft.Unselected),new N(this._edgeManipulatorGeometry.instantiate(),Zt.Edge|ft.Unfocused|ft.Unselected),new N(this._edgeManipulatorOutlineGeometry.instantiate(),Zt.Edge|ft.Unfocused|ft.Unselected));const p=new D({view:a,renderObjects:r,elevationInfo:e,focusMultiplier:1,touchMultiplier:1,available:this.object.visible,metadata:{deleting:!1}});p.selected=i,this._setTypeSpecificManipulatorSettings(p,t,e);const d="edge"===t.type?{manipulator:p,handle:t,locationUpdateHandle:null,type:"edge",selectedIndex:0}:{manipulator:p,handle:t,type:"vertex",selectedIndex:0};if(this._manipulatorInfos.push(d),this.manipulators.add(p),this._updateManipulatorPosition(d),"edge"===d.type){const t=[];for(const e of[d.handle.leftVertex,d.handle.rightVertex]){const i=this._getManipulatorInfoFromHandle(e);null!=i&&t.push(i.manipulator.events.on("location-update",(()=>this._updateManipulatorPosition(d))))}d.locationUpdateHandle=s(t),this._manipulatorHandles.add(d.locationUpdateHandle,p)}this._manipulatorHandles.add(this._watchAndUpdateGrabState(p,!0),p);const u=dt(p,((t,i,a,o)=>{let s=null;const{snappingStep:l,cancelSnapping:r}=vt({predicate:()=>!this._isMultiVertexSelection(),snappingManager:this.tool.snappingManager,snappingContext:new _t({editGeometryOperations:n,elevationInfo:e,pointer:o,excludeFeature:this.object.graphic,visualizer:new R}),updatingHandles:this._updatingHandles,useZ:!1});a=a.next((e=>(this._onDragCancel(!t.metadata.deleting,(()=>s=h(s))),e))).next(r),i.next((t=>this._trackNumDragging(t))).next((t=>{if("start"===t.action&&this._operations&&(s=this._operations.createUndoGroup()),"edge"===d.type){const e=this._splitEdgeManipulator(d);return{...t,info:e,snapOrigin:e.handle.pos}}return{...t,info:d,snapOrigin:d.handle.pos}})).next(ut(this.view,t.elevationAlignedLocation)).next(F(this.view,t.elevationAlignedLocation,this.object.elevationInfo,t.location.spatialReference,this.object.graphic)).next(pt(this.view,e,this.object.graphic??void 0)).next(...l).next(ht()).next((e=>{this._perVertexManipulatorDragAction(e),"end"===e.action&&(s=h(s)),this._updateTranslateVertexTooltip(t,J.XY,e)}))}));return this._manipulatorHandles.add([u,p.events.on("immediate-click",(t=>this._manipulatorClickCallback(t,d))),p.events.on("select-changed",(()=>{d.selectedIndex=++this._selectedIndex,this._updateMoveManipulationPosition()})),p.events.on("focus-changed",(({action:t})=>{"focus"===t&&"edge"!==d.type?this._updateTranslateVertexTooltip(p,J.XY):this._hideTooltip()}))],p),this.events.emit("manipulators-changed"),d}_trackNumDragging(t){switch(t.action){case"start":this._numDragging++;break;case"end":this._numDragging--}return t}_onDragCancel(t=!0,e){switch(this._numDragging--,t&&this.undo(),null!=this.tool.snappingManager&&this.tool.snappingManager.doneSnapping(),this._hideTooltip(),this._reshapeEventState){case zt.NONE:break;case zt.MOVING:this.events.emit("move",{type:"move",dx:0,dy:0,object:this.object});break;case zt.RESHAPING:this.events.emit("reshape",{type:"reshape",object:this.object})}e&&e(),this.destroyed||this._updateEventState(zt.NONE)}_setTypeSpecificManipulatorSettings(t,e,i){const a=this._settings;switch(e.type){case"vertex":{t.state=Zt.Vertex,t.selectable=!0,t.cursor="move",t.collisionPriority=2;const{size:e,collisionPadding:n}=a.manipulators.vertex;t.radius=e/2+n,t.elevationInfo=i;const o=this._operations?.data.type;t.interactive=null!=o&&"point"!==o&&"mesh"!==o;break}case"edge":{t.state=Zt.Edge,t.selectable=!1,t.cursor="copy",t.collisionPriority=-1;const{size:e,collisionPadding:n}=a.manipulators.edge;t.radius=e/2+n,t.elevationInfo="on-the-ground"!==i.mode||G(this.object.graphic?.symbol)?{mode:"absolute-height",offset:0}:i;break}}}_watchAndUpdateGrabState(t,e){return t.events.on("grab-changed",(i=>this._onGrabStateChanged(t,e,i.action,i.pointerType)))}_onGrabStateChanged(t,e,i,a="mouse"){if(!this._recreatingManipulators){if("start"===i)e&&this._updateSelection(t),this._numGrabbing++;else if(this._numGrabbing--,this._updateEventState(zt.NONE),this.destroyed)return;this._moveManipulation.interactive=!this._numGrabbing,("touch"!==a||this.enableEdgeOffset)&&(this._manipulatorInfos.forEach((t=>{const{manipulator:e}=t,i=this._operations?.data.type;e.interactive=e.grabbing||!this._numGrabbing&&null!=i&&"point"!==i&&"mesh"!==i,"edgeManipulator"in t&&(t.edgeManipulator.interactive=t.edgeManipulator.grabbing||!this._numGrabbing)})),this._objectMoveManipulation.forEachManipulator((t=>{t.interactive=t.grabbing||!this._numGrabbing})))}}_clearSelection(){for(const t of this._manipulatorInfos)t.manipulator.grabbing||(t.manipulator.selected=!1)}_updateSelection(t){t.grabbing&&!t.selected&&t.selectable&&(this._clearSelection(),t.selected=!0,this.events.emit("manipulators-changed"))}_removeManipulator(t){null!=t&&(t.manipulator.metadata.deleting=!0,this.manipulators.remove(t.manipulator),this._manipulatorHandles.remove(t.manipulator),i(this._manipulatorInfos,t),this.events.emit("manipulators-changed"))}_getManipulatorInfoFromHandle(t){if(t)for(const e of this._manipulatorInfos)if(t===e.handle)return e;return null}_updateManipulatorPositions(t){for(const e of t)this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e))}_updateManipulatorPosition(t){const e=this._operations;if(null!=t&&e)if("vertex"===t.type)t.manipulator.location=e.data.coordinateHelper.vectorToDehydratedPoint(t.handle.pos,Rt),t.manipulator.grabbing&&null!=this._vertexLaserLineVisualElement&&(this._vertexLaserLineVisualElement.visualElement.intersectsWorldUpAtLocation=t.manipulator.renderLocation);else if("edge"===t.type){const i=this._getManipulatorInfoFromHandle(t.handle.leftVertex),a=this._getManipulatorInfoFromHandle(t.handle.rightVertex);if(null==i||null==a)return;const n=i.manipulator,o=a.manipulator;if(null!=t.manipulator.elevationInfo&&"on-the-ground"===t.manipulator.elevationInfo.mode){const i=n.location,a=o.location,s=.5,l=i.x+s*(a.x-i.x),r=i.y+s*(a.y-i.y),p=i.hasZ&&a.hasZ?0:void 0;t.manipulator.location=L(l,r,p,e.data.spatialReference)}else y(Ft,n.renderLocation,o.renderLocation,.5),t.manipulator.renderLocation=Ft}}_splitEdgeManipulator(t,e=.5){const i=this._operations,a=i.splitEdge(t.handle,e).createdVertex;t.locationUpdateHandle=h(t.locationUpdateHandle);const n=this.object.elevationInfo;let o;this.enableEdgeOffset?(this._removeManipulator(t),o=this._createVertexOrEdgeManipulator(a)):(o=t,o.handle=a,o.type="vertex",this._setTypeSpecificManipulatorSettings(t.manipulator,t.handle,n)),a.leftEdge&&this._createVertexOrEdgeManipulator(a.leftEdge),a.rightEdge&&this._createVertexOrEdgeManipulator(a.rightEdge),this._updateManipulatorPosition(o),this.enableEdgeOffset||this._updateTranslateVertexTooltip(o.manipulator,J.XY),this._updateSelection(t.manipulator);const s=this._updateEventState(zt.RESHAPING),l=i.data.coordinateHelper.vectorToArray(o.handle.pos),r=i.data.components.indexOf(a.component);return this.events.emit("vertex-add",{type:"vertex-add",object:this.object,vertices:[{coordinates:l,componentIndex:r,vertexIndex:a.index}],added:l}),s&&this._updateEventState(zt.NONE),o}_updateMoveManipulationPosition(){const t=E(Ft,0,0,0);let e=0,i=!1,a=null,n=null;for(const l of this._manipulatorInfos)"vertex"===l.type&&(l.manipulator.selected?(e++,j(t,t,l.manipulator.renderLocation),null==a||l.selectedIndex>a.selectedIndex?(n=a,a=l):(null==n||l.selectedIndex>n.selectedIndex)&&(n=l)):i=!0);const o=this.object,s=this._operations?.data.geometry;if(0===e){const t=o.visible&&this.enableMoveObject;this._moveManipulation.xyManipulation.available=t,this._moveManipulation.xyAxisManipulation.available=t,this._moveManipulation.xyAxisManipulation.orthogonalAvailable=t,this._moveManipulation.zManipulation.available=t&&this.enableZShape&&q(this._operations,o.elevationInfo),this._moveManipulation.angle=z(s),this._moveManipulation.radius=Q.radiusForSymbol(o.graphic?.symbol)}else{const t=o.visible;this._moveManipulation.xyManipulation.available=t,this._moveManipulation.xyAxisManipulation.available=t,this._moveManipulation.zManipulation.available=t&&this.enableZVertex&&q(this._operations,this.object.elevationInfo),this._moveManipulation.xyAxisManipulation.orthogonalAvailable=t&&1!==e;let i=0;if(null!=a){const t=a.handle.pos,e=null!=n?n.handle.pos:a.handle.leftEdge&&a.handle.leftEdge.leftVertex?a.handle.leftEdge.leftVertex.pos:null,o=null==n&&a.handle.rightEdge&&a.handle.rightEdge.rightVertex?a.handle.rightEdge.rightVertex.pos:null;e&&o?this._moveManipulation.xyAxisManipulation.available=!1:e?i=Nt(e,t):o&&(i=Nt(t,o))}this._moveManipulation.angle=i,this._moveManipulation.radius=B}0!==e&&i?(I(t,t,1/e),Rt.spatialReference=this._operations.data.spatialReference,Rt.hasZ=!0,this.view.renderCoordsHelper.fromRenderCoords(t,Rt),this._moveManipulation.elevationAlignedLocation=Rt):null==this._outlineVisualElement||this.object.isDraped||null==this._outlineVisualElement.attachmentOrigin?U(this._moveManipulation,this.object):this._moveManipulation.elevationAlignedLocation=this._outlineVisualElement.attachmentOrigin}_removeVertices(t){const e=new Array,i=this._operations;if(i){for(const a of t){const t=a.handle.component;if("vertex"===a.type&&i.canRemoveVertex(t)){e.push(a.handle),this._removeManipulator(a),this._removeManipulator(this._getManipulatorInfoFromHandle(a.handle.leftEdge)),this._removeManipulator(this._getManipulatorInfoFromHandle(a.handle.rightEdge));const n=i.removeVertices([a.handle]),o=n.removedVertices?.[0].createdEdge;o?this._createVertexOrEdgeManipulator(o):this.enableEdgeOffset&&t.vertices.length<=2&&this._removeManipulator(this._getManipulatorInfoFromHandle(t.edges[0]))}}if(e.length>0){const t=e.map((t=>{const e=i.data.components.indexOf(t.component);return{coordinates:i.data.coordinateHelper.vectorToArray(t.pos),componentIndex:e,vertexIndex:t.index}})),a=this._updateEventState(zt.RESHAPING);if(this.destroyed)return;if(this.events.emit("vertex-remove",{type:"vertex-remove",object:this.object,removed:t.map((t=>t.coordinates)),vertices:t}),this.destroyed)return;if(a&&(this._updateEventState(zt.NONE),this.destroyed))return;this._updateMoveManipulationPosition()}}}_moveVertices(t,e,i=("start"===e.action?gt.NEW_STEP:gt.ACCUMULATE_STEPS)){const a=this._operations;if(a){t.length>0&&a.moveVertices(t.map((t=>t.handle)),e.mapDeltaX,e.mapDeltaY,e.mapDeltaZ,i);for(const e of t)this._updateManipulatorPosition(e)}}_offsetEdge(t,e){if(null==e.operation||null==e.signedDistance)return;const i=this._operations;if(!i)return;const a=e.operation.clone();a.distance=e.signedDistance,i.updateVertices([t.handle.leftVertex,t.handle.rightVertex],a),this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(t.handle.leftVertex)),this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(t.handle.rightVertex))}_manipulatorClickCallback(t,e){t.shiftKey||this._clearSelection(),"vertex"===e.type&&(e.manipulator.selected=!e.manipulator.selected,t.button===rt.Right&&this._removeVertices([e])),"edge"===e.type&&t.button===rt.Left&&this._splitEdgeManipulator(e),t.stopPropagation()}_updateTranslateTooltip(t,e){const i=this._manipulatorInfos.filter((t=>"vertex"===t.type&&t.manipulator.selected));1===i.length?this._updateTranslateVertexTooltip(i[0].manipulator,t,e):this._updateTranslateObjectTooltip(t,e)}_updateTranslateObjectTooltip(t,e){const{sketchOptions:i,tooltip:a}=this;switch(t){case J.XY:this._latestTooltipInfo=this._translateTooltipInfo??=new yt({sketchOptions:i}),Pt(this._latestTooltipInfo,e,((t,e)=>Ht(t,e)));break;case J.XY_AXIS:this._latestTooltipInfo=this._translateXYTooltipInfo??=new Ot({sketchOptions:i}),Pt(this._latestTooltipInfo,e,((t,i)=>c(Ht(t,i),$(e))));break;case J.Z:this._latestTooltipInfo=this._translateZTooltipInfo??=new xt({sketchOptions:i}),Pt(this._latestTooltipInfo,e,At)}this._latestTooltipInfo.sketchOptions=i,a.info=i.tooltips.effectiveEnabled?this._latestTooltipInfo:null}_updateTranslateVertexTooltip(t,e,i){const{sketchOptions:a,tooltip:n}=this;switch(e){case J.XY:this._latestTooltipInfo=this._translateVertexTooltipInfo??=new It({sketchOptions:a}),Pt(this._latestTooltipInfo,i,((t,e)=>Ht(t,e))),this._updateTooltipAreaOrTotalLength(this._latestTooltipInfo);break;case J.XY_AXIS:this._latestTooltipInfo=this._translateVertexXYTooltipInfo??=new jt({sketchOptions:a}),Pt(this._latestTooltipInfo,i,((t,e)=>c(Ht(t,e),$(i)))),this._updateTooltipAreaOrTotalLength(this._latestTooltipInfo);break;case J.Z:this._latestTooltipInfo=this._translateVertexZTooltipInfo??=new Et({sketchOptions:a}),Pt(this._latestTooltipInfo,i,At)}const o=Vt(t.location);this._latestTooltipInfo.elevation=null!=o?Tt({actual:o}):null,this._latestTooltipInfo.sketchOptions=a,n.info=a.tooltips.effectiveEnabled?this._latestTooltipInfo:null}_updateTooltipAreaOrTotalLength(t){const e=this._operations?.data.geometry;if(null==e)return t.area=null,void(t.totalLength=null);t.area="polygon"===e.type?St(e):null,t.totalLength="polyline"===e.type?wt(e):null}_hideTooltip(){this.tooltip.clear(),this._latestTooltipInfo=null}get test(){return{segmentLabels:this._segmentLabels,manipulatorInfos:this._manipulatorInfos}}};function Pt(t,e,i){if(null!=e&&"end"!==e.action){const{mapStart:a,mapEnd:n}=e,o=i(a,n);t.distance=null!=o?o:d}else t.distance=d}function kt(){return t=>{const{operation:e,mapEnd:i}=t;return null==e||null==i?t:("start"===t.action&&e.selectArrowFromStartPoint(i),{...t,signedDistance:e.signedDistanceToPoint(i)})}}function Ut(t){const e=t.size/2,i=e+t.collisionPadding;return{size:e/i,outlineSize:(e+t.outlineSize)/i}}function Nt(t,e){return Math.atan2(e[1]-t[1],e[0]-t[0])+Math.PI/2}function Ct(t,e,i,a,n){if(t){const t=n.toXYZ(n.pointToVector(i)),o=V(a,t,A.get()),s=Lt(o,t,n.spatialReference);if(null!=s)return u(s.value*Math.sign(e),s.unit)}return u(e*_(i.spatialReference),"meters")}t([v()],Dt.prototype,"_operations",null),t([v()],Dt.prototype,"_segmentLabels",void 0),t([v({constructOnly:!0})],Dt.prototype,"tool",void 0),t([v()],Dt.prototype,"tooltip",void 0),t([v({readOnly:!0})],Dt.prototype,"updating",null),t([v()],Dt.prototype,"manipulators",null),t([v()],Dt.prototype,"view",null),t([v()],Dt.prototype,"object",null),t([v()],Dt.prototype,"enableZShape",null),t([v()],Dt.prototype,"enableZVertex",null),t([v()],Dt.prototype,"enableMoveObject",null),t([v()],Dt.prototype,"enableMidpoints",null),t([v()],Dt.prototype,"enableEdgeOffset",null),t([v()],Dt.prototype,"sketchOptions",null),t([v()],Dt.prototype,"_accentColor",null),Dt=t([M("esri.views.3d.interactive.editingTools.reshape.ReshapeOperation")],Dt);const Rt=L(0,0,void 0,Gt.WGS84),Ft=S(),Xt=1e-6;var Zt,zt,Yt;!function(t){t.Vertex=mt.Custom1,t.Edge=mt.Custom2}(Zt||(Zt={})),function(t){t[t.NONE=0]="NONE",t[t.MOVING=1]="MOVING",t[t.RESHAPING=2]="RESHAPING"}(zt||(zt={})),function(t){t[t.ALL=0]="ALL",t[t.SELECTED_OR_ALL=1]="SELECTED_OR_ALL"}(Yt||(Yt={}));export{Dt as ReshapeOperation};
