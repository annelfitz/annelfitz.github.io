/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{ScreenSpaceGeometry as e}from"../effects/ScreenSpaceGeometry.js";import{AppleAmdDriverHelper as r}from"../../../webgl/AppleAmdDriverHelper.js";import{RenderingContext as s}from"../../../webgl/RenderingContext.js";class t extends s{constructor(r,s,t){super(r,s),this.gl=r,this.newCache=t,this._appleAmdDriverHelper=null,this._refCount=1,this.screen=new e(this)}destroy(){--this._refCount>0||this.dispose()}ref(){++this._refCount}dispose(){super.dispose(),this._appleAmdDriverHelper?.dispose(),this.screen.destroy()}bindTechnique(e,r,s,t,i){return this.useProgram(e.program),this.setPipelineState(e.getPipeline(!!i)),e.program.bindPass(s,r),t&&e.program.bindDraw(t,r,s),e.program}runAppleAmdDriverHelper(){this.driverTest.drawArraysRequiresIndicesTypeReset.result&&(this._appleAmdDriverHelper??=new r(this),this._appleAmdDriverHelper.run())}get test(){return{cachedWebGLObjects:this.programCache.test.cachedWebGLProgramObjects+this.screen.test.cachedWebGLObjects+(this._appleAmdDriverHelper?.test.cachedWebGLObjects??0)}}}export{t as RenderingContext};
