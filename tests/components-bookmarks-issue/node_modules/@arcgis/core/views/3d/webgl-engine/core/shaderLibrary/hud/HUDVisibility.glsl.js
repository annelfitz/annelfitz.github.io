/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{AlignPixel as e}from"./AlignPixel.glsl.js";import{HUDRenderStyle as r}from"./HUDRenderStyle.js";import{Float4PassUniform as o}from"../../shaderModules/Float4PassUniform.js";import{FloatPassUniform as i}from"../../shaderModules/FloatPassUniform.js";import{glsl as l}from"../../shaderModules/interfaces.js";import{Texture2DPassUniform as s}from"../../shaderModules/Texture2DPassUniform.js";function t(t){t.vertex.uniforms.add(new i("renderTransparentlyOccludedHUD",((e,o)=>o.hudRenderStyle===r.Occluded?1:o.hudRenderStyle===r.NotOccluded?0:.75)),new o("viewport",((e,r)=>r.camera.fullViewport)),new s("hudVisibilityTexture",((e,r)=>r.hudVisibility?.getTexture()))),t.vertex.include(e),t.vertex.code.add(l`bool testHUDVisibility(vec4 posProj) {
vec4 posProjCenter = alignToPixelCenter(posProj, viewport.zw);
vec4 occlusionPixel = texture(hudVisibilityTexture, .5 + .5 * posProjCenter.xy / posProjCenter.w);
if (renderTransparentlyOccludedHUD > 0.5) {
return occlusionPixel.r * occlusionPixel.g > 0.0 && occlusionPixel.g * renderTransparentlyOccludedHUD < 1.0;
}
return occlusionPixel.r * occlusionPixel.g > 0.0 && occlusionPixel.g == 1.0;
}`)}export{t as HUDVisibility};
