/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{Milliseconds as t,millisecondsFromSeconds as i}from"../../../../core/time.js";import{f as e,l as r,c as n}from"../../../../chunks/vec32.js";import{create as m}from"../../../../core/libs/gl-matrix-2/factories/vec3f64.js";import{Camera as s}from"./Camera.js";import a from"../../webgl/RenderCamera.js";import{Animation as o}from"../../../animation/pointToPoint/Animation.js";class c{get finished(){return this.currentTime>=this._animation.time}get time(){return this._animation.time}constructor(i){this.currentTime=t(0),this._animation=new o((()=>new s(i))),this._current=new s(i)}update(i,m,s){const{source:a,target:o}=this._animation.definition,c=e(h,m.center,i.center),u=r(c);u>=1e-5?(c[0]/=u,c[1]/=u,c[2]/=u):(c[0]=0,c[1]=1,c[0]=0),n(a.direction,c),n(o.direction,c),a.copyFromRenderCamera(i),o.copyFromRenderCamera(m),this._current.copyFrom(a),this._animation.update(a,o,s),this.currentTime=t(0),i.almostEquals(m)&&(this.currentTime=this._animation.time)}cameraAt(t,i){return this._animation.cameraAt(t,this._current),i=i||new a,this._current.copyToRenderCamera(i),i}step(e,r){return this.finished||(this.currentTime=t(this.currentTime+i(e)),this.currentTime>=this.time&&(this.currentTime=this.time)),this.cameraAt(this.currentTime/this.time,r)}}const h=m();export{c as Animation};
