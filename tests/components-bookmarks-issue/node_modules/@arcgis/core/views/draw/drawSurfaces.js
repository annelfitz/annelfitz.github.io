/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import"../../geometry.js";import{createScreenPointArray as e,createScreenPoint as t}from"../../core/screenUtils.js";import{makeDehydratedPoint as r}from"../../layers/graphics/dehydratedPoint.js";import{clonePoint as s}from"../../layers/graphics/hydratedFeatures.js";import{getConvertedElevation as n,getZForElevationMode as i}from"../../support/elevationInfoUtils.js";import o from"../../geometry/SpatialReference.js";import a from"../../geometry/Point.js";class c{constructor(e,t,r,s=null){this._elevationInfo=e,this.defaultZ=t,this._view=r,this._excludeGraphics=s}screenToMap(t){const{defaultZ:r,_view:s}=this,n=s.sceneIntersectionHelper.intersectElevationFromScreen(e(t.x,t.y),this._elevationInfo,r??0,this._excludeGraphics);return null==r&&null!=n&&(n.z=void 0),n}mapToScreen(e){const t=r(e.x,e.y,n(this._view,e,this._elevationInfo),e.spatialReference);return this._view.toScreen(t)}constrainZ(e){const{defaultZ:t}=this;return null!=t&&e.z!==t&&((e=s(e)).z=t),e}}class l{constructor(e,t,r=[]){this.view=e,this.elevationInfo=t,this.exclude=r}screenToMap(e){const t=this.view.toMap(e,{exclude:this.exclude,excludeHud:!0});return null!=t&&(t.z=i(t,this.view,this.elevationInfo)),t}mapToScreen(e){let t=e;return null!=this.elevationInfo&&(t=r(e.x,e.y,n(this.view,e,this.elevationInfo),e.spatialReference)),this.view.toScreen(t)}constrainZ(e){return e}}class h{constructor(e,t=!1,r=0){this.view=e,this.hasZ=t,this.defaultZ=r,this.mapToScreen=t=>e.toScreen(t),this.screenToMap=t?t=>{const s=e.toMap(t);return s.z=r,s}:t=>e.toMap(t)}constrainZ(e){const{defaultZ:t}=this;return this.hasZ&&e.z!==t&&((e=s(e)).z=t),e}}class u{screenToMap(e){const{x:t,y:r}=e;return new a({x:t,y:r,spatialReference:u.spatialReference})}mapToScreen(e){return t(e.x,e.y)}constrainZ(e){return e}}u.spatialReference=new o;export{c as ElevationDrawSurface,h as MapDrawSurface,l as SceneDrawSurface,u as ScreenDrawSurface};
