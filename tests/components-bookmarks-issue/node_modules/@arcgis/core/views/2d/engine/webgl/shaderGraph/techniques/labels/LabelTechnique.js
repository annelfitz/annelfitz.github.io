/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{WGLDrawPhase as e,FeatureSymbologyDrawOrder as s}from"../../../enums.js";import{getSelectionDefines as t,getFeaturePipelineState as r,resolveDynamicUniforms as i,getFeatureUniforms as a}from"../featureTechniqueUtils.js";import{Technique as o}from"../Technique.js";import{meshWriterRegistry as n}from"../mesh/MeshWriterRegistry.js";import{TextShader as m}from"../text/TextShader.js";class u extends o{constructor(){super(...arguments),this.meshWriter=n.LabelMeshWriter,this.shaders={geometry:new m},this.drawPhase=e.LABEL|e.LABEL_ALPHA,this.symbologyPlane=s.TEXT}render(e,s){const{context:o,painter:n}=e,m=t(e),u={...r(e)},h={shader:this.shaders.geometry,uniforms:{...i(e,s.target,s.instance.getInput().geometry),...a(e,s.target),mosaicInfo:n.textureManager.getMosaicInfo(o,s.textureKey)},defines:{...m,isHaloPass:!1,isBackgroundPass:!0,isLabel:!0},optionalAttributes:s.instance.optionalAttributes,useComputeBuffer:!1};n.setShader(h),n.setPipelineState(u),n.submitDraw(o,s),n.setShader({...h,defines:{...m,isHaloPass:!0,isBackgroundPass:!1,isLabel:!0}}),n.setPipelineState(u),n.submitDraw(o,s),n.setShader({...h,defines:{...m,isHaloPass:!1,isBackgroundPass:!1,isLabel:!0}}),n.setPipelineState(u),n.submitDraw(o,s)}}export{u as LabelTechnique};
