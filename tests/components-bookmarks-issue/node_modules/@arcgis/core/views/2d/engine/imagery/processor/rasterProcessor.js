/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import r from"./aspectProcessor.js";import e from"./bandArithmeticProcessor.js";import t from"./compositeBandProcessor.js";import o from"./contrastProcessor.js";import s from"./convolutionProcessor.js";import n from"./curvatureProcessor.js";import c from"./extractBandProcessor.js";import i from"./focalStatisticsProcessor.js";import a from"./grayscaleProcessor.js";import m from"./localProcessor.js";import p from"./maskProcessor.js";import u from"./ndviProcessor.js";import f from"./remapProcessor.js";import l from"./reprojectProcessor.js";import j from"./slopeProcessor.js";import d from"./stretchProcessor.js";import{SizedPixelFormat as P,TextureSamplingMode as h,PixelType as w,TextureWrapMode as g}from"../../../../webgl/enums.js";import{Texture as x}from"../../../../webgl/Texture.js";import{TextureDescriptor as T}from"../../../../webgl/TextureDescriptor.js";const b=new Map;function v(r,e){const t=new T;return t.width=r,t.height=e,t.internalFormat=P.RGBA32F,t.samplingMode=h.NEAREST,t.dataType=w.FLOAT,t.isImmutable=!0,t.wrapMode=g.CLAMP_TO_EDGE,t}function A(r,e,t,o){const{context:s,requestRender:n,allowDelayedRender:c}=r,i=o.createProgram(r,t);return c&&null!=n&&!i.compiled?(n(),null):(s.bindFramebuffer(e),s.setViewport(0,0,e.width,e.height),s.useProgram(i),i)}function F(r){return b.get(r.toLowerCase())}function y(r,e,t,o){const s=r.rasterFunction.name.toLowerCase(),n="reproject"===s?l:F(s);if(null==n)return;const c=A(r,t,o,n);if(!c)return;n.bindTextureAndUniforms(r,c,o);const{interpolation:i}=o;"reproject"===s&&(o.interpolation="nearest"),e.draw();const[a,m]=o.getRasterTextureSize("reproject"===s),p=v(a,m),u=new x(r.context,p);if(t.copyToTexture(0,0,a,m,0,0,u),"reproject"===s)o.rasterTexture=u,o.projected=!0,o.interpolation=i;else{const e=r.hasBranches?r.rasterFunction.id:0;o.functionTextures[e]=u}}b.set("arithmetic",m),b.set("aspect",r),b.set("bandarithmetic",e),b.set("compositeband",t),b.set("convolution",s),b.set("contrastbrightness",o),b.set("curvature",n),b.set("extractband",c),b.set("statistics",i),b.set("grayscale",a),b.set("local",m),b.set("mask",p),b.set("ndvi",u),b.set("remap",f),b.set("slope",j),b.set("stretch",d);export{v as createTextureDescriptor,y as process};
