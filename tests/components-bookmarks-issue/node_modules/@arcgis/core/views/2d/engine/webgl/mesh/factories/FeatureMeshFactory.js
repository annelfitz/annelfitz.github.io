/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{AMeshFactory as e}from"./MeshFactory.js";import{createMatcher as t}from"../../util/createMatcher.js";class s extends e{static async create(e,o,r,c){const i=await t(e,o,r.symbology,c),a=r.labels?await t(e,o,r.labels,c):null;return new s(i,a)}constructor(e,t){super(),this._symbology=e,this._labels=t}destroy(){}async enqueueMatcherRequests(e,t){await Promise.all([this._symbology.fetchResources(e,t),this._labels?.fetchResources(e,t)])}enqueueWriterRequests(e,t,s){const o=this._symbology.match(t,s);if(o){for(const r of o)r.enqueueRequest(e,t,s);if(this._labels){const o=this._labels.match(t,s);if(!o)return;for(const r of o)r.enqueueRequest(e,t,s)}}}write(e,t,s,o,r){const c=this._symbology.match(s,o);if(!c)return;for(const i of c)i.write(e,t,s,o,r);if(e.entityRecordCount()>=1&&this._labels){const i=this._labels.match(s,o);if(!i)return;for(const a of i)a.setReferences(c),a.write(e,t,s,o,r)}}getSortKey(e,t){return this._symbology.getSortKey(e,t)}}export{s as FeatureMeshFactory};
