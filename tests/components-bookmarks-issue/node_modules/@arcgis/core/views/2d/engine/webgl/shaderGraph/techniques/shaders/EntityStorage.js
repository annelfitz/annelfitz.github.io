/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{_ as t}from"../../../../../../../chunks/tslib.es6.js";import has from"../../../../../../../core/has.js";import{UniformGroup as a,uniform as e}from"../../GraphShaderModule.js";import{texture2D as i,int as r,float as s,mod as o,Vec2 as u,ceil as g,Sampler2D as l,Float as n}from"../../graph/glsl.js";import{unpackDisplayIdTexel as D}from"./utils.js";class p extends a{getVisualVariableData(t){if(!this._vvData){const a=this.getAttributeDataCoords(t);this._vvData=i(this.visualVariableData,a).setDebugName("storage2")}return this._vvData}getAttributeDataCoords(t){if(!this._uv){const a=D(t),e=this.size,i=r(a.x),g=r(a.y).multiply(r(256)),l=r(a.z).multiply(r(256)).multiply(r(256)),n=s(i.add(g).add(l)),p=o(n,e),d=n.subtract(p).divide(e);this._uv=new u(p,d).add(.5).divide(e)}return this._uv}getFilterData(t){const a=this.getAttributeDataCoords(t);return i(this.filterFlags,a).setDebugName("storage0")}getAnimationData(t){const a=this.getAttributeDataCoords(t);return i(this.animation,a).setDebugName("storage1")}getVVData(t){return this.getVisualVariableData(t)}getDataDrivenData0(t){const a=this.getAttributeDataCoords(t);return i(this.dataDriven0,a).setDebugName("storage30")}getDataDrivenData1(t){const a=this.getAttributeDataCoords(t);return i(this.dataDriven1,a).setDebugName("storage31")}getDataDrivenData2(t){const a=this.getAttributeDataCoords(t);return i(this.dataDriven2,a).setDebugName("storage32")}getGPGPUData(t){const a=this.getAttributeDataCoords(t);return i(this.gpgpu,a).setDebugName("storage4")}getFilterFlags(t){return has("webgl-ignores-sampler-precision")?g(this.getFilterData(t).x.multiply(s(255))):this.getFilterData(t).x.multiply(s(255))}getAnimationValue(t){return this.getAnimationData(t).x}getSizeValue(t){return this.getVisualVariableData(t).x}getColorValue(t){return this.getVisualVariableData(t).y}getOpacityValue(t){return this.getVisualVariableData(t).z}getRotationValue(t){return this.getVisualVariableData(t).w}}t([e(l)],p.prototype,"filterFlags",void 0),t([e(l)],p.prototype,"animation",void 0),t([e(l)],p.prototype,"gpgpu",void 0),t([e(l)],p.prototype,"visualVariableData",void 0),t([e(l)],p.prototype,"dataDriven0",void 0),t([e(l)],p.prototype,"dataDriven1",void 0),t([e(l)],p.prototype,"dataDriven2",void 0),t([e(n)],p.prototype,"size",void 0);export{p as EntityStorage};
