/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{pt2px as e}from"../../../../core/screenUtils.js";import n from"../../../../geometry/Polygon.js";import{create as t}from"../../../../geometry/support/aaBoundingRect.js";import{getInfo as i}from"../../../../geometry/support/spatialReferenceUtils.js";import{glyphSize as r,magicLabelLineHeight as o}from"../../engine/webgl/definitions.js";import{shapeGlyphs as s}from"../../engine/webgl/mesh/templates/shapingUtils.js";const l=512,a=50;function m(e,n){const r=i(n);if(!r)return null;const[o,s]=r.valid;return e[2]>s?[t([e[0],e[1],s,e[3]]),t([o,e[1],o+e[2]-s,e[3]])]:e[0]<o?[t([o,e[1],e[2],e[3]]),t([s-(o-e[0]),e[1],s,e[3]])]:null}function f(e){return"text"===e||"esriTS"===e}function g(e){return"simple-marker"===e||"picture-marker"===e||"esriSMS"===e||"esriPMS"===e}function c(n,t,i){if(!i.glyphs.length)return n;const l=s(i,{scale:e(t.font.size)/r,angle:t.angle??0,xOffset:t.xoffset??0,yOffset:t.yoffset??0,horizontalAlignment:t.horizontalAlignment??"center",verticalAlignment:t.verticalAlignment??"baseline",maxLineWidth:Math.max(32,Math.min(t.lineWidth||512,512)),lineHeight:o*Math.max(.25,Math.min(t.lineHeight||1,4)),decoration:t.font.decoration||"none",useCIMAngleBehavior:!1,hasBackground:!!t.backgroundColor,borderLineSizePx:e(t.borderLineSize)}).bounds;return n[0]=e(l.x-l.halfWidth),n[1]=e(l.y-l.halfHeight),n[2]=e(l.width),n[3]=e(l.height),n}function u(e){if(!e)return null;const{xmin:t,ymin:i,xmax:r,ymax:o,spatialReference:s}=e;return new n({rings:[[[t,i],[t,o],[r,o],[r,i],[t,i]]],spatialReference:s})}export{c as getTextSymbolSize,m as intersectingInternationalDateline,g as isMarkerSymbol,f as isTextSymbol,a as pixelBuffer,u as polygonFromExtent,l as tileSize};
