/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import"../intl.js";import{property as e}from"../core/accessorSupport/decorators/property.js";import"../core/has.js";import"../core/Logger.js";import"../core/RandomLCG.js";import{subclass as s}from"../core/accessorSupport/decorators/subclass.js";import o from"../widgets/Widget.js";import{loadCalciteComponents as i}from"../widgets/support/componentsUtils.js";import"../widgets/support/widgetUtils.js";import{messageBundle as n}from"../widgets/support/decorators/messageBundle.js";import{tsx as r}from"../widgets/support/jsxFactory.js";import{getCalciteThemeClass as l}from"../support/themeUtils.js";import{substitute as a}from"../intl/substitute.js";const c="esri-identity-modal",p={base:c,info:`${c}__info`,notice:`${c}__notice`},d="ArcGIS Online";let u=class extends o{constructor(t,e){super(t,e),this.container=document.createElement("div"),this.error=null,this.oAuthPrompt=!1,this.open=!1,this.signingIn=!1,this.server=null,this.resource=null,this._usernameInputNode=null,this._passwordInputNode=null,document.body.appendChild(this.container)}loadDependencies(){return i({button:()=>import("@esri/calcite-components/dist/components/calcite-button.js"),input:()=>import("@esri/calcite-components/dist/components/calcite-input.js"),label:()=>import("@esri/calcite-components/dist/components/calcite-label.js"),modal:()=>import("@esri/calcite-components/dist/components/calcite-modal.js"),notice:()=>import("@esri/calcite-components/dist/components/calcite-notice.js")})}get title(){return this.commonMessages?.auth.signIn}render(){const{open:t,title:e,messages:s,signingIn:o,oAuthPrompt:i,server:n,resource:c,error:u}=this,{info:m,oAuthInfo:h,lblItem:g,invalidUser:b,noAuthService:v,lblUser:y,lblPwd:f,lblCancel:_,lblSigning:I,lblOk:j}=s;return r("div",{class:this.classes(p.base,l())},r("form",{bind:this,onsubmit:this._submit},r("calcite-modal",{bind:this,open:t,outsideCloseDisabled:!0,scale:"s",widthScale:"s",onCalciteModalClose:this._cancel,onCalciteModalOpen:this._focusUsernameInput},r("div",{slot:"header"},e),r("div",{slot:"content"},r("div",{class:p.info},a(i?h:m,{server:n&&/\.arcgis\.com/i.test(n)?d:n,resource:`(${c||g})`})),u?r("calcite-notice",{class:p.notice,icon:"exclamation-mark-triangle",kind:"danger",open:!0},r("div",{slot:"message"},u.details?.httpStatus?b:v)):null,i?null:[r("calcite-label",null,y,r("calcite-input",{afterCreate:t=>this._usernameInputNode=t,autocomplete:"off",bind:this,name:"username",required:!0,spellcheck:!1,type:"text",value:""})),r("calcite-label",null,f,r("calcite-input",{afterCreate:t=>this._passwordInputNode=t,bind:this,name:"password",required:!0,type:"password",value:""}))]),r("calcite-button",{appearance:"outline",bind:this,onclick:this._cancel,slot:"secondary",type:"button",width:"full"},_),r("calcite-button",{loading:!!o,slot:"primary",type:"submit",width:"full"},o?I:j))))}_focusUsernameInput(){requestAnimationFrame((()=>{this._usernameInputNode?.setFocus()}))}_cancel(){this._set("signingIn",!1),this.open=!1,this._usernameInputNode&&(this._usernameInputNode.value=""),this._passwordInputNode&&(this._passwordInputNode.value=""),this.emit("cancel")}_submit(t){t.preventDefault(),this._set("signingIn",!0);const e=this.oAuthPrompt?{}:{username:this._usernameInputNode?.value,password:this._passwordInputNode?.value};this.emit("submit",e)}};t([e({readOnly:!0})],u.prototype,"container",void 0),t([e(),n("esri/t9n/common")],u.prototype,"commonMessages",void 0),t([e()],u.prototype,"error",void 0),t([e(),n("esri/identity/t9n/identity")],u.prototype,"messages",void 0),t([e()],u.prototype,"oAuthPrompt",void 0),t([e()],u.prototype,"open",void 0),t([e()],u.prototype,"signingIn",void 0),t([e()],u.prototype,"server",void 0),t([e({readOnly:!0})],u.prototype,"title",null),t([e()],u.prototype,"resource",void 0),u=t([s("esri.identity.IdentityModal")],u);const m=u;export{m as default};
