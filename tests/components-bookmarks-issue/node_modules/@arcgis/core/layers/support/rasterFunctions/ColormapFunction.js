/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{_ as o}from"../../../chunks/tslib.es6.js";import{property as r}from"../../../core/accessorSupport/decorators/property.js";import"../../../core/has.js";import"../../../core/Logger.js";import"../../../core/RandomLCG.js";import{subclass as t}from"../../../core/accessorSupport/decorators/subclass.js";import{isIntegerPixelType as s}from"../rasterFormats/pixelRangeUtils.js";import e from"./BaseRasterFunction.js";import p from"./ColormapFunctionArguments.js";import{getColormapByName as i}from"./colormaps.js";import{convertColorRampToColormap as n,getColorRampJSON as c}from"../../../renderers/support/colorRampUtils.js";let a=class extends e{constructor(){super(...arguments),this.functionName="Colormap",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isNoopProcess=!0}_bindSourceRasters(){const o=this.sourceRasterInfos[0];if(o.bandCount>1)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};let{colormap:r,colormapName:t,colorRamp:s,colorRampName:e}=this.functionArguments;if(!r?.length)if(s)r=n(s,{interpolateAlpha:!0});else if(e){const o=c(e);o&&(r=n(o))}else t&&(r=i(t));if(!r?.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};const p=this._getOutputPixelType(o.pixelType);this.outputPixelType=p.startsWith("f")?"s32":p;const a=o.clone();return a.pixelType=this.outputPixelType,a.colormap=r,a.bandCount=1,this.rasterInfo=a,{success:!0,supportsGPU:!0}}_processPixels(o){let r=o.pixelBlocks?.[0];return!r||s(r.pixelType)||(r=r.clone(),r.clamp(this.outputPixelType)),r}};o([r({json:{write:!0,name:"rasterFunction"}})],a.prototype,"functionName",void 0),o([r({type:p,json:{write:!0,name:"rasterFunctionArguments"}})],a.prototype,"functionArguments",void 0),o([r()],a.prototype,"rasterArgumentNames",void 0),o([r()],a.prototype,"isNoopProcess",void 0),o([r({json:{write:!0}})],a.prototype,"indexedColormap",void 0),a=o([t("esri.layers.support.rasterFunctions.ColormapFunction")],a);const u=a;export{u as default};
