/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
const t=9999999e31,e=2e-7,n={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function s(t){return n[t]??[-34028234663852886e22,34028234663852886e22]}function u(t,e){return null==t||null==e?"s32":t<0?t>=-128&&e<128?"s8":t>=-32768&&e<32768?"s16":"s32":e<256?"u8":e<65536?"u16":"u32"}function i(t){return(t?.startsWith("s")||t?.startsWith("u"))??!1}function l(n,u,i){if(n.depthCount&&n.depthCount>1)return;const{pixels:l,statistics:a,pixelType:o}=n,r=l[0].length,c=n.bandMasks??[],f=n.mask??new Uint8Array(r).fill(255),b="f32"===o||"f64"===o,h=s(o);let m=!1;for(let s=0;s<l.length;s++){const n="number"==typeof u?u:u[s];if(null==n)continue;const r=a?.[s]?.minValue??h[0],d=a?.[s]?.maxValue??h[1];if(r>n+Number.EPSILON||d<n-Number.EPSILON)continue;const p=c[s]||f.slice(),M=l[s],N=i?.customFloatTolerance;if(b&&0!==N){let s=N;s||(s=Math.abs(n)>=t?e*Math.abs(n):"f32"===o?2**-23:Number.EPSILON);for(let t=0;t<M.length;t++)p[t]&&Math.abs(M[t]-n)<s&&(M[t]=0,p[t]=0,f[t]=0,m=!0)}else for(let t=0;t<M.length;t++)p[t]&&M[t]===n&&(M[t]=0,p[t]=0,f[t]=0,m=!0);c[s]=p}m&&(n.bandMasks=n.bandMasks||n.pixels.length>1?c:null,n.mask=f),m&&"updateStatistics"in n&&n.updateStatistics()}export{l as convertNoDataToMask,u as getIntegerPixelType,s as getPixelValueRange,i as isIntegerPixelType};
