/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import"../../geometry.js";import{nameToId as e,OriginId as t}from"../../core/accessorSupport/PropertyOrigin.js";import{getInfo as n}from"../../geometry/support/spatialReferenceUtils.js";import o from"./ControlPointsGeoreference.js";import i from"../../geometry/Extent.js";import r from"../../geometry/Point.js";const a=100,c=.5;async function s(e,t){e.loaded||await e.load();const{width:s,height:p}=e.content,{spatialReference:m}=t,l=n(m);let y=!1;if(l){const e=l.valid[1]-l.valid[0];t.width>e&&(t=new i({xmin:l.valid[0],ymin:t.ymin,xmax:l.valid[1],ymax:t.ymax,spatialReference:t.spatialReference}),y=!0)}const f=t.expand(c),{center:x,width:u,height:P}=f,d=y||s>p?u:s/p*P,h=y||s>p?p/s*u:P,w=x.x-d/2,g=x.x+d/2,R=x.y+h/2,j=x.y-h/2;return new o({controlPoints:[{sourcePoint:{x:a,y:p-a},mapPoint:new r({x:w,y:j,spatialReference:m})},{sourcePoint:{x:a,y:a},mapPoint:new r({x:w,y:R,spatialReference:m})},{sourcePoint:{x:s-a,y:a},mapPoint:new r({x:g,y:R,spatialReference:m})},{sourcePoint:{x:s-a,y:p-a},mapPoint:new r({x:g,y:j,spatialReference:m})}],width:s,height:p})}function p(e){const t=e.georeference;if("control-points"!==t.type)return null;const n={wkid:0},{width:i,height:a}=t,c=t.controlPoints;return new o({controlPoints:c.map((e=>{const{x:t,y:o}=e.sourcePoint;return{sourcePoint:{x:t,y:o},mapPoint:new r({x:t,y:a-o,spatialReference:n})}})),width:i,height:a})}function m(e){return"media"===e?.type}function l(n,o){const i=e(o);return m(n)&&!!n.portalItem&&null!=i&&i>t.PORTAL_ITEM}export{s as createDefaultControlPointsGeoreference,p as createLocalModeControlPointsGeoreference,l as isWritingLayerFromItemToWebDocument};
