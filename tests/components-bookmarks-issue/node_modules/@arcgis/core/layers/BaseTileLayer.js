/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import t from"../request.js";import r from"../core/Error.js";import{property as o}from"../core/accessorSupport/decorators/property.js";import"../core/has.js";import"../core/Logger.js";import"../core/RandomLCG.js";import{subclass as s}from"../core/accessorSupport/decorators/subclass.js";import i from"../geometry/Extent.js";import a from"../geometry/SpatialReference.js";import{create as p}from"../geometry/support/aaBoundingRect.js";import l from"./Layer.js";import{BlendLayer as n}from"./mixins/BlendLayer.js";import{RefreshableLayer as m}from"./mixins/RefreshableLayer.js";import{ScaleRangeLayer as c}from"./mixins/ScaleRangeLayer.js";import{createTileBitmap as f}from"./support/imageBitmapUtils.js";import y from"./support/TileInfo.js";import{TileKey as u}from"./support/TileKey.js";var h;const d=new u("0/0/0",0,0,0,void 0);let g=h=class extends(n(c(m(l)))){constructor(){super(...arguments),this.tileInfo=y.create({spatialReference:a.WebMercator,size:256}),this.type="base-tile",this.fullExtent=new i(-20037508.342787,-20037508.34278,20037508.34278,20037508.342787,a.WebMercator),this.spatialReference=a.WebMercator}getTileBounds(e,t,r,o){const s=o||p();return d.level=e,d.row=t,d.col=r,d.extent=s,this.tileInfo.updateTileInfo(d),d.extent=void 0,s}fetchTile(e,r,o,s={}){const{signal:i}=s,a=this.getTileUrl(e,r,o),p={responseType:"image",signal:i,query:{...this.refreshParameters}};return t(a??"",p).then((e=>e.data))}async fetchImageBitmapTile(e,r,o,s={}){const{signal:i}=s;if(this.fetchTile!==h.prototype.fetchTile){const t=await this.fetchTile(e,r,o,s);return f(t,e,r,o,i)}const a=this.getTileUrl(e,r,o)??"",p={responseType:"blob",signal:i,query:{...this.refreshParameters}},{data:l}=await t(a,p);return f(l,e,r,o,i)}getTileUrl(){throw new r("basetilelayer:gettileurl-not-implemented","getTileUrl() is not implemented")}};e([o({type:y})],g.prototype,"tileInfo",void 0),e([o({type:["show","hide"]})],g.prototype,"listMode",void 0),e([o({readOnly:!0,value:"base-tile"})],g.prototype,"type",void 0),e([o({nonNullable:!0})],g.prototype,"fullExtent",void 0),e([o()],g.prototype,"spatialReference",void 0),g=h=e([s("esri.layers.BaseTileLayer")],g);const j=g;export{j as default};
