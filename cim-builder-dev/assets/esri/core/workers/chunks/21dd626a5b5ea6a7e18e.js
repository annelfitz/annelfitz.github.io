"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[3938],{6518:(t,e,n)=>{n.d(e,{F:()=>a});var i=n(44208),s=n(75503),r=n(19419);const o={minX:0,minY:0,maxX:0,maxY:0};class a{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new s.wq(9,(0,i.A)("esri-csp-restrictions")?t=>({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const t=new Array(this._idByBounds.size);let e=0;this._idByBounds.forEach((n,i)=>{t[e++]=i}),this._indexInvalid=!1,this._index.clear(),this._index.load(t)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(t=>this._idByBounds.has(t))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const t=(0,r.Ie)();for(const e of this._boundsById.values())e&&(t[0]=Math.min(e[0],t[0]),t[1]=Math.min(e[1],t[1]),t[2]=Math.max(e[2],t[2]),t[3]=Math.max(e[3],t[3]));return t}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(t){const e=this._boundsById.get(t);this._boundsById.delete(t),e&&(this._idByBounds.delete(e),this._indexInvalid||this._index.remove(e))}forEachInBounds(t,e){this._loadIndex(),function(t,e,n){(function(t){o.minX=t[0],o.minY=t[1],o.maxX=t[2],o.maxY=t[3]})(e),t.search(o,n)}(this._index,t,t=>e(this._idByBounds.get(t)))}get(t){return this._boundsById.get(t)}has(t){return this._boundsById.has(t)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(t,e){if(!this._indexInvalid){const e=this._boundsById.get(t);e&&(this._index.remove(e),this._idByBounds.delete(e))}this._boundsById.set(t,e),e&&(this._idByBounds.set(e,t),this._indexInvalid||(this._boundsToLoad.push(e),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},9762:(t,e,n)=>{n.r(e),n.d(e,{projectBuffer:()=>s});var i=n(37539);function s(t,e,n,s,r,o,a=Math.floor(t.length/3)){const l=(0,i.jd)(e,r);if(null==l)return!1;if(l===i.pO){if(t===s&&n===o)return!0;const e=n+3*a;for(let i=n,r=o;i<e;i++,r++)s[r]=t[i];return!0}const u=n+3*a;for(let e=n,i=o;e<u;e+=3,i+=3)l(t,e,s,i);return!0}},36708:(t,e,n)=>{n.d(e,{C_:()=>d,OH:()=>_,Vh:()=>p,on:()=>c,pc:()=>g,wB:()=>l,z7:()=>u});var i=n(37955),s=n(36563),r=n(97768),o=n(74887),a=n(14012);function l(t,e,n={}){return h(t,e,n,f)}function u(t,e,n={}){return h(t,e,n,m)}function h(t,e,n={},i){let s=null;const o=n.once?(t,n)=>{i(t)&&((0,r.xt)(s),e(t,n))}:(t,n)=>{i(t)&&e(t,n)};if(s=(0,a.Cn)(t,o,n.sync,n.equals),n.initial){const e=t();o(e,e)}return s}function c(t,e,n,o={}){let a=null,u=null,h=null;function c(){a&&u&&(u.remove(),o.onListenerRemove?.(a),a=null,u=null)}function d(t){o.once&&o.once&&(0,r.xt)(h),n(t)}const f=l(t,(t,n)=>{c(),(0,i.wb)(t)&&(a=t,u=(0,i.on)(t,e,d),o.onListenerAdd?.(t))},{sync:o.sync,initial:!0});return h=(0,s.hA)(()=>{f.remove(),c()}),h}function d(t,e){return function(t,e,n){if((0,o.G4)(n))return Promise.reject((0,o.NK)());const i=t();if(e?.(i))return Promise.resolve(i);let a=null;function l(){a=(0,r.xt)(a)}return new Promise((i,r)=>{a=(0,s.vE)([(0,o.u7)(n,()=>{l(),r((0,o.NK)())}),h(t,t=>{l(),i(t)},{sync:!1,once:!0},e??f)])})}(t,m,e)}function f(t){return!0}function m(t){return!!t}n(80559);const _={sync:!0},p={initial:!0},g={sync:!0,initial:!0}},37539:(t,e,n)=>{n.d(e,{pO:()=>_,jd:()=>d,Tp:()=>f,w5:()=>c});var i=n(34727),s=n(83047),r=n(73941),o=n(79258);Math.PI;const a=o.$O.radius,l=o.$O.eccentricitySquared,u={a1:a*l,a2:a*l*a*l,a3:a*l*l/2,a4:a*l*a*l*2.5,a5:a*l+a*l*l/2,a6:1-l};o.$O.radius,o.$O.flattening,o.Sw.radius,o.Sw.flattening,o.sH.radius,o.sH.flattening,o.sH.radius;var h=n(21325);const c={2:{5:_,7:null,9:null,10:_,1:v,6:null,8:null,0:null,3:g,11:y,2:_,4:S},5:{5:_,7:null,9:null,10:_,1:v,6:null,8:null,0:null,3:g,11:y,2:_,4:S},7:{5:null,7:_,9:null,10:_,1:null,6:I,8:null,0:null,3:null,11:null,2:null,4:null},9:{5:null,7:null,9:_,10:_,1:null,6:null,8:w,0:null,3:null,11:null,2:null,4:null},3:{5:p,7:null,9:null,10:p,1:function(t,e,n,i){const s=t[e]/E,r=X-2*Math.atan(Math.exp(-t[e+1]/E)),o=E+t[e+2],a=Math.cos(r)*o;n[i]=Math.cos(s)*a,n[i+1]=Math.sin(s)*a,n[i+2]=Math.sin(r)*o},6:null,8:null,0:null,3:_,11:function(t,e,n,i){p(t,e,n,i),y(n,i,n,i)},2:p,4:function(t,e,n,i){p(t,e,n,i),S(n,i,n,i)}},4:{5:k,7:null,9:null,10:k,1:function(t,e,n,i){k(t,e,n,i),v(n,i,n,i)},6:null,8:null,0:null,3:function(t,e,n,i){k(t,e,n,i),g(n,i,n,i)},11:function(t,e,n,i){k(t,e,n,i),y(n,i,n,i)},2:k,4:_},1:{5:R,7:null,9:null,10:R,1:_,6:null,8:null,0:null,3:function(t,e,n,i){R(t,e,n,i),g(n,i,n,i)},11:function(t,e,n,i){R(t,e,n,i),y(n,i,n,i)},2:R,4:function(t,e,n,i){R(t,e,n,i),S(n,i,n,i)}},6:{5:null,7:B,9:null,10:B,1:null,6:_,8:null,0:null,3:null,11:null,2:null,4:null},8:{5:null,7:null,9:b,10:b,1:null,6:null,8:_,0:null,3:null,11:null,2:null,4:null},0:{5:null,7:null,9:null,10:null,1:null,6:null,8:null,0:_,3:null,11:null,2:null,4:null},10:{5:_,7:_,9:_,10:_,1:v,6:I,8:w,0:null,3:g,11:y,2:_,4:S},11:{5:x,7:null,9:null,10:x,1:function(t,e,n,i){x(t,e,n,i),v(n,i,n,i)},6:null,8:null,0:null,3:function(t,e,n,i){x(t,e,n,i),g(n,i,n,i)},11:_,2:x,4:function(t,e,n,i){x(t,e,n,i),S(n,i,n,i)}}};function d(t,e){return f(t,e)?.projector}function f(t,e){if(null==t||null==e)return null;if(j.source.spatialReference===t&&j.dest.spatialReference===e)return j;const n=m(t,j.source),i=m(e,j.dest);return 0===n&&0===i?(0,h.aI)(t,e)?j.projector=_:j.projector=null:j.projector=c[n][i],j}function m(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=(0,s.GA)(t,1)),(0,r.jA)(t)?e.spatialReferenceId=1:(0,h.oT)(t)?e.spatialReferenceId=2:(0,h.K8)(t)?e.spatialReferenceId=3:(0,h.r1)(t)?e.spatialReferenceId=11:t.wkt===r.Ro.wkt?e.spatialReferenceId=4:4490===t.wkid?e.spatialReferenceId=5:t.wkt===r.FY.wkt?e.spatialReferenceId=6:t.wkt===r.LJ.wkt?e.spatialReferenceId=8:(0,h.q8)(t)?e.spatialReferenceId=7:(0,h.KQ)(t)?e.spatialReferenceId=9:e.spatialReferenceId=0):0}function _(t,e,n,i){t!==n&&(n[i++]=t[e++],n[i++]=t[e++],n[i]=t[e])}function p(t,e,n,i){n[i]=Y*(t[e]/E),n[i+1]=Y*(X-2*Math.atan(Math.exp(-t[e+1]/E))),n[i+2]=t[e+2]}function g(t,e,n,s){!function(t,e,n,s,r){const o=.4999999*Math.PI,a=(0,i.qE)(A*t[e+1],-o,o),l=Math.sin(a);n[s++]=A*t[e]*r.radius,n[s++]=r.halfSemiMajorAxis*Math.log((1+l)/(1-l)),n[s]=t[e+2]}(t,e,n,s,o.$O)}function y(t,e,n,i){n[i]=t[e]*P,n[i+1]=t[e+1]*P,n[i+2]=t[e+2]}function x(t,e,n,i){n[i]=t[e]*O,n[i+1]=t[e+1]*O,n[i+2]=t[e+2]}function M(t,e,n,i,s){const r=s+t[e+2],o=A*t[e+1],a=A*t[e],l=Math.cos(o)*r;n[i]=Math.cos(a)*l,n[i+1]=Math.sin(a)*l,n[i+2]=Math.sin(o)*r}function w(t,e,n,i){M(t,e,n,i,o.Sw.radius)}function I(t,e,n,i){M(t,e,n,i,o.sH.radius)}function v(t,e,n,i){M(t,e,n,i,o.$O.radius)}function z(t,e,n,s,r){const o=t[e],a=t[e+1],l=t[e+2],u=Math.sqrt(o*o+a*a+l*l),h=(0,i.YN)(l/(0===u?1:u)),c=Math.atan2(a,o);n[s++]=Y*c,n[s++]=Y*h,n[s]=u-r}function b(t,e,n,i){z(t,e,n,i,o.Sw.radius)}function B(t,e,n,i){z(t,e,n,i,o.sH.radius)}function R(t,e,n,i){z(t,e,n,i,o.$O.radius)}function S(t,e,n,i){!function(t,e,n,i,s){const r=A*t[e],o=A*t[e+1],a=t[e+2],l=Math.sin(o),u=Math.cos(o),h=s.radius/Math.sqrt(1-s.eccentricitySquared*l*l);n[i++]=(h+a)*u*Math.cos(r),n[i++]=(h+a)*u*Math.sin(r),n[i++]=(h*(1-s.eccentricitySquared)+a)*l}(t,e,n,i,o.$O)}function k(t,e,n,i){const s=u,r=t[e],a=t[e+1],l=t[e+2];let h,c,d,f,m,_,p,g,y,x,M,w,I,v,z,b,B,R,S,k,j;h=Math.abs(l),c=r*r+a*a,d=Math.sqrt(c),f=c+l*l,m=Math.sqrt(f),k=Math.atan2(a,r),_=l*l/f,p=c/f,v=s.a2/m,z=s.a3-s.a4/m,p>.3?(g=h/m*(1+p*(s.a1+v+_*z)/m),S=Math.asin(g),x=g*g,y=Math.sqrt(1-x)):(y=d/m*(1-_*(s.a5-v-p*z)/m),S=Math.acos(y),x=1-y*y,g=Math.sqrt(x)),M=1-o.$O.eccentricitySquared*x,w=o.$O.radius/Math.sqrt(M),I=s.a6*w,v=d-w*y,z=h-I*g,B=y*v+g*z,b=y*z-g*v,R=b/(I/M+B),S+=R,j=B+b*R/2,l<0&&(S=-S),n[i++]=Y*k,n[i++]=Y*S,n[i]=j}const j={source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:_},A=(0,i.kU)(1),Y=(0,i.KJ)(1),X=.5*Math.PI,E=o.$O.radius,P=E*Math.PI/180,O=180/(E*Math.PI)},37730:(t,e,n)=>{n.d(e,{T:()=>s});var i=n(43334);const s={getObjectId:t=>t.objectId,getAttributes:t=>t.attributes,getAttribute:(t,e)=>t.attributes[e],cloneWithGeometry:(t,e)=>new i.Om(e,t.attributes,null,t.objectId),getGeometry:t=>t.geometry,getCentroid:(t,e)=>t.ensureCentroid(e)}},58376:(t,e,n)=>{n.d(e,{J:()=>m});var i=n(4718),s=n(74887),r=n(65864),o=n(17136),a=n(21325),l=n(31464),u=n(95422),h=n(8384),c=n(58727),d=n(62798),f=n(62660);async function m(t,e,n){const m=(0,s.Mq)(n),{point:_,distance:p,returnEdge:g,vertexMode:y}=e;if(!g&&"none"===y)return{candidates:[]};let x=(0,i.o8)(e.query);x=await t.schedule(()=>(0,c.T2)(x,t.definitionExpression,t.spatialReference),m),x=await t.reschedule(()=>(0,d.B4)(x,{availableFields:t.availableFields,fieldsIndex:t.fieldsIndex,geometryType:t.geometryType,spatialReference:t.spatialReference}),m);const M=!(0,a.aI)(_.spatialReference,t.spatialReference);M&&await(0,l.Nk)(_.spatialReference,t.spatialReference);const w="number"==typeof p?p:p.x,I="number"==typeof p?p:p.y,v={xmin:_.x-w,xmax:_.x+w,ymin:_.y-I,ymax:_.y+I,spatialReference:_.spatialReference},z=M?(0,l.Cv)(v,t.spatialReference):v;if(!z)return{candidates:[]};const b=(await(0,o.el)((0,r.rS)(_),null,{signal:m}))[0],B=(await(0,o.el)((0,r.rS)(z),null,{signal:m}))[0];if(null==b||null==B)return{candidates:[]};const R=new h.G(await t.reschedule(()=>t.searchFeatures((0,u.ux)(B.toJSON())),m),x,t);await t.reschedule(()=>t.executeObjectIdsQuery(R),m),await t.reschedule(()=>t.executeTimeQuery(R),m),await t.reschedule(()=>t.executeAttributesQuery(R),m),await t.reschedule(()=>async function(t,e,n){const{query:i}=e,{spatialRel:s}=i;if(!e?.items?.length||!i.geometry||!s)return;const r=await(0,f.xt)(s,i.geometry,t.geometryType,t.hasZ,t.hasM),o=await t.runSpatialFilter(e.items,t=>r(t.geometry),n);e.items=o}(t,R,m),m);const S=b.toJSON(),k=M?(0,l.Cv)(S,t.spatialReference):S,j=M?Math.max(z.xmax-z.xmin,z.ymax-z.ymin)/2:p;return R.createSnappingResponse({...e,point:k,distance:j},x.returnZ,_.spatialReference)}},62815:(t,e,n)=>{n.d(e,{N:()=>o});var i=n(83047),s=n(73941),r=n(21325);function o(t,e,n){if(null==e||null==n||n.vcsWkid||(0,r.aI)(e,n)||(0,s.xP)(e)||(0,s.xP)(n))return null;const o=(0,i.G9)(e)/(0,i.G9)(n);if(1===o)return null;switch(t){case"point":case"esriGeometryPoint":return t=>function(t,e){null!=t?.z&&(t.z*=e)}(t,o);case"polyline":case"esriGeometryPolyline":return t=>function(t,e){if(t)for(const n of t.paths)for(const t of n)t.length>2&&(t[2]*=e)}(t,o);case"polygon":case"esriGeometryPolygon":return t=>function(t,e){if(t)for(const n of t.rings)for(const t of n)t.length>2&&(t[2]*=e)}(t,o);case"multipoint":case"esriGeometryMultipoint":return t=>function(t,e){if(t)for(const n of t.points)n.length>2&&(n[2]*=e)}(t,o);case"extent":case"esriGeometryEnvelope":return t=>function(t,e){t&&null!=t.zmin&&null!=t.zmax&&(t.zmin*=e,t.zmax*=e)}(t,o);default:return null}}},66344:(t,e,n)=>{n.d(e,{q:()=>a});const i=!!(0,n(44208).A)("esri-tests-disable-gpu-memory-measurements");Symbol.iterator;class s{get size(){return this._size}constructor(t=10485760){this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._users=new Map,this._sizeLimits=new Map}destroy(){this.clearAll(),this._sizeLimits.clear(),this._users.clear(),this._db=null}register(t){this._users.set(t.id.slice(0,-1),t)}deregister(t){this.clear(t),this._sizeLimits.delete(t),this._users.delete(t.id.slice(0,-1))}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,-1),this._checkSize()}getSize(t,e){const n=this._db.get(t.id+e);return n?.size??0}put(t,e,n,s,o){e=t.id+e;const a=this._db.get(e);if(a&&(this._size-=a.size,t.size-=a.size,this._db.delete(e),a.entry!==n&&this._notifyRemove(e,a.entry,a.size,0)),s>this._maxSize)return void this._notifyRemove(e,n,s,0);if(void 0===n)return void console.warn("Refusing to cache undefined entry ");if(!s||s<0)return i||console.warn(`Refusing to cache entry with size ${s} for key ${e}`),void this._notifyRemove(e,n,0,0);const l=1+Math.max(o,-4)- -3;this._db.set(e,new r(n,s,l)),this._size+=s,t.size+=s,this._checkSize()}updateSize(t,e,n,i){e=t.id+e;const s=this._db.get(e);if(s&&s.entry===n){for(this._size-=s.size,t.size-=s.size;i>this._maxSize;){const t=this._notifyRemove(e,n,i,1);if(!(null!=t&&t>0))return void this._db.delete(e);i=t}s.size=i,this._size+=i,t.size+=i,this._checkSize()}}pop(t,e){e=t.id+e;const n=this._db.get(e);if(n)return this._size-=n.size,t.size-=n.size,this._db.delete(e),++this._hit,n.entry;++this._miss}get(t,e){e=t.id+e;const n=this._db.get(e);if(void 0!==n)return this._db.delete(e),n.lives=n.lifetime,this._db.set(e,n),++this._hit,n.entry;++this._miss}peek(t,e){const n=this._db.get(t.id+e);return n?++this._hit:++this._miss,n?.entry}get performanceInfo(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},e={},n=new Array;this._db.forEach((t,i)=>{const s=t.lifetime;n[s]=(n[s]||0)+t.size,this._users.forEach(n=>{const{id:s,name:r}=n;if(i.startsWith(s)){const n=e[r]||0;e[r]=n+t.size}})});const i={};this._users.forEach(t=>{const n=t.name;if("hitRate"in t&&"number"==typeof t.hitRate&&!isNaN(t.hitRate)&&t.hitRate>0){const s=e[n]||0;e[n]=s,i[n]=Math.round(100*t.hitRate)+"%"}else i[n]="0%"});const s=Object.keys(e);s.sort((t,n)=>e[n]-e[t]),s.forEach(n=>t[n]=Math.round(e[n]/2**20)+"MB / "+i[n]);for(let e=n.length-1;e>=0;--e){const i=n[e];i&&(t["Priority "+(e+-3-1)]=Math.round(i/this._size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forEach(t=>t.resetHitRate())}clear(t){const e=t.id;this._db.forEach((t,n)=>{n.startsWith(e)&&(this._size-=t.size,this._db.delete(n),this._notifyRemove(n,t.entry,t.size,0))}),t.size=0}clearAll(){this._db.forEach((t,e)=>this._notifyRemove(e,t.entry,t.size,0)),this._users.forEach(t=>t.size=0),this._size=0,this._db.clear()}*values(t){for(const[e,n]of this._db)e.startsWith(t.id)&&(yield n.entry)}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,e,n,i){const s=this._users.get(t.split(o)[0])?.removeFunc,r=s?.(e,i,n);return"number"==typeof r?r:null}_checkSize(){this._sizeLimits.forEach((t,e)=>this._checkSizeLimits(t,e)),this._checkSizeLimits(this.maxSize)}setMaxSize(t,e){null==e||e<=0?this._sizeLimits.delete(t):this._sizeLimits.set(t,e)}_checkSizeLimits(t,e){const n=e??this;if(n.size<=t)return;const i=e?.id;let s=!0;for(;s;){s=!1;for(const[r,a]of this._db)if(0===a.lifetime&&(!i||r.startsWith(i))){const i=e??this._users.get(r.split(o)[0]);if(this._purgeItem(r,a,i),n.size<=.9*t)return;s||=this._db.has(r)}}for(const[s,r]of this._db)if(!i||s.startsWith(i)){const i=e??this._users.get(s.split(o)[0]);if(this._purgeItem(s,r,i),n.size<=.9*t)return}}_purgeItem(t,e,n){if(this._db.delete(t),e.lives<=1){this._size-=e.size,n&&(n.size-=e.size);const i=this._notifyRemove(t,e.entry,e.size,1);null!=i&&i>0&&(this._size+=i,n&&(n.size+=i),e.lives=e.lifetime,e.size=i,this._db.set(t,e))}else--e.lives,this._db.set(t,e)}}class r{constructor(t,e,n){this.entry=t,this.size=e,this.lifetime=n,this.lives=n}}const o=":";class a{constructor(t,e){this.removeFunc=e,this._storage=new s,this.id="",this.name="",this.size=0,this._storage.maxSize=t,this._storage.register(this)}destroy(){this._storage.deregister(this),this._storage.destroy(),this._storage=null}put(t,e,n=1){this._storage.put(this,t,e,n,1)}pop(t){return this._storage.pop(this,t)}get(t){return this._storage.get(this,t)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}resetHitRate(){}}},69540:(t,e,n)=>{n.d(e,{O:()=>u,P:()=>h});var i=n(31635),s=n(65008),r=(n(44208),n(4718)),o=(n(53966),n(97768)),a=n(88620),l=n(40608);const u=t=>{const e=t;let n=class extends e{clone(t){const e=(0,a.oY)(this);(0,o.Lw)(e,"unable to clone instance of non-accessor class");const n=e.metadata,i=e.store,s={},l=new Map;for(const e in n){const o=n[e],a=i?.originOf(e),u=o.clonable;if(o.readOnly||!1===u||7!==a&&0!==a&&5!==a&&4!==a)continue;const h=this[e];let c=null;if("function"==typeof u)c=u(h,t);else if("reference"===u)c=h;else if(c=(0,r.TU)(h,t),null!=h&&null==c)continue;0===a?l.set(e,c):s[e]=c}const u=new(0,Object.getPrototypeOf(this).constructor)(s);if(l.size){const t=(0,a.oY)(u)?.store;if(t)for(const[e,n]of l)t.set(e,n,0)}return u}};return n=(0,i.Cg)([(0,l.$)("esri.core.Clonable")],n),n},h=u(s.A)},75503:(t,e,n)=>{n.d(e,{EC:()=>b,wq:()=>a});var i=n(4576),s=n(21818),r=(n(44208),n(15142)),o=n(11006);class a{constructor(t=9,e){this._compareMinX=d,this._compareMinY=f,this._toBBox=t=>t,this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&("function"==typeof e?this._toBBox=e:this._initFormat(e)),this.clear()}destroy(){this.clear(),w.prune(),I.prune(),v.prune(),z.prune()}all(t){l(this._data,t)}search(t,e){let n=this._data;const i=this._toBBox;if(x(t,n))for(w.clear();n;){for(let s=0,r=n.children.length;s<r;s++){const r=n.children[s],o=n.leaf?i(r):r;x(t,o)&&(n.leaf?e(r):y(t,o)?l(r,e):w.push(r))}n=w.pop()}}collides(t){let e=this._data;const n=this._toBBox;if(!x(t,e))return!1;for(w.clear();e;){for(let i=0,s=e.children.length;i<s;i++){const s=e.children[i],r=e.leaf?n(s):s;if(x(t,r)){if(e.leaf||y(t,r))return!0;w.push(s)}}e=w.pop()}return!1}load(t){if(!t.length)return this;if(t.length<this._minEntries){for(let e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(this._data.children.length)if(this._data.height===e.height)this._splitRoot(this._data,e);else{if(this._data.height<e.height){const t=this._data;this._data=e,e=t}this._insert(e,this._data.height-e.height-1,!0)}else this._data=e;return this}insert(t){return t&&this._insert(t,this._data.height-1),this}clear(){return this._data=new R([]),this}remove(t){if(!t)return this;let e,n=this._data,r=null,o=0,a=!1;const l=this._toBBox(t);for(v.clear(),z.clear();n||v.length>0;){if(n||(n=v.pop(),r=v.data[v.length-1],o=z.pop()??0,a=!0),n.leaf&&(e=(0,i.qh)(n.children,(0,s.zI)(t),n.children.length,n.indexHint),-1!==e))return n.children.splice(e,1),v.push(n),this._condense(v),this;a||n.leaf||!y(n,l)?r?(o++,n=r.children[o],a=!1):n=null:(v.push(n),z.push(o),o=0,r=n,n=n.children[0])}return this}toJSON(){return this._data}fromJSON(t){return this._data=t,this}_build(t,e,n,i){const s=n-e+1;let r=this._maxEntries;if(s<=r){const i=new R(t.slice(e,n+1));return u(i,this._toBBox),i}i||(i=Math.ceil(Math.log(s)/Math.log(r)),r=Math.ceil(s/r**(i-1)));const o=new S([]);o.height=i;const a=Math.ceil(s/r),l=a*Math.ceil(Math.sqrt(r));M(t,e,n,l,this._compareMinX);for(let s=e;s<=n;s+=l){const e=Math.min(s+l-1,n);M(t,s,e,a,this._compareMinY);for(let n=s;n<=e;n+=a){const s=Math.min(n+a-1,e);o.children.push(this._build(t,n,s,i-1))}}return u(o,this._toBBox),o}_insert(t,e,n){const i=this._toBBox,s=n?t:i(t);v.clear();const r=function(t,e,n,i){for(;i.push(e),!0!==e.leaf&&i.length-1!==n;){let n,i=1/0,s=1/0;for(let r=0,o=e.children.length;r<o;r++){const o=e.children[r],a=m(o),l=p(t,o)-a;l<s?(s=l,i=a<i?a:i,n=o):l===s&&a<i&&(i=a,n=o)}e=n||e.children[0]}return e}(s,this._data,e,v);for(r.children.push(t),c(r,s);e>=0&&v.data[e].children.length>this._maxEntries;)this._split(v,e),e--;!function(t,e,n){for(let i=n;i>=0;i--)c(e.data[i],t)}(s,v,e)}_split(t,e){const n=t.data[e],i=n.children.length,s=this._minEntries;this._chooseSplitAxis(n,s,i);const r=this._chooseSplitIndex(n,s,i);if(!r)return;const o=n.children.splice(r,n.children.length-r),a=n.leaf?new R(o):new S(o);a.height=n.height,u(n,this._toBBox),u(a,this._toBBox),e?t.data[e-1].children.push(a):this._splitRoot(n,a)}_splitRoot(t,e){this._data=new S([t,e]),this._data.height=t.height+1,u(this._data,this._toBBox)}_chooseSplitIndex(t,e,n){let i,s,r;i=s=1/0;for(let o=e;o<=n-e;o++){const e=h(t,0,o,this._toBBox),a=h(t,o,n,this._toBBox),l=g(e,a),u=m(e)+m(a);l<i?(i=l,r=o,s=u<s?u:s):l===i&&u<s&&(s=u,r=o)}return r}_chooseSplitAxis(t,e,n){const i=t.leaf?this._compareMinX:d,s=t.leaf?this._compareMinY:f;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,s)&&t.children.sort(i)}_allDistMargin(t,e,n,i){t.children.sort(i);const s=this._toBBox,r=h(t,0,e,s),o=h(t,n-e,n,s);let a=_(r)+_(o);for(let i=e;i<n-e;i++){const e=t.children[i];c(r,t.leaf?s(e):e),a+=_(r)}for(let i=n-e-1;i>=e;i--){const e=t.children[i];c(o,t.leaf?s(e):e),a+=_(o)}return a}_condense(t){for(let e=t.length-1;e>=0;e--){const n=t.data[e];if(0===n.children.length)if(e>0){const s=t.data[e-1],r=s.children;r.splice((0,i.qh)(r,n,r.length,s.indexHint),1)}else this.clear();else u(n,this._toBBox)}}_initFormat(t){const e=["return a"," - b",";"];this._compareMinX=new Function("a","b",e.join(t[0])),this._compareMinY=new Function("a","b",e.join(t[1])),this._toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}function l(t,e){let n=t;for(I.clear();n;){if(!0===n.leaf)for(const t of n.children)e((0,s.zI)(t));else I.pushArray(n.children);n=I.pop()??null}}function u(t,e){h(t,0,t.children.length,e,t)}function h(t,e,n,i,s){s||(s=new R([])),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let r,o=e;o<n;o++)r=t.children[o],c(s,t.leaf?i(r):r);return s}function c(t,e){t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY)}function d(t,e){return t.minX-e.minX}function f(t,e){return t.minY-e.minY}function m(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function _(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function g(t,e){const n=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),s=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,s-n)*Math.max(0,r-i)}function y(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function x(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function M(t,e,n,i,s){const r=[e,n];for(;r.length;){const e=r.pop(),n=r.pop();if(e-n<=i)continue;const a=n+Math.ceil((e-n)/i/2)*i;(0,o.q)(t,a,n,e,s),r.push(n,a,a,e)}}const w=new r.A,I=new r.A,v=new r.A,z=new r.A({deallocator:void 0});class b{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class B extends b{constructor(){super(...arguments),this.height=1,this.indexHint=new i.vW}}class R extends B{constructor(t){super(),this.children=t,this.leaf=!0}}class S extends B{constructor(t){super(),this.children=t,this.leaf=!1}}},83221:(t,e,n)=>{n.d(e,{A:()=>m});var i=n(4576),s=n(49186),r=n(65529),o=n(53966),a=n(70328),l=n(19419),u=n(90708),h=n(6518),c=n(51441),d=n(37730);const f=(0,a.vt)();class m{constructor(t){this.geometryInfo=t,this._boundsStore=new h.F,this._featuresById=new Map,this._usedMemory=0,this.events=new r.bk,this.featureAdapter=d.T}get usedMemory(){return this._usedMemory}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let t=0;return this._featuresById.forEach(e=>{null!=e.geometry&&e.geometry.coords&&(t+=e.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:t/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(t){if(null==this.fullBounds)return null;const[e,n,i,s]=this.fullBounds;return{xmin:e,ymin:n,xmax:i,ymax:s,spatialReference:(0,c.ag)(t)}}add(t){this._add(t),this._emitChanged()}addMany(t){for(const e of t)this._add(e);this._emitChanged()}upsertMany(t){const e=t.map(t=>this._upsert(t));return this._emitChanged(),e.filter(i.Ru)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged(),this._usedMemory=0}removeById(t){const e=this._featuresById.get(t);return e?(this._remove(e),this._emitChanged(),e):null}removeManyById(t){this._boundsStore.invalidateIndex();for(const e of t){const t=this._featuresById.get(e);t&&this._remove(t)}this._emitChanged()}forEachBounds(t,e){for(const n of t){const t=this._boundsStore.get(n.objectId);t&&e((0,a.Jt)(f,t))}}getFeature(t){return this._featuresById.get(t)}has(t){return this._featuresById.has(t)}forEach(t){this._featuresById.forEach(e=>t(e))}forEachInBounds(t,e){this._boundsStore.forEachInBounds(t,t=>{e(this._featuresById.get(t))})}_emitChanged(){this.events.emit("changed",void 0)}_add(t){if(!t)return;const e=t.objectId;if(null==e)return void o.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new s.A("featurestore:invalid-feature","feature id is missing",{feature:t}));const n=this._featuresById.get(e);let i;if(n?(t.displayId=n.displayId,i=this._boundsStore.get(e),this._boundsStore.delete(e),this._usedMemory-=this.estimateFeatureUsedMemory?.(n)??0):null!=this.onFeatureAdd&&this.onFeatureAdd(t),!t.geometry?.coords?.length)return this._boundsStore.set(e,null),void this._featuresById.set(e,t);i=(0,u.jQ)(null!=i?i:(0,l.vt)(),t.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=i&&this._boundsStore.set(e,i),this._featuresById.set(e,t),this._usedMemory+=this.estimateFeatureUsedMemory?.(t)??0}_upsert(t){const e=t?.objectId;if(null==e)return o.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new s.A("featurestore:invalid-feature","feature id is missing",{feature:t})),null;const n=this._featuresById.get(e);if(!n)return this._add(t),t;this._usedMemory-=this.estimateFeatureUsedMemory?.(n)??0;const{geometry:i,attributes:r}=t;for(const t in r)n.attributes[t]=r[t];return i&&(n.geometry=i,this._boundsStore.set(e,(0,u.jQ)((0,l.vt)(),i,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),this._usedMemory+=this.estimateFeatureUsedMemory?.(n)??0,n}_remove(t){null!=this.onFeatureRemove&&this.onFeatureRemove(t);const e=t.objectId;return this._boundsStore.delete(e),this._featuresById.delete(e),this._usedMemory-=this.estimateFeatureUsedMemory?.(t)??0,t}}},98988:(t,e,n)=>{n.r(e),n.d(e,{canProjectWithoutEngine:()=>$,getTransformation:()=>C,getTransformations:()=>q,initializeProjection:()=>U,isEqualBaseGCS:()=>K,isLoaded:()=>A,isLoadedOrLoad:()=>Y,isLoadedOrLoadFor:()=>X,load:()=>P,project:()=>O,projectExtent:()=>rt,projectMany:()=>L,projectMultipoint:()=>V,projectOrLoad:()=>T,projectOrLoadMany:()=>F,projectPoint:()=>Q,projectPolygon:()=>it,projectPolyline:()=>et,projectWithZConversion:()=>N,projectWithoutEngine:()=>J,requiresLoad:()=>E,test:()=>H,tryProjectWithZConversion:()=>W,unload:()=>Z});var i=n(49186),s=n(74887),r=n(62788),o=n(95488),a=n(51850),l=n(21276),u=n(73941),h=n(5443),c=n(48526),d=n(83290),f=n(86738),m=n(39829),_=n(82799),p=n(16930),g=n(9762),y=n(37539);function x(t,e,n,i,s,r){return M[0]=t,M[1]=e,M[2]=n,(0,g.projectBuffer)(M,i,0,s,r,0)}const M=(0,a.vt)();let w=0;class I{static fromGE(t){const e=new I;return e._wkt=t.wkt,e._wkid=t.wkid,e._isInverse=t.isInverse,e}constructor(t){this.uid=w++,t?(this._wkt=null!=t.wkt?t.wkt:null,this._wkid=null!=t.wkid?t.wkid:-1,this._isInverse=null!=t.isInverse&&!0===t.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}get wkt(){return this._wkt}set wkt(t){this._wkt=t,this.uid=w++}get wkid(){return this._wkid}set wkid(t){this._wkid=t,this.uid=w++}get isInverse(){return this._isInverse}set isInverse(t){this._isInverse=t,this.uid=w++}getInverse(){const t=new I;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t}}class v{static cacheKey(t,e){return[t.wkid?.toString()??"-1",t.wkt?.toString()??"",t.wkt2?.toString()??"",e.wkid?.toString()??"-1",e.wkt?.toString()??"",e.wkt2?.toString()??""].join()}static fromGE(t){const e=new v;let n="";for(const i of t.steps){const t=I.fromGE(i);e.steps.push(t),n+=t.uid.toString()+","}return e._cachedProjection={},e._gtlistentry=null,e._chain=n,e}constructor(t){if(this.steps=[],this._cachedProjection={},this._chain="",this._gtlistentry=null,t?.steps)for(const e of t.steps)e instanceof I?this.steps.push(e):this.steps.push(new I({wkid:e.wkid,wkt:e.wkt,isInverse:e.isInverse}))}getInverse(){const t=new v;t.steps=[];for(let e=this.steps.length-1;e>=0;e--){const n=this.steps[e];t.steps.push(n.getInverse())}return t}getGTListEntry(){let t="";for(const e of this.steps)t+=e.uid.toString()+",";return t!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=t),this._gtlistentry}assignCachedGe(t,e,n){this._cachedProjection[v.cacheKey(t,e)]=n}getCachedGeTransformation(t,e){let n="";for(const t of this.steps)n+=t.uid.toString()+",";n!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=n);const i=this._cachedProjection[v.cacheKey(t,e)];return void 0===i?null:i}}var z=n(21325),b=n(62815);let B=null,R=null,S=null,k={};const j=new o.I;function A(){return!!B&&(0,d.i)()}function Y(){return!!A()||((0,r.gc)(j),P(),!1)}function X(t,e){return!t||!e||$(t,e)||Y()}function E(t,e){return!$(t,e)&&!A()}function P(t){return null==S&&(S=Promise.all([(0,d.l)(),n.e(9930).then(n.bind(n,49930)).then(t=>t.g),n.e(2731).then(n.bind(n,12731))])),S.then(([,e,{hydratedAdapter:n}])=>{(0,s.Te)(t),R=n,B=e.default,B._enableProjection(d.p),j.notify()})}function O(t,e,n=null,i=null){return Array.isArray(t)?0===t.length?[]:((0,l.H)(t),L(R,t,t[0].spatialReference,e,n,i)):((0,l.f)(t),L(R,[t],t.spatialReference,e,n,i)[0])}function L(t,e,n,i,s=null,r=null){if(null==n||null==i)return e;if($(n,i,s))return e.map(t=>J(t,n,i));if(null==s&&(0,u.jA)(n))return e.map(t=>J(t,n,p.A.WGS84)).map(t=>W(t,i));if(null==s&&(0,u.jA)(i))return e.map(t=>W(t,p.A.WGS84)).map(t=>J(t,p.A.WGS84,i));if(null==s){const t=v.cacheKey(n,i);void 0!==k[t]?s=k[t]:(null==(s=C(n,i,void 0))&&(s=new v),k[t]=s)}if(null==B||null==t)throw new G;return null!=r?B._project(t,e,n,i,s,r):B._project(t,e,n,i,s)}function T(t,e){const n=F([t],e);return null!=n.pending?{pending:n.pending,geometry:null}:null!=n.geometries?{pending:null,geometry:n.geometries[0]}:{pending:null,geometry:null}}function F(t,e){if(!A())for(const n of t)if(null!=n&&!(0,z.aI)(n.spatialReference,e)&&(0,z.fn)(n.spatialReference)&&(0,z.fn)(e)&&!$(n.spatialReference,e))return(0,r.gc)(j),{pending:P(),geometries:null};return{pending:null,geometries:t.map(t=>null==t?null:(0,z.aI)(t.spatialReference,e)?t:(0,z.fn)(t.spatialReference)&&(0,z.fn)(e)?W(t,e):null)}}function C(t,e,n=null){if(null==t||null==e)return null;if(null==B||null==R)throw new G;const i=B._getTransformation(R,t,e,n,n?.spatialReference);return null!==i?v.fromGE(i):null}function q(t,e,n=null){if(null==B||null==R)throw new G;const i=B._getTransformationBySuitability(R,t,e,n,n?.spatialReference);if(null!==i){const t=[];for(const e of i)t.push(v.fromGE(e));return t}return[]}class G extends i.A{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}}function Z(){B=null,R=null,S=null,k={}}const H={get loadPromise(){return S}};function W(t,e){try{const n=O(t,e);if(null==n)return null;"xmin"in t&&"xmin"in n&&(n.zmin=t.zmin,n.zmax=t.zmax);const i=(0,b.N)(n.type,t.spatialReference,e);return null!=i&&i(n),n}catch(t){if(!(t instanceof G))throw t;return null}}async function N(t,e,n){const i=t.spatialReference;return null!=i&&null!=e&&await U(i,e,null,n),W(t,e)}function $(t,e,n){return!n&&(!!(0,z.aI)(t,e)||(0,z.fn)(t)&&(0,z.fn)(e)&&!!(0,y.jd)(t,e))}function K(t,e){if((0,z.aI)(t,e))return!0;if(!(0,z.fn)(t)||!(0,z.fn)(e))return!1;const n=(0,z.oT)(t)||(0,z.K8)(t)||(0,z.x1)(t),i=(0,z.oT)(e)||(0,z.K8)(e)||(0,z.x1)(e);return n&&i}async function U(t,e,n,i){if(A())return(0,s.NO)(i);if(Array.isArray(t)){for(const{source:e,dest:n,geographicTransformation:s}of t)if(e&&n&&!$(e,n,s))return P(i)}else if(t&&e&&!$(t,e,n))return P(i);return(0,s.NO)(i)}function J(t,e,n){return t?"x"in t?D(t,e,new f.A,n,0):"xmin"in t?ot(t,e,new h.A,n,0):"rings"in t?st(t,e,new m.A,n,0):"paths"in t?nt(t,e,new _.A,n,0):"points"in t?tt(t,e,new c.A,n,0):null:null}function Q(t,e,n=e.spatialReference,i=0){return null!=n&&null!=t.spatialReference&&null!=D(t,t.spatialReference,e,n,i)}function D(t,e,n,i,s){lt[0]=t.x,lt[1]=t.y;const r=t.z;return lt[2]=void 0!==r?r:s,(0,g.projectBuffer)(lt,e,0,lt,i,0)?(n.x=lt[0],n.y=lt[1],n.spatialReference=i,void 0!==r||(0,u.xP)(i)?(n.z=lt[2],n.hasZ=!0):(n.z=void 0,n.hasZ=!1),void 0===t.m?(n.m=void 0,n.hasM=!1):(n.m=t.m,n.hasM=!0),n):null}function V(t,e,n=e.spatialReference,i=0){return null!=t.spatialReference&&null!=n&&null!=tt(t,t.spatialReference,e,n,i)}function tt(t,e,n,i,s){const{points:r,hasZ:o,hasM:a}=t,l=[],h=r.length,c=[];for(const t of r)c.push(t[0],t[1],o?t[2]:s);if(!(0,g.projectBuffer)(c,e,0,c,i,0,h))return null;const d=o||(0,u.xP)(i);for(let t=0;t<h;++t){const e=3*t,n=c[e],i=c[e+1];d&&a?l.push([n,i,c[e+2],r[t][3]]):d?l.push([n,i,c[e+2]]):a?l.push([n,i,r[t][2]]):l.push([n,i])}return n.points=l,n.spatialReference=i,n.hasZ=o,n.hasM=a,n}function et(t,e,n=e.spatialReference,i=0){return null!=t.spatialReference&&null!=n&&null!=nt(t,t.spatialReference,e,n,i)}function nt(t,e,n,i,s){const{paths:r,hasZ:o,hasM:a}=t,l=[];if(!at(r,o??!1,a??!1,e,l,i,s))return null;const h=o||(0,u.xP)(i);return n.paths=l,n.spatialReference=i,n.hasZ=h,n.hasM=a,n}function it(t,e,n=e.spatialReference,i=0){return null!=t.spatialReference&&null!=n&&null!=st(t,t.spatialReference,e,n,i)}function st(t,e,n,i,s){const{rings:r,hasZ:o,hasM:a}=t,l=[];if(!at(r,o??!1,a??!1,e,l,i,s))return null;const h=o||(0,u.xP)(i);return n.rings=l,n.spatialReference=i,n.hasZ=h,n.hasM=a,n}function rt(t,e,n=e.spatialReference,i=0){return null!=t.spatialReference&&null!=n&&null!=ot(t,t.spatialReference,e,n,i)}function ot(t,e,n,i,s){const{xmin:r,ymin:o,xmax:a,ymax:l,hasZ:h,hasM:c}=t;if(!x(r,o,h?t.zmin:s,e,lt,i))return null;const d=h||(0,u.xP)(i);return n.xmin=lt[0],n.ymin=lt[1],d&&(n.zmin=lt[2]),x(a,l,h?t.zmax:s,e,lt,i)?(n.xmax=lt[0],n.ymax=lt[1],d&&(n.zmax=lt[2]),c&&(n.mmin=t.mmin,n.mmax=t.mmax),n.spatialReference=i,n):null}function at(t,e,n,i,s,r,o=0){const a=new Array;for(const n of t)for(const t of n)a.push(t[0],t[1],e?t[2]:o);if(!(0,g.projectBuffer)(a,i,0,a,r,0))return!1;let l=0;s.length=0;const h=e||(0,u.xP)(r);for(const e of t){const t=new Array;for(const i of e)h&&n?t.push([a[l++],a[l++],a[l++],i[3]]):h?t.push([a[l++],a[l++],a[l++]]):n?(t.push([a[l++],a[l++],i[2]]),l++):(t.push([a[l++],a[l++]]),l++);s.push(t)}return!0}const lt=(0,a.vt)()}}]);