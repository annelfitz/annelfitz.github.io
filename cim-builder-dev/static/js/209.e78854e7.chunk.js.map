{"version":3,"sources":["../node_modules/@arcgis/core/identity/IdentityForm.js","../../src/index.js","../../index.js","../node_modules/@arcgis/core/identity/IdentityModal.js","../node_modules/@arcgis/core/identity/OAuthCredential.js","../node_modules/@arcgis/core/identity/OAuthInfo.js","../node_modules/@arcgis/core/identity/ServerInfo.js","../node_modules/@arcgis/core/identity/IdentityManagerBase.js","../node_modules/@arcgis/core/identity/IdentityManager.js"],"names":["a","p","o","constructor","s","e","super","this","_usernameInputNode","_passwordInputNode","messages","signingIn","server","resource","error","oAuthPrompt","render","t","n","d","u","class","r","oAuthInfo","info","test","lblItem","c","key","lblUser","value","required","autocomplete","spellcheck","type","bind","afterCreate","i","m","lblPwd","h","classes","disabled","lblSigning","lblOk","lblCancel","onclick","_cancel","g","details","httpStatus","invalidUser","noAuthService","onsubmit","_submit","_set","emit","preventDefault","username","password","prototype","candidateSelectors","candidateSelector","matches","Element","getCandidates","candidates","Array","el","includeContainer","getTabindex","tabindexAttr","parseInt","node","isNaN","isContentEditable","sortOrderedTabbables","b","isInput","isNonTabbableRadio","isRadio","radioScope","queryRadios","name","window","radioSet","err","console","checked","nodes","getCheckedRadio","isTabbableRadio","isNodeMatchingSelectorFocusable","isHiddenInput","getComputedStyle","nodeUnderDetails","displayCheck","width","height","isHidden","options","child","isDetailsWithSummary","parentNode","isDisabledFromFieldset","isNodeMatchingSelectorTabbable","focusableCandidateSelector","isFocusable","Error","activeFocusTraps","trapQueue","activateTrap","activeTrap","trapIndex","deactivateTrap","delay","setTimeout","fn","findIndex","idx","arr","valueOrHandler","params","createFocusTrap","doc","config","returnFocusOnDeactivate","escapeDeactivates","delayInitialFocus","state","containers","tabbableGroups","nodeFocusedBeforeActivation","mostRecentlyFocusedNode","active","paused","delayInitialFocusTimer","undefined","getOption","configOverrideOptions","optionName","configOptionName","containersContain","container","getNodeForOption","optionValue","getInitialFocusNode","firstTabbableGroup","updateTabbableNodes","tabbableNodes","regularTabbables","orderedTabbables","candidate","candidateTabindex","documentOrder","tabIndex","tabbable","firstTabbableNode","lastTabbableNode","tryFocus","preventScroll","isSelectableInput","getReturnFocusNode","checkPointerDown","trap","returnFocus","checkFocusIn","targetContained","checkKey","isEscapeEvent","isTabEvent","destinationNode","containerIndex","startOfGroupIndex","destinationGroupIndex","lastOfGroupIndex","checkTab","checkClick","addListeners","capture","passive","removeListeners","activate","onActivate","activateOptions","onPostActivate","checkCanFocusTrap","finishActivation","deactivate","clearTimeout","onDeactivate","deactivateOptions","onPostDeactivate","checkCanReturnFocus","finishDeactivation","pause","unpause","updateContainerElements","elementsAsArray","concat","containerElements","filter","element","l","document","createElement","content","open","_close","body","appendChild","own","watch","_toggleFocusTrap","destroy","_destroyFocusTrap","id","title","close","role","_createFocusTrap","_renderContent","_focusTrap","requestAnimationFrame","initialFocus","cancelAnimationFrame","innerHTML","HTMLElement","_attachToNode","readOnly","aliasOf","storage","appId","expires","ssl","token","userId","_init","isValid","Date","now","minTimeUntilExpiration","save","_load","authNamespace","portalUrl","setItem","JSON","stringify","log","replace","FormData","append","navigator","sendBeacon","XMLHttpRequest","send","_oAuthCred","getItem","parse","declaredClass","expiration","forceLogin","forceUserId","locale","popup","popupCallbackUrl","popupWindowFeatures","preserveUrlHash","clone","fromJSON","toJSON","json","write","adminTokenServiceUrl","currentVersion","hasPortal","hasServer","owningSystemUrl","owningTenant","shortLivedTokenValidity","tokenServiceUrl","webTierAuth","R","_","host","P","some","C","D","localStorage","sessionStorage","j","_portalConfig","esriGeowConfig","serverInfos","oAuthInfos","credentials","_soReqs","_xoReqs","_portals","defaultOAuthInfo","defaultTokenValidity","dialog","formConstructor","y","tokenValidity","normalizeWebTierAuth","_appOrigin","origin","location","_appUrlObj","href","_busy","_rejectOnPersistedPageShow","_oAuthHash","_gwTokenUrl","_agsRest","_agsPortal","_agsAdmin","_adminSvcs","_gwDomains","regex","customBaseUrl","_legacyFed","_regexSDirUrl","_regexServerType","_gwUser","_gwItem","_gwGroup","_rePortalTokenSvc","_createDefaultOAuthInfo","_hasTestedIfAppIsOnPortal","_getOAuthHash","addEventListener","_pageShowHandler","registerServers","findServerInfo","forEach","push","registerOAuthInfos","findOAuthInfo","splice","indexOf","registerToken","_sanitizeUrl","_isServerRsrc","O","_getServerInstanceRoot","_getTokenSvcUrl","_findCredential","Object","assign","q","scope","resources","emitTokenChange","refreshServerTokens","map","initialize","length","x","_hasSameServerInstance","findCredential","_getIdenticalSvcIdx","getCredential","prompt","signal","abort","reject","promise","_isAdminResource","resolve","_restInfoPms","_selfReq","f","selfDfd","_getPortalSelf","_enqueue","getResourceName","_isRESTService","generateToken","isAdmin","serverUrl","customParameters","toLowerCase","scheme","uri","port","v","query","request","referer","client","method","authMode","useProxy","_useProxy","ioArgs","withCredentials","then","data","validity","isBusy","checkSignInStatus","checkAppAccess","credential","_doPortalSignIn","force","client_id","valid","viewOnlyUserTypeApp","catch","viewOnly","setOAuthResponseHash","_oAuthDfd","clearInterval","_oAuthIntervalId","_oAuthOnHashHandle","remove","charAt","substring","error_description","sinfo_","oinfo_","access_token","Number","expires_in","persist","setOAuthRedirectionHandler","_oAuthRedirectFunc","setProtocolErrorHandler","_protocolFunc","signIn","U","on","oAuthSignIn","oAuthWin_","closed","resUrl_","oAuthPopupConfirmation","_doOAuthSignIn","destroyCredentials","slice","enablePostMessageAuth","_postMessageAuthHandle","endsWith","source","postMessage","message","disablePostMessageAuth","hash","hasOwnProperty","persisted","_errbackFunc","_addResource","_removeResource","_findOAuthInfo","_isIdProvider","_isPortalDomain","String","_getOrigin","search","substr","_normalizeAGOLorgDomain","proxyUrl","path","_isIdenticalService","_getSuffix","restBaseUrl","adminUrl","_exchangeToken","_getPlatformSelf","headers","Promise","allSSL","portalMode","supportsOAuth","startsWith","_checkProtocol","trim","S","resourceUrl","serverInfo","options_","admin_","refresh_","focus","_doSignIn","creationTime","shift","parent","T","_pendingDfd","oAuthState","user","portalToken","tokenExpiration","parseFloat","_generateOAuthInfo","accountId","redirect_uri","w","urlKey","top","response_type","force_login","prepopulatedusername","redirectToUserOrgUrl","I","setInterval","detail","authorizeParams","authorizeUrl","EventedAccessor","tokenRefreshBuffer","refreshToken","_enqueued","_refreshTimer","_startRefreshTimer","k","A"],"mappings":"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","file":"static/js/209.e78854e7.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as s}from\"../chunks/tslib.es6.js\";import{property as e}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/Logger.js\";import{subclass as t}from\"../core/accessorSupport/decorators/subclass.js\";import{substitute as r}from\"../intl/substitute.js\";import o from\"../widgets/Widget.js\";import{storeNode as i}from\"../widgets/support/widgetUtils.js\";import{messageBundle as n}from\"../widgets/support/decorators/messageBundle.js\";import{tsx as u}from\"../widgets/support/jsxFactory.js\";const a={base:\"esri-identity-form\",group:\"esri-identity-form__group\",label:\"esri-identity-form__label\",footer:\"esri-identity-form__footer\",esriInput:\"esri-input\",esriButton:\"esri-button\",esriButtonSecondary:\"esri-button--secondary\"},l=\"ArcGIS Online\";let p=class extends o{constructor(s,e){super(s,e),this._usernameInputNode=null,this._passwordInputNode=null,this.messages=null,this.signingIn=!1,this.server=null,this.resource=null,this.error=null,this.oAuthPrompt=!1}render(){const{error:s,server:e,resource:t,signingIn:o,oAuthPrompt:n,messages:p}=this,d=u(\"div\",{class:a.group},r(n?p.oAuthInfo:p.info,{server:/\\.arcgis\\.com/i.test(e)?l:e,resource:`(${t||p.lblItem})`})),c=n?null:u(\"div\",{class:a.group,key:\"username\"},u(\"label\",{class:a.label},p.lblUser,u(\"input\",{value:\"\",required:!0,autocomplete:\"off\",spellcheck:!1,type:\"text\",bind:this,afterCreate:i,\"data-node-ref\":\"_usernameInputNode\",class:a.esriInput}))),m=n?null:u(\"div\",{class:a.group,key:\"password\"},u(\"label\",{class:a.label},p.lblPwd,u(\"input\",{value:\"\",required:!0,type:\"password\",bind:this,afterCreate:i,\"data-node-ref\":\"_passwordInputNode\",class:a.esriInput}))),h=u(\"div\",{class:this.classes(a.group,a.footer)},u(\"input\",{type:\"submit\",disabled:!!o,value:o?p.lblSigning:p.lblOk,class:a.esriButton}),u(\"input\",{type:\"button\",value:p.lblCancel,bind:this,onclick:this._cancel,class:this.classes(a.esriButton,a.esriButtonSecondary)})),g=s?u(\"div\",null,s.details&&s.details.httpStatus?p.invalidUser:p.noAuthService):null;return u(\"form\",{class:a.base,bind:this,onsubmit:this._submit},d,g,c,m,h)}_cancel(){this._set(\"signingIn\",!1),this._usernameInputNode&&(this._usernameInputNode.value=\"\"),this._passwordInputNode&&(this._passwordInputNode.value=\"\"),this.emit(\"cancel\")}_submit(s){s.preventDefault(),this._set(\"signingIn\",!0);const e=this.oAuthPrompt?{}:{username:this._usernameInputNode&&this._usernameInputNode.value,password:this._passwordInputNode&&this._passwordInputNode.value};this.emit(\"submit\",e)}};s([e(),n(\"esri/identity/t9n/identity\")],p.prototype,\"messages\",void 0),s([e()],p.prototype,\"signingIn\",void 0),s([e()],p.prototype,\"server\",void 0),s([e()],p.prototype,\"resource\",void 0),s([e()],p.prototype,\"error\",void 0),s([e()],p.prototype,\"oAuthPrompt\",void 0),p=s([t(\"esri.identity.IdentityForm\")],p);var d=p;export{d as default};\n","const candidateSelectors = [\n  'input',\n  'select',\n  'textarea',\n  'a[href]',\n  'button',\n  '[tabindex]',\n  'audio[controls]',\n  'video[controls]',\n  '[contenteditable]:not([contenteditable=\"false\"])',\n  'details>summary:first-of-type',\n  'details',\n];\nconst candidateSelector = /* #__PURE__ */ candidateSelectors.join(',');\n\nconst matches =\n  typeof Element === 'undefined'\n    ? function () {}\n    : Element.prototype.matches ||\n      Element.prototype.msMatchesSelector ||\n      Element.prototype.webkitMatchesSelector;\n\nconst getCandidates = function (el, includeContainer, filter) {\n  let candidates = Array.prototype.slice.apply(\n    el.querySelectorAll(candidateSelector)\n  );\n  if (includeContainer && matches.call(el, candidateSelector)) {\n    candidates.unshift(el);\n  }\n  candidates = candidates.filter(filter);\n  return candidates;\n};\n\nconst isContentEditable = function (node) {\n  return node.contentEditable === 'true';\n};\n\nconst getTabindex = function (node) {\n  const tabindexAttr = parseInt(node.getAttribute('tabindex'), 10);\n\n  if (!isNaN(tabindexAttr)) {\n    return tabindexAttr;\n  }\n\n  // Browsers do not return `tabIndex` correctly for contentEditable nodes;\n  // so if they don't have a tabindex attribute specifically set, assume it's 0.\n  if (isContentEditable(node)) {\n    return 0;\n  }\n\n  // in Chrome, <details/>, <audio controls/> and <video controls/> elements get a default\n  //  `tabIndex` of -1 when the 'tabindex' attribute isn't specified in the DOM,\n  //  yet they are still part of the regular tab order; in FF, they get a default\n  //  `tabIndex` of 0; since Chrome still puts those elements in the regular tab\n  //  order, consider their tab index to be 0.\n  if (\n    (node.nodeName === 'AUDIO' ||\n      node.nodeName === 'VIDEO' ||\n      node.nodeName === 'DETAILS') &&\n    node.getAttribute('tabindex') === null\n  ) {\n    return 0;\n  }\n\n  return node.tabIndex;\n};\n\nconst sortOrderedTabbables = function (a, b) {\n  return a.tabIndex === b.tabIndex\n    ? a.documentOrder - b.documentOrder\n    : a.tabIndex - b.tabIndex;\n};\n\nconst isInput = function (node) {\n  return node.tagName === 'INPUT';\n};\n\nconst isHiddenInput = function (node) {\n  return isInput(node) && node.type === 'hidden';\n};\n\nconst isDetailsWithSummary = function (node) {\n  const r =\n    node.tagName === 'DETAILS' &&\n    Array.prototype.slice\n      .apply(node.children)\n      .some((child) => child.tagName === 'SUMMARY');\n  return r;\n};\n\nconst getCheckedRadio = function (nodes, form) {\n  for (let i = 0; i < nodes.length; i++) {\n    if (nodes[i].checked && nodes[i].form === form) {\n      return nodes[i];\n    }\n  }\n};\n\nconst isTabbableRadio = function (node) {\n  if (!node.name) {\n    return true;\n  }\n  const radioScope = node.form || node.ownerDocument;\n\n  const queryRadios = function (name) {\n    return radioScope.querySelectorAll(\n      'input[type=\"radio\"][name=\"' + name + '\"]'\n    );\n  };\n\n  let radioSet;\n  if (\n    typeof window !== 'undefined' &&\n    typeof window.CSS !== 'undefined' &&\n    typeof window.CSS.escape === 'function'\n  ) {\n    radioSet = queryRadios(window.CSS.escape(node.name));\n  } else {\n    try {\n      radioSet = queryRadios(node.name);\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.error(\n        'Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s',\n        err.message\n      );\n      return false;\n    }\n  }\n\n  const checked = getCheckedRadio(radioSet, node.form);\n  return !checked || checked === node;\n};\n\nconst isRadio = function (node) {\n  return isInput(node) && node.type === 'radio';\n};\n\nconst isNonTabbableRadio = function (node) {\n  return isRadio(node) && !isTabbableRadio(node);\n};\n\nconst isHidden = function (node, displayCheck) {\n  if (getComputedStyle(node).visibility === 'hidden') {\n    return true;\n  }\n\n  const isDirectSummary = matches.call(node, 'details>summary:first-of-type');\n  const nodeUnderDetails = isDirectSummary ? node.parentElement : node;\n  if (matches.call(nodeUnderDetails, 'details:not([open]) *')) {\n    return true;\n  }\n  if (!displayCheck || displayCheck === 'full') {\n    while (node) {\n      if (getComputedStyle(node).display === 'none') {\n        return true;\n      }\n      node = node.parentElement;\n    }\n  } else if (displayCheck === 'non-zero-area') {\n    const { width, height } = node.getBoundingClientRect();\n    return width === 0 && height === 0;\n  }\n\n  return false;\n};\n\n// form fields (nested) inside a disabled fieldset are not focusable/tabbable\n//  unless they are in the _first_ <legend> element of the top-most disabled\n//  fieldset\nconst isDisabledFromFieldset = function (node) {\n  if (\n    isInput(node) ||\n    node.tagName === 'SELECT' ||\n    node.tagName === 'TEXTAREA' ||\n    node.tagName === 'BUTTON'\n  ) {\n    let parentNode = node.parentElement;\n    while (parentNode) {\n      if (parentNode.tagName === 'FIELDSET' && parentNode.disabled) {\n        // look for the first <legend> as an immediate child of the disabled\n        //  <fieldset>: if the node is in that legend, it'll be enabled even\n        //  though the fieldset is disabled; otherwise, the node is in a\n        //  secondary/subsequent legend, or somewhere else within the fieldset\n        //  (however deep nested) and it'll be disabled\n        for (let i = 0; i < parentNode.children.length; i++) {\n          const child = parentNode.children.item(i);\n          if (child.tagName === 'LEGEND') {\n            if (child.contains(node)) {\n              return false;\n            }\n\n            // the node isn't in the first legend (in doc order), so no matter\n            //  where it is now, it'll be disabled\n            return true;\n          }\n        }\n\n        // the node isn't in a legend, so no matter where it is now, it'll be disabled\n        return true;\n      }\n\n      parentNode = parentNode.parentElement;\n    }\n  }\n\n  // else, node's tabbable/focusable state should not be affected by a fieldset's\n  //  enabled/disabled state\n  return false;\n};\n\nconst isNodeMatchingSelectorFocusable = function (options, node) {\n  if (\n    node.disabled ||\n    isHiddenInput(node) ||\n    isHidden(node, options.displayCheck) ||\n    // For a details element with a summary, the summary element gets the focus\n    isDetailsWithSummary(node) ||\n    isDisabledFromFieldset(node)\n  ) {\n    return false;\n  }\n  return true;\n};\n\nconst isNodeMatchingSelectorTabbable = function (options, node) {\n  if (\n    !isNodeMatchingSelectorFocusable(options, node) ||\n    isNonTabbableRadio(node) ||\n    getTabindex(node) < 0\n  ) {\n    return false;\n  }\n  return true;\n};\n\nconst tabbable = function (el, options) {\n  options = options || {};\n\n  const regularTabbables = [];\n  const orderedTabbables = [];\n\n  const candidates = getCandidates(\n    el,\n    options.includeContainer,\n    isNodeMatchingSelectorTabbable.bind(null, options)\n  );\n\n  candidates.forEach(function (candidate, i) {\n    const candidateTabindex = getTabindex(candidate);\n    if (candidateTabindex === 0) {\n      regularTabbables.push(candidate);\n    } else {\n      orderedTabbables.push({\n        documentOrder: i,\n        tabIndex: candidateTabindex,\n        node: candidate,\n      });\n    }\n  });\n\n  const tabbableNodes = orderedTabbables\n    .sort(sortOrderedTabbables)\n    .map((a) => a.node)\n    .concat(regularTabbables);\n\n  return tabbableNodes;\n};\n\nconst focusable = function (el, options) {\n  options = options || {};\n\n  const candidates = getCandidates(\n    el,\n    options.includeContainer,\n    isNodeMatchingSelectorFocusable.bind(null, options)\n  );\n\n  return candidates;\n};\n\nconst isTabbable = function (node, options) {\n  options = options || {};\n  if (!node) {\n    throw new Error('No node provided');\n  }\n  if (matches.call(node, candidateSelector) === false) {\n    return false;\n  }\n  return isNodeMatchingSelectorTabbable(options, node);\n};\n\nconst focusableCandidateSelector = /* #__PURE__ */ candidateSelectors\n  .concat('iframe')\n  .join(',');\n\nconst isFocusable = function (node, options) {\n  options = options || {};\n  if (!node) {\n    throw new Error('No node provided');\n  }\n  if (matches.call(node, focusableCandidateSelector) === false) {\n    return false;\n  }\n  return isNodeMatchingSelectorFocusable(options, node);\n};\n\nexport { tabbable, focusable, isTabbable, isFocusable };\n","import { tabbable, isFocusable } from 'tabbable';\n\nconst activeFocusTraps = (function () {\n  const trapQueue = [];\n  return {\n    activateTrap(trap) {\n      if (trapQueue.length > 0) {\n        const activeTrap = trapQueue[trapQueue.length - 1];\n        if (activeTrap !== trap) {\n          activeTrap.pause();\n        }\n      }\n\n      const trapIndex = trapQueue.indexOf(trap);\n      if (trapIndex === -1) {\n        trapQueue.push(trap);\n      } else {\n        // move this existing trap to the front of the queue\n        trapQueue.splice(trapIndex, 1);\n        trapQueue.push(trap);\n      }\n    },\n\n    deactivateTrap(trap) {\n      const trapIndex = trapQueue.indexOf(trap);\n      if (trapIndex !== -1) {\n        trapQueue.splice(trapIndex, 1);\n      }\n\n      if (trapQueue.length > 0) {\n        trapQueue[trapQueue.length - 1].unpause();\n      }\n    },\n  };\n})();\n\nconst isSelectableInput = function (node) {\n  return (\n    node.tagName &&\n    node.tagName.toLowerCase() === 'input' &&\n    typeof node.select === 'function'\n  );\n};\n\nconst isEscapeEvent = function (e) {\n  return e.key === 'Escape' || e.key === 'Esc' || e.keyCode === 27;\n};\n\nconst isTabEvent = function (e) {\n  return e.key === 'Tab' || e.keyCode === 9;\n};\n\nconst delay = function (fn) {\n  return setTimeout(fn, 0);\n};\n\n// Array.find/findIndex() are not supported on IE; this replicates enough\n//  of Array.findIndex() for our needs\nconst findIndex = function (arr, fn) {\n  let idx = -1;\n\n  arr.every(function (value, i) {\n    if (fn(value)) {\n      idx = i;\n      return false; // break\n    }\n\n    return true; // next\n  });\n\n  return idx;\n};\n\n/**\n * Get an option's value when it could be a plain value, or a handler that provides\n *  the value.\n * @param {*} value Option's value to check.\n * @param {...*} [params] Any parameters to pass to the handler, if `value` is a function.\n * @returns {*} The `value`, or the handler's returned value.\n */\nconst valueOrHandler = function (value, ...params) {\n  return typeof value === 'function' ? value(...params) : value;\n};\n\nconst createFocusTrap = function (elements, userOptions) {\n  const doc = document;\n\n  const config = {\n    returnFocusOnDeactivate: true,\n    escapeDeactivates: true,\n    delayInitialFocus: true,\n    ...userOptions,\n  };\n\n  const state = {\n    // @type {Array<HTMLElement>}\n    containers: [],\n\n    // list of objects identifying the first and last tabbable nodes in all containers/groups in\n    //  the trap\n    // NOTE: it's possible that a group has no tabbable nodes if nodes get removed while the trap\n    //  is active, but the trap should never get to a state where there isn't at least one group\n    //  with at least one tabbable node in it (that would lead to an error condition that would\n    //  result in an error being thrown)\n    // @type {Array<{ container: HTMLElement, firstTabbableNode: HTMLElement|null, lastTabbableNode: HTMLElement|null }>}\n    tabbableGroups: [],\n\n    nodeFocusedBeforeActivation: null,\n    mostRecentlyFocusedNode: null,\n    active: false,\n    paused: false,\n\n    // timer ID for when delayInitialFocus is true and initial focus in this trap\n    //  has been delayed during activation\n    delayInitialFocusTimer: undefined,\n  };\n\n  let trap; // eslint-disable-line prefer-const -- some private functions reference it, and its methods reference private functions, so we must declare here and define later\n\n  const getOption = (configOverrideOptions, optionName, configOptionName) => {\n    return configOverrideOptions &&\n      configOverrideOptions[optionName] !== undefined\n      ? configOverrideOptions[optionName]\n      : config[configOptionName || optionName];\n  };\n\n  const containersContain = function (element) {\n    return state.containers.some((container) => container.contains(element));\n  };\n\n  const getNodeForOption = function (optionName) {\n    const optionValue = config[optionName];\n    if (!optionValue) {\n      return null;\n    }\n\n    let node = optionValue;\n\n    if (typeof optionValue === 'string') {\n      node = doc.querySelector(optionValue);\n      if (!node) {\n        throw new Error(`\\`${optionName}\\` refers to no known node`);\n      }\n    }\n\n    if (typeof optionValue === 'function') {\n      node = optionValue();\n      if (!node) {\n        throw new Error(`\\`${optionName}\\` did not return a node`);\n      }\n    }\n\n    return node;\n  };\n\n  const getInitialFocusNode = function () {\n    let node;\n\n    // false indicates we want no initialFocus at all\n    if (getOption({}, 'initialFocus') === false) {\n      return false;\n    }\n\n    if (getNodeForOption('initialFocus') !== null) {\n      node = getNodeForOption('initialFocus');\n    } else if (containersContain(doc.activeElement)) {\n      node = doc.activeElement;\n    } else {\n      const firstTabbableGroup = state.tabbableGroups[0];\n      const firstTabbableNode =\n        firstTabbableGroup && firstTabbableGroup.firstTabbableNode;\n      node = firstTabbableNode || getNodeForOption('fallbackFocus');\n    }\n\n    if (!node) {\n      throw new Error(\n        'Your focus-trap needs to have at least one focusable element'\n      );\n    }\n\n    return node;\n  };\n\n  const updateTabbableNodes = function () {\n    state.tabbableGroups = state.containers\n      .map((container) => {\n        const tabbableNodes = tabbable(container);\n\n        if (tabbableNodes.length > 0) {\n          return {\n            container,\n            firstTabbableNode: tabbableNodes[0],\n            lastTabbableNode: tabbableNodes[tabbableNodes.length - 1],\n          };\n        }\n\n        return undefined;\n      })\n      .filter((group) => !!group); // remove groups with no tabbable nodes\n\n    // throw if no groups have tabbable nodes and we don't have a fallback focus node either\n    if (\n      state.tabbableGroups.length <= 0 &&\n      !getNodeForOption('fallbackFocus')\n    ) {\n      throw new Error(\n        'Your focus-trap must have at least one container with at least one tabbable node in it at all times'\n      );\n    }\n  };\n\n  const tryFocus = function (node) {\n    if (node === false) {\n      return;\n    }\n\n    if (node === doc.activeElement) {\n      return;\n    }\n\n    if (!node || !node.focus) {\n      tryFocus(getInitialFocusNode());\n      return;\n    }\n\n    node.focus({ preventScroll: !!config.preventScroll });\n    state.mostRecentlyFocusedNode = node;\n\n    if (isSelectableInput(node)) {\n      node.select();\n    }\n  };\n\n  const getReturnFocusNode = function (previousActiveElement) {\n    const node = getNodeForOption('setReturnFocus');\n\n    return node ? node : previousActiveElement;\n  };\n\n  // This needs to be done on mousedown and touchstart instead of click\n  // so that it precedes the focus event.\n  const checkPointerDown = function (e) {\n    if (containersContain(e.target)) {\n      // allow the click since it ocurred inside the trap\n      return;\n    }\n\n    if (valueOrHandler(config.clickOutsideDeactivates, e)) {\n      // immediately deactivate the trap\n      trap.deactivate({\n        // if, on deactivation, we should return focus to the node originally-focused\n        //  when the trap was activated (or the configured `setReturnFocus` node),\n        //  then assume it's also OK to return focus to the outside node that was\n        //  just clicked, causing deactivation, as long as that node is focusable;\n        //  if it isn't focusable, then return focus to the original node focused\n        //  on activation (or the configured `setReturnFocus` node)\n        // NOTE: by setting `returnFocus: false`, deactivate() will do nothing,\n        //  which will result in the outside click setting focus to the node\n        //  that was clicked, whether it's focusable or not; by setting\n        //  `returnFocus: true`, we'll attempt to re-focus the node originally-focused\n        //  on activation (or the configured `setReturnFocus` node)\n        returnFocus: config.returnFocusOnDeactivate && !isFocusable(e.target),\n      });\n      return;\n    }\n\n    // This is needed for mobile devices.\n    // (If we'll only let `click` events through,\n    // then on mobile they will be blocked anyways if `touchstart` is blocked.)\n    if (valueOrHandler(config.allowOutsideClick, e)) {\n      // allow the click outside the trap to take place\n      return;\n    }\n\n    // otherwise, prevent the click\n    e.preventDefault();\n  };\n\n  // In case focus escapes the trap for some strange reason, pull it back in.\n  const checkFocusIn = function (e) {\n    const targetContained = containersContain(e.target);\n    // In Firefox when you Tab out of an iframe the Document is briefly focused.\n    if (targetContained || e.target instanceof Document) {\n      if (targetContained) {\n        state.mostRecentlyFocusedNode = e.target;\n      }\n    } else {\n      // escaped! pull it back in to where it just left\n      e.stopImmediatePropagation();\n      tryFocus(state.mostRecentlyFocusedNode || getInitialFocusNode());\n    }\n  };\n\n  // Hijack Tab events on the first and last focusable nodes of the trap,\n  // in order to prevent focus from escaping. If it escapes for even a\n  // moment it can end up scrolling the page and causing confusion so we\n  // kind of need to capture the action at the keydown phase.\n  const checkTab = function (e) {\n    updateTabbableNodes();\n\n    let destinationNode = null;\n\n    if (state.tabbableGroups.length > 0) {\n      // make sure the target is actually contained in a group\n      // NOTE: the target may also be the container itself if it's tabbable\n      //  with tabIndex='-1' and was given initial focus\n      const containerIndex = findIndex(state.tabbableGroups, ({ container }) =>\n        container.contains(e.target)\n      );\n\n      if (containerIndex < 0) {\n        // target not found in any group: quite possible focus has escaped the trap,\n        //  so bring it back in to...\n        if (e.shiftKey) {\n          // ...the last node in the last group\n          destinationNode =\n            state.tabbableGroups[state.tabbableGroups.length - 1]\n              .lastTabbableNode;\n        } else {\n          // ...the first node in the first group\n          destinationNode = state.tabbableGroups[0].firstTabbableNode;\n        }\n      } else if (e.shiftKey) {\n        // REVERSE\n\n        // is the target the first tabbable node in a group?\n        let startOfGroupIndex = findIndex(\n          state.tabbableGroups,\n          ({ firstTabbableNode }) => e.target === firstTabbableNode\n        );\n\n        if (\n          startOfGroupIndex < 0 &&\n          state.tabbableGroups[containerIndex].container === e.target\n        ) {\n          // an exception case where the target is the container itself, in which\n          //  case, we should handle shift+tab as if focus were on the container's\n          //  first tabbable node, and go to the last tabbable node of the LAST group\n          startOfGroupIndex = containerIndex;\n        }\n\n        if (startOfGroupIndex >= 0) {\n          // YES: then shift+tab should go to the last tabbable node in the\n          //  previous group (and wrap around to the last tabbable node of\n          //  the LAST group if it's the first tabbable node of the FIRST group)\n          const destinationGroupIndex =\n            startOfGroupIndex === 0\n              ? state.tabbableGroups.length - 1\n              : startOfGroupIndex - 1;\n\n          const destinationGroup = state.tabbableGroups[destinationGroupIndex];\n          destinationNode = destinationGroup.lastTabbableNode;\n        }\n      } else {\n        // FORWARD\n\n        // is the target the last tabbable node in a group?\n        let lastOfGroupIndex = findIndex(\n          state.tabbableGroups,\n          ({ lastTabbableNode }) => e.target === lastTabbableNode\n        );\n\n        if (\n          lastOfGroupIndex < 0 &&\n          state.tabbableGroups[containerIndex].container === e.target\n        ) {\n          // an exception case where the target is the container itself, in which\n          //  case, we should handle tab as if focus were on the container's\n          //  last tabbable node, and go to the first tabbable node of the FIRST group\n          lastOfGroupIndex = containerIndex;\n        }\n\n        if (lastOfGroupIndex >= 0) {\n          // YES: then tab should go to the first tabbable node in the next\n          //  group (and wrap around to the first tabbable node of the FIRST\n          //  group if it's the last tabbable node of the LAST group)\n          const destinationGroupIndex =\n            lastOfGroupIndex === state.tabbableGroups.length - 1\n              ? 0\n              : lastOfGroupIndex + 1;\n\n          const destinationGroup = state.tabbableGroups[destinationGroupIndex];\n          destinationNode = destinationGroup.firstTabbableNode;\n        }\n      }\n    } else {\n      destinationNode = getNodeForOption('fallbackFocus');\n    }\n\n    if (destinationNode) {\n      e.preventDefault();\n      tryFocus(destinationNode);\n    }\n    // else, let the browser take care of [shift+]tab and move the focus\n  };\n\n  const checkKey = function (e) {\n    if (\n      isEscapeEvent(e) &&\n      valueOrHandler(config.escapeDeactivates) !== false\n    ) {\n      e.preventDefault();\n      trap.deactivate();\n      return;\n    }\n\n    if (isTabEvent(e)) {\n      checkTab(e);\n      return;\n    }\n  };\n\n  const checkClick = function (e) {\n    if (valueOrHandler(config.clickOutsideDeactivates, e)) {\n      return;\n    }\n\n    if (containersContain(e.target)) {\n      return;\n    }\n\n    if (valueOrHandler(config.allowOutsideClick, e)) {\n      return;\n    }\n\n    e.preventDefault();\n    e.stopImmediatePropagation();\n  };\n\n  //\n  // EVENT LISTENERS\n  //\n\n  const addListeners = function () {\n    if (!state.active) {\n      return;\n    }\n\n    // There can be only one listening focus trap at a time\n    activeFocusTraps.activateTrap(trap);\n\n    // Delay ensures that the focused element doesn't capture the event\n    // that caused the focus trap activation.\n    state.delayInitialFocusTimer = config.delayInitialFocus\n      ? delay(function () {\n          tryFocus(getInitialFocusNode());\n        })\n      : tryFocus(getInitialFocusNode());\n\n    doc.addEventListener('focusin', checkFocusIn, true);\n    doc.addEventListener('mousedown', checkPointerDown, {\n      capture: true,\n      passive: false,\n    });\n    doc.addEventListener('touchstart', checkPointerDown, {\n      capture: true,\n      passive: false,\n    });\n    doc.addEventListener('click', checkClick, {\n      capture: true,\n      passive: false,\n    });\n    doc.addEventListener('keydown', checkKey, {\n      capture: true,\n      passive: false,\n    });\n\n    return trap;\n  };\n\n  const removeListeners = function () {\n    if (!state.active) {\n      return;\n    }\n\n    doc.removeEventListener('focusin', checkFocusIn, true);\n    doc.removeEventListener('mousedown', checkPointerDown, true);\n    doc.removeEventListener('touchstart', checkPointerDown, true);\n    doc.removeEventListener('click', checkClick, true);\n    doc.removeEventListener('keydown', checkKey, true);\n\n    return trap;\n  };\n\n  //\n  // TRAP DEFINITION\n  //\n\n  trap = {\n    activate(activateOptions) {\n      if (state.active) {\n        return this;\n      }\n\n      const onActivate = getOption(activateOptions, 'onActivate');\n      const onPostActivate = getOption(activateOptions, 'onPostActivate');\n      const checkCanFocusTrap = getOption(activateOptions, 'checkCanFocusTrap');\n\n      if (!checkCanFocusTrap) {\n        updateTabbableNodes();\n      }\n\n      state.active = true;\n      state.paused = false;\n      state.nodeFocusedBeforeActivation = doc.activeElement;\n\n      if (onActivate) {\n        onActivate();\n      }\n\n      const finishActivation = () => {\n        if (checkCanFocusTrap) {\n          updateTabbableNodes();\n        }\n        addListeners();\n        if (onPostActivate) {\n          onPostActivate();\n        }\n      };\n\n      if (checkCanFocusTrap) {\n        checkCanFocusTrap(state.containers.concat()).then(\n          finishActivation,\n          finishActivation\n        );\n        return this;\n      }\n\n      finishActivation();\n      return this;\n    },\n\n    deactivate(deactivateOptions) {\n      if (!state.active) {\n        return this;\n      }\n\n      clearTimeout(state.delayInitialFocusTimer); // noop if undefined\n      state.delayInitialFocusTimer = undefined;\n\n      removeListeners();\n      state.active = false;\n      state.paused = false;\n\n      activeFocusTraps.deactivateTrap(trap);\n\n      const onDeactivate = getOption(deactivateOptions, 'onDeactivate');\n      const onPostDeactivate = getOption(deactivateOptions, 'onPostDeactivate');\n      const checkCanReturnFocus = getOption(\n        deactivateOptions,\n        'checkCanReturnFocus'\n      );\n\n      if (onDeactivate) {\n        onDeactivate();\n      }\n\n      const returnFocus = getOption(\n        deactivateOptions,\n        'returnFocus',\n        'returnFocusOnDeactivate'\n      );\n\n      const finishDeactivation = () => {\n        delay(() => {\n          if (returnFocus) {\n            tryFocus(getReturnFocusNode(state.nodeFocusedBeforeActivation));\n          }\n          if (onPostDeactivate) {\n            onPostDeactivate();\n          }\n        });\n      };\n\n      if (returnFocus && checkCanReturnFocus) {\n        checkCanReturnFocus(\n          getReturnFocusNode(state.nodeFocusedBeforeActivation)\n        ).then(finishDeactivation, finishDeactivation);\n        return this;\n      }\n\n      finishDeactivation();\n      return this;\n    },\n\n    pause() {\n      if (state.paused || !state.active) {\n        return this;\n      }\n\n      state.paused = true;\n      removeListeners();\n\n      return this;\n    },\n\n    unpause() {\n      if (!state.paused || !state.active) {\n        return this;\n      }\n\n      state.paused = false;\n      updateTabbableNodes();\n      addListeners();\n\n      return this;\n    },\n\n    updateContainerElements(containerElements) {\n      const elementsAsArray = [].concat(containerElements).filter(Boolean);\n\n      state.containers = elementsAsArray.map((element) =>\n        typeof element === 'string' ? doc.querySelector(element) : element\n      );\n\n      if (state.active) {\n        updateTabbableNodes();\n      }\n\n      return this;\n    },\n  };\n\n  // initialize container elements\n  trap.updateContainerElements(elements);\n\n  return trap;\n};\n\nexport { createFocusTrap };\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../chunks/tslib.es6.js\";import{makeHandle as e}from\"../core/handleUtils.js\";import{property as o}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/Logger.js\";import{subclass as s}from\"../core/accessorSupport/decorators/subclass.js\";import i from\"../widgets/Widget.js\";import{isWidget as r}from\"../widgets/support/widget.js\";import{createFocusTrap as n}from\"focus-trap\";import{messageBundle as a}from\"../widgets/support/decorators/messageBundle.js\";import{tsx as c}from\"../widgets/support/jsxFactory.js\";const d={base:\"esri-identity-modal\",open:\"esri-identity-modal--open\",closed:\"esri-identity-modal--closed\",title:\"esri-identity-modal__title\",dialog:\"esri-identity-modal__dialog\",content:\"esri-identity-modal__content\",closeButton:\"esri-identity-modal__close-button\",iconClose:\"esri-icon-close\"};let l=class extends i{constructor(t,e){super(t,e),this.container=document.createElement(\"div\"),this.content=null,this.open=!1,this._close=()=>{this.open=!1},document.body.appendChild(this.container),this.own(this.watch(\"open\",(()=>this._toggleFocusTrap())))}destroy(){this._destroyFocusTrap()}render(){const t=this.id,{open:e,content:o,title:s,messages:i}=this,r=e&&!!o,n={[d.open]:r,[d.closed]:!r},a=c(\"button\",{class:d.closeButton,\"aria-label\":i.close,title:i.close,bind:this,onclick:this._close},c(\"span\",{\"aria-hidden\":\"true\",class:d.iconClose})),l=`${t}_title`,p=`${t}_content`,u=s?c(\"h1\",{id:l,class:d.title},s):null,m=r?c(\"div\",{bind:this,class:d.dialog,role:\"dialog\",\"aria-labelledby\":l,\"aria-describedby\":p,afterCreate:this._createFocusTrap},a,u,this._renderContent(p)):null;return c(\"div\",{tabIndex:-1,class:this.classes(d.base,n)},m)}_destroyFocusTrap(){var t;null==(t=this._focusTrap)||t.deactivate({onDeactivate:null}),this._focusTrap=null}_toggleFocusTrap(){const{_focusTrap:t,open:e}=this;t&&(e?t.activate():t.deactivate())}_createFocusTrap(t){this._destroyFocusTrap();const o=requestAnimationFrame((()=>{this._focusTrap=n(t,{initialFocus:\"input\",onDeactivate:this._close}),this._toggleFocusTrap()}));this.own(e((()=>cancelAnimationFrame(o))))}_renderContent(t){const e=this.content;return\"string\"==typeof e?c(\"div\",{class:d.content,id:t,innerHTML:e}):r(e)?c(\"div\",{class:d.content,id:t},e.render()):e instanceof HTMLElement?c(\"div\",{class:d.content,id:t,bind:e,afterCreate:this._attachToNode}):null}_attachToNode(t){const e=this;t.appendChild(e)}};t([o({readOnly:!0})],l.prototype,\"container\",void 0),t([o()],l.prototype,\"content\",void 0),t([o()],l.prototype,\"open\",void 0),t([o(),a(\"esri/t9n/common\")],l.prototype,\"messages\",void 0),t([o({aliasOf:\"messages.auth.signIn\"})],l.prototype,\"title\",void 0),l=t([s(\"esri.identity.IdentityModal\")],l);var p=l;export{p as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nconst t=\"esriJSAPIOAuth\";class s{constructor(t,s){this.oAuthInfo=null,this.storage=null,this.appId=null,this.expires=null,this.ssl=null,this.token=null,this.userId=null,this.oAuthInfo=t,this.storage=s,this._init()}isValid(){let t=!1;if(this.oAuthInfo&&this.token&&this.userId){const s=Date.now();if(this.expires>s){(this.expires-s)/1e3>60*this.oAuthInfo.minTimeUntilExpiration&&(t=!0)}}return t}save(){if(!this.storage)return;const s=this._load(),e=this.oAuthInfo;if(e&&e.authNamespace&&e.portalUrl){let o=s[e.authNamespace];o||(o=s[e.authNamespace]={}),o[e.portalUrl]={appId:this.appId=e.appId,expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem(t,JSON.stringify(s))}catch(i){console.log(i)}}}destroy(){const s=this._load(),e=this.oAuthInfo;if(e&&e.appId&&e.portalUrl&&this.token&&this.expires>Date.now()){const t=e.portalUrl.replace(/^http:/i,\"https:\")+\"/sharing/rest/oauth2/revokeToken\",s=new FormData;if(s.append(\"f\",\"json\"),s.append(\"auth_token\",this.token),s.append(\"client_id\",e.appId),s.append(\"token_type_hint\",\"access_token\"),\"function\"==typeof navigator.sendBeacon)navigator.sendBeacon(t,s);else{const e=new XMLHttpRequest;e.open(\"POST\",t),e.send(s)}}if(e&&e.authNamespace&&e.portalUrl&&this.storage){const o=s[e.authNamespace];if(o){delete o[e.portalUrl];try{this.storage.setItem(t,JSON.stringify(s))}catch(i){console.log(i)}}}e&&(e._oAuthCred=null,this.oAuthInfo=null)}_init(){const t=this._load(),s=this.oAuthInfo;if(s&&s.authNamespace&&s.portalUrl){let e=t[s.authNamespace];e&&(e=e[s.portalUrl],e&&(this.appId=e.appId,this.expires=e.expires,this.ssl=e.ssl,this.token=e.token,this.userId=e.userId))}}_load(){let s={};if(this.storage){const i=this.storage.getItem(t);if(i)try{s=JSON.parse(i)}catch(e){console.log(e)}}return s}}s.prototype.declaredClass=\"esri.identity.OAuthCredential\";export{s as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../chunks/tslib.es6.js\";import{JSONSupport as t}from\"../core/JSONSupport.js\";import{property as r}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/Logger.js\";import{subclass as e}from\"../core/accessorSupport/decorators/subclass.js\";var p;let s=p=class extends t{constructor(o){super(o),this._oAuthCred=null,this.appId=null,this.authNamespace=\"/\",this.expiration=20160,this.forceLogin=!1,this.forceUserId=!1,this.locale=null,this.minTimeUntilExpiration=30,this.popup=!1,this.popupCallbackUrl=\"oauth-callback.html\",this.popupWindowFeatures=\"height=490,width=800,resizable,scrollbars,status\",this.portalUrl=\"https://www.arcgis.com\",this.preserveUrlHash=!1,this.userId=null}clone(){return p.fromJSON(this.toJSON())}};o([r({json:{write:!0}})],s.prototype,\"appId\",void 0),o([r({json:{write:!0}})],s.prototype,\"authNamespace\",void 0),o([r({json:{write:!0}})],s.prototype,\"expiration\",void 0),o([r({json:{write:!0}})],s.prototype,\"forceLogin\",void 0),o([r({json:{write:!0}})],s.prototype,\"forceUserId\",void 0),o([r({json:{write:!0}})],s.prototype,\"locale\",void 0),o([r({json:{write:!0}})],s.prototype,\"minTimeUntilExpiration\",void 0),o([r({json:{write:!0}})],s.prototype,\"popup\",void 0),o([r({json:{write:!0}})],s.prototype,\"popupCallbackUrl\",void 0),o([r({json:{write:!0}})],s.prototype,\"popupWindowFeatures\",void 0),o([r({json:{write:!0}})],s.prototype,\"portalUrl\",void 0),o([r({json:{write:!0}})],s.prototype,\"preserveUrlHash\",void 0),o([r({json:{write:!0}})],s.prototype,\"userId\",void 0),s=p=o([e(\"esri.identity.OAuthInfo\")],s);var i=s;export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../chunks/tslib.es6.js\";import{JSONSupport as r}from\"../core/JSONSupport.js\";import{property as e}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/Logger.js\";import{subclass as t}from\"../core/accessorSupport/decorators/subclass.js\";let s=class extends r{constructor(o){super(o),this.adminTokenServiceUrl=null,this.currentVersion=null,this.hasPortal=null,this.hasServer=null,this.owningSystemUrl=null,this.owningTenant=null,this.server=null,this.shortLivedTokenValidity=null,this.tokenServiceUrl=null,this.webTierAuth=null}};o([e({json:{write:!0}})],s.prototype,\"adminTokenServiceUrl\",void 0),o([e({json:{write:!0}})],s.prototype,\"currentVersion\",void 0),o([e({json:{write:!0}})],s.prototype,\"hasPortal\",void 0),o([e({json:{write:!0}})],s.prototype,\"hasServer\",void 0),o([e({json:{write:!0}})],s.prototype,\"owningSystemUrl\",void 0),o([e({json:{write:!0}})],s.prototype,\"owningTenant\",void 0),o([e({json:{write:!0}})],s.prototype,\"server\",void 0),o([e({json:{write:!0}})],s.prototype,\"shortLivedTokenValidity\",void 0),o([e({json:{write:!0}})],s.prototype,\"tokenServiceUrl\",void 0),o([e({json:{write:!0}})],s.prototype,\"webTierAuth\",void 0),s=o([t(\"esri.identity.ServerInfo\")],s);var i=s;export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import t from\"../config.js\";import{id as s}from\"../kernel.js\";import r from\"../request.js\";import i from\"../core/Error.js\";import n from\"../core/Evented.js\";import{on as o}from\"../core/events.js\";import a from\"../core/global.js\";import{fixJson as h}from\"../core/lang.js\";import{getDeepValue as l}from\"../core/object.js\";import{createAbortController as c,createResolver as d,onAbort as u,isAborted as p}from\"../core/promiseUtils.js\";import{Url as _,urlToObject as g,hasSameOrigin as f,queryToObject as m,normalize as v,getProxyRule as S,makeAbsolute as w,objectToQuery as I}from\"../core/urlUtils.js\";import{property as k}from\"../core/accessorSupport/decorators/property.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/has.js\";import\"../core/Logger.js\";import{subclass as A}from\"../core/accessorSupport/decorators/subclass.js\";import y from\"./IdentityForm.js\";import U from\"./IdentityModal.js\";import T from\"./OAuthCredential.js\";import x from\"./OAuthInfo.js\";import O from\"./ServerInfo.js\";const R={},b=e=>{const t=new _(e.owningSystemUrl).host,s=new _(e.server).host,r=/.+\\.arcgis\\.com$/i;return r.test(t)&&r.test(s)},P=(e,t)=>!!(b(e)&&t&&t.some((t=>t.test(e.server))));let C=null,D=null;try{C=window.localStorage,D=window.sessionStorage}catch{}class j extends n{constructor(){super(),this._portalConfig=a.esriGeowConfig,this.serverInfos=[],this.oAuthInfos=[],this.credentials=[],this._soReqs=[],this._xoReqs=[],this._portals=[],this.defaultOAuthInfo=null,this.defaultTokenValidity=60,this.dialog=null,this.formConstructor=y,this.tokenValidity=null,this.normalizeWebTierAuth=!1,this._appOrigin=\"null\"!==window.origin?window.origin:window.location.origin,this._appUrlObj=g(window.location.href),this._busy=null,this._rejectOnPersistedPageShow=!1,this._oAuthHash=null,this._gwTokenUrl=\"/sharing/rest/generateToken\",this._agsRest=\"/rest/services\",this._agsPortal=/\\/sharing(\\/|$)/i,this._agsAdmin=/(https?:\\/\\/[^\\/]+\\/[^\\/]+)\\/admin\\/?(\\/.*)?$/i,this._adminSvcs=/\\/rest\\/admin\\/services(\\/|$)/i,this._gwDomains=[{regex:/^https?:\\/\\/www\\.arcgis\\.com/i,customBaseUrl:\"maps.arcgis.com\",tokenServiceUrl:\"https://www.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/(?:dev|[a-z\\d-]+\\.mapsdev)\\.arcgis\\.com/i,customBaseUrl:\"mapsdev.arcgis.com\",tokenServiceUrl:\"https://dev.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/(?:devext|[a-z\\d-]+\\.mapsdevext)\\.arcgis\\.com/i,customBaseUrl:\"mapsdevext.arcgis.com\",tokenServiceUrl:\"https://devext.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/(?:qaext|[a-z\\d-]+\\.mapsqa)\\.arcgis\\.com/i,customBaseUrl:\"mapsqa.arcgis.com\",tokenServiceUrl:\"https://qaext.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/[a-z\\d-]+\\.maps\\.arcgis\\.com/i,customBaseUrl:\"maps.arcgis.com\",tokenServiceUrl:\"https://www.arcgis.com/sharing/rest/generateToken\"}],this._legacyFed=[],this._regexSDirUrl=/http.+\\/rest\\/services\\/?/gi,this._regexServerType=/(\\/(FeatureServer|GPServer|GeoDataServer|GeocodeServer|GeoenrichmentServer|GeometryServer|GlobeServer|ImageServer|MapServer|MobileServer|NAServer|NetworkDiagramServer|OGCFeatureServer|ParcelFabricServer|RelationalCatalogServer|SceneServer|StreamServer|UtilityNetworkServer|ValidationServer|VectorTileServer|VersionManagementServer)).*/gi,this._gwUser=/http.+\\/users\\/([^\\/]+)\\/?.*/i,this._gwItem=/http.+\\/items\\/([^\\/]+)\\/?.*/i,this._gwGroup=/http.+\\/groups\\/([^\\/]+)\\/?.*/i,this._rePortalTokenSvc=/\\/sharing(\\/rest)?\\/generatetoken/i,this._createDefaultOAuthInfo=!0,this._hasTestedIfAppIsOnPortal=!1,this._getOAuthHash(),window.addEventListener(\"pageshow\",(e=>{this._pageShowHandler(e)}))}registerServers(e){const t=this.serverInfos;t?(e=e.filter((e=>!this.findServerInfo(e.server))),this.serverInfos=t.concat(e)):this.serverInfos=e,e.forEach((e=>{e.owningSystemUrl&&this._portals.push(e.owningSystemUrl),e.hasPortal&&this._portals.push(e.server)}))}registerOAuthInfos(e){const t=this.oAuthInfos;if(t){for(const s of e){const e=this.findOAuthInfo(s.portalUrl);e&&t.splice(t.indexOf(e),1)}this.oAuthInfos=t.concat(e)}else this.oAuthInfos=e}registerToken(e){e={...e};const t=this._sanitizeUrl(e.server),s=this._isServerRsrc(t);let r,i=this.findServerInfo(t),n=!0;i||(i=new O,i.server=this._getServerInstanceRoot(t),s?i.hasServer=!0:(i.tokenServiceUrl=this._getTokenSvcUrl(t),i.hasPortal=!0),this.registerServers([i])),r=this._findCredential(t),r?(delete e.server,Object.assign(r,e),n=!1):(r=new q({userId:e.userId,server:i.server,token:e.token,expires:e.expires,ssl:e.ssl,scope:s?\"server\":\"portal\"}),r.resources=[t],this.credentials.push(r)),r.emitTokenChange(!1),n||r.refreshServerTokens()}toJSON(){return h({serverInfos:this.serverInfos.map((e=>e.toJSON())),oAuthInfos:this.oAuthInfos.map((e=>e.toJSON())),credentials:this.credentials.map((e=>e.toJSON()))})}initialize(e){if(!e)return;\"string\"==typeof e&&(e=JSON.parse(e));const t=e.serverInfos,s=e.oAuthInfos,r=e.credentials;if(t){const e=[];t.forEach((t=>{t.server&&t.tokenServiceUrl&&e.push(t.declaredClass?t:new O(t))})),e.length&&this.registerServers(e)}if(s){const e=[];s.forEach((t=>{t.appId&&e.push(t.declaredClass?t:new x(t))})),e.length&&this.registerOAuthInfos(e)}r&&r.forEach((e=>{e.server&&e.token&&e.expires&&e.expires>Date.now()&&((e=e.declaredClass?e:new q(e)).emitTokenChange(),this.credentials.push(e))}))}findServerInfo(e){let t;e=this._sanitizeUrl(e);for(const s of this.serverInfos)if(this._hasSameServerInstance(s.server,e)){t=s;break}return t}findOAuthInfo(e){let t;e=this._sanitizeUrl(e);for(const s of this.oAuthInfos)if(this._hasSameServerInstance(s.portalUrl,e)){t=s;break}return t}findCredential(e,t){let s;e=this._sanitizeUrl(e);const r=this._isServerRsrc(e)?\"server\":\"portal\";if(t){for(const i of this.credentials)if(this._hasSameServerInstance(i.server,e)&&t===i.userId&&i.scope===r){s=i;break}}else for(const i of this.credentials)if(this._hasSameServerInstance(i.server,e)&&-1!==this._getIdenticalSvcIdx(e,i)&&i.scope===r){s=i;break}return s}getCredential(e,t){let s,r,n=!0;t&&(s=!!t.token,r=t.error,n=!1!==t.prompt),t={...t},e=this._sanitizeUrl(e);const o=c(),a=d();if(t.signal&&u(t.signal,(()=>{o.abort()})),u(o,(()=>{a.reject(new i(\"identity-manager:user-aborted\",\"ABORTED\"))})),p(o))return a.promise;t.signal=o.signal;const h=this._isAdminResource(e),l=s?this.findCredential(e):null;let _;if(l&&r&&r.details&&498===r.details.httpStatus)l.destroy();else if(l)return _=new i(\"identity-manager:not-authorized\",\"You are currently signed in as: '\"+l.userId+\"'. You do not have access to this resource: \"+e,{error:r}),a.reject(_),a.promise;const g=this._findCredential(e,t);if(g)return a.resolve(g),a.promise;let m=this.findServerInfo(e);if(m)!m.hasServer&&this._isServerRsrc(e)&&(m._restInfoPms=this._getTokenSvcUrl(e),m.hasServer=!0);else{const t=this._getTokenSvcUrl(e);if(!t)return _=new i(\"identity-manager:unknown-resource\",\"Unknown resource - could not find token service endpoint.\"),a.reject(_),a.promise;m=new O,m.server=this._getServerInstanceRoot(e),\"string\"==typeof t?(m.tokenServiceUrl=t,m.hasPortal=!0):(m._restInfoPms=t,m.hasServer=!0),this.registerServers([m])}return m.hasPortal&&void 0===m._selfReq&&(n||f(m.tokenServiceUrl,this._appOrigin)||this._gwDomains.some((e=>e.tokenServiceUrl===m.tokenServiceUrl)))&&(m._selfReq={owningTenant:t&&t.owningTenant,selfDfd:this._getPortalSelf(m.tokenServiceUrl.replace(this._rePortalTokenSvc,\"/sharing/rest/portals/self\"),e)}),this._enqueue(e,m,t,a,h)}getResourceName(e){return this._isRESTService(e)?e.replace(this._regexSDirUrl,\"\").replace(this._regexServerType,\"\")||\"\":this._gwUser.test(e)&&e.replace(this._gwUser,\"$1\")||this._gwItem.test(e)&&e.replace(this._gwItem,\"$1\")||this._gwGroup.test(e)&&e.replace(this._gwGroup,\"$1\")||\"\"}generateToken(e,t,s){const n=this._rePortalTokenSvc.test(e.tokenServiceUrl),o=new _(this._appOrigin),a=e.shortLivedTokenValidity;let h,l,c,d,u,p,g,m;t&&(m=this.tokenValidity||a||this.defaultTokenValidity,m>a&&a>0&&(m=a)),s&&(h=s.isAdmin,l=s.serverUrl,c=s.token,p=s.signal,g=s.ssl,e.customParameters=s.customParameters),h?d=e.adminTokenServiceUrl:(d=e.tokenServiceUrl,u=new _(d.toLowerCase()),e.webTierAuth&&null!=s&&s.serverUrl&&!g&&\"http\"===o.scheme&&(f(o.uri,d,!0)||\"https\"===u.scheme&&o.host===u.host&&\"7080\"===o.port&&\"7443\"===u.port)&&(d=d.replace(/^https:/i,\"http:\").replace(/:7443/i,\":7080\")));const v={query:{request:\"getToken\",username:null==t?void 0:t.username,password:null==t?void 0:t.password,serverUrl:l,token:c,expiration:m,referer:h||n?this._appOrigin:null,client:h?\"referer\":null,f:\"json\",...e.customParameters},method:\"post\",authMode:\"anonymous\",useProxy:this._useProxy(e,s),signal:p,...null==s?void 0:s.ioArgs};n||(v.withCredentials=!1);return r(d,v).then((s=>{const r=s.data;if(!r||!r.token)return new i(\"identity-manager:authentication-failed\",\"Unable to generate token\");const n=e.server;return R[n]||(R[n]={}),t&&(R[n][t.username]=t.password),r.validity=m,r}))}isBusy(){return!!this._busy}checkSignInStatus(e){return this.checkAppAccess(e,\"\").then((e=>e.credential))}checkAppAccess(e,t,s){let n=!1;return this.getCredential(e,{prompt:!1}).then((o=>{let a;const h={f:\"json\"};if(\"portal\"===o.scope)if(t&&(this._doPortalSignIn(e)||s&&s.force))a=o.server+\"/sharing/rest/oauth2/validateAppAccess\",h.client_id=t;else{if(!o.token)return{credential:o};a=o.server+\"/sharing/rest\"}else{if(!o.token)return{credential:o};a=o.server+\"/rest/services\"}return o.token&&(h.token=o.token),r(a,{query:h,authMode:\"anonymous\"}).then((e=>{if(!1===e.data.valid)throw new i(\"identity-manager:not-authorized\",`You are currently signed in as: '${o.userId}'.`,e.data);return n=!!e.data.viewOnlyUserTypeApp,{credential:o}})).catch((e=>{if(\"identity-manager:not-authorized\"===e.name)throw e;const t=e.details&&e.details.httpStatus;if(498===t)throw o.destroy(),new i(\"identity-manager:not-authenticated\",\"User is not signed in.\");if(400===t)throw new i(\"identity-manager:invalid-request\");return{credential:o}}))})).then((e=>({credential:e.credential,viewOnly:n})))}setOAuthResponseHash(e){var t;const s=this._oAuthDfd;if(this._oAuthDfd=null,!s||!e)return;clearInterval(this._oAuthIntervalId),null==(t=this._oAuthOnHashHandle)||t.remove(),\"#\"===e.charAt(0)&&(e=e.substring(1));const r=m(e);if(r.error){const e=\"access_denied\"===r.error,t=new i(e?\"identity-manager:user-aborted\":\"identity-manager:authentication-failed\",e?\"ABORTED\":\"OAuth: \"+r.error+\" - \"+r.error_description);s.reject(t)}else{const e=s.sinfo_,t=s.oinfo_,i=t._oAuthCred,n=new q({userId:r.username,server:e.server,token:r.access_token,expires:Date.now()+1e3*Number(r.expires_in),ssl:\"true\"===r.ssl,_oAuthCred:i});t.userId=n.userId,i.storage=r.persist?C:D,i.token=n.token,i.expires=n.expires,i.userId=n.userId,i.ssl=n.ssl,i.save(),s.resolve(n)}}setOAuthRedirectionHandler(e){this._oAuthRedirectFunc=e}setProtocolErrorHandler(e){this._protocolFunc=e}signIn(e,t,s={}){const r=d(),n=()=>{var e,t,s,r,i;null==(e=h)||e.remove(),null==(t=l)||t.remove(),null==(s=c)||s.remove(),null==(r=a)||r.destroy(),null==(i=this.dialog)||i.destroy(),this.dialog=a=h=l=c=null},o=()=>{n(),this._oAuthDfd=null,r.reject(new i(\"identity-manager:user-aborted\",\"ABORTED\"))};s.signal&&u(s.signal,(()=>{o()}));let a=new this.formConstructor;a.resource=this.getResourceName(e),a.server=t.server,this.dialog=new U,this.dialog.content=a,this.dialog.open=!0,this.emit(\"dialog-create\");let h=a.on(\"cancel\",o),l=this.dialog.watch(\"open\",o),c=a.on(\"submit\",(e=>{this.generateToken(t,e,{isAdmin:s.isAdmin,signal:s.signal}).then((i=>{n();const o=new q({userId:e.username,server:t.server,token:i.token,expires:null!=i.expires?Number(i.expires):null,ssl:!!i.ssl,isAdmin:s.isAdmin,validity:i.validity});r.resolve(o)})).catch((e=>{a.error=e,a.signingIn=!1}))}));return r.promise}oAuthSignIn(e,t,s,r){this._oAuthDfd=d();const n=this._oAuthDfd;null!=r&&r.signal&&u(r.signal,(()=>{const e=this._oAuthDfd&&this._oAuthDfd.oAuthWin_;e&&!e.closed?e.close():this.dialog&&h()})),n.resUrl_=e,n.sinfo_=t,n.oinfo_=s;const o=!r||!1!==r.oAuthPopupConfirmation;if(!s.popup||!o)return this._doOAuthSignIn(e,t,s),n.promise;const a=new this.formConstructor;a.oAuthPrompt=!0,a.server=t.server,this.dialog=new U,this.dialog.content=a,this.dialog.open=!0,this.emit(\"dialog-create\");const h=()=>{_(),this._oAuthDfd=null,n.reject(new i(\"identity-manager:user-aborted\",\"ABORTED\"))},l=a.on(\"cancel\",h),c=this.dialog.watch(\"open\",h),p=a.on(\"submit\",(()=>{_(),this._doOAuthSignIn(e,t,s)})),_=()=>{l.remove(),c.remove(),p.remove(),a.destroy(),this.dialog.destroy(),this.dialog=null};return n.promise}destroyCredentials(){if(this.credentials){this.credentials.slice().forEach((e=>{e.destroy()}))}this.emit(\"credentials-destroy\")}enablePostMessageAuth(e=\"https://www.arcgis.com/sharing/rest\"){this._postMessageAuthHandle&&this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=o(window,\"message\",(t=>{var s;if((t.origin===this._appOrigin||t.origin.endsWith(\".arcgis.com\"))&&\"arcgis:auth:requestCredential\"===(null==(s=t.data)?void 0:s.type)){const s=t.source;this.getCredential(e).then((e=>{s.postMessage({type:\"arcgis:auth:credential\",credential:{expires:e.expires,server:e.server,ssl:e.ssl,token:e.token,userId:e.userId}},t.origin)})).catch((e=>{s.postMessage({type:\"arcgis:auth:error\",error:{name:e.name,message:e.message}},t.origin)}))}}))}disablePostMessageAuth(){this._postMessageAuthHandle&&(this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=null)}_getOAuthHash(){let e=window.location.hash;if(e){\"#\"===e.charAt(0)&&(e=e.substring(1));const t=m(e);let s=!1;if(t.access_token&&t.expires_in&&t.state&&t.hasOwnProperty(\"username\"))try{t.state=JSON.parse(t.state),\"object\"==typeof t.state&&t.state.portalUrl&&(this._oAuthHash=t,s=!0)}catch{}else t.error&&t.error_description&&(console.log(\"IdentityManager OAuth Error: \",t.error,\" - \",t.error_description),\"access_denied\"===t.error&&(s=!0));s&&(window.location.hash=\"object\"==typeof t.state&&t.state.hash||\"\")}}_pageShowHandler(e){if(e.persisted&&this.isBusy()&&this._rejectOnPersistedPageShow){const e=new i(\"identity-manager:user-aborted\",\"ABORTED\");this._errbackFunc(e)}}_findCredential(e,t){let s,r,i,n,o=-1;const a=t&&t.token,h=t&&t.resource,l=this._isServerRsrc(e)?\"server\":\"portal\",c=this.credentials.filter((t=>this._hasSameServerInstance(t.server,e)&&t.scope===l));if(e=h||e,c.length)if(1===c.length){if(s=c[0],n=this.findServerInfo(s.server),r=n&&n.owningSystemUrl,i=r&&this.findCredential(r,s.userId),o=this._getIdenticalSvcIdx(e,s),!a)return-1===o&&s.resources.push(e),this._addResource(e,i),s;-1!==o&&(s.resources.splice(o,1),this._removeResource(e,i))}else{let t,s;if(c.some((a=>(s=this._getIdenticalSvcIdx(e,a),-1!==s&&(t=a,n=this.findServerInfo(t.server),r=n&&n.owningSystemUrl,i=r&&this.findCredential(r,t.userId),o=s,!0)))),a)t&&(t.resources.splice(o,1),this._removeResource(e,i));else if(t)return this._addResource(e,i),t}}_findOAuthInfo(e){let t=this.findOAuthInfo(e);if(!t)for(const s of this.oAuthInfos)if(this._isIdProvider(s.portalUrl,e)){t=s;break}return t}_addResource(e,t){t&&-1===this._getIdenticalSvcIdx(e,t)&&t.resources.push(e)}_removeResource(e,t){let s=-1;t&&(s=this._getIdenticalSvcIdx(e,t),s>-1&&t.resources.splice(s,1))}_useProxy(e,t){return t&&t.isAdmin&&!f(e.adminTokenServiceUrl,this._appOrigin)||!this._isPortalDomain(e.tokenServiceUrl)&&\"10.1\"===String(e.currentVersion)&&!f(e.tokenServiceUrl,this._appOrigin)}_getOrigin(e){const t=new _(e);return t.scheme+\"://\"+t.host+(null!=t.port?\":\"+t.port:\"\")}_getServerInstanceRoot(e){const t=e.toLowerCase();let s=t.indexOf(this._agsRest);return-1===s&&this._isAdminResource(e)&&(s=this._agsAdmin.test(e)?e.replace(this._agsAdmin,\"$1\").length:e.search(this._adminSvcs)),-1===s&&(s=t.indexOf(\"/sharing\")),-1===s&&\"/\"===t.substr(-1)&&(s=t.length-1),s>-1?e.substring(0,s):e}_hasSameServerInstance(e,t){return\"/\"===e.substr(-1)&&(e=e.slice(0,-1)),e=e.toLowerCase(),t=this._getServerInstanceRoot(t).toLowerCase(),e=this._normalizeAGOLorgDomain(e),t=this._normalizeAGOLorgDomain(t),(e=e.substr(e.indexOf(\":\")))===(t=t.substr(t.indexOf(\":\")))}_normalizeAGOLorgDomain(e){const t=/^https?:\\/\\/(?:cdn|[a-z\\d-]+\\.maps)\\.arcgis\\.com/i,s=/^https?:\\/\\/(?:cdndev|[a-z\\d-]+\\.mapsdevext)\\.arcgis\\.com/i,r=/^https?:\\/\\/(?:cdnqa|[a-z\\d-]+\\.mapsqa)\\.arcgis\\.com/i;return t.test(e)?e=e.replace(t,\"https://www.arcgis.com\"):s.test(e)?e=e.replace(s,\"https://devext.arcgis.com\"):r.test(e)&&(e=e.replace(r,\"https://qaext.arcgis.com\")),e}_sanitizeUrl(e){const s=(t.request.proxyUrl||\"\").toLowerCase(),r=s?e.toLowerCase().indexOf(s+\"?\"):-1;return-1!==r&&(e=e.substring(r+s.length+1)),e=v(e),g(e).path}_isRESTService(e){return e.indexOf(this._agsRest)>-1}_isAdminResource(e){return this._agsAdmin.test(e)||this._adminSvcs.test(e)}_isServerRsrc(e){return this._isRESTService(e)||this._isAdminResource(e)}_isIdenticalService(e,t){let s;if(this._isRESTService(e)&&this._isRESTService(t)){const r=this._getSuffix(e).toLowerCase(),i=this._getSuffix(t).toLowerCase();if(s=r===i,!s){const e=/(.*)\\/(MapServer|FeatureServer|UtilityNetworkServer).*/gi;s=r.replace(e,\"$1\")===i.replace(e,\"$1\")}}else this._isAdminResource(e)&&this._isAdminResource(t)?s=!0:this._isServerRsrc(e)||this._isServerRsrc(t)||!this._isPortalDomain(e)||(s=!0);return s}_isPortalDomain(e){const s=new _(e.toLowerCase()),r=this._portalConfig;let i=this._gwDomains.some((e=>e.regex.test(s.uri)));return!i&&r&&(i=this._hasSameServerInstance(this._getServerInstanceRoot(r.restBaseUrl),s.uri)),i||t.portalUrl&&(i=f(s,t.portalUrl,!0)),i||(i=this._portals.some((e=>this._hasSameServerInstance(e,s.uri)))),i=i||this._agsPortal.test(s.path),i}_isIdProvider(e,t){let s=-1,r=-1;this._gwDomains.forEach(((i,n)=>{-1===s&&i.regex.test(e)&&(s=n),-1===r&&i.regex.test(t)&&(r=n)}));let i=!1;if(s>-1&&r>-1&&(0===s||4===s?0!==r&&4!==r||(i=!0):1===s?1!==r&&2!==r||(i=!0):2===s?2===r&&(i=!0):3===s&&3===r&&(i=!0)),!i){const s=this.findServerInfo(t),r=s&&s.owningSystemUrl;r&&b(s)&&this._isPortalDomain(r)&&this._isIdProvider(e,r)&&(i=!0)}return i}_getIdenticalSvcIdx(e,t){let s=-1;for(let r=0;r<t.resources.length;r++){const i=t.resources[r];if(this._isIdenticalService(e,i)){s=r;break}}return s}_getSuffix(e){return e.replace(this._regexSDirUrl,\"\").replace(this._regexServerType,\"$1\")}_getTokenSvcUrl(e){let t,s,i;if(this._isRESTService(e)||this._isAdminResource(e)){const i=this._getServerInstanceRoot(e);return t=i+\"/admin/generateToken\",s=r(e=i+\"/rest/info\",{query:{f:\"json\"}}).then((e=>e.data)),{adminUrl:t,promise:s}}if(this._isPortalDomain(e)){let t=\"\";if(this._gwDomains.some((s=>(s.regex.test(e)&&(t=s.tokenServiceUrl),!!t))),t||this._portals.some((s=>(this._hasSameServerInstance(s,e)&&(t=s+this._gwTokenUrl),!!t))),t||(i=e.toLowerCase().indexOf(\"/sharing\"),-1!==i&&(t=e.substring(0,i)+this._gwTokenUrl)),t||(t=this._getOrigin(e)+this._gwTokenUrl),t){const s=new _(e).port;/^http:\\/\\//i.test(e)&&\"7080\"===s&&(t=t.replace(/:7080/i,\":7443\")),t=t.replace(/http:/i,\"https:\")}return t}if(-1!==e.toLowerCase().indexOf(\"premium.arcgisonline.com\"))return\"https://premium.arcgisonline.com/server/tokens\"}_exchangeToken(e,t,s){return r(`${e}/sharing/rest/oauth2/exchangeToken`,{authMode:\"anonymous\",method:\"post\",query:{f:\"json\",client_id:t,token:s}}).then((e=>e.data.token))}_getPlatformSelf(e,t){return r(`${e}/sharing/rest/oauth2/platformSelf`,{authMode:\"anonymous\",headers:{\"X-Esri-Auth-Client-Id\":t,\"X-Esri-Auth-Redirect-Uri\":window.location.href.replace(/#.*$/,\"\")},method:\"post\",query:{f:\"json\"},withCredentials:!0}).then((e=>e.data))}_getPortalSelf(e,t){let s;if(this._gwDomains.some((t=>(t.regex.test(e)&&(s=t.customBaseUrl),!!s))),s)return Promise.resolve({allSSL:!0,currentVersion:\"4.4\",customBaseUrl:s,portalMode:\"multitenant\",supportsOAuth:!0});this._appOrigin.startsWith(\"https:\")?e=e.replace(/^http:/i,\"https:\").replace(/:7080/i,\":7443\"):/^http:/i.test(t)&&(e=e.replace(/^https:/i,\"http:\").replace(/:7443/i,\":7080\"));return r(e,{query:{f:\"json\"},authMode:\"anonymous\",withCredentials:!0}).then((e=>e.data))}_doPortalSignIn(e){const t=this._portalConfig,s=window.location.href,r=this.findServerInfo(e);return!(!t&&!this._isPortalDomain(s)||!(r?r.hasPortal||r.owningSystemUrl&&this._isPortalDomain(r.owningSystemUrl):this._isPortalDomain(e))||!(this._isIdProvider(s,e)||t&&(this._hasSameServerInstance(this._getServerInstanceRoot(t.restBaseUrl),e)||this._isIdProvider(t.restBaseUrl,e))||f(s,e,!0)))}_checkProtocol(e,t,s,r){let n=!0;const o=r?t.adminTokenServiceUrl:t.tokenServiceUrl;if(o.trim().toLowerCase().startsWith(\"https:\")&&!this._appOrigin.startsWith(\"https:\")&&S(o)&&(n=!!this._protocolFunc&&!!this._protocolFunc({resourceUrl:e,serverInfo:t}),!n)){s(new i(\"identity-manager:aborted\",\"Aborted the Sign-In process to avoid sending password over insecure connection.\"))}return n}_enqueue(e,t,s,r,i,n){return r||(r=d()),r.resUrl_=e,r.sinfo_=t,r.options_=s,r.admin_=i,r.refresh_=n,this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(e),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(r)):this._xoReqs.push(r):this._doSignIn(r),r.promise}_doSignIn(e){this._busy=e,this._rejectOnPersistedPageShow=!1;const t=t=>{const s=e.options_&&e.options_.resource,r=e.resUrl_,i=e.refresh_;let n=!1;-1===this.credentials.indexOf(t)&&(i&&-1!==this.credentials.indexOf(i)?(i.userId=t.userId,i.token=t.token,i.expires=t.expires,i.validity=t.validity,i.ssl=t.ssl,i.creationTime=t.creationTime,n=!0,t=i):this.credentials.push(t)),t.resources||(t.resources=[]),t.resources.push(s||r),t.scope=this._isServerRsrc(r)?\"server\":\"portal\",t.emitTokenChange();const o=this._soReqs,a={};this._soReqs=[],o.forEach((e=>{if(!this._isIdenticalService(r,e.resUrl_)){const s=this._getSuffix(e.resUrl_);a[s]||(a[s]=!0,t.resources.push(e.resUrl_))}})),e.resolve(t),o.forEach((e=>{this._hasSameServerInstance(this._getServerInstanceRoot(r),e.resUrl_)?e.resolve(t):this._soReqs.push(e)})),this._busy=e.resUrl_=e.sinfo_=e.refresh_=null,n||this.emit(\"credential-create\",{credential:t}),this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},s=t=>{e.reject(t),this._busy=e.resUrl_=e.sinfo_=e.refresh_=null,this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},r=(r,n,a,h)=>{var l,c;const d=e.sinfo_,p=!e.options_||!1!==e.options_.prompt,_=d.hasPortal&&this._findOAuthInfo(e.resUrl_);let g,m;if(r)t(new q({userId:r,server:d.server,token:a||null,expires:null!=h?Number(h):null,ssl:!!n}));else if(window!==window.parent&&null!=(l=this._appUrlObj.query)&&l[\"arcgis-auth-origin\"]&&null!=(c=this._appUrlObj.query)&&c[\"arcgis-auth-portal\"]&&this._hasSameServerInstance(this._getServerInstanceRoot(this._appUrlObj.query[\"arcgis-auth-portal\"]),e.resUrl_)){var v;window.parent.postMessage({type:\"arcgis:auth:requestCredential\"},this._appUrlObj.query[\"arcgis-auth-origin\"]);const r=o(window,\"message\",(e=>{e.source===window.parent&&e.data&&(\"arcgis:auth:credential\"===e.data.type?(r.remove(),t(new q(e.data.credential))):\"arcgis:auth:error\"===e.data.type&&(r.remove(),s(i.fromJSON(e.data.error))))}));u(null==(v=e.options_)?void 0:v.signal,(()=>{r.remove()}))}else if(_){let r=_._oAuthCred;if(!r){const e=new T(_,C),t=new T(_,D);e.isValid()&&t.isValid()?e.expires>t.expires?(r=e,t.destroy()):(r=t,e.destroy()):r=e.isValid()?e:t,_._oAuthCred=r}if(r.isValid())g=new q({userId:r.userId,server:d.server,token:r.token,expires:r.expires,ssl:r.ssl,_oAuthCred:r}),_.appId!==r.appId&&this._doPortalSignIn(e.resUrl_)?e._pendingDfd=this._exchangeToken(g.server,_.appId,g.token).then((e=>{g.token=e,r.token=e,r.save(),t(g)})).catch((()=>{t(g)})):t(g);else if(this._oAuthHash&&this._hasSameServerInstance(_.portalUrl,this._oAuthHash.state.portalUrl)){const e=this._oAuthHash;g=new q({userId:e.username,server:d.server,token:e.access_token,expires:Date.now()+1e3*Number(e.expires_in),ssl:\"true\"===e.ssl,oAuthState:e.state,_oAuthCred:r}),_.userId=g.userId,r.storage=e.persist?C:D,r.token=g.token,r.expires=g.expires,r.userId=g.userId,r.ssl=g.ssl,r.save(),this._oAuthHash=null,t(g)}else{const r=()=>{p?e._pendingDfd=this.oAuthSignIn(e.resUrl_,d,_,e.options_).then(t,s):(m=new i(\"identity-manager:not-authenticated\",\"User is not signed in.\"),s(m))};this._doPortalSignIn(e.resUrl_)?e._pendingDfd=this._getPlatformSelf(d.server,_.appId).then((({portalUrl:e,token:s,username:i})=>{!e||f(e,this._appOrigin,!0)?(g=new q({server:d.server,userId:i,token:s}),t(g)):r()})).catch(r):r()}}else if(p){if(this._checkProtocol(e.resUrl_,d,s,e.admin_)){let r=e.options_;e.admin_&&(r=r||{},r.isAdmin=!0),e._pendingDfd=this.signIn(e.resUrl_,d,r).then(t,s)}}else m=new i(\"identity-manager:not-authenticated\",\"User is not signed in.\"),s(m)},n=()=>{const r=e.sinfo_,i=r.owningSystemUrl,n=e.options_;let o,a,h,l;if(n&&(o=n.token,a=n.error,h=n.prompt),l=this._findCredential(i,{token:o,resource:e.resUrl_}),!l)for(const e of this.credentials)if(this._isIdProvider(i,e.server)){l=e;break}if(l){const i=this.findCredential(e.resUrl_,l.userId);if(i)t(i);else if(P(r,this._legacyFed)){const e=l.toJSON();e.server=r.server,e.resources=null,t(new q(e))}else{(e._pendingDfd=this.generateToken(this.findServerInfo(l.server),null,{serverUrl:e.resUrl_,token:l.token,signal:e.options_.signal,ssl:l.ssl})).then((s=>{t(new q({userId:l.userId,server:r.server,token:s.token,expires:null!=s.expires?Number(s.expires):null,ssl:!!s.ssl,isAdmin:e.admin_,validity:s.validity}))}),s)}}else{this._busy=null,o&&(e.options_.token=null);(e._pendingDfd=this.getCredential(i.replace(/\\/?$/,\"/sharing\"),{resource:e.resUrl_,owningTenant:r.owningTenant,signal:e.options_.signal,token:o,error:a,prompt:h})).then((()=>{this._enqueue(e.resUrl_,e.sinfo_,e.options_,e,e.admin_)}),(t=>{e.resUrl_=e.sinfo_=e.refresh_=null,e.reject(t)}))}};this._errbackFunc=s;const a=e.sinfo_.owningSystemUrl,h=this._isServerRsrc(e.resUrl_),c=e.sinfo_._restInfoPms;c?c.promise.then((t=>{const s=e.sinfo_;if(s._restInfoPms){s.adminTokenServiceUrl=s._restInfoPms.adminUrl,s._restInfoPms=null,s.tokenServiceUrl=l(\"authInfo.tokenServicesUrl\",t)||l(\"authInfo.tokenServiceUrl\",t)||l(\"tokenServiceUrl\",t),s.shortLivedTokenValidity=l(\"authInfo.shortLivedTokenValidity\",t),s.currentVersion=t.currentVersion,s.owningTenant=t.owningTenant;const e=s.owningSystemUrl=t.owningSystemUrl;e&&this._portals.push(e)}h&&s.owningSystemUrl?n():r()}),(()=>{e.sinfo_._restInfoPms=null;const t=new i(\"identity-manager:server-identification-failed\",\"Unknown resource - could not find token service endpoint.\");s(t)})):h&&a?n():e.sinfo_._selfReq?e.sinfo_._selfReq.selfDfd.then((t=>{const s={};let r,i,n,o;return t&&(r=t.user&&t.user.username,s.username=r,s.allSSL=t.allSSL,i=t.supportsOAuth,n=t.currentVersion,\"multitenant\"===t.portalMode&&(o=t.customBaseUrl)),e.sinfo_.webTierAuth=!!r,r&&this.normalizeWebTierAuth?this.generateToken(e.sinfo_,null,{ssl:s.allSSL}).catch((()=>null)).then((e=>(s.portalToken=e&&e.token,s.tokenExpiration=e&&e.expires,s))):!r&&i&&parseFloat(n)>=4.4&&!this._findOAuthInfo(e.resUrl_)?this._generateOAuthInfo({portalUrl:e.sinfo_.server,customBaseUrl:o,owningTenant:e.sinfo_._selfReq.owningTenant}).catch((()=>null)).then((()=>s)):s})).catch((()=>null)).then((t=>{e.sinfo_._selfReq=null,t?r(t.username,t.allSSL,t.portalToken,t.tokenExpiration):r()})):r()}_generateOAuthInfo(e){let t,s,i=e.portalUrl;const n=e.customBaseUrl,o=e.owningTenant,a=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal;if(a){s=window.location.href;let e=s.indexOf(\"?\");e>-1&&(s=s.slice(0,e)),e=s.search(/\\/(apps|home)\\//),s=e>-1?s.slice(0,e):null}return a&&s?(this._hasTestedIfAppIsOnPortal=!0,t=r(s+\"/sharing/rest\",{query:{f:\"json\"}}).then((()=>{this.defaultOAuthInfo=new x({appId:\"arcgisonline\",popupCallbackUrl:s+\"/home/oauth-callback.html\"})}))):t=Promise.resolve(),t.then((()=>{if(this.defaultOAuthInfo)return i=i.replace(/^http:/i,\"https:\"),r(i+\"/sharing/rest/oauth2/validateRedirectUri\",{query:{accountId:o,client_id:this.defaultOAuthInfo.appId,redirect_uri:w(this.defaultOAuthInfo.popupCallbackUrl),f:\"json\"}}).then((e=>{if(e.data.valid){const t=this.defaultOAuthInfo.clone();e.data.urlKey&&n?t.portalUrl=\"https://\"+e.data.urlKey.toLowerCase()+\".\"+n:t.portalUrl=i,t.popup=window!==window.top||!(f(i,this._appOrigin)||this._gwDomains.some((e=>e.regex.test(i)&&e.regex.test(this._appOrigin)))),this.oAuthInfos.push(t)}}))}))}_doOAuthSignIn(e,t,s){const r={portalUrl:s.portalUrl};!s.popup&&s.preserveUrlHash&&window.location.hash&&(r.hash=window.location.hash);const n={client_id:s.appId,response_type:\"token\",state:JSON.stringify(r),expiration:s.expiration,locale:s.locale,redirect_uri:s.popup?w(s.popupCallbackUrl):window.location.href.replace(/#.*$/,\"\")};s.forceLogin&&(n.force_login=!0),s.forceUserId&&s.userId&&(n.prepopulatedusername=s.userId),!s.popup&&this._doPortalSignIn(e)&&(n.redirectToUserOrgUrl=!0);const h=s.portalUrl.replace(/^http:/i,\"https:\")+\"/sharing/oauth2/authorize\",l=h+\"?\"+I(n);if(s.popup){const e=window.open(l,\"esriJSAPIOAuth\",s.popupWindowFeatures);if(e)e.focus(),this._oAuthDfd.oAuthWin_=e,this._oAuthIntervalId=setInterval((()=>{if(e.closed){clearInterval(this._oAuthIntervalId),this._oAuthOnHashHandle.remove();const e=this._oAuthDfd;if(e){const t=new i(\"identity-manager:user-aborted\",\"ABORTED\");e.reject(t)}}}),500),this._oAuthOnHashHandle=o(a,\"arcgis:auth:hash\",(e=>{this.setOAuthResponseHash(e.detail)}));else{const e=new i(\"identity-manager:popup-blocked\",\"ABORTED\");this._oAuthDfd.reject(e)}}else this._rejectOnPersistedPageShow=!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:n,authorizeUrl:h,resourceUrl:e,serverInfo:t,oAuthInfo:s}):window.location.href=l}}j.prototype.declaredClass=\"esri.identity.IdentityManagerBase\";let q=class extends n.EventedAccessor{constructor(e){super(e),this._oAuthCred=null,this.tokenRefreshBuffer=2,e&&e._oAuthCred&&(this._oAuthCred=e._oAuthCred)}initialize(){this.resources=this.resources||[],null==this.creationTime&&(this.creationTime=Date.now())}refreshToken(){const e=s.findServerInfo(this.server),t=e&&e.owningSystemUrl,r=!!t&&\"server\"===this.scope,i=r&&P(e,s._legacyFed),n=e.webTierAuth,o=n&&s.normalizeWebTierAuth,a=R[this.server],h=a&&a[this.userId];let l,c=this.resources&&this.resources[0],d=r&&s.findServerInfo(t),u={username:this.userId,password:h};if(n&&!o)return;r&&!d&&s.serverInfos.some((e=>(s._isIdProvider(t,e.server)&&(d=e),!!d)));const p=d&&s.findCredential(d.server,this.userId);if(!r||p){if(!i){if(r)l={serverUrl:c,token:p&&p.token,ssl:p&&p.ssl};else if(o)u=null,l={ssl:this.ssl};else{if(!h){let t;return c&&(c=s._sanitizeUrl(c),this._enqueued=1,t=s._enqueue(c,e,null,null,this.isAdmin,this),t.then((()=>{this._enqueued=0,this.refreshServerTokens()})).catch((()=>{this._enqueued=0}))),t}this.isAdmin&&(l={isAdmin:!0})}return s.generateToken(r?d:e,r?null:u,l).then((e=>{this.token=e.token,this.expires=null!=e.expires?Number(e.expires):null,this.creationTime=Date.now(),this.validity=e.validity,this.emitTokenChange(),this.refreshServerTokens()})).catch((()=>{}))}p.refreshToken()}}refreshServerTokens(){\"portal\"===this.scope&&s.credentials.forEach((e=>{const t=s.findServerInfo(e.server),r=t&&t.owningSystemUrl;e!==this&&e.userId===this.userId&&r&&\"server\"===e.scope&&(s._hasSameServerInstance(this.server,r)||s._isIdProvider(r,this.server))&&(P(t,s._legacyFed)?(e.token=this.token,e.expires=this.expires,e.creationTime=this.creationTime,e.validity=this.validity,e.emitTokenChange()):e.refreshToken())}))}emitTokenChange(e){clearTimeout(this._refreshTimer);const t=this.server&&s.findServerInfo(this.server),r=t&&t.owningSystemUrl,i=r&&s.findServerInfo(r);!1===e||r&&\"portal\"!==this.scope&&(!i||!i.webTierAuth||s.normalizeWebTierAuth)||null==this.expires&&null==this.validity||this._startRefreshTimer(),this.emit(\"token-change\")}destroy(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null,this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);const e=s.credentials.indexOf(this);e>-1&&s.credentials.splice(e,1),this.emitTokenChange(),this.emit(\"destroy\")}toJSON(){const e=h({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),t=this.resources;return t&&t.length>0&&(e.resources=t.slice()),e}_startRefreshTimer(){clearTimeout(this._refreshTimer);const e=6e4*this.tokenRefreshBuffer,t=2**31-1;let s=(this.validity?this.creationTime+6e4*this.validity:this.expires)-Date.now();s<0?s=0:s>t&&(s=t),this._refreshTimer=setTimeout(this.refreshToken.bind(this),s>e?s-e:s)}};e([k()],q.prototype,\"creationTime\",void 0),e([k()],q.prototype,\"expires\",void 0),e([k()],q.prototype,\"isAdmin\",void 0),e([k()],q.prototype,\"oAuthState\",void 0),e([k()],q.prototype,\"resources\",void 0),e([k()],q.prototype,\"scope\",void 0),e([k()],q.prototype,\"server\",void 0),e([k()],q.prototype,\"ssl\",void 0),e([k()],q.prototype,\"token\",void 0),e([k()],q.prototype,\"tokenRefreshBuffer\",void 0),e([k()],q.prototype,\"userId\",void 0),e([k()],q.prototype,\"validity\",void 0),q=e([A(\"esri.identity.Credential\")],q);export{q as Credential,j as IdentityManagerBase};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{setId as e}from\"../kernel.js\";import{IdentityManagerBase as t}from\"./IdentityManagerBase.js\";class r extends t{}r.prototype.declaredClass=\"esri.identity.IdentityManager\";const s=new r;e(s);export{s as default};\n"],"sourceRoot":""}