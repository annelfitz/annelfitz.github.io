(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[7],{550:function(e,t,n){"use strict";var r,i;function s(e){switch(e){case"left":return r.Left;case"right":return r.Right;case"center":case"justify":return r.Center}}function a(e){switch(e){case"top":return i.Top;case"middle":return i.Center;case"baseline":return i.Baseline;case"bottom":return i.Bottom}}function o(e){switch(e){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[r.Right,i.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[r.Center,i.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[r.Left,i.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[r.Right,i.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":return[r.Center,i.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[r.Left,i.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[r.Right,i.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[r.Center,i.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[r.Left,i.Top];case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[r.Center,i.Baseline];default:return console.debug("Found invalid placement type "+e),[r.Center,i.Center]}}function l(e){switch(e){case r.Right:return-1;case r.Center:return 0;case r.Left:return 1;default:return console.debug("Found invalid horizontal alignment "+e),0}}function c(e){switch(e){case i.Top:return 1;case i.Center:return 0;case i.Bottom:case i.Baseline:return-1;default:return console.debug("Found invalid vertical alignment "+e),0}}function u(e){switch(e){case"left":return r.Left;case"right":return r.Right;case"center":case"justify":return r.Center}}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return c})),function(e){e[e.Left=-1]="Left",e[e.Center=0]="Center",e[e.Right=1]="Right"}(r||(r={})),function(e){e[e.Top=1]="Top",e[e.Center=0]="Center",e[e.Bottom=-1]="Bottom",e[e.Baseline=2]="Baseline"}(i||(i={}))},554:function(e,t,n){"use strict";n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return L})),n.d(t,"d",(function(){return U})),n.d(t,"e",(function(){return N})),n.d(t,"f",(function(){return P})),n.d(t,"g",(function(){return k})),n.d(t,"h",(function(){return M})),n.d(t,"i",(function(){return S})),n.d(t,"j",(function(){return A})),n.d(t,"k",(function(){return I})),n.d(t,"l",(function(){return _}));n(5);var r=n(3),i=n(18),s=n(76),a=n(327),o=n(29),l=n(300),c=n(68),u=n(118),f=n(17),h=n(250),d=n(83),m=n(24),p=n(67),b=n(550),g=n(583),y=n(558);const x=Math.PI/180,O=.04,v=Object(a.a)(),j=Object(l.a)(),w=512,T=50;function S(e,t){if(!t.isWrappable)return null;const[n,r]=Object(d.c)(t);return e[2]>r?[Object(c.g)([e[0],e[1],r,e[3]]),Object(c.g)([n,e[1],n+e[2]-r,e[3]])]:e[0]<n?[Object(c.g)([n,e[1],e[2],e[3]]),Object(c.g)([r-(n-e[0]),e[1],r,e[3]])]:null}function L(e,t,n,r,s,a,o){if(!r||!n.symbol)return e[0]=e[1]=e[2]=e[3]=0,t[0]=t[1]=t[2]=t[3]=0,e;const l=r;if(!Object(f.f)(l)){Object(u.a)(e,l);let r=t[0];0===r&&(r=function e(t){switch(t.symbol.type){case"esriSFS":case"esriPFS":{const e=t.symbol.outline;return e?e.width:0}case"esriSLS":return Object(i.c)(t.symbol.width);case"esriSMS":{const e=t.symbol,n=Object(i.c)(e.xoffset),r=Object(i.c)(e.yoffset);return Object(i.c)(e.size)+Math.sqrt(n*n+r*r)}case"esriPMS":{const e=t.symbol,n=Object(i.c)(e.xoffset),r=Object(i.c)(e.yoffset);return Object(i.c)(Math.max(e.width,e.height))+Math.sqrt(n*n+r*r)}case"esriTS":{const e=[0,0,0,0];k(e,t.symbol,t.mosaicItem);const n=Math.max(Math.abs(e[0]),Math.abs(e[1]));return Math.max(e[2],e[3])+n}case"expanded-cim":{const e=p.a.getEnvelope(t.symbol.data);return e.width!==-1/0&&e.height!==-1/0||(e.width=10,e.height=10,e.x=0,e.y=0),Object(i.c)(Math.sqrt(e.width*e.width+e.height*e.height))}case"composite-symbol":{if(!t.symbol.layers.length)return 0;const n=t.symbol.layers.length-1;return e({symbol:t.symbol.layers[n],mosaicItem:null})}default:return 0}}(n),t[0]=r);const a=s*r/2;return e[0]-=a,e[1]-=a,e[2]+=a,e[3]+=a,e}{const r=l.x,i=l.y;"esriTS"===n.symbol.type&&0===t[2]&&0===t[3]&&k(t,n.symbol,n.mosaicItem),function(e,t,n,r,i,s,a,o){let l;switch(r.type){case"esriSMS":case"esriPMS":l=N(t,n,r,s,a,0);break;case"esriTS":l=P(t,n,r,i,s,0);break;case"cim":case"CIMSymbolReference":case"expanded-cim":l=U(t,n,r,s,a,0)}let c,u,f=0;for(let h=0;h<l.rings[0].length-1;h++)u=l.rings[0][h],c=(t-u[0])*(t-u[0])+(n-u[1])*(n-u[1]),f=Math.max(f,c);f=Math.sqrt(f);let d=Object(h.b)(t-f,o),p=Object(h.b)(t+f,o);if(d>p){const e=Object(m.e)(o);if(e){const[t,n]=e.valid;d=t,p=n}}e[0]=d,e[1]=n-f,e[2]=p,e[3]=n+f}(e,r,i,n.symbol,t,s,a,o)}return e}function _(e){return"text"===e||"esriTS"===e}function A(e){return"simple-marker"===e||"picture-marker"===e||"esriSMS"===e||"esriPMS"===e}function M(e){switch(Object(r.q)(e.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0}const F=Object(l.a)(),R=Object(l.a)(),B=Object(l.a)(),E=Object(l.a)(),z=Object(l.a)(),V=Object(l.a)(),C=Object(l.a)();function I(e,t,n,r){Object(o.m)(B,t,n);const i=e.paths;let s,a,l,c,u,f,h,d,m,p=1/0;for(let b=0;b<i.length;b++){const e=i[b];if(!(e.length<2))for(let i=1;i<e.length;i++)s=e[i-1][0],l=e[i-1][1],a=e[i][0],c=e[i][1],u=Math.min(s,a)-r,f=Math.min(l,c)-r,h=Math.max(s,a)+r,d=Math.max(l,c)+r,t<u||t>h||n<f||n>d||(Object(o.m)(F,s,l),Object(o.m)(R,a,c),Object(o.a)(E,R,F),Object(o.a)(z,F,B),Object(o.b)(V,E,Object(o.h)(E,z)/Object(o.h)(E,E)),Object(o.a)(C,z,V),m=Object(o.h)(C,C),p>m&&(p=m))}return Math.sqrt(p)<=r}function N(e,t,n,r,a,l){let c,u;const f=Object(i.c)(n.xoffset),h=Object(i.c)(n.yoffset),d=x*n.angle,m=x*l;switch(n.type){case"esriSMS":c=u=Object(i.c)(n.size);break;case"esriPMS":c=Object(i.c)(n.width),u=Object(i.c)(n.height)}a<O&&(r=O*r/a);const p=Object(s.d)(v);Object(s.h)(p,p,Object(o.m)(j,e,t)),Object(s.f)(p,p,m-d),Object(s.g)(p,p,Object(o.m)(j,r,-r)),Object(s.h)(p,p,Object(o.m)(j,f,-h));const b=[0,0];Object(o.n)(b,Object(o.m)(j,-.5*c,-.5*u),p);const g=[0,0];Object(o.n)(g,Object(o.m)(j,-.5*c,.5*u),p);const y=[0,0];Object(o.n)(y,Object(o.m)(j,.5*c,-.5*u),p);const w=[0,0];return Object(o.n)(w,Object(o.m)(j,.5*c,.5*u),p),{rings:[[b,y,w,g,b]]}}function U(e,t,n,r,a,l){const c=p.a.getEnvelope(n.data);if(!c)return null;a<O&&(r=O*r/a);const u=Object(i.c)(c.width),f=Object(i.c)(c.height),h=Object(i.c)(c.x),d=Object(i.c)(c.y),m=0*x,b=x*l,g=Object(s.d)(v);Object(s.h)(g,g,Object(o.m)(j,e,t)),Object(s.f)(g,g,b-m),Object(s.g)(g,g,Object(o.m)(j,r,r));const y=[0,0];Object(o.n)(y,Object(o.m)(j,h,d+f),g);const w=[0,0];Object(o.n)(w,Object(o.m)(j,h,d),g);const T=[0,0];Object(o.n)(T,Object(o.m)(j,h+u,d+f),g);const S=[0,0];return Object(o.n)(S,Object(o.m)(j,h+u,d),g),{rings:[[y,T,S,w,y]]}}function P(e,t,n,r,a,l){const c=Object(i.c)(n.xoffset),u=Object(i.c)(n.yoffset),f=x*n.angle,h=x*l,d=Object(s.d)(v);Object(s.h)(d,d,Object(o.m)(j,e,t)),Object(s.f)(d,d,h),Object(s.g)(d,d,Object(o.m)(j,a,-a));const m=r[0]+r[2]/2,p=r[1]+r[3]/2;Object(s.h)(d,d,Object(o.m)(j,c,-u)),Object(s.h)(d,d,Object(o.m)(j,m,p)),Object(s.f)(d,d,f),Object(s.h)(d,d,Object(o.m)(j,-m,-p));const b=[0,0];Object(o.n)(b,Object(o.m)(j,r[0],r[1]),d);const g=[0,0];Object(o.n)(g,Object(o.m)(j,r[0],r[1]+r[3]),d);const y=[0,0];Object(o.n)(y,Object(o.m)(j,r[0]+r[2],r[1]),d);const O=[0,0];return Object(o.n)(O,Object(o.m)(j,r[0]+r[2],r[1]+r[3]),d),{rings:[[b,y,O,g,b]]}}function k(e,t,n){if(!n||0===n.glyphMosaicItems.length)return e;const r=Object(y.a)(t.text)[1],s=n.glyphMosaicItems,a=Object(g.a)(s,r,{scale:Object(i.c)(t.font.size)/24,angle:t.angle,xOffset:t.xoffset,yOffset:t.yoffset,hAlign:Object(b.d)(t.horizontalAlignment||"center"),vAlign:Object(b.f)(t.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(t.lineWidth||512,512)),lineHeight:30*Math.max(.25,Math.min(t.lineHeight||1,4)),decoration:t.font.decoration||"none",isCIM:!1}).bounds;return e[0]=Object(i.c)(a.x-a.halfWidth),e[1]=Object(i.c)(a.y-a.halfHeight),e[2]=Object(i.c)(a.width),e[3]=Object(i.c)(a.height),e}},558:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r=new(n(599).a);function i(e){if(!r.hasBidiChar(e))return[e,!1];let t;return t="rtl"===r.checkContextual(e)?"IDNNN":"ICNNN",[r.bidiTransform(e,t,"VLYSN"),!0]}},559:function(e,t,n){"use strict";n.d(t,"a",(function(){return V})),n.d(t,"b",(function(){return L})),n.d(t,"c",(function(){return T}));n(252),n(303),n(306),n(307),n(93);var r=n(231),i=(n(230),n(254),n(9)),s=n(5),a=n(7),o=n(4),l=n(3),c=n(18),u=n(89),f=n(534),h=n(538),d=n(537),m=n(568);var p=n(600),b=n(601),g=n(603),y=n(598);const x=o.a.getLogger("esri.views.2d.layers.features.schemaUtils"),O="ValidationError",v={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};function j(e){return Object(d.h)(e)}function w(e){var t;return"line-marker"===e.type?{type:"line-marker",color:null==(t=e.color)?void 0:t.toJSON(),placement:e.placement,style:e.style}:Object(u.a)(e.toJSON()).toJSON()}function T(e,t,n){if(!e)return null;let r=0,i=!1,s=0;switch(Object(l.j)(t)&&(s=Object(p.b)(t),"visualVariables"in t&&(r=function(e){if(!e)return f.e.NONE;let t=0;for(const n of e)if("size"===n.type){const e=Object(m.a)(n);t|=e,"outline"===n.target&&(t|=e<<4)}else"color"===n.type?t|=f.e.COLOR:"opacity"===n.type?t|=f.e.OPACITY:"rotation"===n.type&&(t|=f.e.ROTATION);return t}(t.visualVariables||[]),i="dot-density"===t.type)),e.type){case"simple-fill":case"picture-fill":return function(e,t,n,r){const i=Object(d.g)(f.d.FILL,t,!1,n),s=r?j(i):i,a=e.clone(),o=a.outline;a.outline=null;const l=[],c={materialKey:s,hash:a.hash(),...w(a)};if(l.push(c),o){const e=Object(d.g)(f.d.LINE,t,!0,!1),n={materialKey:r?j(e):e,hash:o.hash(),...w(o)};l.push(n)}return{type:"composite-symbol",layers:l,hash:l.reduce((e,t)=>t.hash+e,"")}}(e,r,i,n);case"simple-marker":case"picture-marker":return function(e,t,n,r){const i=Object(d.g)(f.d.MARKER,t,!1,!1),s=r?j(i):i,a=w(e);return{materialKey:s,hash:e.hash(),...a,angle:e.angle,maxVVSize:n}}(e,r,s,n);case"simple-line":return function(e,t,n){const r=Object(d.g)(f.d.LINE,t,!1,!1),i=n?j(r):r,s=e.clone(),a=s.marker;s.marker=null;const o=[];if(o.push({materialKey:i,hash:s.hash(),...w(s)}),a){var l;const e=Object(d.g)(f.d.MARKER,t,!1,!1),r=n?j(e):e;a.color=null!=(l=a.color)?l:s.color,o.push({materialKey:r,hash:a.hash(),lineWidth:s.width,...w(a)})}return{type:"composite-symbol",layers:o,hash:o.reduce((e,t)=>t.hash+e,"")}}(e,r,n);case"text":return function(e,t,n,r){const i=Object(d.g)(f.d.TEXT,t,!1,!1),s=r?j(i):i,a=w(e);return{materialKey:s,hash:e.hash(),...a,angle:e.angle,maxVVSize:n}}(e,r,s,n);case"label":return function(e,t,n){const r=e.toJSON(),i=Object(d.g)(f.d.LABEL,t,!1,!1,r.labelPlacement);return{materialKey:n?j(i):i,hash:e.hash(),...r,labelPlacement:r.labelPlacement}}(e,r,n);case"cim":return{type:"cim",rendererKey:r,data:e.data,maxVVSize:s};case"web-style":return{...w(e),type:"web-style",hash:e.hash(),rendererKey:r,maxVVSize:s};default:throw new Error("symbol not supported "+e.type)}}function S(e,t){const n=Object(a.a)(e);return n.some(e=>function(e,t){const n=e.labelPlacement,r=v[t];if(!e.symbol)return x.warn("No ILabelClass symbol specified."),!0;if(!r)return x.error(new i.a("mapview-labeling:unsupported-geometry-type",`Unable to create labels for Feature Layer, ${t} is not supported`)),!0;if(!r.some(e=>e===n)){const i=r[0];n&&x.warn(`Found invalid label placement type ${n} for ${t}. Defaulting to ${i}`),e.labelPlacement=i}return!1}(e,t))?[]:n}function L(e){return Object(s.a)("esri-2d-update-debug")&&console.debug("Created new schema",_(e,!0)),_(e)}function _(e,t=!1){try{var n,s;const a=function(e,t=!1){const n=new Array;return n.push(function(e,t,n=!1){const s={indexCount:0,fields:{}},a="featureReduction"in e&&e.featureReduction,o=a?"aggregate":"feature";if("sublayers"in e){const t={type:"subtype",subtypeField:e.subtypeField,renderers:{}},r={type:"subtype",mapping:{},target:"feature"},a={type:"subtype",classes:{}},c={type:"symbol",target:"feature",aggregateFields:[],attributes:s,storage:r,mesh:{matcher:t,aggregateMatcher:null,labels:a,sortKey:null}},u=new Set;let f=0;for(const{renderer:h,subtypeCode:d,labelingInfo:m,labelsVisible:p}of e.sublayers){const e=V(s,o,h,n),c=z(s,o,h),b=p&&m;if("visualVariables"in h&&h.visualVariables&&h.visualVariables.length)throw new i.a(O,"Visual variables are currently not supported for subtype layers");if("dictionary"===e.type)throw new i.a(O,"Dictionary renderer is not supported in subtype layers");if("subtype"===e.type)throw new i.a(O,"Nested subtype renderers is not supported");if(Object(l.j)(c)&&"subtype"===c.type)throw new i.a(O,"Nested subtype storage is not supported");if(Object(l.j)(c)&&"dot-density"===c.type)throw new i.a(O,"Dot density attributes are not supported in subtype layers");if(u.has(d))throw new i.a(O,"Subtype codes for sublayers must be unique");u.add(d),t.renderers[d]=e,r.mapping[d]=c,b&&(a.classes[d]=b.map(e=>E(h,s,e,"feature",f++,n)))}return c}if("heatmap"===e.renderer.type){const{blurRadius:t,fieldOffset:n,field:r}=e.renderer;return{type:"heatmap",aggregateFields:[],attributes:s,target:o,storage:null,mesh:{blurRadius:t,fieldOffset:n,field:R(s,{target:o,field:r,resultType:"numeric"}).field}}}{const t=[],c="aggregate"===o?Object(g.b)(t,e.renderer,a,null):e.renderer;!function(e,t){const n={mesh:!0,storage:!0};for(const r of t){const{name:t,outStatistic:i}=r,{statisticType:s,onStatisticField:a}=i;let o=null,l=null,c=null;const u="numeric",f="feature";"onStatisticValueExpression"in i?l=B(e,{type:"expression",target:f,valueExpression:i.onStatisticValueExpression,resultType:u}).fieldIndex:"onStatisticNormalizationField"in i?(o=B(e,{type:"field",target:f,field:a,resultType:u}).field,c=i.onStatisticNormalizationField):o=B(e,{type:"field",target:f,field:a,resultType:u}).field,B(e,{type:"statistic",target:"aggregate",name:t,context:n,inField:o,inNormalizationField:c,inFieldIndex:l,statisticType:s})}}(s,t);const u=V(s,o,c,n);let f=null;const h=z(s,o,c),d=Object(y.a)(e.geometryType);let m=e.labelsVisible&&e.labelingInfo||[],p=[];if(a){if("selection"===a.type)throw new i.a(O,"Mapview does not support `selection` reduction type",a);if(a.symbol){const e=new r.a({symbol:a.symbol,visualVariables:"visualVariables"in c?c.visualVariables:null});f=V(s,o,e,n)}p=a&&a.labelsVisible&&a.labelingInfo||[]}m=S(m,d),p=S(p,d);let b=0;const v=[...m.map(e=>E(c,s,e,"feature",b++,n)),...p.map(e=>E(c,s,e,"aggregate",b++,n))],j=function(e,t){if(Object(l.i)(t)||!t.length)return null;t.length>1&&x.warn(`Layer rendering currently only supports ordering by 1 orderByInfo, but found ${t.length}. All but the first will be discarded`);const n=t[0],r="ascending"===n.order?"asc":"desc";if(n.field)return{field:n.field,order:r};if(n.valueExpression)return{fieldIndex:B(e,{type:"expression",target:"feature",valueExpression:n.valueExpression,resultType:"numeric"}).fieldIndex,order:r};return x.error(new i.a(O,"Expected to find a field or valueExpression for OrderByInfo",n)),null}(s,e.orderBy);return{type:"symbol",target:o,attributes:s,aggregateFields:t,storage:h,mesh:{matcher:u,labels:{type:"simple",classes:v},aggregateMatcher:f,sortKey:j}}}}(e,t)),n}(e,t),o={};return a.map(t=>function(e,t,n){switch(n.target){case"feature":return void F(e,M(t),n);case"aggregate":{if(!("featureReduction"in t))return;const r=t.featureReduction;if("selection"===r.type)throw new i.a(O,"Mapview does not support `selection` reduction type",r);return F(e,M(t),n),void function(e,t,n){e.aggregate||(e.aggregate={name:"aggregate",input:"feature",filters:null,attributes:{},params:{clusterRadius:Object(c.c)(t.clusterRadius/2),clusterPixelBuffer:64*Math.ceil(Object(c.c)(t.clusterMaxSize)/64),fields:n.aggregateFields}}),A(e.aggregate,n.attributes.fields)}(e,r,n)}}}(o,e,t)),{source:{definitionExpression:e.definitionExpression,fields:e.fields.map(e=>e.toJSON()),gdbVersion:e.gdbVersion,historicMoment:null==(n=e.historicMoment)?void 0:n.getTime(),outFields:e.availableFields,pixelBuffer:e.pixelBuffer,spatialReference:e.spatialReference.toJSON(),timeExtent:null==(s=e.timeExtent)?void 0:s.toJSON(),customParameters:e.customParameters},attributes:{fields:{},indexCount:0},processors:a,targets:o}}catch(a){if(a.fieldName===O)return x.error(a),null;throw a}}function A(e,t){for(const n in t){const r=t[n];if(r.target!==e.name)continue;const i=e.attributes[n];i?(i.context.mesh=i.context.mesh||r.context.mesh,i.context.storage=i.context.storage||r.context.storage):e.attributes[n]=r}return e}function M(e){var t,n,r,i,s;return[null!=(t=null==(n=e.filter)?void 0:n.toJSON())?t:null,null!=(r=null==(i=e.effect)||null==(s=i.filter)?void 0:s.toJSON())?r:null]}function F(e,t,n){return e.feature||(e.feature={name:"feature",input:"source",filters:t,attributes:{}}),A(e.feature,n.attributes.fields),e}function R(e,t){return t.field?B(e,{...t,type:"field",field:t.field}):t.valueExpression?B(e,{...t,type:"expression",valueExpression:t.valueExpression}):{field:null,fieldIndex:null}}function B(e,t){switch(t.type){case"expression":{const n=t.valueExpression;if(!e.fields[n]){const r=e.indexCount++;e.fields[n]={...t,name:n,fieldIndex:r}}return{fieldIndex:e.fields[n].fieldIndex}}case"label-expression":{const n=JSON.stringify(t.label);if(!e.fields[n]){const r=e.indexCount++;e.fields[n]={...t,name:n,fieldIndex:r}}return{fieldIndex:e.fields[n].fieldIndex}}case"field":{const n=t.field;return"aggregate"===t.target&&e.fields[n]||(e.fields[n]={...t,name:n}),{field:n}}case"statistic":return e.fields[t.name]={...t},{field:t.name}}}function E(e,t,n,r,i,s=!1){const a=B(t,{type:"label-expression",target:r,context:{mesh:!0},resultType:"string",label:{labelExpression:n.labelExpression,labelExpressionInfo:n.labelExpressionInfo?{expression:n.labelExpressionInfo.expression}:null,symbol:!!n.symbol,where:n.where}}),{fieldIndex:o}=a;return{...T(n,e,s),fieldIndex:o,target:r,index:i}}function z(e,t,n){switch(n.type){case"dot-density":return function(e,t,n){return n&&n.length?{type:"dot-density",mapping:n.map((n,r)=>{const{field:i,fieldIndex:s}=R(e,{valueExpression:n.valueExpression,field:n.field,resultType:"numeric",target:t});return{binding:r,field:i,fieldIndex:s}}),target:t}:{type:"dot-density",mapping:[],target:t}}(e,t,n.attributes);case"simple":case"class-breaks":case"unique-value":case"dictionary":return function(e,t,n){if(!n||!n.length)return{type:"visual-variable",mapping:[],target:t};const r={storage:!0},i="numeric";return{type:"visual-variable",mapping:Object(b.b)(n).map(n=>{var s;const a=Object(h.m)(n.type),{field:o,fieldIndex:l}=R(e,{target:t,valueExpression:n.valueExpression,field:n.field,context:r,resultType:i});switch(n.type){case"size":return"$view.scale"===n.valueExpression?null:{type:"size",binding:a,field:o,fieldIndex:l,normalizationField:R(e,{target:t,field:n.normalizationField,context:r,resultType:i}).field,valueRepresentation:null!=(s=n.valueRepresentation)?s:null};case"color":return{type:"color",binding:a,field:o,fieldIndex:l,normalizationField:R(e,{target:t,field:n.normalizationField,context:r,resultType:i}).field};case"opacity":return{type:"opacity",binding:a,field:o,fieldIndex:l,normalizationField:R(e,{target:t,field:n.normalizationField,context:r,resultType:i}).field};case"rotation":return{type:"rotation",binding:a,field:o,fieldIndex:l}}}).filter(e=>e),target:t}}(e,t,n.visualVariables);case"heatmap":return null}}function V(e,t,n,r=!1){const s=Object(l.r)(e,{indexCount:0,fields:{}});switch(n.type){case"simple":case"dot-density":return function(e,t,n,r=!1){const i=t.getSymbols();return{type:"simple",symbol:T(i.length?i[0]:null,t,r),isDotDensity:n}}(0,n,"dot-density"===n.type,r);case"class-breaks":return function(e,t,n,r=!1){const i=n.backgroundFillSymbol,{field:s,fieldIndex:a}=R(e,{target:t,field:n.field,valueExpression:n.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}}),o=n.normalizationType,l="log"===o?"esriNormalizeByLog":"percent-of-total"===o?"esriNormalizeByPercentOfTotal":"field"===o?"esriNormalizeByField":null,c=n.classBreakInfos.map(e=>({symbol:T(e.symbol,n,r),min:e.minValue,max:e.maxValue})).sort((e,t)=>e.min-t.min);return{type:"interval",attributes:e.fields,field:s,fieldIndex:a,backgroundFillSymbol:T(i,n,r),defaultSymbol:T(n.defaultSymbol,n,r),intervals:c,normalizationField:n.normalizationField,normalizationTotal:n.normalizationTotal,normalizationType:l,isMaxInclusive:n.isMaxInclusive}}(s,t,n,r);case"unique-value":return function(e,t,n,r=!1){const s=[],a=n.backgroundFillSymbol,o={target:t,context:{mesh:!0},resultType:"string"};if(n.field&&"string"!=typeof n.field)throw new i.a(O,"Expected renderer.field to be a string",n);const{field:l,fieldIndex:c}=R(e,{...o,field:n.field,valueExpression:n.valueExpression});for(const i of n.uniqueValueInfos)s.push({value:""+i.value,symbol:T(i.symbol,n,r)});return{type:"map",attributes:e.fields,field:l,fieldIndex:c,field2:R(e,{...o,field:n.field2}).field,field3:R(e,{...o,field:n.field3}).field,fieldDelimiter:n.fieldDelimiter,backgroundFillSymbol:T(a,n),defaultSymbol:T(n.defaultSymbol,n),map:s}}(s,t,n,r);case"dictionary":return function(e,t,n=!1){return{type:"dictionary",renderer:t.toJSON()}}(0,n,r)}}},576:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e=0,t=0,n=0,r=0){this.x=e,this.y=t,this.width=n,this.height=r}get isEmpty(){return this.width<=0||this.height<=0}union(e){this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.width=Math.max(this.width,e.width),this.height=Math.max(this.height,e.height)}}},583:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var r=n(76),i=n(327),s=n(29),a=n(300),o=n(550),l=n(536),c=n(576),u=n(49);class f{constructor(e,t,n,r){this.center=Object(a.b)(e,t),this.centerT=Object(a.a)(),this.halfWidth=n/2,this.halfHeight=r/2,this.width=n,this.height=r}get x(){return this.center[0]}get y(){return this.center[1]}get blX(){return this.center[0]+this.halfWidth}get blY(){return this.center[1]+this.halfHeight}get trX(){return this.center[0]-this.halfWidth}get trY(){return this.center[1]-this.halfHeight}get xmin(){return this.x-this.halfWidth}get xmax(){return this.x+this.halfWidth}get ymin(){return this.y-this.halfHeight}get ymax(){return this.y+this.halfHeight}set x(e){this.center[0]=e}set y(e){this.center[1]=e}clone(){return new f(this.x,this.y,this.width,this.height)}serialize(e){return e.writeF32(this.center[0]),e.writeF32(this.center[1]),e.push(this.width),e.push(this.height),e}findCollisionDelta(e,t=4){const n=Math.abs(e.centerT[0]-this.centerT[0]),r=Math.abs(e.centerT[1]-this.centerT[1]),i=(e.halfWidth+this.halfWidth+t)/n,s=(e.halfHeight+this.halfHeight+t)/r,a=Math.min(i,s);return Object(u.j)(a)}extend(e){const t=Math.min(this.xmin,e.xmin),n=Math.min(this.ymin,e.ymin),r=Math.max(this.xmax,e.xmax)-t,i=Math.max(this.ymax,e.ymax)-n,s=t+r/2,a=n+i/2;this.width=r,this.height=i,this.halfWidth=r/2,this.halfHeight=i/2,this.x=s,this.y=a}static deserialize(e){const t=e.readF32(),n=e.readF32(),r=e.readInt32(),i=e.readInt32();return new f(t,n,r,i)}}const h=Math.PI/180;class d{constructor(e,t,n,r){this._rotationT=Object(i.a)(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const s=n.rect,a=new Float32Array(8);e*=r,t*=r;const o=n.code?s.width*r:n.metrics.width,l=n.code?s.height*r:n.metrics.height;a[0]=e,a[1]=t,a[2]=e+o,a[3]=t,a[4]=e,a[5]=t+l,a[6]=e+o,a[7]=t+l,this._data=a,this._setTextureCoords(s),this._scale=r,this._mosaic=n,this.x=e,this.y=t,this.maxOffset=Math.max(e+o,t+l)}get width(){return this._mosaic.metrics.width*this._scale}get mosaic(){return this._mosaic}set angle(e){this._angle=e,Object(r.d)(this._rotationT),Object(r.f)(this._rotationT,this._rotationT,-e),this._setOffsets(this._data)}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(this._data),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:e,width:t}=this._mosaic.metrics,n=t*this._scale,s=Math.abs(e)*this._scale,a=new Float32Array(8);a[0]=this.x,a[1]=this.y,a[2]=this.x+n,a[3]=this.y,a[4]=this.x,a[5]=this.y+s,a[6]=this.x+n,a[7]=this.y+s;const o=Object(r.e)(Object(i.a)(),this._rotationT,this._T);Object(i.b)(a,a,o);let l=1/0,c=1/0,u=0,h=0;for(let r=0;r<4;r++){const e=a[2*r],t=a[2*r+1];l=Math.min(l,e),c=Math.min(c,t),u=Math.max(u,e),h=Math.max(h,t)}const d=u-l,m=h-c,p=l+d/2,b=c+m/2;this._bounds=new f(p,b,d,m)}return this._bounds}setTransform(e){this._T=e,this._offsets=null}_setOffsets(e){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const t=this._offsets,n=new Float32Array(8),s=Object(r.e)(Object(i.a)(),this._rotationT,this._T);Object(i.b)(n,e,s),t.upperLeft=Object(l.a)(8*n[0],8*n[1]),t.upperRight=Object(l.a)(8*n[2],8*n[3]),t.lowerLeft=Object(l.a)(8*n[4],8*n[5]),t.lowerRight=Object(l.a)(8*n[6],8*n[7])}_setTextureCoords({x:e,y:t,width:n,height:r}){this._texcoords={upperLeft:Object(l.a)(e,t),upperRight:Object(l.a)(e+n,t),lowerLeft:Object(l.a)(e,t+r),lowerRight:Object(l.a)(e+n,t+r)}}}const m=(e,t)=>({code:0,page:0,sdf:!0,rect:new c.a(0,0,11,8),textureBinding:t,metrics:{advance:0,height:4,width:e,left:0,top:0}});class p{constructor(e,t,n){this._rotation=0,this._decorate(e,t,n),this.glyphs=e,this.bounds=this._createBounds(e),this.isMultiline=t.length>1,this._hasRotation=0!==n.angle,this._T=this._createGlyphTransform(this.bounds,n);for(const r of e)r.setTransform(this._T)}setRotation(e){if(0===e&&0===this._rotation)return;this._rotation=e;const t=this._T,n=Object(r.b)(Object(i.a)(),e);Object(r.e)(t,n,t);for(const r of this.glyphs)r.setTransform(this._T)}_decorate(e,t,n){if(!n.decoration||"none"===n.decoration||!e.length)return;const r=n.scale,i="underline"===n.decoration?30:20,s=e[0].textureBinding;for(const a of t){const t=a.startX*r,n=a.startY*r,o=(a.width+a.glyphWidthEnd)*r;e.push(new d(t,n+i*r,m(o,s),1))}}get boundsT(){const e=this.bounds,t=Object(s.m)(Object(a.a)(),e.x,e.y);if(Object(s.n)(t,t,this._T),this._hasRotation){const n=Math.max(e.width,e.height);return new f(t[0],t[1],n,n)}return new f(t[0],t[1],e.width,e.height)}_createBounds(e){let t=1/0,n=1/0,r=0,i=0;for(const o of e)t=Math.min(t,o.xTopLeft),n=Math.min(n,o.yTopLeft),r=Math.max(r,o.xTopLeft+o.width),i=Math.max(i,o.yBottomRight);const s=r-t,a=i-n;return new f(t+s/2,n+a/2,s,a)}_createGlyphTransform(e,t){const n=h*t.angle,o=Object(i.a)(),l=Object(a.a)();return Object(r.h)(o,o,Object(s.m)(l,t.xOffset,-t.yOffset)),t.isCIM?Object(r.f)(o,o,n):(Object(r.h)(o,o,Object(s.m)(l,e.x,e.y)),Object(r.f)(o,o,n),Object(r.h)(o,o,Object(s.m)(l,-e.x,-e.y))),o}}class b{constructor(e,t,n,r,i,s){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(t,n)),this.end=Math.max(0,Math.max(t,n)),this.end<e.length&&(this.glyphWidthEnd=e[this.end].metrics.width),this.width=r,this.yMin=i,this.yMax=s}}const g=e=>10===e,y=e=>32===e;function x(e,t,n){const r=n.scale,i=new Array,s=function(e,t,n){const r=new Array,i=1/n.scale,s=n.maxLineWidth*i,a=t?e.length-1:0,o=t?-1:e.length,l=t?-1:1;let c=a,u=0,f=0,h=c,d=h,m=0,p=1/0,x=0;for(;c!==o;){const{code:t,metrics:n}=e[c],i=Math.abs(n.top);if(g(t)||y(t)||(p=Math.min(p,i),x=Math.max(x,i+n.height)),g(t))c!==a&&(r.push(new b(e,h,c-l,u,p,x)),p=1/0,x=0),u=0,h=c+l,d=c+l,f=0;else if(y(t))d=c+l,f=0,m=n.advance,u+=n.advance;else if(u>s){if(d!==h){const t=d-2*l;u-=m,r.push(new b(e,h,t,u-f,p,x)),p=1/0,x=0,h=d,u=f}else r.push(new b(e,h,c-l,u,p,x)),p=1/0,x=0,h=c,d=c,u=0;u+=n.advance,f+=n.advance}else u+=n.advance,f+=n.advance;c+=l}const O=new b(e,h,c-l,u,p,x);return O.start>=0&&O.end<e.length&&r.push(O),r}(e,t,n),a=function(e,t){let n=0;for(let s=0;s<e.length;s++){const{width:t}=e[s];n=Math.max(t,n)}const r="underline"===t.decoration?4:0,i=e[0].yMin;return{x:0,y:i,height:e[e.length-1].yMax+t.lineHeight*(e.length-1)+r-i,width:n}}(s,n),{vAlign:l,hAlign:c}=n,u=l===o.a.Baseline?1:0,f=u?0:l-1,h=(1-u)*-a.y+f*(a.height/2)+-26*(u?1:0);for(let o=0;o<s.length;o++){const{start:t,end:a,width:l}=s[o];let u=-1*(c+1)*(l/2)-3;const f=o*n.lineHeight+h-3;s[o].startX=u,s[o].startY=f;for(let n=t;n<=a;n++){const t=e[n];if(g(t.code))continue;const s=new d(u+t.metrics.left,f-t.metrics.top,t,r);u+=t.metrics.advance,i.push(s)}}return new p(i,s,n)}},591:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return r}));const r={Base64:0,Hex:1,String:2,Raw:3};function i(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function s(e){const t=[];for(let n=0,r=8*e.length;n<r;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t}function a(e){const t=[];for(let n=0,r=32*e.length;n<r;n+=8)t.push(String.fromCharCode(e[n>>5]>>>n%32&255));return t.join("")}function o(e,t,n,r,s,a){return i(function(e,t){return e<<t|e>>>32-t}(i(i(t,e),i(r,a)),s),n)}function l(e,t,n,r,i,s,a){return o(t&n|~t&r,e,t,i,s,a)}function c(e,t,n,r,i,s,a){return o(t&r|n&~r,e,t,i,s,a)}function u(e,t,n,r,i,s,a){return o(t^n^r,e,t,i,s,a)}function f(e,t,n,r,i,s,a){return o(n^(t|~r),e,t,i,s,a)}function h(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;let n=1732584193,r=-271733879,s=-1732584194,a=271733878;for(let o=0;o<e.length;o+=16){const t=n,h=r,d=s,m=a;n=l(n,r,s,a,e[o+0],7,-680876936),a=l(a,n,r,s,e[o+1],12,-389564586),s=l(s,a,n,r,e[o+2],17,606105819),r=l(r,s,a,n,e[o+3],22,-1044525330),n=l(n,r,s,a,e[o+4],7,-176418897),a=l(a,n,r,s,e[o+5],12,1200080426),s=l(s,a,n,r,e[o+6],17,-1473231341),r=l(r,s,a,n,e[o+7],22,-45705983),n=l(n,r,s,a,e[o+8],7,1770035416),a=l(a,n,r,s,e[o+9],12,-1958414417),s=l(s,a,n,r,e[o+10],17,-42063),r=l(r,s,a,n,e[o+11],22,-1990404162),n=l(n,r,s,a,e[o+12],7,1804603682),a=l(a,n,r,s,e[o+13],12,-40341101),s=l(s,a,n,r,e[o+14],17,-1502002290),r=l(r,s,a,n,e[o+15],22,1236535329),n=c(n,r,s,a,e[o+1],5,-165796510),a=c(a,n,r,s,e[o+6],9,-1069501632),s=c(s,a,n,r,e[o+11],14,643717713),r=c(r,s,a,n,e[o+0],20,-373897302),n=c(n,r,s,a,e[o+5],5,-701558691),a=c(a,n,r,s,e[o+10],9,38016083),s=c(s,a,n,r,e[o+15],14,-660478335),r=c(r,s,a,n,e[o+4],20,-405537848),n=c(n,r,s,a,e[o+9],5,568446438),a=c(a,n,r,s,e[o+14],9,-1019803690),s=c(s,a,n,r,e[o+3],14,-187363961),r=c(r,s,a,n,e[o+8],20,1163531501),n=c(n,r,s,a,e[o+13],5,-1444681467),a=c(a,n,r,s,e[o+2],9,-51403784),s=c(s,a,n,r,e[o+7],14,1735328473),r=c(r,s,a,n,e[o+12],20,-1926607734),n=u(n,r,s,a,e[o+5],4,-378558),a=u(a,n,r,s,e[o+8],11,-2022574463),s=u(s,a,n,r,e[o+11],16,1839030562),r=u(r,s,a,n,e[o+14],23,-35309556),n=u(n,r,s,a,e[o+1],4,-1530992060),a=u(a,n,r,s,e[o+4],11,1272893353),s=u(s,a,n,r,e[o+7],16,-155497632),r=u(r,s,a,n,e[o+10],23,-1094730640),n=u(n,r,s,a,e[o+13],4,681279174),a=u(a,n,r,s,e[o+0],11,-358537222),s=u(s,a,n,r,e[o+3],16,-722521979),r=u(r,s,a,n,e[o+6],23,76029189),n=u(n,r,s,a,e[o+9],4,-640364487),a=u(a,n,r,s,e[o+12],11,-421815835),s=u(s,a,n,r,e[o+15],16,530742520),r=u(r,s,a,n,e[o+2],23,-995338651),n=f(n,r,s,a,e[o+0],6,-198630844),a=f(a,n,r,s,e[o+7],10,1126891415),s=f(s,a,n,r,e[o+14],15,-1416354905),r=f(r,s,a,n,e[o+5],21,-57434055),n=f(n,r,s,a,e[o+12],6,1700485571),a=f(a,n,r,s,e[o+3],10,-1894986606),s=f(s,a,n,r,e[o+10],15,-1051523),r=f(r,s,a,n,e[o+1],21,-2054922799),n=f(n,r,s,a,e[o+8],6,1873313359),a=f(a,n,r,s,e[o+15],10,-30611744),s=f(s,a,n,r,e[o+6],15,-1560198380),r=f(r,s,a,n,e[o+13],21,1309151649),n=f(n,r,s,a,e[o+4],6,-145523070),a=f(a,n,r,s,e[o+11],10,-1120210379),s=f(s,a,n,r,e[o+2],15,718787259),r=f(r,s,a,n,e[o+9],21,-343485551),n=i(n,t),r=i(r,h),s=i(s,d),a=i(a,m)}return[n,r,s,a]}function d(e,t=r.Hex){const n=t||r.Base64,i=h(s(e),8*e.length);switch(n){case r.Raw:return i;case r.Hex:return function(e){const t="0123456789abcdef",n=[];for(let r=0,i=4*e.length;r<i;r++)n.push(t.charAt(e[r>>2]>>r%4*8+4&15)+t.charAt(e[r>>2]>>r%4*8&15));return n.join("")}(i);case r.String:return a(i);case r.Base64:return function(e){const t=[];for(let n=0,r=4*e.length;n<r;n+=3){const r=(e[n>>2]>>n%4*8&255)<<16|(e[n+1>>2]>>(n+1)%4*8&255)<<8|e[n+2>>2]>>(n+2)%4*8&255;for(let i=0;i<4;i++)8*n+6*i>32*e.length?t.push("="):t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>6*(3-i)&63))}return t.join("")}(i)}}},598:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r=new(n(21).a)({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function i(e){return r.toJSON(e)}},599:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));const r=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["\xab","\xbb"],["\xbb","\xab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]],i=["\u0622","\u0623","\u0625","\u0627"],s=["\ufef5","\ufef7","\ufef9","\ufefb"],a=["\ufef6","\ufef8","\ufefa","\ufefc"],o=["\u0627","\u0628","\u062a","\u062b","\u062c","\u062d","\u062e","\u062f","\u0630","\u0631","\u0632","\u0633","\u0634","\u0635","\u0636","\u0637","\u0638","\u0639","\u063a","\u0641","\u0642","\u0643","\u0644","\u0645","\u0646","\u0647","\u0648","\u064a","\u0625","\u0623","\u0622","\u0629","\u0649","\u0644","\u0645","\u0646","\u0647","\u0648","\u064a","\u0625","\u0623","\u0622","\u0629","\u0649","\u06cc","\u0626","\u0624"],l=["\ufe8d","\ufe8f","\ufe95","\ufe99","\ufe9d","\ufea1","\ufea5","\ufea9","\ufeab","\ufead","\ufeaf","\ufeb1","\ufeb5","\ufeb9","\ufebd","\ufec1","\ufec5","\ufec9","\ufecd","\ufed1","\ufed5","\ufed9","\ufedd","\ufee1","\ufee5","\ufee9","\ufeed","\ufef1","\ufe87","\ufe83","\ufe81","\ufe93","\ufeef","\ufbfc","\ufe89","\ufe85","\ufe70","\ufe72","\ufe74","\ufe76","\ufe78","\ufe7a","\ufe7c","\ufe7e","\ufe80","\ufe89","\ufe85"],c=["\ufe8e","\ufe90","\ufe96","\ufe9a","\ufe9e","\ufea2","\ufea6","\ufeaa","\ufeac","\ufeae","\ufeb0","\ufeb2","\ufeb6","\ufeba","\ufebe","\ufec2","\ufec6","\ufeca","\ufece","\ufed2","\ufed6","\ufeda","\ufede","\ufee2","\ufee6","\ufeea","\ufeee","\ufef2","\ufe88","\ufe84","\ufe82","\ufe94","\ufef0","\ufbfd","\ufe8a","\ufe86","\ufe70","\ufe72","\ufe74","\ufe76","\ufe78","\ufe7a","\ufe7c","\ufe7e","\ufe80","\ufe8a","\ufe86"],u=["\ufe8e","\ufe92","\ufe98","\ufe9c","\ufea0","\ufea4","\ufea8","\ufeaa","\ufeac","\ufeae","\ufeb0","\ufeb4","\ufeb8","\ufebc","\ufec0","\ufec4","\ufec8","\ufecc","\ufed0","\ufed4","\ufed8","\ufedc","\ufee0","\ufee4","\ufee8","\ufeec","\ufeee","\ufef4","\ufe88","\ufe84","\ufe82","\ufe94","\ufef0","\ufbff","\ufe8c","\ufe86","\ufe71","\ufe72","\ufe74","\ufe77","\ufe79","\ufe7b","\ufe7d","\ufe7f","\ufe80","\ufe8c","\ufe86"],f=["\ufe8d","\ufe91","\ufe97","\ufe9b","\ufe9f","\ufea3","\ufea7","\ufea9","\ufeab","\ufead","\ufeaf","\ufeb3","\ufeb7","\ufebb","\ufebf","\ufec3","\ufec7","\ufecb","\ufecf","\ufed3","\ufed7","\ufedb","\ufedf","\ufee3","\ufee7","\ufeeb","\ufeed","\ufef3","\ufe87","\ufe83","\ufe81","\ufe93","\ufeef","\ufbfe","\ufe8b","\ufe85","\ufe70","\ufe72","\ufe74","\ufe76","\ufe78","\ufe7a","\ufe7c","\ufe7e","\ufe80","\ufe8b","\ufe85"],h=["\u0621","\u0622","\u0623","\u0624","\u0625","\u0627","\u0629","\u062f","\u0630","\u0631","\u0632","\u0648","\u0649"],d=["\u064b","\u064b","\u064c","\u061f","\u064d","\u061f","\u064e","\u064e","\u064f","\u064f","\u0650","\u0650","\u0651","\u0651","\u0652","\u0652","\u0621","\u0622","\u0622","\u0623","\u0623","\u0624","\u0624","\u0625","\u0625","\u0626","\u0626","\u0626","\u0626","\u0627","\u0627","\u0628","\u0628","\u0628","\u0628","\u0629","\u0629","\u062a","\u062a","\u062a","\u062a","\u062b","\u062b","\u062b","\u062b","\u062c","\u062c","\u062c","\u062c","\u062d","\u062d","\u062d","\u062d","\u062e","\u062e","\u062e","\u062e","\u062f","\u062f","\u0630","\u0630","\u0631","\u0631","\u0632","\u0632","\u0633","\u0633","\u0633","\u0633","\u0634","\u0634","\u0634","\u0634","\u0635","\u0635","\u0635","\u0635","\u0636","\u0636","\u0636","\u0636","\u0637","\u0637","\u0637","\u0637","\u0638","\u0638","\u0638","\u0638","\u0639","\u0639","\u0639","\u0639","\u063a","\u063a","\u063a","\u063a","\u0641","\u0641","\u0641","\u0641","\u0642","\u0642","\u0642","\u0642","\u0643","\u0643","\u0643","\u0643","\u0644","\u0644","\u0644","\u0644","\u0645","\u0645","\u0645","\u0645","\u0646","\u0646","\u0646","\u0646","\u0647","\u0647","\u0647","\u0647","\u0648","\u0648","\u0649","\u0649","\u064a","\u064a","\u064a","\u064a","\ufef5","\ufef6","\ufef7","\ufef8","\ufef9","\ufefa","\ufefb","\ufefc","\u061f","\u061f","\u061f"],m=["\u0621","\u0641"],p=["\u063a","\u064a"],b=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y=10,x=12,O=18,v=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],j=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107],w=[[O,O,O,O,O,O,O,O,O,6,5,6,8,5,O,O,O,O,O,O,O,O,O,O,O,O,O,O,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,y,9,y,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,O,O,O,O,O,O,5,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,9,4,11,11,11,11,4,4,4,4,0,4,4,O,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,1,x,1,x,x,1,x,x,1,x,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,11,11,7,9,7,4,4,x,x,x,x,x,x,x,x,x,x,x,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,3,3,3,3,3,3,3,3,3,3,11,3,3,7,7,7,x,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,x,x,x,x,x,x,x,3,4,x,x,x,x,x,x,7,7,x,x,4,x,x,x,x,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,x,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,x,x,x,x,x,x,x,x,x,x,x,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,x,x,x,x,x,x,x,x,x,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,O,O,O,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,O,O,O,O,O,4,4,4,4,4,O,O,O,O,O,O,2,0,4,4,2,2,2,2,2,2,y,y,4,4,4,0,2,2,2,2,2,2,2,2,2,2,y,y,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,4,4,4,4,4,1,x,1,1,1,1,1,1,1,1,1,1,y,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,x,x,x,x,x,x,x,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,11,4,4,y,y,4,4,4,4,4,11,11,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,O],[4,4,4,11,11,11,4,4,4,4,4,y,9,y,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,11,11,4,4,4,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]];class T{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(e,t,n){if(this.sourceToTarget=[],this.targetToSource=[],!e)return"";if(function(e,t,n){q=[],G=[];for(let r=0;r<n;r++)e[r]=r,t[r]=r,q[r]=r}(this.sourceToTarget,this.targetToSource,e.length),!this.checkParameters(t,n))return e;t=this.inputFormat,n=this.outputFormat;let r=e;const o=K,u=k(t.charAt(1)),h=k(n.charAt(1)),m=("I"===t.charAt(0)?"L":t.charAt(0))+u,p=("I"===n.charAt(0)?"L":n.charAt(0))+h,b=t.charAt(2)+n.charAt(2);o.defInFormat=m,o.defOutFormat=p,o.defSwap=b;const g=function e(t,n,r,i,s){const a=function(e,t,n){if(void 0===t.inFormat&&(t.inFormat=n.defInFormat),void 0===t.outFormat&&(t.outFormat=n.defOutFormat),void 0===t.swap&&(t.swap=n.defSwap),t.inFormat===t.outFormat)return t;const r=t.inFormat.substring(0,1),i=t.outFormat.substring(0,1);let s,a=t.inFormat.substring(1,4),o=t.outFormat.substring(1,4);return"C"===a.charAt(0)&&(s=S(e),a="ltr"===s||"rtl"===s?s.toUpperCase():"L"===t.inFormat.charAt(2)?"LTR":"RTL",t.inFormat=r+a),"C"===o.charAt(0)&&(s=S(e),"rtl"===s?o="RTL":"ltr"===s?(s=function(e){const t=e.split("");return t.reverse(),S(t.join(""))}(e),o=s.toUpperCase()):o="L"===t.outFormat.charAt(2)?"LTR":"RTL",t.outFormat=i+o),t}(t,{inFormat:n,outFormat:r,swap:i},s);if(a.inFormat===a.outFormat)return t;n=a.inFormat,r=a.outFormat,i=a.swap;const o=n.substring(0,1),l=n.substring(1,4),c=r.substring(0,1),u=r.substring(1,4);if(s.inFormat=n,s.outFormat=r,s.swap=i,"L"===o&&"VLTR"===r){if("LTR"===l)return s.dir=X,L(t,s);if("RTL"===l)return s.dir=Z,L(t,s)}if("V"===o&&"V"===c)return s.dir="RTL"===l?Z:X,M(t,s);if("L"===o&&"VRTL"===r)return"LTR"===l?(s.dir=X,t=L(t,s)):(s.dir=Z,t=L(t,s)),M(t);if("VLTR"===n&&"LLTR"===r)return s.dir=X,L(t,s);if("V"===o&&"L"===c&&l!==u)return t=M(t),"RTL"===l?e(t,"LLTR","VLTR",i,s):e(t,"LRTL","VRTL",i,s);if("VRTL"===n&&"LRTL"===r)return e(t,"LRTL","VRTL",i,s);if("L"===o&&"L"===c){const n=s.swap;return s.swap=n.substr(0,1)+"N","RTL"===l?(s.dir=Z,t=L(t,s),s.swap="N"+n.substr(1,2),s.dir=X,t=L(t,s)):(s.dir=X,t=L(t,s),s.swap="N"+n.substr(1,2),t=e(t,"VLTR","LRTL",s.swap,s)),t}return t}(e,m,p,b,o);let y=!1;return"R"===n.charAt(1)?y=!0:"C"!==n.charAt(1)&&"D"!==n.charAt(1)||(y="rtl"===this.checkContextual(g)),this.sourceToTarget=q,this.targetToSource=function(e){const t=new Array(e.length);for(let n=0;n<e.length;n++)t[e[n]]=n;return t}(this.sourceToTarget),J=this.targetToSource,r=t.charAt(3)===n.charAt(3)?g:"S"===n.charAt(3)?function(e,t,n){if(0===t.length)return"";void 0===e&&(e=!0),void 0===n&&(n=!0);const r=(t=String(t)).split("");let i=0,o=1,u=r.length;e||(i=r.length-1,o=-1,u=1);const h=function(e,t,n,r,i){let o=0;const u=[];let h=0;for(let d=t;d*n<r;d+=n)if(R(e[d])||P(e[d])){if("\u0644"===e[d]&&E(e,d+n,n,r)){e[d]=W(e[d+n],0===o?s:a),d+=n,D(e,d,n,r),i&&(u[h]=d,h++),o=0;continue}const t=e[d];1===o?e[d]=B(e,d+n,n,r)?N(e[d]):U(e[d],c):!0===B(e,d+n,n,r)?e[d]=U(e[d],f):e[d]=U(e[d],l),P(t)||(o=1),!0===I(t)&&(o=0)}else o=0;return u}(r,i,o,u,n);let d="";for(let s=0;s<r.length;s++)n&&F(h,h.length,s)>-1?(H(J,s,!e,-1),q.splice(s,1)):d+=r[s];return d}(y,g,!0):function(e,t,n){if(0===e.length)return"";void 0===n&&(n=!0),void 0===t&&(t=!0);let r="";const s=(e=String(e)).split("");for(let a=0;a<e.length;a++){let o=!1;if(s[a]>="\ufe70"&&s[a]<"\ufeff"){const l=e.charCodeAt(a);s[a]>="\ufef5"&&s[a]<="\ufefc"?(t?(a>0&&n&&" "===s[a-1]?r=r.substring(0,r.length-1)+"\u0644":(r+="\u0644",o=!0),r+=i[(l-65269)/2]):(r+=i[(l-65269)/2],r+="\u0644",a+1<e.length&&n&&" "===s[a+1]?a++:o=!0),o&&(H(J,a,!0,1),q.splice(a,0,q[a]))):r+=d[l-65136]}else r+=s[a]}return r}(g,y,!0),this.sourceToTarget=q,this.targetToSource=J,this.levels=G,r}_inputFormatSetter(e){if(!Q.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=e}_outputFormatSetter(e){if(!Q.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=e}checkParameters(e,t){return e?this._inputFormatSetter(e):e=this.inputFormat,t?this._outputFormatSetter(t):t=this.outputFormat,e!==t}checkContextual(e){let t=S(e);if("ltr"!==t&&"rtl"!==t){try{t=document.dir.toLowerCase()}catch(n){}"ltr"!==t&&"rtl"!==t&&(t="ltr")}return t}hasBidiChar(e){return ee.test(e)}}function S(e){const t=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(e);return t?t[0]<="z"?"ltr":"rtl":""}function L(e,t){const n=e.split(""),r=[];return _(n,r,t),function(e,t,n){if(0!==n.hiLevel&&n.swap.substr(0,1)!==n.swap.substr(1,2))for(let r=0;r<e.length;r++)1===t[r]&&(e[r]=C(e[r]))}(n,r,t),z(2,n,r,t),z(1,n,r,t),G=r,n.join("")}function _(e,t,n){const r=e.length,i=n.dir?g:b;let s=0,a=-1;const o=[],l=[];n.hiLevel=n.dir,n.lastArabic=!1,n.hasUbatAl=!1,n.hasUbatB=!1,n.hasUbatS=!1;for(let c=0;c<r;c++)o[c]=A(e[c]);for(let c=0;c<r;c++){const r=s,u=V(e,o,l,c,n);l[c]=u,s=i[r][u];const f=240&s;s&=15;const h=i[s][Y];if(t[c]=h,f>0)if(16===f){for(let e=a;e<c;e++)t[e]=1;a=-1}else a=-1;if(i[s][$])-1===a&&(a=c);else if(a>-1){for(let e=a;e<c;e++)t[e]=h;a=-1}5===o[c]&&(t[c]=0),n.hiLevel|=h}n.hasUbatS&&function(e,t,n,r){for(let i=0;i<n;i++)if(6===e[i]){t[i]=r.dir;for(let n=i-1;n>=0&&8===e[n];n--)t[n]=r.dir}}(o,t,r,n)}function A(e){const t=e.charCodeAt(0),n=j[t>>8];return n<100?n:w[n-100][255&t]}function M(e,t){const n=e.split("");if(t){const e=[];_(n,e,t),G=e}return n.reverse(),q.reverse(),n.join("")}function F(e,t,n){for(let r=0;r<t;r++)if(e[r]===n)return r;return-1}function R(e){for(let t=0;t<m.length;t++)if(e>=m[t]&&e<=p[t])return!0;return!1}function B(e,t,n,r){for(;t*n<r&&P(e[t]);)t+=n;return!!(t*n<r&&R(e[t]))}function E(e,t,n,r){for(;t*n<r&&P(e[t]);)t+=n;let s=" ";if(!(t*n<r))return!1;s=e[t];for(let a=0;a<i.length;a++)if(i[a]===s)return!0;return!1}function z(e,t,n,r){if(r.hiLevel<e)return;if(1===e&&r.dir===Z&&!r.hasUbatB)return t.reverse(),void q.reverse();const i=t.length;let s,a,o,l,c,u=0;for(;u<i;){if(n[u]>=e){for(s=u+1;s<i&&n[s]>=e;)s++;for(a=u,o=s-1;a<o;a++,o--)l=t[a],t[a]=t[o],t[o]=l,c=q[a],q[a]=q[o],q[o]=c;u=s}u++}}function V(e,t,n,r,i){const s=t[r];return{UBAT_L:()=>(i.lastArabic=!1,0),UBAT_R:()=>(i.lastArabic=!1,1),UBAT_ON:()=>4,UBAT_AN:()=>3,UBAT_EN:()=>i.lastArabic?3:2,UBAT_AL:()=>(i.lastArabic=!0,i.hasUbatAl=!0,1),UBAT_WS:()=>4,UBAT_CS:()=>{let e,s;return r<1||r+1>=t.length||2!==(e=n[r-1])&&3!==e||2!==(s=t[r+1])&&3!==s?4:(i.lastArabic&&(s=3),s===e?s:4)},UBAT_ES:()=>2===(r>0?n[r-1]:5)&&r+1<t.length&&2===t[r+1]?2:4,UBAT_ET:()=>{if(r>0&&2===n[r-1])return 2;if(i.lastArabic)return 4;let e=r+1;const s=t.length;for(;e<s&&11===t[e];)e++;return e<s&&2===t[e]?2:4},UBAT_NSM:()=>{if("VLTR"===i.inFormat){const n=t.length;let i=r+1;for(;i<n&&t[i]===x;)i++;if(i<n){const n=e[r].charCodeAt[0],s=n>=1425&&n<=2303||64286===n,a=t[i];if(s&&(1===a||7===a))return 1}}return r<1||5===t[r-1]?4:n[r-1]},UBAT_B:()=>(i.lastArabic=!0,i.hasUbatB=!0,i.dir),UBAT_S:()=>(i.hasUbatS=!0,4),UBAT_LRE:()=>(i.lastArabic=!1,4),UBAT_RLE:()=>(i.lastArabic=!1,4),UBAT_LRO:()=>(i.lastArabic=!1,4),UBAT_RLO:()=>(i.lastArabic=!1,4),UBAT_PDF:()=>(i.lastArabic=!1,4),UBAT_BN:()=>4}[v[s]]()}function C(e){let t,n=0,i=r.length-1;for(;n<=i;)if(t=Math.floor((n+i)/2),e<r[t][0])i=t-1;else{if(!(e>r[t][0]))return r[t][1];n=t+1}return e}function I(e){for(let t=0;t<h.length;t++)if(h[t]===e)return!0;return!1}function N(e){for(let t=0;t<o.length;t++)if(e===o[t])return u[t];return e}function U(e,t){for(let n=0;n<o.length;n++)if(e===o[n])return t[n];return e}function P(e){return e>="\u064b"&&e<="\u0655"}function k(e){return"L"===e?"LTR":"R"===e?"RTL":"C"===e?"CLR":"D"===e?"CRL":""}function D(e,t,n,r){for(;t*n<r&&P(e[t]);)t+=n;return t*n<r&&(e[t]=" ",!0)}function W(e,t){for(let n=0;n<i.length;n++)if(e===i[n])return t[n];return e}function H(e,t,n,r){for(let i=0;i<e.length;i++)(e[i]>t||!n&&e[i]===t)&&(e[i]+=r)}let q=[],J=[],G=[];const K={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},Y=5,$=6,X=0,Z=1,Q=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,ee=/[\u0591-\u06ff\ufb1d-\ufefc]/},600:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var r=n(18),i=n(67),s=n(186),a=n(533),o=n(554);const l={"simple-marker":1,"picture-marker":1,text:0,"simple-line":0,"simple-fill":0,"picture-fill":0,cim:1,"web-style":1};function c(e){if(!("visualVariables"in e))return 0;if(!e.hasVisualVariables("size"))return 0;const t=e.getVisualVariablesForType("size");if(!t[0])return 0;const n=t[0];if("outline"===n.target)return 0;if("stops"===n.transformationType)return n.stops.map(e=>e.size).reduce(g,0);if("clamped-linear"===n.transformationType){let e=-1/0,t=-1/0;return e="number"==typeof n.maxSize?n.maxSize:n.maxSize.stops.map(e=>e.size).reduce(g,0),t="number"==typeof n.minSize?n.minSize:n.minSize.stops.map(e=>e.size).reduce(g,0),Math.max(e,t)}return"real-world-size"===n.transformationType?30:void 0}async function u(e,t,n){if(!e||n&&"cluster"===n.type)return 0;if("heatmap"===e.type)return Math.round(3*e.blurRadius);if("dot-density"===e.type)return 0;if("dictionary"===e.type)return"esriGeometryPoint"===t||"esriGeometryMultipoint"===t?100:200;const i=e.getSymbols(),s=c(e),a=[];for(const r of i)a.push(p(r,s));const o=await Promise.all(a);return Object(r.c)(o.reduce(g,0))}const f=[0,0,0,0];function h(e,t){return null==e?t:e}const d={sdf:!0,code:99,metrics:a.c.metrics,rect:new s.a(0,0,24,24),page:0,textureBinding:2};async function m(e,t){if("simple-marker"===e.type){const n=Math.max(h(e.size,12),t);return b(e)+.707*n}if("picture-marker"===e.type){const n=Math.max(h(e.height,12),t),r=h(e.width,12)*(n/h(e.height,12))/2,i=n/2;return b(e)+Math.sqrt(r*r+i*i)}if("text"===e.type){const t=function(e){const t=e.text&&e.text.length;if(!t)return{glyphMosaicItems:[d]};const n=[];for(let r=0;r<t;r++)n.push({...d,code:e.text.charCodeAt(r)});return{glyphMosaicItems:n}}(e);Object(o.g)(f,e.toJSON(),t);const n=Math.abs(f[0]),r=Math.abs(f[1]),i=f[2],s=f[3];return Math.max(n,r)+Math.max(i,s)}if("simple-line"===e.type){const n=e,r=Math.max(h(n.width,.75),t)/2;return n.marker?Math.max(6*n.width,2*t):r}if("simple-fill"===e.type||"picture-fill"===e.type)return Math.max(function(e,t){return null==e.outline?t:h(e.outline.width,t)}(e,0),t)/2;if("cim"===e.type){const t=i.a.getEnvelope(e.data);return t?Math.sqrt(t.width*t.width+t.height*t.height):0}return"web-style"===e.type?m(await e.fetchCIMSymbol(),t):0}async function p(e,t){return function(e){return e.type in l}(e)?Math.min(await m(e,t),75):0}function b(e){const t=h(e.xoffset,0),n=h(e.yoffset,0);return Math.sqrt(t*t+n*n)}function g(e,t){return Math.max(e,t)}},601:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(4),i=n(18);const s=r.a.getLogger("esri.renderers.visualVariables.support.utils"),a=e=>{if(!("visualVariables"in e)||!e.visualVariables||!e.visualVariables.length)return e;const t=e.clone(),n=t.visualVariables.map(e=>l(e)?c(e):e);return t.visualVariables=n,t};function o(e){return e.map(e=>l(e)?c(e.clone()):e)}function l(e){return("size"===e.type||"color"===e.type||"opacity"===e.type)&&null!=e.stops}function c(e){return e.stops=function(e,t){return t.length<=8?t:(s.warn(`Found ${t.length} Visual Variable stops, but MapView only supports 8. Displayed stops will be simplified.`),t.length>16?function(e,t){const[n,...r]=t,s=r.pop(),a=r[0].value,o=r[r.length-1].value,l=(o-a)/6,c=[];for(let f=a;f<o;f+=l){let n=0;for(;f>=r[n].value;)n++;const s=r[n],a=t[n-1],o=f-a.value,l=s.value===a.value?1:o/(s.value-a.value);if("color"===e){const e=r[n],i=t[n-1],s=e.color.clone();s.r=u(i.color.r,s.r,l),s.g=u(i.color.g,s.g,l),s.b=u(i.color.b,s.b,l),s.a=u(i.color.a,s.a,l),c.push({value:f,color:s,label:e.label})}else if("size"===e){const e=r[n],s=t[n-1],a=Object(i.e)(e.size),o=u(Object(i.e)(s.size),a,l);c.push({value:f,size:o,label:e.label})}else{const e=r[n],i=u(t[n-1].opacity,e.opacity,l);c.push({value:f,opacity:i,label:e.label})}}return[n,...c,s]}(e,t):function(e){const[t,...n]=e,r=n.pop();for(;n.length>6;){let e=0,t=0;for(let r=1;r<n.length;r++){const i=n[r-1],s=n[r],a=Math.abs(s.value-i.value);a>t&&(t=a,e=r)}n.splice(e,1)}return[t,...n,r]}(t))}(e.type,e.stops),e}function u(e,t,n){return(1-n)*e+n*t}},603:function(e,t,n){"use strict";n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return T}));var r,i=n(9),s=n(5),a=n(4),o=n(3),l=n(591),c=n(253),u=n(344),f=n(0),h=n(7),d=n(1),m=(n(6),n(2)),p=n(14),b=n(100);let g=r=class extends c.a{writeLevels(e,t,n){for(const r in e){const e=this.levels[r];return void(t.stops=e)}}clone(){return new r({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:Object(b.c)(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:Object(b.c)(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(e=>e.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:Object(h.a)(this.levels)})}};Object(f.a)([Object(d.b)()],g.prototype,"levels",void 0),Object(f.a)([Object(p.a)("levels")],g.prototype,"writeLevels",null),g=r=Object(f.a)([Object(m.a)("esri.views.2d.engine.LevelDependentSizeVariable")],g);const y=a.a.getLogger("esri.views.2d.layers.support.clusterUtils");s.a.add("esri-cluster-arcade-enabled",!0);const x=Object(s.a)("esri-cluster-arcade-enabled"),O=(e,t,n,r)=>{const i=t.clone();if(!T(i))return i;if(n.fields)for(const s of n.fields)S(e,s);if("visualVariables"in i){const t=(i.visualVariables||[]).filter(e=>"$view.scale"!==e.valueExpression),s=v(t);t.forEach(t=>{"rotation"===t.type?t.field?t.field=_(e,t.field,"avg_angle"):t.valueExpression&&(t.field=L(e,t.valueExpression,"avg_angle"),t.valueExpression=null):t.normalizationField?(t.field=_(e,t.field,"norm",t.normalizationField),t.normalizationField=null):t.field?t.field=_(e,t.field,"avg"):(t.field=L(e,t.valueExpression,"avg"),t.valueExpression=null)}),Object(o.i)(s)&&!j(t)&&(t.push(w(n,r)),i.dynamicClusterSize=!0),i.visualVariables=t}switch(i.type){case"simple":break;case"unique-value":i.field?i.field=_(e,i.field,"mode"):i.valueExpression&&(i.field=L(e,i.valueExpression,"mode"),i.valueExpression=null);break;case"class-breaks":i.normalizationField?(i.field=_(e,i.field,"norm",i.normalizationField),i.normalizationField=null):i.field?i.field=_(e,i.field,"avg"):(i.field=L(e,i.valueExpression,"avg"),i.valueExpression=null)}return i},v=e=>{for(const t of e)if("size"===t.type)return t;return null},j=e=>{for(const t of e)if("cluster_count"===t.field)return!0;return!1},w=(e,t)=>{const n=[new u.a({value:0,size:0}),new u.a({value:1})];if(Object(o.i)(t))return new c.a({field:"cluster_count",stops:[...n,new u.a({value:2,size:0})]});const r=Object.keys(t).reduce((r,i)=>({...r,[i]:[...n,new u.a({value:Math.max(2,t[i].minValue),size:e.clusterMinSize}),new u.a({value:Math.max(3,t[i].maxValue),size:e.clusterMaxSize})]}),{});return new g({field:"cluster_count",levels:r})},T=e=>{const t=t=>y.error(new i.a("Unsupported-renderer",t,{renderer:e}));if("unique-value"===e.type){if(e.field2||e.field3)return t("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===e.type){if(e.normalizationField){const n=e.normalizationType;if("field"!==n)return t("FeatureReductionCluster does not support a normalizationType of "+n),!1}}else if("simple"!==e.type)return t("FeatureReductionCluster does not support renderers of type "+e.type),!1;if(!x){if("valueExpression"in e&&e.valueExpression)return t("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in e&&e.visualVariables||[]).some(e=>!(!("valueExpression"in e)||!e.valueExpression)))return t("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function S(e,t){const{name:n,outStatistic:r}=t,{onStatisticField:s,onStatisticValueExpression:a,statisticType:o}=r;if(a){const t=Object(l.a)(a.toLowerCase());e.push({name:n,outStatistic:{onStatisticField:t,onStatisticValueExpression:a,statisticType:o}})}else s?e.push({name:n,outStatistic:{onStatisticField:s,statisticType:o}}):y.error(new i.a("mapview-unsupported-field","Unable to handle field",{field:t}))}function L(e,t,n){const r=Object(l.a)(t),i="mode"===n?"cluster_type_"+r:"cluster_avg_"+r;return e.some(e=>e.name===i)||e.push({name:i,outStatistic:{onStatisticField:r,onStatisticValueExpression:t,statisticType:n}}),i}function _(e,t,n,r){if("cluster_count"===t||e.some(e=>e.name===t))return t;const i=function(e,t,n){switch(e){case"avg":case"avg_angle":return"cluster_avg_"+t;case"mode":return"cluster_type_"+t;case"norm":{const e=n,r="field",i=t.toLowerCase()+",norm:"+r+","+e.toLowerCase();return"cluster_avg_"+Object(l.a)(i)}}}(n,t,r);return e.some(e=>e.name===i)||("norm"===n?e.push({name:i,outStatistic:{onStatisticField:t,onStatisticNormalizationField:r,statisticType:n}}):e.push({name:i,outStatistic:{onStatisticField:t,statisticType:n}})),i}}}]);
//# sourceMappingURL=7.44f1d2a5.chunk.js.map